<!DOCTYPE html>
<html class="theme-light" lang="zh-cn-auto">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="关于如何使用 freebsd-update 或 Git 来保持 FreeBSD 系统最新的信息，以及如何重新构建和重新安装整个基本系统等。"/>
  <meta name="keywords" content="91, 34, 117, 112, 100, 97, 116, 105, 110, 103, 34, 44, 32, 34, 117, 112, 103, 114, 97, 100, 105, 110, 103, 34, 44, 32, 34, 100, 111, 99, 117, 109, 101, 110, 116, 97, 116, 105, 111, 110, 34, 44, 32, 34, 70, 114, 101, 101, 66, 83, 68, 45, 83, 84, 65, 66, 76, 69, 34, 44, 32, 34, 70, 114, 101, 101, 66, 83, 68, 45, 67, 85, 82, 82, 69, 78, 84, 34, 44, 32, 34, 83, 101, 99, 117, 114, 105, 116, 121, 32, 80, 97, 116, 99, 104, 101, 115, 34, 93"/>
  <meta name="copyright" content="1995-2024 The FreeBSD Foundation" />
  <link rel="canonical" href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/" />

  <title>第 26 章 更新和升级 FreeBSD |  FreeBSD 中文文档</title>

  <meta name="theme-color" content="#790000">
  <meta name="color-scheme" content="system light dark high-contrast">

    <link rel="shortcut icon" href="https://free.bsd-doc.org/favicon.ico">
    <link rel="stylesheet" href="/styles/main.min.css">
    <link rel="stylesheet" href="https://free.bsd-doc.org/css/font-awesome-min.css">
    <script defer src="/js/theme-chooser.min.js"></script>
    <script defer src="/js/copy-clipboard.min.js"></script>
    <script defer src="/js/search.min.js"></script>

  
  
    
    <meta property="og:title" content="第 26 章 更新和升级 FreeBSD" />
    <meta property="og:description" content="关于如何使用 freebsd-update 或 Git 来保持 FreeBSD 系统最新的信息，以及如何重新构建和重新安装整个基本系统等。" />
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://free.bsd-doc.orgfavicon.ico"/>
    <meta property="og:image:alt" content="FreeBSD Logo">
    <meta property="og:locale" content="zh-cn-auto" />
    <meta property="og:url" content="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/" />
    <meta property="og:site_name" content="FreeBSD 中文文档" />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "url": "https:\/\/free.bsd-doc.org\/zh-cn-auto\/books\/handbook\/cutting-edge\/",
        "name": "FreeBSD 中文文档",
        "headline": "FreeBSD 中文文档",
        "description": "FreeBSD 中文文档"
      }
    </script>
    

  
</head>


  <body>
    <header>
  <div class="header-container">
    <div class="logo-menu-bars-container">
      <a href="https://free.bsd-doc.org" class="logo">
        <img src="https://free.bsd-doc.org/images/FreeBSD-monochromatic.svg" width="160" height="50" alt="FreeBSD logo" />
      </a>
      <label class="menu-bars" for="menu-bars">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </div>
    <input id="menu-bars" type="checkbox" />
    
    <div class="search-donate-container">
      
      <div class="donate">
        <a href="https://github.com/fierceX/freebsd-doc-cn" target="_blank">
          <span class="heart">♥</span>
          GitHub
        </a>
      </div>
    </div>
  </div>
</header>

    
<input type="checkbox" class="hidden toggle" id="menu-control">
<main class="main-wrapper-book">
  <a id="top"></a>
  
  <aside class="book-menu">
    <div class="book-menu-content">
      <input id="search-book" type="text" placeholder="Search" aria-label="Search" maxlength="128" />
      <nav id="MenuContents">
        
  <ul>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ada319c45e780947f82b569049480cc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-8ada319c45e780947f82b569049480cc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/">
              前言
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-audience">预期读者</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-changes-from4">第四版</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-changes-from3">第三版</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-changes-from2">第二版（2004 年）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-changes">第一版（2001 年）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-overview">本书的组织结构</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-conv">本书中使用的约定</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/preface/#preface-acknowledgements">致谢</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-32a83d18a326852a8d9ae2582360bbc8" class="toggle"  />
          <label  for="chapter-32a83d18a326852a8d9ae2582360bbc8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/parti/">
              第一部分：入门指南
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a4909db05d872d16d5be86a57cbc2dc7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a4909db05d872d16d5be86a57cbc2dc7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/introduction/">
              第一章 引言
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/introduction/#introduction-synopsis">1.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/introduction/#nutshell">1.2. 欢迎来到 FreeBSD ！</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/introduction/#history">1.3. 关于 FreeBSD 项目</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3c2455cadf89eadd3f6e77461085d5e9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3c2455cadf89eadd3f6e77461085d5e9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/">
              第二章 安装 FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-synopsis">2.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-hardware">2.2. 最低硬件要求</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-pre">2.3. 安装前的任务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-start">2.4. 开始安装</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#using-bsdinstall">2.5. 使用 bsdinstall</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-partitioning">2.6. 分配磁盘空间</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-fetching-distribution">2.7. 获取分发文件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-post">2.8. 网络接口，账户，时区，服务和加固</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#bsdinstall-install-trouble">2.9. 故障排除</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bsdinstall/#using-live-cd">2.10. 使用 Live CD</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-709481b75d22ad36960f7ac166b3306c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-709481b75d22ad36960f7ac166b3306c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/">
              第三章. FreeBSD 基础知识
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#basics-synopsis">3.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#consoles">3.2. 虚拟控制台和终端</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#users-synopsis">3.3. 用户和基本账户管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#permissions">3.4. 权限</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#dirstructure">3.5. 目录结构</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#disk-organization">3.6. 磁盘组织</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#mount-unmount">3.7. 挂载和卸载文件系统</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#basics-processes">3.8. 进程和守护进程</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#shells">3.9. Shells</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#editors">3.10. 文本编辑器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#basics-devices">3.11. 设备和设备节点</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/basics/#basics-more-information">3.12. 手册页</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-58c050d31a1fbecd859248dacefeb567" class="toggle"  />
          <label  class="icon cursor"  for="chapter-58c050d31a1fbecd859248dacefeb567"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/">
              第四章 安装应用程序：软件包和 Ports
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-synopsis">4.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-overview">4.2. 软件安装概述</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-finding-applications">4.3. 寻找软件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#pkgng-intro">4.4. 使用 pkg 进行二进制包管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-using">4.5. 使用 Ports 集合</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-poudriere">4.6. 使用 poudriere 构建软件包</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-nextsteps">4.7. 安装后的考虑事项</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ports/#ports-broken">4.8. 处理损坏的 ports</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e5a000ce7f50680a180e2c1b83c121bc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e5a000ce7f50680a180e2c1b83c121bc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/">
              第五章 X Window 系统
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/#x11-synopsis">5.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/#x-install">5.2. 安装 Xorg</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/#x-graphic-card-drivers">5.3. 显卡驱动程序</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/#x-config">5.4. Xorg 配置</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/x11/#x-fonts">5.5. 在 Xorg 中使用字体</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-235af08fb87fd7a58003348706d2111d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-235af08fb87fd7a58003348706d2111d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/">
              第六章 Wayland
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-synopsis">6.1. Wayland 概述</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-wayfire">6.2. Wayfire 合成器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-hikari">6.3. Hikari 合成器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-sway">6.4. Sway 合成器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-xwayland">6.5. 使用 Xwayland</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-remotedesktop">6.6. 使用 VNC 进行远程桌面访问</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-ly">6.7. Wayland 登录管理器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wayland/#wayland-utilities">6.8. 有用的工具</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4de18483dde20bf9ed0024176afd09da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4de18483dde20bf9ed0024176afd09da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/">
              第 7 章 网络
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#network-synopsis">7.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#config-network-setup">7.2. 设置网络</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#config-network-connection">7.3. 有线网络</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#network-wireless">7.4. 无线网络</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#hostname">7.5. 主机名</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#dns">7.6. DNS</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network/#troubleshooting">7.7. 故障排除</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-5eb30759c3a2873e716dc31d7760054c" class="toggle"  />
          <label  for="chapter-5eb30759c3a2873e716dc31d7760054c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/partii/">
              第二部分：常见任务
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-c96504f017c56f4bc7f71548cccf5382" class="toggle"  />
          <label  class="icon cursor"  for="chapter-c96504f017c56f4bc7f71548cccf5382"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/">
              第 8 章 桌面环境
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-synopsis">8.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-environments">8.2. 桌面环境</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-browsers">8.3. 浏览器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-development">8.4. 开发工具</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-productivity">8.5. 桌面办公生产力</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-viewers">8.6. 文档查看器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/desktop/#desktop-finance">8.7. 金融</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e1898af36aaacc168e13b673d25b908f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e1898af36aaacc168e13b673d25b908f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/">
              第 9 章 多媒体
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#multimedia-synopsis">9.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#sound-setup">9.2. 设置声卡</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#audio-ports">9.3. 音频播放器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#video-ports">9.4. 视频播放器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#conferencing-meetings">9.5. 会议和会议</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/multimedia/#scanners">9.6. 图像扫描仪</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6926664836e63c5cae4b2fa60855f91d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-6926664836e63c5cae4b2fa60855f91d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/">
              第 10 章 配置 FreeBSD 内核
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-synopsis">10.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-custom-kernel">10.2. 为什么要构建自定义内核？</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-devices">10.3. 查找系统硬件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-config">10.4. 配置文件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-building">10.5. 构建和安装自定义内核</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/kernelconfig/#kernelconfig-trouble">10.6. 如果出现问题</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-19d36bd70a320268f0ea1f66e4f3e224" class="toggle"  />
          <label  class="icon cursor"  for="chapter-19d36bd70a320268f0ea1f66e4f3e224"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/">
              第 11 章 打印
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-quick-start">11.1. 快速入门</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-connections">11.2. 打印机连接</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-pdls">11.3. 常见的页面描述语言</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-direct">11.4. 直接打印</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-lpd">11.5. LPD （ Line Printer Daemon ）是一种用于打印机的网络协议。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/printing/#printing-other">11.6. 其他打印系统</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/linuxemu/">
              第 12 章 Linux 二进制兼容性
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/linuxemu/#linuxemu-synopsis">12.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/linuxemu/#linuxemu-lbc-install">12.2. 配置 Linux 二进制兼容性</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/linuxemu/#linux-userlands">12.3. Linux 用户空间</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/linuxemu/#linuxemu-advanced">12.4. 高级主题</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-af234c193ce95c480af0ff5ec3f32f5c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-af234c193ce95c480af0ff5ec3f32f5c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/">
              第 13 章 WINE
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#wine-synopsis">13.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#wine-overview-concepts">13.2. WINE 概述与概念</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#installing-wine-on-freebsd">13.3. 在 FreeBSD 上安装 WINE</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#running-first-wine-program">13.4. 在 FreeBSD 上运行第一个 WINE 程序</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#configuring-wine-installation">13.5. 配置 WINE 安装</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#wine-management-guis">13.6. WINE 管理图形界面</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#wine-in-multi-user-os-installations">13.7. 在多用户的 FreeBSD 安装中使用 WINE</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/wine/#wine-on-os-faq">13.8. 在 FreeBSD 上使用 WINE 的常见问题解答</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-51416fdea9d5a1dfa1c2718cd825213a" class="toggle"  />
          <label  for="chapter-51416fdea9d5a1dfa1c2718cd825213a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/partiii/">
              第三部分：系统管理
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-532d0380ba66d66e033765a0b6930ee7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-532d0380ba66d66e033765a0b6930ee7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/">
              第 14 章 配置、服务、日志和电源管理
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#config-synopsis">14.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#configtuning-configfiles">14.2. 配置文件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#configtuning-rcd">14.3. 在 FreeBSD 中管理服务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#cron-periodic">14.4. Cron 和周期性任务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#configtuning-syslog">14.5. 配置系统日志</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#acpi-overview">14.6. 功耗和资源管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/config/#adding-swap-space">14.7. 添加交换空间</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-d05f41680fb7e3d68b354ae03de368b1" class="toggle"  />
          <label  class="icon cursor"  for="chapter-d05f41680fb7e3d68b354ae03de368b1"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/boot/">
              第 15 章 FreeBSD 的引导过程
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/boot/#boot-synopsis">15.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/boot/#boot-introduction">15.2. FreeBSD 引导过程</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/boot/#device-hints">15.3. 设备提示</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/boot/#boot-shutdown">15.4. 关机序列</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-513e8e407c57354df334059688e9b60a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-513e8e407c57354df334059688e9b60a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/">
              第 16 章 安全
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-synopsis">16.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-intro">16.2. 介绍</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#sec-accounts">16.3. 保护账户安全</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-ids">16.4. 入侵检测系统（ IDS ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-secure-levels">16.5. 安全级别</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-file-flags">16.6. 文件标志</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#openssh">16.7. OpenSSH 是一个用于安全远程登录和文件传输的开源软件套件。它提供了加密的通信通道，以防止未经授权的访问和数据泄露。 OpenSSH 支持 SSH 协议，可以在不同的操作系统上运行，并且具有强大的身份验证和加密功能。它被广泛用于管理远程服务器和保护敏感数据的传输。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#openssl">16.8. OpenSSL 是一个开源的软件库，提供了一套用于安全通信的加密工具。它支持多种加密算法和协议，包括 SSL 和 TLS 。 OpenSSL 广泛用于网络通信、数字证书管理和数据加密等领域。它是一个功能强大且可靠的工具，被广泛应用于各种计算机系统和应用程序中。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#kerberos5">16.9. Kerberos 是一种网络身份验证协议，用于在计算机网络中验证用户的身份。它使用加密技术来确保通信的安全性，并防止身份伪造和中间人攻击。 Kerberos 还提供了单点登录功能，允许用户在一次身份验证后访问多个网络服务。它是计算机领域中常用的身份验证解决方案之一。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#tcpwrappers">16.10. TCP 包装器（ TCP Wrappers ）是一种网络访问控制工具，用于在 TCP/IP 网络上限制对特定服务的访问。它通过检查远程主机的 IP 地址和主机名来决定是否允许连接到受保护的服务。 TCP 包装器可以用于增强网络安全性，防止未经授权的访问和恶意活动。它通常与网络服务（如 SSH 、 FTP 和 Telnet ）一起使用，以提供对这些服务的访问控制。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#fs-acl">16.11. 访问控制列表</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#capsicum">16.12. Capsicum 是一种辣椒植物，属于茄科。它的果实通常被用作调味品和食材，具有辛辣的味道。 Capsicum 也被用于药用目的，具有抗氧化和抗炎作用。它含有丰富的维生素 C 和维生素 A ，对于保持健康非常重要。 Capsicum 在烹饪中被广泛使用，可以用于制作各种菜肴和调味品。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-accounting">16.13. 进程账户</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-resourcelimits">16.14. 资源限制</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-pkg">16.15. 监控第三方安全问题</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/security/#security-advisories">16.16. FreeBSD 安全公告</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0f7d2858504c83a029928c048d394e2a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0f7d2858504c83a029928c048d394e2a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/">
              第 17 章 Jails 和容器
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jails-synopsis">17.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jail-types">17.2. Jail 类型</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#host-configuration">17.3. 主机配置</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#classic-jail">17.4. 经典 Jail（厚 Jail ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#thin-jail">17.5. 薄（Thin）Jails</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jail-management">17.6. Jail 管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jail-upgrading">17.7. Jail 升级</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jail-resource-limits">17.8. Jail 资源限制</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/jails/#jail-managers-and-containers">17.9. Jail 管理器和容器</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-15be125ce5997f51c5499e3a0dee6c2c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-15be125ce5997f51c5499e3a0dee6c2c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/">
              第 18 章 强制访问控制
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-synopsis">18.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-inline-glossary">18.2. 关键术语</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-understandlabel">18.3. 理解 MAC 标签</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-planning">18.4. 规划安全配置</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-policies">18.5. 可用的 MAC 策略</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-userlocked">18.6. 用户锁定</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-implementing">18.7. 在 MAC 监狱中的 Nagios</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mac/#mac-troubleshoot">18.8. 解决 MAC 框架的问题</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3f7e8d763b17c7d0c44c60505cf0feea" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3f7e8d763b17c7d0c44c60505cf0feea"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/audit/">
              第 19 章 安全事件审计
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/audit/#audit-synopsis">19.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/audit/#audit-inline-glossary">19.2. 关键术语</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/audit/#audit-config">19.3. 审计配置</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/audit/#audit-administration">19.4. 使用审计跟踪功能</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7bb1cb2287cd08a3672cc878e604f0d0" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7bb1cb2287cd08a3672cc878e604f0d0"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/">
              第 20 章 存储
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-synopsis">20.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-adding">20.2. 添加磁盘</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-growing">20.3. 调整和扩展磁盘大小</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#usb-disks">20.4. USB 存储设备</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#creating-cds">20.5. 创建和使用 CD 媒体</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#creating-dvds">20.6. 创建和使用 DVD 媒体</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#floppies">20.7. 创建和使用软盘</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#using-ntfs">20.8. 使用 NTFS 磁盘</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#backup-basics">20.9. 备份基础知识</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-virtual">20.10. 内存磁盘</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#snapshots">20.11. 文件系统快照</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#quotas">20.12. 磁盘配额</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-encrypting">20.13. 加密磁盘分区</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#swap-encrypting">20.14. 加密交换分区</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/disks/#disks-hast">20.15. 高可用存储（ Highly Available Storage ， HAST ）</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-dec5fc4f0100e5030db0fb188d8d4b2f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-dec5fc4f0100e5030db0fb188d8d4b2f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/">
              第 21 章 GEOM ：模块化磁盘转换框架
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-synopsis">21.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-striping">21.2. RAID0 - 条带化</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-mirror">21.3. RAID1 - 镜像</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-raid3">21.4. RAID3 - 以字节为单位的条带化和专用奇偶校验</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-graid">21.5. 软件 RAID 设备</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-ggate">21.6. GEOM Gate Network 是一种计算机网络技术。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-glabel">21.7. 标记磁盘设备</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/geom/#geom-gjournal">21.8. 通过 GEOM 实现的 UFS 日志记录</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f1657a05627dd16bad31d4c7f675604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f1657a05627dd16bad31d4c7f675604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/">
              第 22 章 Z 文件系统（ZFS）
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-differences">22.1. ZFS 有何不同之处</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-quickstart">22.2. 快速入门指南</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-zpool">22.3. <code>zpool</code> 管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-zfs">22.4. <code>zfs</code> 管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-zfs-allow">22.5. 委派管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-advanced">22.6. 高级主题</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-links">22.7. 进一步资源</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/zfs/#zfs-term">22.8. ZFS 功能和术语</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4c6bf6828e601b79edb2813329ac6604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4c6bf6828e601b79edb2813329ac6604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/filesystems/">
              第 23 章 其他文件系统
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/filesystems/#filesystems-synopsis">23.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/filesystems/#filesystems-linux">23.2. Linux® 文件系统</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-ae23289d4b6415f3f878893f9d3ef9b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-ae23289d4b6415f3f878893f9d3ef9b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/">
              第 24 章 虚拟化
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-synopsis">24.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-guest-parallelsdesktop">24.2. 在 Parallels Desktop for macOS® 上作为客户机的 FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-guest-vmware">24.3. 在 macOS 上使用 VMware Fusion 作为客户机的 FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-guest-virtualbox">24.4. 在 VirtualBox™ 上作为客户机的 FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-host-virtualbox">24.5. 使用 VirtualBox™ 将 FreeBSD 作为主机</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-host-bhyve">24.6. 使用 bhyve 作为 FreeBSD 主机</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/virtualization/#virtualization-host-xen">24.7. FreeBSD 作为 Xen™ 主机</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-b279d2b738963a45a059268d2fae00d5" class="toggle"  />
          <label  class="icon cursor"  for="chapter-b279d2b738963a45a059268d2fae00d5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n/">
              第 25 章 本地化 - i18n/L10n 的使用和设置
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n/#l10n-synopsis">25.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n/#using-localization">25.2. 使用本地化</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n/#l10n-compiling">25.3. 寻找国际化应用程序</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n/#lang-setup">25.4. 特定语言的区域配置</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9e3f99bd76c861ab2e9a5f31ac421842" class="toggle"  checked  />
          <label  class="icon cursor"  for="chapter-9e3f99bd76c861ab2e9a5f31ac421842"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/">
              第 26 章 更新和升级 FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#updating-upgrading-synopsis">26.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate">26.2. FreeBSD 更新</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#updating-bootcode">26.3. 更新引导代码</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#updating-upgrading-documentation">26.4. 更新文档集合</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#current-stable">26.5. 跟踪开发分支</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#makeworld">26.6. 从源代码更新 FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#small-lan">26.7. 多台机器的追踪</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/cutting-edge/#building-on-non-freebsd-hosts">26.8. 在非 FreeBSD 主机上构建</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3ba999091575eb04ae88235cd0fb1afa" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3ba999091575eb04ae88235cd0fb1afa"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace/">
              第 27 章 DTrace
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace/#dtrace-synopsis">27.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace/#dtrace-implementation">27.2. 实现差异</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace/#dtrace-enable">27.3. 启用 DTrace 支持</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace/#dtrace-using">27.4. 使用 DTrace</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bdb217202a0a3eef4571dd1fcd50863c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bdb217202a0a3eef4571dd1fcd50863c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/usb-device-mode/">
              第 28 章 USB 设备模式 /USB OTG
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/usb-device-mode/#usb-device-mode-synopsis">28.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/usb-device-mode/#usb-device-mode-terminals">28.2. USB 虚拟串口</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/usb-device-mode/#usb-device-mode-network">28.3. USB 设备模式网络接口</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/usb-device-mode/#usb-device-mode-storage">28.4. USB 虚拟存储设备</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6d4439926bb106ac084ecc88cfd3cfa4" class="toggle"  />
          <label  for="chapter-6d4439926bb106ac084ecc88cfd3cfa4"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/partiv/">
              第四部分：网络通信
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-05a353fcb61d8e035f7c43e14725766e" class="toggle"  />
          <label  class="icon cursor"  for="chapter-05a353fcb61d8e035f7c43e14725766e"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/">
              第 29 章 串行通信
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#serial-synopsis">29.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#serial">29.2. 串行术语和硬件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#term">29.3. 终端</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#dialup">29.4. 拨入服务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#dialout">29.5. 拨出服务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/serialcomms/#serialconsole-setup">29.6. 设置串行控制台</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/">
              第 30 章 PPP
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis">30.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/#userppp">30.2. 配置 PPP</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/#ppp-troubleshoot">30.3. PPP 连接故障排除</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/#pppoe">30.4. 使用以太网上的点对点协议（ PPP over Ethernet ， PPPoE ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/ppp-and-slip/#pppoa">30.5. 使用 ATM 上的 PPP （ PPPoA ）</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9d023b545804f197d195dd9412749943" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9d023b545804f197d195dd9412749943"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/">
              第 31 章 电子邮件
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#mail-synopsis">31.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#mail-using">31.2. 邮件组件</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#dragonFly-mail-agent">31.3. DragonFly Mail Agent （ DMA ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#sendmail">31.4. Sendmail 是一种用于电子邮件传输的开源软件。它是一种邮件传输代理（ MTA ），用于将电子邮件从发送者的计算机发送到接收者的计算机。 Sendmail 具有广泛的功能和灵活性，可以在各种操作系统上运行，并且被广泛用于互联网上的电子邮件传输。它支持多种邮件协议和格式，并提供了丰富的配置选项，使用户能够根据自己的需求进行定制。 Sendmail 是互联网上最早的邮件传输代理之一，至今仍然被广泛使用。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#mail-changingmta">31.5. 更改邮件传输代理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#mail-agents">31.6. 邮件用户代理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mail/#mail-advanced">31.7. 高级主题</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-42b19e05d30c4135c74b9878818747a9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-42b19e05d30c4135c74b9878818747a9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/">
              第 32 章 网络服务器
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-servers-synopsis">32.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-inetd">32.2. inetd 超级服务器</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-nfs">32.3. 网络文件系统（ NFS ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-nis">32.4. 网络信息系统（ NIS ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-ldap">32.5. 轻量级目录访问协议（ LDAP ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-dhcp">32.6. 动态主机配置协议（ DHCP ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-dns">32.7. 域名系统（ DNS ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-apache">32.8. Apache HTTP Server 是一个开源的 Web 服务器软件，它是目前最流行的 Web 服务器之一。它由 Apache 软件基金会开发和维护，可运行在多种操作系统上，包括 Windows 、 Linux 和 Unix 等。 Apache HTTP Server 具有高度可扩展性和灵活性，支持多种模块和插件，可以实现各种功能，如动态内容生成、虚拟主机配置和安全性控制等。它还提供了丰富的文档和社区支持，使得用户能够轻松地学习和使用。无论是个人网站还是大型企业应用， Apache HTTP Server 都是一个可靠和强大的选择。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-ftp">32.9. 文件传输协议（ FTP ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-samba">32.10. 适用于 Microsoft® Windows® 客户端的文件和打印服务（ Samba ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-ntp">32.11. 使用 NTP 进行时钟同步</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/network-servers/#network-iscsi">32.12. iSCSI 发起者和目标配置</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9554a5177d00d0e87ada408809a1fc67" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9554a5177d00d0e87ada408809a1fc67"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/">
              第 33 章 防火墙
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-intro">33.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-concepts">33.2. 防火墙概念</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-pf">33.3. PF 可以有多种含义，根据上下文不同可能指：</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-ipfw">33.4. IPFW 是指 Internet 协议防火墙，是一种用于网络安全的技术。它可以通过过滤和监控网络流量来保护计算机和网络免受恶意攻击和未经授权的访问。 IPFW 可以根据预先定义的规则集来控制网络流量的进出，以实现对网络连接的管理和保护。它是一种常见的防火墙解决方案，被广泛应用于企业和个人网络环境中。</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-ipf">33.5. IPFILTER （ IPF ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/firewalls/#firewalls-blacklistd">33.6. 黑名单服务</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9903a1d844ed803a436595e93ec33572" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9903a1d844ed803a436595e93ec33572"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/">
              第 34 章 . 高级网络
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#advanced-networking-synopsis">34.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-routing">34.2. 网关和路由</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#configtuning-virtual-hosts">34.3. 虚拟主机</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-advanced-wireless">34.4. 无线高级认证</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#wireless-ad-hoc-mode">34.5. 无线自组网模式</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-usb-tethering">34.6. USB 网络共享</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-bluetooth">34.7. 蓝牙</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-bridging">34.8. 桥接</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-aggregation">34.9. 链路聚合和故障转移</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-diskless">34.10. 使用 PXE 进行无盘操作</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#carp">34.11. 常见地址冗余协议（ CARP ）</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/advanced-networking/#network-vlan">34.12. 虚拟局域网（ VLANs ）</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ca29f99c249993ee9234cb4632af7a5" class="toggle"  />
          <label  for="chapter-8ca29f99c249993ee9234cb4632af7a5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/partv/">
              第五部分. 附录
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0229d553ebf23ffeb945be6f32836221" class="toggle"  />
          <label  for="chapter-0229d553ebf23ffeb945be6f32836221"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/mirrors/">
              附录 A. 获取 FreeBSD
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-743c99fa278b8138914ff018e40c9231" class="toggle"  />
          <label  class="icon cursor"  for="chapter-743c99fa278b8138914ff018e40c9231"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bibliography/">
              附录 B. 参考文献
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bibliography/#bibliography-freebsd">B.1. FreeBSD 参考文献</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bibliography/#bibliography-security">B.2. 安全参考</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bibliography/#bibliography-history">B.3. UNIX® 历史</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/bibliography/#bibliography-journals">B.4. 期刊、杂志和期刊</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-de7eade4b8b64f298c0cbac44c2278da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-de7eade4b8b64f298c0cbac44c2278da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/eresources/">
              附录 C. 互联网资源
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/eresources/#eresources-www">C.1. 网站</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/eresources/#eresources-mail">C.2. 邮件列表</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/eresources/#eresources-news">C.3. Usenet 新闻组</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/pgpkeys/">
              附录 D. OpenPGP 密钥
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/pgpkeys/#pgpkeys-officers">D.1. 官员们</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-2a8deedf14429128049622ec007c9d3f" class="toggle"  />
          <label  for="chapter-2a8deedf14429128049622ec007c9d3f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/glossary/">
              FreeBSD 词汇表
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-110dbb242491bf200e51e76db171f670" class="toggle"  />
          <label  for="chapter-110dbb242491bf200e51e76db171f670"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/colophon/">
              后记
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-caffbcba74982e4b26b9263ac0232bc3" class="toggle"  />
          <label  for="chapter-caffbcba74982e4b26b9263ac0232bc3"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn-auto/books/handbook/introduction/">
              
            </a>
            
            
          

        
      </li>
    
      <li>
        
      </li>
    
  </ul>


      </nav>
    </div>
  </aside>
  
  <div class="book">
    
    <div class="book-menu-mobile">
      <label for="menu-control">
        <span class="menu-control-button">
          <i class="fa fa-list" aria-hidden="true" title="Book menu"></i>
          Book menu
        </span>
      </label>
    </div>
    
    <h1 class="title">第 26 章 更新和升级 FreeBSD</h1>
    
    
      <div class="admonitionblock note">
        <p>
          <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
          如果发现翻译错误，请直接 <a href="https://github.com/fierceX/freebsd-doc-cn/pulls" target="_blank">发起PR修改</a>。
        </p>
      </div>
    
    
    
    <div class="toc-mobile">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#updating-upgrading-synopsis">26.1. 简介</a></li>
    <li><a href="#updating-upgrading-freebsdupdate">26.2. FreeBSD 更新</a></li>
    <li><a href="#updating-bootcode">26.3. 更新引导代码</a></li>
    <li><a href="#updating-upgrading-documentation">26.4. 更新文档集合</a></li>
    <li><a href="#current-stable">26.5. 跟踪开发分支</a></li>
    <li><a href="#makeworld">26.6. 从源代码更新 FreeBSD</a></li>
    <li><a href="#small-lan">26.7. 多台机器的追踪</a></li>
    <li><a href="#building-on-non-freebsd-hosts">26.8. 在非 FreeBSD 主机上构建</a></li>
  </ul>
</nav>
    </div>
    
      
      
    
    <div class="book-content">
      <div id="preamble">
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="updating-upgrading-synopsis">26.1. 简介<a class="anchor" href="#updating-upgrading-synopsis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>FreeBSD 在发布之间处于不断的开发中。有些人喜欢使用官方发布的版本，而其他人则喜欢与最新的开发保持同步。然而，即使是官方发布的版本也经常会更新以修复安全和其他关键问题。无论使用哪个版本， FreeBSD 都提供了所有必要的工具来保持系统更新，并允许在版本之间进行轻松升级。本章介绍如何跟踪开发系统以及保持 FreeBSD 系统最新的基本工具。</p>
</div>
<div class="paragraph">
<p>阅读完本章后，您将了解：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>如何使用 freebsd-update 或 Git 来保持 FreeBSD 系统的最新状态。</p>
</li>
<li>
<p>如何将已安装系统的状态与已知的原始副本进行比较。</p>
</li>
<li>
<p>如何使用 Git 或文档端口来保持已安装文档的最新状态。</p>
</li>
<li>
<p>两个开发分支之间的区别： FreeBSD-STABLE 和 FreeBSD-CURRENT 。</p>
</li>
<li>
<p>如何重建和重新安装整个基础系统。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在阅读本章之前，您应该：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>正确设置网络连接（参见：高级网络设置）。</p>
</li>
<li>
<p>了解如何安装额外的第三方软件（参考： ports[ports ，安装应用程序：软件包和端口] ）。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>在本章中，使用 <code>git</code> 来获取和更新 FreeBSD 源代码。可选地，可以使用 <code><a class="package" href="https://cgit.freebsd.org/ports/tree/devel/git/">devel/git</a></code> 端口或软件包。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-upgrading-freebsdupdate">26.2. FreeBSD 更新<a class="anchor" href="#updating-upgrading-freebsdupdate"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>及时应用安全补丁和升级到操作系统的新版本是系统管理的重要方面。 FreeBSD 包含一个名为 <code>freebsd-update</code> 的实用程序，可用于执行这两个任务。</p>
</div>
<div class="paragraph">
<p>该实用程序支持对 FreeBSD 进行二进制安全性和勘误更新，无需手动编译和安装补丁或新内核。二进制更新适用于安全团队当前支持的所有架构和版本。支持的版本列表及其预计的生命周期日期可在 <a href="https://www.FreeBSD.org/security/" class="bare">https://www.FreeBSD.org/security/</a> 上找到。</p>
</div>
<div class="paragraph">
<p>该实用程序还支持将操作系统升级到次要点版本以及升级到另一个发布分支。在升级到新版本之前，请查看其发布公告，因为其中包含与该版本相关的重要信息。发布公告可从 <a href="https://www.FreeBSD.org/releases/" class="bare">https://www.FreeBSD.org/releases/</a> 获取。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>如果存在使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8&amp;format=html">freebsd-update(8)</a> 功能的 <a href="https://man.freebsd.org/cgi/man.cgi?query=crontab&amp;sektion=5&amp;format=html">crontab(5)</a> ，在升级操作系统之前必须将其禁用。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>本节描述了 <code>freebsd-update</code> 使用的配置文件，演示了如何应用安全补丁以及如何升级到次要或主要操作系统版本，并讨论了升级操作系统时的一些考虑因素。</p>
</div>
<div class="sect2">
<h3 id="freebsdupdate-config-file">26.2.1. 配置文件<a class="anchor" href="#freebsdupdate-config-file"></a></h3>
<div class="paragraph">
<p><code>freebsd-update</code> 的默认配置文件可以直接使用。一些用户可能希望调整默认配置文件 <code>/etc/freebsd-update.conf</code> ，以便更好地控制该过程。该文件中的注释解释了可用的选项，但以下内容可能需要更多的解释：</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Components of the base system which should be kept updated.
Components world kernel</pre>
</div>
</div>
<div class="paragraph">
<p>该参数控制着哪些部分的 FreeBSD 将保持最新。默认情况下，会更新整个基础系统和内核。也可以指定单个组件，例如 <code>src/base</code> 或 <code>src/sys</code> 。然而，最好的选择是将其保持默认状态，因为更改它以包括特定项需要列出每个所需的项。随着时间的推移，这可能会导致源代码和二进制文件不同步，从而产生灾难性后果。</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Paths which start with anything matching an entry in an IgnorePaths
# statement will be ignored.
IgnorePaths /boot/kernel/linker.hints</pre>
</div>
</div>
<div class="paragraph">
<p>为了在更新过程中保留指定目录（例如 <span class="filename">/bin</span> 或 <span class="filename">/sbin</span> ）的内容不变，可以将它们的路径添加到此语句中。此选项可用于防止 <code>freebsd-update</code> 覆盖本地修改。</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Paths which start with anything matching an entry in an UpdateIfUnmodified
# statement will only be updated if the contents of the file have not been
# modified by the user (unless changes are merged; see below).
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre>
</div>
</div>
<div class="paragraph">
<p>此选项仅会更新指定目录中未修改的配置文件。用户所做的任何更改都会阻止这些文件的自动更新。还有另一个选项 <code>KeepModifiedMetadata</code> ，它会指示 <code>freebsd-update</code> 在合并过程中保存更改。</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># When upgrading to a new FreeBSD release, files which match MergeChanges
# will have any local changes merged into the version from the new release.
MergeChanges /etc/ /var/named/etc/ /boot/device.hints</pre>
</div>
</div>
<div class="paragraph">
<p><code>freebsd-update</code> 应尝试合并的配置文件目录列表。文件合并过程是一系列类似于 <code>mergemaster</code> 的 <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> 补丁，但选项较少。合并可以被接受、打开编辑器或导致 <code>freebsd-update</code> 中止。如果不确定，备份 <span class="filename">/etc</span> 并接受合并。有关 <code>mergemaster</code> 的更多信息，请参阅 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 。</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Directory in which to store downloaded updates and temporary
# files used by FreeBSD Update.
# WorkDir /var/db/freebsd-update</pre>
</div>
</div>
<div class="paragraph">
<p>该目录是用于存放所有补丁和临时文件的位置。在用户进行版本升级的情况下，该位置应至少有 1GB 的可用磁盘空间。</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># When upgrading between releases, should the list of Components be
# read strictly (StrictComponents yes) or merely as a list of components
# which *might* be installed of which FreeBSD Update should figure out
# which actually are installed and upgrade those (StrictComponents no)?
# StrictComponents no</pre>
</div>
</div>
<div class="paragraph">
<p>当将此选项设置为 <code>yes</code> 时， <code>freebsd-update</code> 将假设 <code>Components</code> 列表是完整的，并且不会尝试在列表之外进行更改。实际上， <code>freebsd-update</code> 将尝试更新属于 <code>Components</code> 列表的每个文件。</p>
</div>
<div class="paragraph">
<p>请参考 <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update.conf&amp;sektion=5&amp;format=html">freebsd-update.conf(5)</a> 获取更多详细信息。</p>
</div>
</div>
<div class="sect2">
<h3 id="freebsdupdate-security-patches">26.2.2. 应用安全补丁<a class="anchor" href="#freebsdupdate-security-patches"></a></h3>
<div class="paragraph">
<p>应用 FreeBSD 安全补丁的过程已经简化，管理员可以使用 <code>freebsd-update</code> 来保持系统完全更新。有关 FreeBSD 安全公告的更多信息，请参阅 <a href="../security/#security-advisories">FreeBSD Security Advisories</a> 。</p>
</div>
<div class="paragraph">
<p>可以使用以下命令下载和安装 FreeBSD 安全补丁。第一个命令将确定是否有可用的未解决补丁，并且如果应用了这些补丁，将列出将被修改的文件。第二个命令将应用这些补丁。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update fetch</span>
<span class="c"># freebsd-update install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果更新应用了任何内核补丁，系统将需要重新启动以引导到已打补丁的内核。如果补丁被应用于正在运行的二进制文件，受影响的应用程序应该重新启动，以便使用已打补丁的二进制版本。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>通常，用户需要准备好重新启动系统。要知道系统是否需要由于内核更新而重新启动，请执行命令 <code>freebsd-version -k</code> 和 <code>uname -r</code> 。如果输出不同，请重新启动系统。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>系统可以通过将以下条目添加到 [/etc/crontab] 来配置每天自动检查更新：</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>@daily                                  root    freebsd-update cron</pre>
</div>
</div>
<div class="paragraph">
<p>如果存在补丁，它们将会自动下载但不会被应用。系统会向 <code>root</code> 用户发送一封电子邮件，以便可以审查这些补丁，并使用 <code>freebsd-update install</code> 命令手动安装它们。</p>
</div>
<div class="paragraph">
<p>如果出现任何问题， <code>freebsd-update</code> 可以使用以下命令回滚最后一组更改：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update rollback</span>
Uninstalling updates... <span class="k">done</span>.</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果内核或任何内核模块被修改，系统应该重新启动，并且应该重新启动任何受影响的二进制文件。</p>
</div>
<div class="paragraph">
<p>只有 <span class="filename">GENERIC</span> 内核可以被 <code>freebsd-update</code> 自动更新。如果安装了自定义内核，则需要在 <code>freebsd-update</code> 完成更新后重新构建和安装它。默认的内核名称是 <em>GENERIC</em>。可以使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> 命令来验证其安装情况。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>始终保留一个 <span class="filename">GENERIC</span> 内核的副本在 <span class="filename">/boot/GENERIC</span> 中。这对于诊断各种问题和进行版本升级非常有帮助。请参考 <a href="#freebsd-update-custom-kernel-9x">使用 FreeBSD 9.X 及更高版本的自定义内核</a> 了解如何获取 <span class="filename">GENERIC</span> 内核的副本的说明。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>除非已更改 <span class="filename">/etc/freebsd-update.conf</span> 中的默认配置，否则 <code>freebsd-update</code> 将与其他更新一起安装更新的内核源代码。然后可以按照通常的方式重新构建和重新安装新的自定义内核。</p>
</div>
<div class="paragraph">
<p><code>freebsd-update</code> 分发的更新并不总是涉及内核。如果内核源代码没有被 <code>freebsd-update install</code> 修改过，那么重新构建自定义内核是不必要的。然而， <code>freebsd-update</code> 总是会更新 <code>/usr/src/sys/conf/newvers.sh</code> 文件。通过 <code>uname -r</code> 命令报告的 <code>-p</code> 数字表示的当前补丁级别是从这个文件中获取的。即使没有其他变化，重新构建自定义内核也可以使 <code>uname</code> 准确地报告系统的当前补丁级别。这在维护多个系统时特别有帮助，因为它可以快速评估每个系统中安装的更新。</p>
</div>
</div>
<div class="sect2">
<h3 id="freebsdupdate-upgrade">26.2.3. 执行次要和主要版本升级<a class="anchor" href="#freebsdupdate-upgrade"></a></h3>
<div class="paragraph">
<p>从一个 FreeBSD 的次要版本升级到另一个次要版本被称为“次要版本”升级。一个例子：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>从 FreeBSD 13.1 升级到 13.2 。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>主要版本升级会增加主要版本号。一个例子：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FreeBSD 13.2 升级至 14.0 。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>通过为 <code>freebsd-update</code> 提供一个发布版本目标，可以执行两种类型的升级。</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>在每次新的 <code>RELEASE</code> 之后， FreeBSD 软件包构建服务器在有限的时间内 * 不会 * 使用较新的操作系统版本。这为许多用户提供了连续性，这些用户在发布公告后不会立即升级。例如：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>在 13.1 版本达到生命周期结束之前，将在运行 13.1 的服务器上构建适用于 13.1 和 13.2 用户的软件包。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p> — 而且，至关重要的是：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>在 13.1 上构建的内核模块可能 * 不适用于 *13.2 。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>因此，无论是小型还是大型操作系统升级，如果您的软件包要求包括任何内核模块：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>* 准备好从源代码构建模块 * 。</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>如果系统正在运行自定义内核，请确保在升级之前在 [/boot/GENERIC] 目录下存在一个 <span class="filename">GENERIC</span> 内核的副本。请参考 <a href="#freebsd-update-custom-kernel-9x">使用 FreeBSD 9.X 及更高版本的自定义内核</a> 以获取 <span class="filename">GENERIC</span> 内核的副本的说明。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>在 FreeBSD 13.1 系统上运行以下命令将升级到 FreeBSD 13.2 ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -r 13.2-RELEASE upgrade</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>在接收到命令后， <code>freebsd-update</code> 将评估配置文件和当前系统，以尝试收集执行升级所需的信息。屏幕上将显示一个列表，列出已检测到和未检测到的组件。例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature <span class="k">for </span>13.1-RELEASE from update1.FreeBSD.org... <span class="k">done</span>.
Fetching metadata index... <span class="k">done</span>.
Inspecting system... <span class="k">done</span>.

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD <span class="k">do </span>not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable <span class="o">(</span>y/n<span class="o">)</span>? y</code></pre>
</div>
</div>
<div class="paragraph">
<p>在这一点上， <code>freebsd-update</code> 将尝试下载升级所需的所有文件。在某些情况下，用户可能会被要求回答关于安装哪些文件或如何继续的问题。</p>
</div>
<div class="paragraph">
<p>当使用自定义内核时，上述步骤将产生类似以下的警告：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">WARNING: This system is running a <span class="s2">&#34;MYKERNEL&#34;</span> kernel, which is not a
kernel configuration distributed as part of FreeBSD 13.1-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running <span class="s2">&#34;/usr/sbin/freebsd-update install&#34;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>此警告可以在此时安全地忽略。更新的 <span class="filename">GENERIC</span> 内核将作为升级过程中的中间步骤使用。</p>
</div>
<div class="paragraph">
<p>一旦所有补丁都下载到本地系统后，它们将被应用。这个过程可能需要一些时间，具体取决于机器的速度和工作负载。然后将合并配置文件。合并过程需要一些用户干预，因为可能需要合并文件或者在屏幕上出现编辑器进行手动合并。每次成功合并的结果都会在进程继续时显示给用户。如果合并失败或被忽略，进程将中止。用户可能希望在以后的某个时间备份 [/etc] 目录并手动合并重要文件，例如 master.passwd 或 group 。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>系统尚未进行修改，因为所有的修补和合并都在另一个目录中进行。一旦所有的修补程序都成功应用，所有的配置文件都已经合并，并且看起来进程将顺利进行，用户可以使用以下命令将更改提交到磁盘：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update install</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>首先，将对内核和内核模块进行补丁。如果系统正在运行自定义内核，请使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=nextboot&amp;sektion=8&amp;format=html">nextboot(8)</a> 命令将内核设置为下一次启动时更新的 <span class="filename">/boot/GENERIC</span> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># nextboot -k GENERIC</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>在使用 <span class="filename">GENERIC</span> 内核重新启动之前，请确保它包含了系统正常启动和连接到网络所需的所有驱动程序，如果正在更新的机器是远程访问的。特别是，如果正在运行的自定义内核包含通常由内核模块提供的内置功能，请确保使用 <span class="filename">/boot/loader.conf</span> 工具将这些模块临时加载到 <span class="filename">GENERIC</span> 内核中。建议在升级过程完成之前禁用非必要的服务以及任何磁盘和网络挂载。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>现在应该使用更新的内核重新启动机器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># shutdown -r now</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>一旦系统恢复在线状态，使用以下命令重新启动 <code>freebsd-update</code> 。由于进程的状态已被保存， <code>freebsd-update</code> 将不会从头开始，而是继续进行下一阶段并删除所有旧的共享库和对象文件。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update install</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>根据库版本号是否有所增加，安装过程可能只有两个阶段，而不是三个阶段。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>升级已完成。如果这是一个主要版本的升级，请按照 <a href="#freebsdupdate-portsrebuild">在主要版本升级后升级软件包</a> 中描述的步骤重新安装所有端口和软件包。</p>
</div>
<div class="sect3">
<h4 id="freebsd-update-custom-kernel-9x">26.2.3.1. 使用 FreeBSD 9.X 及更高版本的自定义内核<a class="anchor" href="#freebsd-update-custom-kernel-9x"></a></h4>
<div class="paragraph">
<p>在使用 <code>freebsd-update</code> 前，请确保 <span class="filename">/boot/GENERIC</span> 目录下存在一个 <span class="filename">GENERIC</span> 内核的副本。如果只构建了一个自定义内核，那么 <span class="filename">/boot/kernel.old</span> 目录下的内核就是 <code>GENERIC</code> 内核。只需将此目录重命名为 <span class="filename">/boot/GENERIC</span> 。</p>
</div>
<div class="paragraph">
<p>如果自定义内核已经构建了多次，或者不知道自定义内核已经构建了多少次，请获取与当前操作系统版本匹配的 <code>GENERIC</code> 内核的副本。如果可以物理访问系统，则可以从安装介质中安装 <code>GENERIC</code> 内核的副本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mount /cdrom</span>
<span class="c"># cd /cdrom/usr/freebsd-dist</span>
<span class="c"># tar -C/ -xvf kernel.txz boot/kernel/kernel</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>或者，也可以从源代码重新构建并安装 <code>GENERIC</code> 内核：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># make kernel __MAKE_CONF=/dev/null SRCCONF=/dev/null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>为了使这个内核被 <code>freebsd-update</code> 识别为 <code>GENERIC</code> 内核，必须确保 <span class="filename">GENERIC</span> 配置文件没有被任何方式修改过。同时建议在构建内核时不使用任何其他特殊选项。</p>
</div>
<div class="paragraph">
<p>不需要重新启动到“ GENERIC ”内核，因为“ freebsd-update ”只需要存在“ /boot/GENERIC ”文件。</p>
</div>
</div>
<div class="sect3">
<h4 id="freebsdupdate-portsrebuild">26.2.3.2. 在主要版本升级后升级软件包<a class="anchor" href="#freebsdupdate-portsrebuild"></a></h4>
<div class="paragraph">
<p>通常，在小版本升级后，已安装的应用程序将继续正常工作，没有问题。主要版本使用不同的应用程序二进制接口（ ABI ），这将导致大多数第三方应用程序无法正常工作。在进行主要版本升级后，所有已安装的软件包和端口都需要升级。可以使用 <code>pkg upgrade</code> 命令升级软件包。要升级已安装的端口，请使用类似于 <a class="package" href="https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/">ports-mgmt/portmaster</a> 的实用工具。</p>
</div>
<div class="paragraph">
<p>强制升级所有已安装的软件包将使用存储库中的新版本替换软件包，即使版本号没有增加。这是因为在升级 FreeBSD 的主要版本之间时， ABI 版本会发生变化。可以通过执行以下操作来完成强制升级：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg-static upgrade -f</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>使用以下命令可以重新构建所有已安装的应用程序：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># portmaster -af</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>该命令将显示每个具有可配置选项的应用程序的配置屏幕，并等待用户与这些屏幕进行交互。为了防止这种行为，并仅使用默认选项，请在上述命令中包含 <code>-G</code> 。</p>
</div>
<div class="paragraph">
<p>一旦软件升级完成，通过最后一次调用 <code>freebsd-update</code> 来完成升级过程，以解决升级过程中的所有问题。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果临时使用了 <span class="filename">GENERIC</span> 内核，现在是构建和安装新的自定义内核的时候了，可以按照 <a href="../kernelconfig/#kernelconfig">Configuring the FreeBSD Kernel</a> 中的说明进行操作。</p>
</div>
<div class="paragraph">
<p>将机器重启到新的 FreeBSD 版本。升级过程现在已经完成。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="freebsdupdate-system-comparison">26.2.4. 系统状态比较<a class="anchor" href="#freebsdupdate-system-comparison"></a></h3>
<div class="paragraph">
<p>可以使用 <code>freebsd-update IDS</code> 命令来测试已安装的 FreeBSD 版本与已知的良好副本之间的状态。该命令评估系统实用程序、库和配置文件的当前版本，并可用作内置的入侵检测系统（ IDS ）。</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>这个命令不能替代真正的入侵检测系统，比如 <a class="package" href="https://cgit.freebsd.org/ports/tree/security/snort/">security/snort</a> 。由于 <code>freebsd-update</code> 将数据存储在磁盘上，篡改的可能性是显而易见的。虽然可以通过使用 <code>kern.securelevel</code> 和在不使用时将 <code>freebsd-update</code> 数据存储在只读文件系统上来减少这种可能性，但更好的解决方案是将系统与安全磁盘（如 DVD 或安全存储的外部 USB 磁盘设备）进行比较。使用内置工具提供 IDS 功能的替代方法在 <a href="../security/#security-ids">Binary Verification</a> 中有描述。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>开始比较之前，请指定要将结果保存到的输出文件：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update IDS &gt;&gt; outfile.ids</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>系统将会被检查，并且会将文件的详细列表以及已知发布版本和当前安装版本的 SHA256 哈希值发送到指定的输出文件中。</p>
</div>
<div class="paragraph">
<p>列表中的条目非常长，但输出格式很容易解析。例如，要获取与发布版本不同的所有文件的列表，请执行以下命令：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cat outfile.ids | awk &#39;{ print $1 }&#39; | more</span>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</code></pre>
</div>
</div>
<div class="paragraph">
<p>由于存在更多的文件，此示例输出已被截断。一些文件具有自然的修改。例如，如果系统中添加了用户， [/etc/passwd] 文件将被修改。内核模块可能会有所不同，因为 <code>freebsd-update</code> 可能已经对它们进行了更新。要排除特定的文件或目录，请将它们添加到 [/etc/freebsd-update.conf] 文件中的 <code>IDSIgnorePaths</code> 选项中。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-bootcode">26.3. 更新引导代码<a class="anchor" href="#updating-bootcode"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>以下手册描述了引导代码和引导加载程序的升级过程： <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> 、 <a href="https://man.freebsd.org/cgi/man.cgi?query=gptboot&amp;sektion=8&amp;format=html">gptboot(8)</a> 、 <a href="https://man.freebsd.org/cgi/man.cgi?query=gptzfsboot&amp;sektion=8&amp;format=html">gptzfsboot(8)</a> 和 <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.efi&amp;sektion=8&amp;format=html">loader.efi(8)</a> 。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-upgrading-documentation">26.4. 更新文档集合<a class="anchor" href="#updating-upgrading-documentation"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>文档是 FreeBSD 操作系统的一个重要组成部分。虽然 FreeBSD 网站上始终提供最新版本的文档（链接： <a href="https://docs.FreeBSD.org">文档门户</a> ），但拥有一个最新的本地副本也是很方便的，包括 FreeBSD 网站、手册、常见问题解答和文章。</p>
</div>
<div class="paragraph">
<p>本节介绍如何使用源代码或 FreeBSD Ports Collection 来保持本地的 FreeBSD 文档最新。</p>
</div>
<div class="paragraph">
<p>有关编辑和提交文档更正的信息，请参阅《 FreeBSD 文档项目新贡献者入门指南》（ <a href="{fdp-primer}">FreeBSD 文档项目新贡献者入门指南</a> ）。</p>
</div>
<div class="sect2">
<h3 id="updating-installed-documentation">26.4.1. 从源代码更新文档<a class="anchor" href="#updating-installed-documentation"></a></h3>
<div class="paragraph">
<p>从源代码重新构建 FreeBSD 文档需要一系列工具，这些工具不是 FreeBSD 基本系统的一部分。可以按照 FreeBSD 文档项目入门指南中的 <a href="{fdp-primer}">这些步骤， overview-quick-start</a> 来安装所需的工具。</p>
</div>
<div class="paragraph">
<p>安装完成后，使用 <code>git</code> 获取文档源代码的干净副本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># git clone https://git.FreeBSD.org/doc.git /usr/doc</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>下载文档源文件可能需要一些时间。请让它运行直到完成。</p>
</div>
<div class="paragraph">
<p>未来可以通过运行以下命令获取文档源的更新：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># git pull</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>一旦文档源的最新快照被获取到 [/usr/doc] 目录下，所有准备工作就完成了，可以更新已安装的文档。</p>
</div>
<div class="paragraph">
<p>可以通过输入以下命令来执行完整更新：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/doc</span>
<span class="c"># make</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="current-stable">26.5. 跟踪开发分支<a class="anchor" href="#current-stable"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>FreeBSD 有两个开发分支： FreeBSD-CURRENT 和 FreeBSD-STABLE 。</p>
</div>
<div class="paragraph">
<p>本节提供了每个分支及其预期受众的解释，以及如何使系统与每个相应分支保持最新的说明。</p>
</div>
<div class="sect2">
<h3 id="current">26.5.1. 使用 FreeBSD-CURRENT<a class="anchor" href="#current"></a></h3>
<div class="paragraph">
<p>FreeBSD-CURRENT 是 FreeBSD 开发的“最前沿”，使用 FreeBSD-CURRENT 的用户需要具备较高的技术能力。希望跟踪开发分支但技术水平较低的用户应该选择跟踪 FreeBSD-STABLE 。</p>
</div>
<div class="paragraph">
<p>FreeBSD-CURRENT 是 FreeBSD 的最新源代码，包括正在进行中的工作、实验性的更改以及可能存在于下一个官方发布版本中的过渡机制。虽然许多 FreeBSD 开发人员每天编译 FreeBSD-CURRENT 源代码，但在某些短暂的时间内，源代码可能无法构建。这些问题会尽快解决，但是 FreeBSD-CURRENT 是否带来灾难或新功能可能取决于源代码同步的时间。</p>
</div>
<div class="paragraph">
<p>FreeBSD-CURRENT 提供给三个主要的利益群体使用：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>活跃在 FreeBSD 社区中，正在积极参与源代码树某个部分工作的成员。</p>
</li>
<li>
<p>FreeBSD 社区的活跃测试人员。他们愿意花时间解决问题，就 FreeBSD 的变化和整体方向提出主题建议，并提交补丁。</p>
</li>
<li>
<p>希望密切关注事物、使用当前源代码进行参考，或偶尔发表评论或贡献代码的用户。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>FreeBSD-CURRENT 不应被视为在下一次发布之前获取新功能的快速途径，因为预发布功能尚未经过完全测试，很可能包含错误。它也不是获取错误修复的快速方式，因为每个提交都有可能引入新的错误而不是修复现有的错误。 FreeBSD-CURRENT 在任何情况下都不是“官方支持”的。</p>
</div>
<div class="paragraph">
<p>要追踪 FreeBSD-CURRENT ：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>加入 {freebsd-current} 和 {dev-commits-src-main} 邮件列表。这是非常重要的，可以看到人们对系统当前状态的评论，并接收有关 FreeBSD-CURRENT 当前状态的重要公告。</p>
<div class="paragraph">
<p>{dev-commits-src-main} 列表记录每次更改的提交日志条目，以及可能的副作用的相关信息。</p>
</div>
<div class="paragraph">
<p>要加入这些邮件列表，请转到 {mailing-lists} ，点击要订阅的列表，并按照说明进行操作。为了跟踪整个源代码树的变化，而不仅仅是 FreeBSD-CURRENT 的变化，请订阅 {dev-commits-src-all} 。</p>
</div>
</li>
<li>
<p>与 FreeBSD-CURRENT 源代码同步。通常情况下，使用 <code>git</code> 从 FreeBSD Git 存储库的 <code>main</code> 分支检出 -CURRENT 代码（有关详细信息，请参阅 <a href="../mirrors/#git ，“使用 Git ”"></a> ）。</p>
</li>
<li>
<p>由于存储库的大小，一些用户选择只同步他们感兴趣的或者他们正在贡献补丁的源代码部分。然而，计划从源代码编译操作系统的用户必须下载整个 FreeBSD-CURRENT ，而不仅仅是选择的部分。</p>
<div class="paragraph">
<p>在编译 FreeBSD-CURRENT 之前，请仔细阅读 [/usr/src/Makefile] 文件，并按照 [makeworld] 中的说明进行操作。阅读 {freebsd-current} 和 [/usr/src/UPDATING] 文件以了解其他引导程序的更新情况，有时在进行下一个版本发布的过程中可能需要这些更新。</p>
</div>
</li>
<li>
<p>积极参与！鼓励 FreeBSD-CURRENT 用户提交他们对增强功能或修复错误的建议。附带代码的建议将会受到欢迎。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="stable">26.5.2. 使用 FreeBSD-STABLE<a class="anchor" href="#stable"></a></h3>
<div class="paragraph">
<p>FreeBSD-STABLE 是用于制作主要发布版本的开发分支。更改以较慢的速度进入此分支，并且通常假定它们首先在 FreeBSD-CURRENT 中进行了测试。这仍然是一个开发分支，并且在任何给定时间， FreeBSD-STABLE 的源代码可能适用或不适用于一般使用。它只是另一个工程开发轨道，而不是面向最终用户的资源。没有资源进行测试的用户应该运行最新版本的 FreeBSD 。</p>
</div>
<div class="paragraph">
<p>对于那些对追踪或参与 FreeBSD 开发过程感兴趣的人，尤其是与下一个 FreeBSD 版本相关的人，应该考虑关注 FreeBSD-STABLE 。</p>
</div>
<div class="paragraph">
<p>尽管 FreeBSD-STABLE 分支应该始终能够编译和运行，但无法保证这一点。由于运行 FreeBSD-STABLE 的人比运行 FreeBSD-CURRENT 的人更多，因此不可避免地会在 FreeBSD-STABLE 中发现一些在 FreeBSD-CURRENT 中不明显的错误和边界情况。因此，不应盲目跟踪 FreeBSD-STABLE 。特别重要的是，在没有在开发或测试环境中彻底测试代码的情况下，不要将任何生产服务器更新到 FreeBSD-STABLE 。</p>
</div>
<div class="paragraph">
<p>跟踪 FreeBSD-STABLE 的方法：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>加入 {freebsd-stable} 以便及时了解在 FreeBSD-STABLE 中可能出现的构建依赖项或其他需要特别关注的问题。开发人员还会在这个邮件列表中发布公告，当他们考虑一些有争议的修复或更新时，给用户一个机会回应，如果他们有任何关于拟议变更的问题需要提出。</p>
<div class="paragraph">
<p>加入与正在跟踪的分支相关的 git 列表。例如，跟踪 13-STABLE 分支的用户应该加入 {dev-commits-src-branches} 。该列表记录每个更改的提交日志条目，以及可能的副作用的任何相关信息。</p>
</div>
<div class="paragraph">
<p>要加入这些列表，请转到 {mailing-lists} ，点击要订阅的列表，并按照说明进行操作。为了跟踪整个源代码树的变化，请订阅 {dev-commits-src-all} 。</p>
</div>
</li>
<li>
<p>要安装一个新的 FreeBSD-STABLE 系统，请从 <a href="../mirrors/#FreeBSD 镜像站点"></a> 安装最新的 FreeBSD-STABLE 版本，或者使用从 FreeBSD-STABLE 构建的每月快照。有关快照的更多信息，请参考 <a href="https://www.FreeBSD.org/snapshots/">www.freebsd.org/snapshots</a> 。</p>
<div class="paragraph">
<p>要编译或升级现有的 FreeBSD 系统到 FreeBSD-STABLE ，使用 <code>git</code> 来检出所需分支的源代码。分支名称，例如 <code>stable/13</code> ，在 <a href="https://www.FreeBSD.org/releng/">www.freebsd.org/releng</a> 上列出。</p>
</div>
</li>
<li>
<p>在编译或升级到 FreeBSD-STABLE 之前，请仔细阅读 [/usr/src/Makefile] 并按照 <a href="#makeworld">从源代码更新 FreeBSD</a> 中的说明进行操作。阅读 {freebsd-stable} 和 [/usr/src/UPDATING] 以了解其他引导程序的最新信息，有时在进行下一个版本发布的过程中可能需要这些信息。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="translate-n-number">26.5.3. N 号码<a class="anchor" href="#translate-n-number"></a></h3>
<div class="paragraph">
<p>在追踪错误时，了解使用哪些版本的源代码创建了出现问题的系统非常重要。 FreeBSD 在内核中提供了编译的版本信息。 <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> 可以检索到这些信息，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>uname -v
FreeBSD 14.0-CURRENT <span class="c">#112 main-n247514-031260d64c18: Tue Jun 22 20:43:19 MDT 2021     fred@machine:/usr/home/fred/obj/usr/home/fred/git/head/amd64.amd64/sys/FRED</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>最后一个字段提供了有关内核名称、构建内核的人以及编译位置的信息。观察第四个字段，它由几个部分组成：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">main-n247514-031260d64c18

main		<i class="conum" data-value="1"></i><b>(1)</b>
n247514		<i class="conum" data-value="2"></i><b>(2)</b>
031260d64c18	<i class="conum" data-value="3"></i><b>(3)</b>
		<i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Git 分支名称。注意：仅对项目发布的分支（ <code>main</code> ， <code>stable/XX</code> 和 <code>releng/XX</code> ）进行 n- 数字的比较才有效。本地分支的 n- 数字将与其父分支的提交重叠。 &lt;.&gt; n- 数字是从包含在该行中的 Git 哈希开始的 Git 存储库的提交线性计数。 &lt;.&gt; 检出树的 Git 哈希 &lt;.&gt; 当内核在具有未提交更改的树中构建时，有时会出现后缀 <code>-dirty</code> 。在此示例中，它不存在，因为 FRED 内核是从原始的检出构建的。</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><code>git rev-list</code> 命令用于查找与 Git 哈希对应的 n-number 。例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>git rev-list --first-parent --count 031260d64c18 <i class="conum" data-value="1"></i><b>(1)</b>
247514 <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>要翻译的 git 哈希（上面示例中的哈希被重用） &lt;.&gt; N 号码。</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>通常这个数字并不是非常重要。然而，当提交了错误修复时，这个数字可以快速确定修复是否存在于当前运行的系统中。开发人员通常会引用提交的哈希值（或提供具有该哈希值的 URL ），而不是 n 号，因为哈希值是一个易于识别的变更标识符，而 n 号则不是。安全公告和勘误通知也会注明一个 n 号，可以直接与您的系统进行比较。当您需要使用浅层 Git 克隆时，您无法可靠地比较 n 号，因为 <code>git rev-list</code> 命令会计算仓库中的所有修订版本，而浅层克隆会省略一些修订版本。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="makeworld">26.6. 从源代码更新 FreeBSD<a class="anchor" href="#makeworld"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>通过从源代码编译来更新 FreeBSD 相比二进制更新有几个优点。可以使用选项构建代码以充分利用特定的硬件。可以使用非默认设置构建基本系统的部分，或者在不需要或不希望的地方完全省略它们。与仅安装二进制更新相比，构建过程更新系统需要更长时间，但允许完全定制以生成定制版本的 FreeBSD 。</p>
</div>
<div class="sect2">
<h3 id="updating-src-quick-start">26.6.1. 快速入门<a class="anchor" href="#updating-src-quick-start"></a></h3>
<div class="paragraph">
<p>这是一个快速参考，用于通过从源代码构建来更新 FreeBSD 的典型步骤。后面的章节将更详细地描述这个过程。</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>当从 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 切换到 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 时，第一次运行可能会错误地合并更改，从而生成虚假的冲突。为了防止这种情况发生，在更新源代码和构建新的系统之前，请执行以下步骤：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># etcupdate extract </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="c"># etcupdate diff </span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>引导数据库的股票 <span class="filename">/etc</span> 文件；有关更多信息，请参阅 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>在引导完成后检查差异。修剪不再需要的本地更改，以减少将来更新中冲突的可能性。</td>
</tr>
</tbody></table>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock procedure">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>更新和构建</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># git pull /usr/src  </span><i class="conum" data-value="1"></i><b>(1)</b>
check /usr/src/UPDATING  <i class="conum" data-value="2"></i><b>(2)</b>
<span class="c"># cd /usr/src          </span><i class="conum" data-value="3"></i><b>(3)</b>
<span class="c"># make -j4 buildworld  </span><i class="conum" data-value="4"></i><b>(4)</b>
<span class="c"># make -j4 kernel      </span><i class="conum" data-value="5"></i><b>(5)</b>
<span class="c"># shutdown -r now      </span><i class="conum" data-value="6"></i><b>(6)</b>
<span class="c"># etcupdate -p         </span><i class="conum" data-value="7"></i><b>(7)</b>
<span class="c"># cd /usr/src          </span><i class="conum" data-value="8"></i><b>(8)</b>
<span class="c"># make installworld    </span><i class="conum" data-value="9"></i><b>(9)</b>
<span class="c"># etcupdate -B         </span><i class="conum" data-value="10"></i><b>(10)</b>
<span class="c"># shutdown -r now      </span><i class="conum" data-value="11"></i><b>(11)</b></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>获取最新版本的源代码。有关获取和更新源代码的更多信息，请参阅 <a href="#updating-src-obtaining-src">更新源代码</a> 。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>在从源代码构建之前或之后，请检查 <span class="filename">/usr/src/UPDATING</span> 是否有任何需要手动执行的步骤。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>进入源代码目录。</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>编译整个世界，除了内核之外的一切。</p>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>编译并安装内核。这相当于执行 <code>make buildkernel installkernel</code> 命令。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>重新启动系统以加载新内核。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>在安装世界之前，需要更新和合并位于 <span class="filename">/etc/</span> 的配置文件。</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>进入源代码目录。</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>安装世界。</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>更新并合并 <span class="filename">/etc/</span> 中的配置文件。</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>重新启动系统以使用新构建的世界和内核。</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-src-preparing">26.6.2. 准备进行源代码更新<a class="anchor" href="#updating-src-preparing"></a></h3>
<div class="paragraph">
<p>阅读 [/usr/src/UPDATING] 文件。该文件描述了在更新之前或之后必须执行的任何手动步骤。</p>
</div>
</div>
<div class="sect2">
<h3 id="updating-src-obtaining-src">26.6.3. 更新源代码<a class="anchor" href="#updating-src-obtaining-src"></a></h3>
<div class="paragraph">
<p>FreeBSD 源代码位于 [/usr/src/] 目录下。更新源代码的首选方法是通过 Git 版本控制系统。请确认源代码已经处于版本控制下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># git remote --v</span>
origin  https://git.freebsd.org/src.git <span class="o">(</span>fetch<span class="o">)</span>
origin  https://git.freebsd.org/src.git <span class="o">(</span>push<span class="o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>这表示 <span class="filename">/usr/src/</span> 已经受到版本控制，可以使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=git&amp;sektion=1&amp;format=html">git(1)</a> 进行更新。</p>
</div>
<div id="synching" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># git pull /usr/src</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果目录最近没有更新，更新过程可能需要一些时间。完成后，源代码将是最新的，可以开始下一节中描述的构建过程。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>获取源代码：</p>
</div>
<div class="paragraph">
<p>如果输出显示“ fatal: not a git repository ”，则表示文件丢失或使用了不同的安装方法。需要重新检出源代码。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<table id="updating-src-obtaining-src-repopath" class="tableblock frame-all grid-all stretch">
<caption class="title">表 1. FreeBSD 版本和存储库分支</caption>
<colgroup>
<col style="width: 10%;"/>
<col style="width: 10%;"/>
<col style="width: 80%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">uname -r 的输出结果</th>
<th class="tableblock halign-left valign-top">仓库路径</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>X.Y</em>-RELEASE</code> 表示一个版本号，其中 <code>X</code> 和 <code>Y</code> 是数字，表示主版本号和次版本号。 <code>RELEASE</code> 表示这是一个正式发布的版本。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>releng/<em>X.Y</em></code> 是一个文件或目录的路径，其中 <code>X.Y</code> 是一个占位符，表示一个特定的版本号。在计算机领域中， <code>releng</code> 通常是指与软件发布和工程相关的任务和流程。这个路径可能用于存储与特定版本相关的发布工程文件或目录。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">发布版本加上仅包含关键安全和错误修复补丁。这个分支推荐给大多数用户使用。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>X.Y</em>-STABLE</code> 表示一个稳定版本，其中 <code>X.Y</code> 是具体的版本号。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stable/<em>X</em></code> 的中文翻译是 ` 稳定版 /<em>X</em>` 。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">稳定版本加上该分支上的所有额外开发。<em>STABLE</em> 指的是应用程序二进制接口（ ABI ）不会改变，因此为早期版本编译的软件仍然可以运行。例如，为了在 FreeBSD 10.1 上运行而编译的软件仍然可以在稍后编译的 FreeBSD 10-STABLE 上运行。</p>
<p class="tableblock">稳定分支偶尔会有错误或不兼容性，可能会影响用户，尽管这些问题通常会很快修复。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><em>X</em>-CURRENT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>main</code> 是一个在计算机编程中常见的术语，表示程序的入口点或主函数。在许多编程语言中，程序的执行通常从 <code>main</code> 函数开始。 <code>main</code> 函数包含了程序的主要逻辑和执行流程。当程序运行时，操作系统会首先调用 <code>main</code> 函数，并从这里开始执行程序的代码。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">最新的未发布开发版本的 FreeBSD 。 CURRENT 分支可能存在重大错误或不兼容性问题，仅推荐给高级用户使用。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> 命令确定正在使用的 FreeBSD 版本。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># uname -r</span>
13.2-RELEASE</code></pre>
</div>
</div>
<div class="paragraph">
<p>根据 &lt;&lt; 更新源码 - 获取源码存储路径 &gt;&gt; ，用于更新 <code>13.2-RELEASE</code> 的源码具有存储路径 <code>releng/13.2</code> 。在检出源码时使用该路径：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mv /usr/src /usr/src.bak </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="c"># git clone --branch releng/13.2 https://git.FreeBSD.org/src.git /usr/src </span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>将旧目录移开。如果该目录没有本地修改，可以删除。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>将从 <a href="#updating-src-obtaining-src-repopath">FreeBSD 版本和存储库分支</a> 的路径添加到存储库 URL 中。第三个参数是本地系统上源代码的目标目录。</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="updating-src-building">26.6.4. 从源代码构建<a class="anchor" href="#updating-src-building"></a></h3>
<div class="paragraph">
<p>整个操作系统除了内核之外的部分被编译。首先这样做是为了提供最新的工具来构建内核。然后构建内核本身：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># make buildworld</span>
<span class="c"># make buildkernel</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>编译后的代码被写入到 <span class="filename">/usr/obj</span> 。</p>
</div>
<div class="paragraph">
<p>这些是基本步骤。下面描述了用于控制构建的其他选项。</p>
</div>
<div class="sect3">
<h4 id="updating-src-building-clean-build">26.6.4.1. 执行清理构建<a class="anchor" href="#updating-src-building-clean-build"></a></h4>
<div class="paragraph">
<p>一些 FreeBSD 构建系统的版本会在临时对象目录 [/usr/obj] 中保留先前编译的代码。这可以通过避免重新编译未更改的代码来加快后续的构建过程。要强制进行全面的清理重建，请在开始构建之前使用 <code>cleanworld</code> 命令。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make cleanworld</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-building-jobs">26.6.4.2. 设置作业数量<a class="anchor" href="#updating-src-building-jobs"></a></h4>
<div class="paragraph">
<p>增加多核处理器上的构建作业数量可以提高构建速度。使用 <code>sysctl hw.ncpu</code> 确定核心数。处理器和不同版本的 FreeBSD 使用的构建系统各不相同，因此测试是唯一确定不同作业数量如何影响构建速度的可靠方法。作为起点，考虑在核心数的一半和两倍之间选择值。作业数量使用 <code>-j</code> 参数指定。</p>
</div>
<div id="updating-src-building-jobs-example" class="exampleblock">
<div class="title">例 1. 增加构建作业的数量</div>
<div class="content">
<div class="paragraph">
<p>使用四个作业构建世界和内核：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make -j4 buildworld buildkernel</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-building-only-kernel">26.6.4.3. 仅构建内核<a class="anchor" href="#updating-src-building-only-kernel"></a></h4>
<div class="paragraph">
<p>如果源代码发生了变化，必须完成 <code>buildworld</code> 。之后，可以随时运行 <code>buildkernel</code> 来构建内核。要仅构建内核：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># make buildkernel</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-building-custom-kernel">26.6.4.4. 构建自定义内核<a class="anchor" href="#updating-src-building-custom-kernel"></a></h4>
<div class="paragraph">
<p>标准的 FreeBSD 内核基于一个名为 <span class="filename">GENERIC</span> 的_内核配置文件_。 <span class="filename">GENERIC</span> 内核包含了最常用的设备驱动程序和选项。有时候，构建一个自定义内核是有用或必要的，可以添加或删除设备驱动程序或选项以满足特定需求。</p>
</div>
<div class="paragraph">
<p>例如，某人正在开发一台内存严重有限的小型嵌入式计算机，可以删除不需要的设备驱动程序或选项，以使内核稍微变小。</p>
</div>
<div class="paragraph">
<p>内核配置文件位于 <span class="filename">/usr/src/sys/arch/conf/</span> ，其中 <em>arch</em> 是从 <code>uname -m</code> 命令的输出中获取的。在大多数计算机上，这个值是 <code>amd64</code> ，因此配置文件目录为 <span class="filename">/usr/src/sys/amd64/conf/</span> 。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><span class="filename">/usr/src</span> 可以被删除或重新创建，因此最好将自定义内核配置文件保存在一个单独的目录中，比如 <span class="filename">/root</span> 。将内核配置文件链接到 <span class="filename">conf</span> 目录中。如果该目录被删除或覆盖，可以将内核配置重新链接到新的目录中。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>可以通过复制 <span class="filename">GENERIC</span> 配置文件来创建自定义配置文件。在这个例子中，新的自定义内核是用于存储服务器的，所以被命名为 <span class="filename">STORAGESERVER</span> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cp /usr/src/sys/amd64/conf/GENERIC /root/STORAGESERVER</span>
<span class="c"># cd /usr/src/sys/amd64/conf</span>
<span class="c"># ln -s /root/STORAGESERVER .</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>然后编辑 <span class="filename">/root/STORAGESERVER</span> ，根据 <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=5&amp;format=html">config(5)</a> 中所示的方式添加或删除设备或选项。</p>
</div>
<div class="paragraph">
<p>通过在命令行中设置 <code>KERNCONF</code> 为内核配置文件来构建自定义内核：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make buildkernel KERNCONF=STORAGESERVER</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-src-installing">26.6.5. 安装编译后的代码<a class="anchor" href="#updating-src-installing"></a></h3>
<div class="paragraph">
<p>在完成 <code>buildworld</code> 和 <code>buildkernel</code> 步骤后，新的内核和系统已被安装：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># make installkernel</span>
<span class="c"># shutdown -r now</span>
<span class="c"># cd /usr/src</span>
<span class="c"># make installworld</span>
<span class="c"># shutdown -r now</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果构建了自定义内核，则还必须设置 <code>KERNCONF</code> 以使用新的自定义内核：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/src</span>
<span class="c"># make installkernel KERNCONF=STORAGESERVER</span>
<span class="c"># shutdown -r now</span>
<span class="c"># cd /usr/src</span>
<span class="c"># make installworld</span>
<span class="c"># shutdown -r now</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-src-completing">26.6.6. 完成更新<a class="anchor" href="#updating-src-completing"></a></h3>
<div class="paragraph">
<p>完成更新还需要进行一些最后的任务。任何已修改的配置文件都将与新版本合并，过时的库将被定位并删除，然后系统将重新启动。</p>
</div>
<div class="sect3">
<h4 id="updating-src-completing-merge-etcupdate">26.6.6.1. 使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 合并配置文件<a class="anchor" href="#updating-src-completing-merge-etcupdate"></a></h4>
<div class="paragraph">
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 是一个用于管理不作为 installworld 的一部分而更新的文件的工具，例如位于 <span class="filename">/etc/</span> 中的文件。它通过对这些文件所做的更改与本地版本进行三方合并来管理更新。与 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 的交互提示相比，它还旨在最小化用户干预的程度。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>通常情况下， <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 在执行任务时不需要任何特定的参数。然而，第一次使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 时，有一个方便的中间命令用于检查将要执行的操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># etcupdate diff</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>该命令允许用户审计配置更改。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>如果 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 无法自动合并文件，则可以通过手动交互来解决合并冲突，方法是执行以下命令：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># etcupdate resolve</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>当从 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 切换到 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 时，第一次运行可能会错误地合并更改，从而生成虚假的冲突。为了防止这种情况发生，在更新源代码和构建新的系统之前，请执行以下步骤：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># etcupdate extract </span><i class="conum" data-value="1"></i><b>(1)</b>
<span class="c"># etcupdate diff </span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>引导数据库的股票 <span class="filename">/etc</span> 文件；有关更多信息，请参阅 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>在引导完成后检查差异。修剪不再需要的本地更改，以减少将来更新中冲突的可能性。</td>
</tr>
</tbody></table>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-completing-merge-mergemaster">26.6.6.2. 使用 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 合并配置文件<a class="anchor" href="#updating-src-completing-merge-mergemaster"></a></h4>
<div class="paragraph">
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 提供了一种将对系统配置文件所做的更改与这些文件的新版本合并的方法。 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 是 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> 的替代方法。使用 <code>-Ui</code> 选项， <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 会自动更新未被用户修改的文件，并安装尚未存在的新文件。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mergemaster -Ui</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果一个文件需要手动合并，交互式显示将允许用户选择保留文件的哪些部分。有关更多信息，请参阅 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 。</p>
</div>
<div class="paragraph">
<p>如果没有使用标准的 <code>/usr/src</code> 路径，必须向 <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> 传递另一个参数：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mergemaster -Ui PATH_TO_SRC</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-completing-check-old">26.6.6.3. 检查过时的文件和库<a class="anchor" href="#updating-src-completing-check-old"></a></h4>
<div class="paragraph">
<p>更新后可能会保留一些过时的文件或目录。这些文件可以位于以下位置：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make check-old</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>已删除：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make delete-old</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>还可能存在一些过时的库。可以使用以下方法检测到这些库：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make check-old-libs</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>并且被删除了。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make delete-old-libs</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>当删除了这些旧库后，仍在使用这些旧库的程序将停止工作。这些程序必须在删除旧库后重新构建或替换。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>当所有旧文件或目录都被确认为安全可删除时，可以通过在命令中设置 <code>BATCH_DELETE_OLD_FILES</code> 来避免按下 <kbd>y</kbd> 和 <kbd>Enter</kbd> 来删除每个文件。例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># make BATCH_DELETE_OLD_FILES=yes delete-old-libs</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="updating-src-completing-restart">26.6.6.4. 更新后重新启动<a class="anchor" href="#updating-src-completing-restart"></a></h4>
<div class="paragraph">
<p>更新完成后的最后一步是重新启动计算机，以使所有更改生效：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># shutdown -r now</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="small-lan">26.7. 多台机器的追踪<a class="anchor" href="#small-lan"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>当多台机器需要跟踪同一个源代码树时，让每台系统都下载源代码并重新构建会浪费磁盘空间、网络带宽和 CPU 周期。解决方案是让一台机器完成大部分工作，而其他机器通过 NFS 挂载这个工作。本节介绍了一种实现方法。有关使用 NFS 的更多信息，请参考 <a href="../network-servers/#network-nfs">网络文件系统（ NFS ）</a> 。</p>
</div>
<div class="paragraph">
<p>首先，确定一组将运行相同二进制文件的机器，称为“构建集”。每台机器可以有自定义的内核，但将运行相同的用户空间二进制文件。从该集合中选择一台机器作为“构建机器”，用于构建世界和内核。理想情况下，这是一台速度快且具有足够空闲 CPU 来运行 <code>make buildworld</code> 和 <code>make buildkernel</code> 的机器。</p>
</div>
<div class="paragraph">
<p>选择一台机器作为“测试机器”，在将软件更新投入生产之前对其进行测试。这台机器必须能够承受较长时间的停机。它可以是构建机器，但不一定是。</p>
</div>
<div class="paragraph">
<p>此构建集中的所有机器都需要通过 NFS 从构建机器挂载 <span class="filename">/usr/obj</span> 和 <span class="filename">/usr/src</span> 。对于多个构建集， <span class="filename">/usr/src</span> 应该在一个构建机器上，并在其他机器上通过 NFS 挂载。</p>
</div>
<div class="paragraph">
<p>确保构建集中所有机器上的 <code>/etc/make.conf</code> 和 <code>/etc/src.conf</code> 与构建机器保持一致。这意味着构建机器必须构建基本系统的所有部分，以便构建集中的任何机器都可以安装。此外，每个构建机器应该使用 <code>/etc/make.conf</code> 中的 <code>KERNCONF</code> 设置其内核名称，并且构建机器应该在其 <code>KERNCONF</code> 中列出所有这些内核，将自己的内核列在第一位。构建机器必须在 <code>/usr/src/sys/arch/conf</code> 中拥有每个机器的内核配置文件。</p>
</div>
<div class="paragraph">
<p>在构建机上，按照 <a href="#makeworld">从源代码更新 FreeBSD</a> 中描述的方式构建内核和世界，但不要在构建机上安装任何东西。相反，将构建好的内核安装在测试机上。在测试机上，通过 NFS 挂载 <span class="filename">/usr/src</span> 和 <span class="filename">/usr/obj</span> 。然后，运行 <code>shutdown now</code> 进入单用户模式，以便安装新的内核和世界，并像往常一样运行 <code>mergemaster</code> 。完成后，重新启动以返回到正常的多用户操作。</p>
</div>
<div class="paragraph">
<p>在验证测试机上的一切正常工作后，使用相同的步骤在构建集中的每台其他机器上安装新软件。</p>
</div>
<div class="paragraph">
<p>相同的方法可以用于端口树。第一步是通过 NFS 将 <code>/usr/ports</code> 共享给构建集中的所有机器。要配置 <code>/etc/make.conf</code> 以共享 distfiles ，将 <code>DISTDIR</code> 设置为一个由 NFS 挂载映射到 <code>root</code> 用户的可写共享目录。如果要在本地构建端口，则每台机器应将 <code>WRKDIRPREFIX</code> 设置为本地构建目录。或者，如果构建系统要构建并分发软件包给构建集中的机器，则在构建系统上将 <code>PACKAGES</code> 设置为类似于 <code>DISTDIR</code> 的目录。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-on-non-freebsd-hosts">26.8. 在非 FreeBSD 主机上构建<a class="anchor" href="#building-on-non-freebsd-hosts"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>从历史上看，构建 FreeBSD 需要一个 FreeBSD 主机。如今， FreeBSD 可以在 Linux 发行版和 macOS 上构建。</p>
</div>
<div class="paragraph">
<p>在非 FreeBSD 主机上构建 FreeBSD 的推荐方法是使用 <code>tools/build/make.py</code> 脚本。该脚本作为 <code>bmake</code> 的包装器， <code>bmake</code> 是 FreeBSD 使用的 make 实现。它确保了必要的工具，包括实际的 FreeBSD 的 <code><a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a></code> ，被引导并且构建环境被正确配置。特别是，它设置了外部工具链变量，如 <code>XCC</code> 、 <code>XLD</code> 等。此外，该脚本可以将任何额外的命令参数，如 <code>-j 4</code> 用于并行构建或特定的 make 目标，传递给 <code>bmake</code> 。</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>最近版本的 <code>bmake</code> 也可以替代 <code>tools/build/make.py</code> 脚本。但在这种情况下，需要手动设置所需的环境变量（最简单的方法是运行 <code>tools/build/make.py --debug</code> 来获取它们的列表）。</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>否则，构建 FreeBSD 所需的先决条件列表相当简短。实际上，它只需要安装几个依赖项。</p>
</div>
<div class="paragraph">
<p>在 macOS 上，唯一的依赖是 LLVM 。必要的依赖项可以通过包管理器（例如， <a href="https://brew.sh/">Homebrew</a> ）进行安装。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">brew install llvm</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 Linux 发行版上，安装 Clang 10.0 或更新版本，以及 libarchive 和 libbz2 的头文件（通常打包为 libarchive-dev 和 libbz2-dev ）。</p>
</div>
<div class="paragraph">
<p>一旦安装了依赖项，主机就应该能够构建 FreeBSD 。</p>
</div>
<div class="paragraph">
<p>例如，下面的 <code>tools/build/make.py</code> 命令构建整个项目：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="nv">MAKEOBJDIRPREFIX</span><span class="o">=</span>/tmp/obj tools/build/make.py -j 8 <span class="nv">TARGET</span><span class="o">=</span>arm64 <span class="nv">TARGET_ARCH</span><span class="o">=</span>aarch64 buildworld</code></pre>
</div>
</div>
<div class="paragraph">
<p>它在 8 个 CPU 上为目标 <code>aarch64:arm64</code> 构建世界，并使用 <code>/tmp/obj</code> 作为对象文件。请注意，在非 FreeBSD 主机上构建时，变量 <code>MAKEOBJDIRPREFIX</code> 、 <code>TARGET</code> 和 <code>TARGET_ARCH</code> 是必需的。此外，请确保创建由 <code>MAKEOBJDIRPREFIX</code> 环境变量指向的对象目录。</p>
</div>
<div class="paragraph">
<p>请参考 <a href="https://man.freebsd.org/cgi/man.cgi?query=arch&amp;sektion=7&amp;format=html">arch(7)</a> 和 <a href="https://man.freebsd.org/cgi/man.cgi?query=build&amp;sektion=7&amp;format=html">build(7)</a> 以获取更多详细信息。</p>
</div>
</div>
</div>

    </div>
    
    <hr />
    <div class="last-modified">
      <p><strong>Last modified on</strong>: January 9, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=57cd73e" target="_blank">fiercex</a></p>
    </div>
    
    <div class="buttons">
      
      <div class="prev">
        <i class="fa fa-angle-left" aria-hidden="true" title="Prev"></i>
        <div class="container">
          
            <a href=https://free.bsd-doc.org/zh-cn-auto/books/handbook/l10n class="direction">Prev</a>
          
        </div>
      </div>
      
      <div class="home">
        <i class="fa fa-home" aria-hidden="true" title="Home"></i>
        <div class="container">
          
            <a href="../" class="direction">Home</a>
          
        </div>
      </div>
      
      <div class="next">
        <div class="container">
          
            <a href=https://free.bsd-doc.org/zh-cn-auto/books/handbook/dtrace  class="direction">Next</a>
          
        </div>
        <i class="fa fa-angle-right" aria-hidden="true" title="Next"></i>
      </div>
      
    </div>
    <label class="hidden book-menu-overlay" for="menu-control"></label>
  </div>
  <aside class="toc">
    <div class="toc-content">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#updating-upgrading-synopsis">26.1. 简介</a></li>
    <li><a href="#updating-upgrading-freebsdupdate">26.2. FreeBSD 更新</a></li>
    <li><a href="#updating-bootcode">26.3. 更新引导代码</a></li>
    <li><a href="#updating-upgrading-documentation">26.4. 更新文档集合</a></li>
    <li><a href="#current-stable">26.5. 跟踪开发分支</a></li>
    <li><a href="#makeworld">26.6. 从源代码更新 FreeBSD</a></li>
    <li><a href="#small-lan">26.7. 多台机器的追踪</a></li>
    <li><a href="#building-on-non-freebsd-hosts">26.8. 在非 FreeBSD 主机上构建</a></li>
  </ul>
</nav>
      <hr />
      
    </div>
  </aside>
  <a class="to-top" href="#top">
    <i class="fa fa-arrow-circle-up" aria-hidden="true"></i>
  </a>
</main>

    <footer>
  <div class="footer-container">
    <section class="logo-column">
          <img src="https://free.bsd-doc.org/images/FreeBSD-colors.svg" width="160" height="50" alt="FreeBSD logo" />
        <div class="options-container">
          
            <div class="language-container">
              <a id="languages" href="https://free.bsd-doc.org/zh-cn-auto/languages">
                
                <img src="https://free.bsd-doc.org/images/language.png" class="language-image" alt="Choose language">
                <span>简体中文-自动翻译</span>
              </a>
            </div>
          
          <div class="theme-container">
            <select id="theme-chooser">
	      <option value="theme-system">System</option>
              <option value="theme-light">Light</option>
              <option value="theme-dark">Dark</option>
              <option value="theme-high-contrast">High contrast</option>
            </select>
          </div>
        </div>
      </section>
      
      <section class="copyright-column">
        <p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p>
        <span>Made with <span class="heart">♥</span> by the FreeBSD Community</span>
      </section>
  </div>
</footer>

  </body>
</html>
