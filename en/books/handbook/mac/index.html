<!DOCTYPE html>
<html class="theme-light" lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="This chapter focuses on the MAC framework and the set of pluggable security policy modules FreeBSD provides for enabling various security mechanisms"/>
  <meta name="keywords" content="MAC, labels, security, configuration, nagios"/>
  <meta name="copyright" content="1995-2024 The FreeBSD Foundation" />
  <link rel="canonical" href="https://free.bsd-doc.org/en/books/handbook/mac/" />

  <title>Chapter 18. Mandatory Access Control |  FreeBSD Documentation Portal</title>

  <meta name="theme-color" content="#790000">
  <meta name="color-scheme" content="system light dark high-contrast">

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.0/fuse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>


    <link rel="shortcut icon" href="https://free.bsd-doc.org/favicon.ico">
    <link rel="stylesheet" href="/styles/main.min.css">
    <link rel="stylesheet" href="https://free.bsd-doc.org/css/font-awesome-min.css">
    <script defer src="/js/theme-chooser.min.js"></script>
    <script defer src="/js/copy-clipboard.min.js"></script>
    <script defer src="/js/search.min.js"></script>
    <script defer src="/js/fssearch.min.js"></script>

  
  
    
    <meta property="og:title" content="Chapter 18. Mandatory Access Control" />
    <meta property="og:description" content="This chapter focuses on the MAC framework and the set of pluggable security policy modules FreeBSD provides for enabling various security mechanisms" />
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://free.bsd-doc.orgfavicon.ico"/>
    <meta property="og:image:alt" content="FreeBSD Logo">
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="https://free.bsd-doc.org/en/books/handbook/mac/" />
    <meta property="og:site_name" content="FreeBSD Documentation Portal" />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "url": "https:\/\/free.bsd-doc.org\/en\/books\/handbook\/mac\/",
        "name": "FreeBSD Documentation Portal",
        "headline": "FreeBSD Documentation Portal",
        "description": "FreeBSD 中文文档"
      }
    </script>
    

  
</head>


  <body>
    <header>
  <div class="header-container">
    <div class="logo-menu-bars-container">
      <a href="https://free.bsd-doc.org" class="logo">
        <img src="https://free.bsd-doc.org/images/FreeBSD-monochromatic.svg" width="160" height="50" alt="FreeBSD logo" />
      </a>
      <label class="menu-bars" for="menu-bars">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </div>
    <input id="menu-bars" type="checkbox" />
    
    <div class="search-donate-container">
      
      <form class="search" method="get" id="search-header-form" action="https://free.bsd-doc.org/zh-cn/search" name="search-header-form">
        <input id="search-query" name="s" type="text" size="20" maxlength="255" value="" />
        <button>
          <i class="fa fa-search" aria-hidden="true"></i>
        </button>
      </form>
      <div class="donate">
        <a href="https://github.com/fierceX/freebsd-doc-cn" target="_blank">
          <span class="heart">♥</span>
          GitHub
        </a>
      </div>
    </div>
  </div>
</header>

    
<input type="checkbox" class="hidden toggle" id="menu-control">
<main class="main-wrapper-book">
  <a id="top"></a>
  
  <aside class="book-menu">
    <div class="book-menu-content">
      <input id="search-book" type="text" placeholder="Search" aria-label="Search" maxlength="128" />
      <nav id="MenuContents">
        
  <ul>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ada319c45e780947f82b569049480cc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-8ada319c45e780947f82b569049480cc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/preface/">
              Preface
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-audience">Intended Audience</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from4">Fourth Edition</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from3">Third Edition</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from2">Second Edition (2004)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes">First Edition (2001)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-overview">Organization of This Book</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-conv">Conventions used in this book</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-acknowledgements">Acknowledgments</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-32a83d18a326852a8d9ae2582360bbc8" class="toggle"  />
          <label  for="chapter-32a83d18a326852a8d9ae2582360bbc8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/parti/">
              Part I. Getting Started
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a4909db05d872d16d5be86a57cbc2dc7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a4909db05d872d16d5be86a57cbc2dc7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/introduction/">
              Chapter 1. Introduction
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#introduction-synopsis">1.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#nutshell">1.2. Welcome to FreeBSD!</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#history">1.3. About the FreeBSD Project</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3c2455cadf89eadd3f6e77461085d5e9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3c2455cadf89eadd3f6e77461085d5e9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/">
              Chapter 2. Installing FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-synopsis">2.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-hardware">2.2. Minimum Hardware Requirements</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-pre">2.3. Pre-Installation Tasks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-start">2.4. Starting the Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#using-bsdinstall">2.5. Using bsdinstall</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-partitioning">2.6. Allocating Disk Space</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-fetching-distribution">2.7. Fetching Distribution Files</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-post">2.8. Network Interfaces, Accounts, Time Zone, Services and Hardening</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-install-trouble">2.9. Troubleshooting</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#using-live-cd">2.10. Using the Live CD</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-709481b75d22ad36960f7ac166b3306c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-709481b75d22ad36960f7ac166b3306c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/basics/">
              Chapter 3. FreeBSD Basics
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-synopsis">3.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#consoles">3.2. Virtual Consoles and Terminals</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#users-synopsis">3.3. Users and Basic Account Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#permissions">3.4. Permissions</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#dirstructure">3.5. Directory Structure</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#disk-organization">3.6. Disk Organization</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#mount-unmount">3.7. Mounting and Unmounting File Systems</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-processes">3.8. Processes and Daemons</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#shells">3.9. Shells</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#editors">3.10. Text Editors</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-devices">3.11. Devices and Device Nodes</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-more-information">3.12. Manual Pages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-58c050d31a1fbecd859248dacefeb567" class="toggle"  />
          <label  class="icon cursor"  for="chapter-58c050d31a1fbecd859248dacefeb567"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/ports/">
              Chapter 4. Installing Applications: Packages and Ports
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-synopsis">4.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-overview">4.2. Overview of Software Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-finding-applications">4.3. Finding Software</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#pkgng-intro">4.4. Using pkg for Binary Package Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-using">4.5. Using the Ports Collection</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-poudriere">4.6. Building Packages with poudriere</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-nextsteps">4.7. Post-Installation Considerations</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-broken">4.8. Dealing with Broken Ports</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e5a000ce7f50680a180e2c1b83c121bc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e5a000ce7f50680a180e2c1b83c121bc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/x11/">
              Chapter 5. The X Window System
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x11-synopsis">5.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-install">5.2. Installing Xorg</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-graphic-card-drivers">5.3. Graphic card drivers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-config">5.4. Xorg Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-fonts">5.5. Using Fonts in Xorg</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-235af08fb87fd7a58003348706d2111d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-235af08fb87fd7a58003348706d2111d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/wayland/">
              Chapter 6. Wayland
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-synopsis">6.1. Wayland Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-wayfire">6.2. The Wayfire Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-hikari">6.3. The Hikari Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-sway">6.4. The Sway Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-xwayland">6.5. Using Xwayland</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-remotedesktop">6.6. Remote Desktop Using VNC</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-ly">6.7. Wayland Login Manager</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-utilities">6.8. Useful Utilities</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4de18483dde20bf9ed0024176afd09da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4de18483dde20bf9ed0024176afd09da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/network/">
              Chapter 7. Network
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#network-synopsis">7.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#config-network-setup">7.2. Setting up the Network</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#config-network-connection">7.3. Wired Networks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#network-wireless">7.4. Wireless Networks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#hostname">7.5. Hostname</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#dns">7.6. DNS</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#troubleshooting">7.7. Troubleshooting</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-5eb30759c3a2873e716dc31d7760054c" class="toggle"  />
          <label  for="chapter-5eb30759c3a2873e716dc31d7760054c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partii/">
              Part II. Common Tasks
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-c96504f017c56f4bc7f71548cccf5382" class="toggle"  />
          <label  class="icon cursor"  for="chapter-c96504f017c56f4bc7f71548cccf5382"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/desktop/">
              Chapter 8. Desktop Environments
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-synopsis">8.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-environments">8.2. Desktop Environments</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-browsers">8.3. Browsers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-development">8.4. Development tools</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-productivity">8.5. Desktop office productivity</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-viewers">8.6. Document Viewers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-finance">8.7. Finance</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e1898af36aaacc168e13b673d25b908f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e1898af36aaacc168e13b673d25b908f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/multimedia/">
              Chapter 9. Multimedia
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#multimedia-synopsis">9.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#sound-setup">9.2. Setting Up the Sound Card</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#audio-ports">9.3. Audio players</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#video-ports">9.4. Video players</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#conferencing-meetings">9.5. Conferencing and Meetings</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#scanners">9.6. Image Scanners</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6926664836e63c5cae4b2fa60855f91d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-6926664836e63c5cae4b2fa60855f91d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/">
              Chapter 10. Configuring the FreeBSD Kernel
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-synopsis">10.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-custom-kernel">10.2. Why Build a Custom Kernel?</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-devices">10.3. Finding the System Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-config">10.4. The Configuration File</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-building">10.5. Building and Installing a Custom Kernel</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-trouble">10.6. If Something Goes Wrong</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-19d36bd70a320268f0ea1f66e4f3e224" class="toggle"  />
          <label  class="icon cursor"  for="chapter-19d36bd70a320268f0ea1f66e4f3e224"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/printing/">
              Chapter 11. Printing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-quick-start">11.1. Quick Start</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-connections">11.2. Printer Connections</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-pdls">11.3. Common Page Description Languages</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-direct">11.4. Direct Printing</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-lpd">11.5. LPD (Line Printer Daemon)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-other">11.6. Other Printing Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/">
              Chapter 12. Linux Binary Compatibility
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-synopsis">12.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-lbc-install">12.2. Configuring Linux Binary Compatibility</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linux-userlands">12.3. Linux userlands</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-advanced">12.4. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-af234c193ce95c480af0ff5ec3f32f5c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-af234c193ce95c480af0ff5ec3f32f5c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/wine/">
              Chapter 13. WINE
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-synopsis">13.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-overview-concepts">13.2. WINE Overview & Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#installing-wine-on-freebsd">13.3. Installing WINE on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#running-first-wine-program">13.4. Running a First WINE Program on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#configuring-wine-installation">13.5. Configuring WINE Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-management-guis">13.6. WINE Management GUIs</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-in-multi-user-os-installations">13.7. WINE in Multi-User FreeBSD Installations</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-on-os-faq">13.8. WINE on FreeBSD FAQ</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-51416fdea9d5a1dfa1c2718cd825213a" class="toggle"  />
          <label  for="chapter-51416fdea9d5a1dfa1c2718cd825213a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partiii/">
              Part III. System Administration
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-532d0380ba66d66e033765a0b6930ee7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-532d0380ba66d66e033765a0b6930ee7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/config/">
              Chapter 14. Configuration, Services, Logging and Power Management
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#config-synopsis">14.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-configfiles">14.2. Configuration Files</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-rcd">14.3. Managing Services in FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#cron-periodic">14.4. Cron and Periodic</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-syslog">14.5. Configuring System Logging</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#acpi-overview">14.6. Power and Resource Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#adding-swap-space">14.7. Adding Swap Space</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-d05f41680fb7e3d68b354ae03de368b1" class="toggle"  />
          <label  class="icon cursor"  for="chapter-d05f41680fb7e3d68b354ae03de368b1"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/boot/">
              Chapter 15. The FreeBSD Booting Process
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-synopsis">15.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-introduction">15.2. FreeBSD Boot Process</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#device-hints">15.3. Device Hints</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-shutdown">15.4. Shutdown Sequence</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-513e8e407c57354df334059688e9b60a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-513e8e407c57354df334059688e9b60a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/security/">
              Chapter 16. Security
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-synopsis">16.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-intro">16.2. Introduction</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#sec-accounts">16.3. Securing Accounts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-ids">16.4. Intrusion Detection System (IDS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-secure-levels">16.5. Secure levels</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-file-flags">16.6. File flags</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#openssh">16.7. OpenSSH</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#openssl">16.8. OpenSSL</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#kerberos5">16.9. Kerberos</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#tcpwrappers">16.10. TCP Wrappers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#fs-acl">16.11. Access Control Lists</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#capsicum">16.12. Capsicum</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-accounting">16.13. Process Accounting</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-resourcelimits">16.14. Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-pkg">16.15. Monitoring Third Party Security Issues</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-advisories">16.16. FreeBSD Security Advisories</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0f7d2858504c83a029928c048d394e2a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0f7d2858504c83a029928c048d394e2a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/jails/">
              Chapter 17. Jails and Containers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jails-synopsis">17.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-types">17.2. Jail Types</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#host-configuration">17.3. Host Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#classic-jail">17.4. Classic Jail (Thick Jail)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#thin-jail">17.5. Thin Jails</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-management">17.6. Jail Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-upgrading">17.7. Jail Upgrading</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-resource-limits">17.8. Jail Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-managers-and-containers">17.9. Jail Managers and Containers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-15be125ce5997f51c5499e3a0dee6c2c" class="toggle"  checked  />
          <label  class="icon cursor"  for="chapter-15be125ce5997f51c5499e3a0dee6c2c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mac/">
              Chapter 18. Mandatory Access Control
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-synopsis">18.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-inline-glossary">18.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-understandlabel">18.3. Understanding MAC Labels</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-planning">18.4. Planning the Security Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-policies">18.5. Available MAC Policies</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-userlocked">18.6. User Lock Down</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-implementing">18.7. Nagios in a MAC Jail</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-troubleshoot">18.8. Troubleshooting the MAC Framework</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3f7e8d763b17c7d0c44c60505cf0feea" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3f7e8d763b17c7d0c44c60505cf0feea"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/audit/">
              Chapter 19. Security Event Auditing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-synopsis">19.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-inline-glossary">19.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-config">19.3. Audit Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-administration">19.4. Working with Audit Trails</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7bb1cb2287cd08a3672cc878e604f0d0" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7bb1cb2287cd08a3672cc878e604f0d0"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/disks/">
              Chapter 20. Storage
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-synopsis">20.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-adding">20.2. Adding Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-growing">20.3. Resizing and Growing Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#usb-disks">20.4. USB Storage Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#creating-cds">20.5. Creating and Using CD Media</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#creating-dvds">20.6. Creating and Using DVD Media</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#floppies">20.7. Creating and Using Floppy Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#using-ntfs">20.8. Using NTFS Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#backup-basics">20.9. Backup Basics</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-virtual">20.10. Memory Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#snapshots">20.11. File System Snapshots</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#quotas">20.12. Disk Quotas</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-encrypting">20.13. Encrypting Disk Partitions</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#swap-encrypting">20.14. Encrypting Swap</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-hast">20.15. Highly Available Storage (HAST)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-dec5fc4f0100e5030db0fb188d8d4b2f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-dec5fc4f0100e5030db0fb188d8d4b2f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/geom/">
              Chapter 21. GEOM: Modular Disk Transformation Framework
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-synopsis">21.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-striping">21.2. RAID0 - Striping</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-mirror">21.3. RAID1 - Mirroring</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-raid3">21.4. RAID3 - Byte-level Striping with Dedicated Parity</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-graid">21.5. Software RAID Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-ggate">21.6. GEOM Gate Network</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-glabel">21.7. Labeling Disk Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-gjournal">21.8. UFS Journaling Through GEOM</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f1657a05627dd16bad31d4c7f675604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f1657a05627dd16bad31d4c7f675604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/zfs/">
              Chapter 22. The Z File System (ZFS)
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-differences">22.1. What Makes ZFS Different</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-quickstart">22.2. Quick Start Guide</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zpool">22.3. <code>zpool</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zfs">22.4. <code>zfs</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zfs-allow">22.5. Delegated Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-advanced">22.6. Advanced Topics</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-links">22.7. Further Resources</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-term">22.8. ZFS Features and Terminology</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4c6bf6828e601b79edb2813329ac6604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4c6bf6828e601b79edb2813329ac6604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/filesystems/">
              Chapter 23. Other File Systems
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/filesystems/#filesystems-synopsis">23.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/filesystems/#filesystems-linux">23.2. Linux® File Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-ae23289d4b6415f3f878893f9d3ef9b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-ae23289d4b6415f3f878893f9d3ef9b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/virtualization/">
              Chapter 24. Virtualization
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-synopsis">24.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-parallelsdesktop">24.2. FreeBSD as a Guest on Parallels Desktop for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-vmware">24.3. FreeBSD as a Guest on VMware Fusion for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-virtualbox">24.4. FreeBSD as a Guest on VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-virtualbox">24.5. FreeBSD as a Host with VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-bhyve">24.6. FreeBSD as a Host with bhyve</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-xen">24.7. FreeBSD as a Xen™-Host</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-b279d2b738963a45a059268d2fae00d5" class="toggle"  />
          <label  class="icon cursor"  for="chapter-b279d2b738963a45a059268d2fae00d5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/l10n/">
              Chapter 25. Localization - i18n/L10n Usage and Setup
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#l10n-synopsis">25.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#using-localization">25.2. Using Localization</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#l10n-compiling">25.3. Finding i18n Applications</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#lang-setup">25.4. Locale Configuration for Specific Languages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9e3f99bd76c861ab2e9a5f31ac421842" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9e3f99bd76c861ab2e9a5f31ac421842"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/">
              Chapter 26. Updating and Upgrading FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-synopsis">26.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate">26.2. FreeBSD Update</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-bootcode">26.3. Updating Bootcode</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-documentation">26.4. Updating the Documentation Set</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#current-stable">26.5. Tracking a Development Branch</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#makeworld">26.6. Updating FreeBSD from Source</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#small-lan">26.7. Tracking for Multiple Machines</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#building-on-non-freebsd-hosts">26.8. Building on non-FreeBSD Hosts</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3ba999091575eb04ae88235cd0fb1afa" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3ba999091575eb04ae88235cd0fb1afa"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/dtrace/">
              Chapter 27. DTrace
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-synopsis">27.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-implementation">27.2. Implementation Differences</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-enable">27.3. Enabling DTrace Support</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-using">27.4. Using DTrace</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bdb217202a0a3eef4571dd1fcd50863c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bdb217202a0a3eef4571dd1fcd50863c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/">
              Chapter 28. USB Device Mode / USB OTG
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-synopsis">28.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-terminals">28.2. USB Virtual Serial Ports</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-network">28.3. USB Device Mode Network Interfaces</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-storage">28.4. USB Virtual Storage Device</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6d4439926bb106ac084ecc88cfd3cfa4" class="toggle"  />
          <label  for="chapter-6d4439926bb106ac084ecc88cfd3cfa4"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partiv/">
              Part IV. Network Communication
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-05a353fcb61d8e035f7c43e14725766e" class="toggle"  />
          <label  class="icon cursor"  for="chapter-05a353fcb61d8e035f7c43e14725766e"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/">
              Chapter 29. Serial Communications
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serial-synopsis">29.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serial">29.2. Serial Terminology and Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#term">29.3. Terminals</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#dialup">29.4. Dial-in Service</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#dialout">29.5. Dial-out Service</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serialconsole-setup">29.6. Setting Up the Serial Console</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/">
              Chapter 30. PPP
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis">30.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#userppp">30.2. Configuring PPP</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#ppp-troubleshoot">30.3. Troubleshooting PPP Connections</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#pppoe">30.4. Using PPP over Ethernet (PPPoE)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#pppoa">30.5. Using PPP over ATM (PPPoA)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9d023b545804f197d195dd9412749943" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9d023b545804f197d195dd9412749943"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mail/">
              Chapter 31. Electronic Mail
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-synopsis">31.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-using">31.2. Mail Components</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#dragonFly-mail-agent">31.3. DragonFly Mail Agent (DMA)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#sendmail">31.4. Sendmail</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-changingmta">31.5. Changing the Mail Transfer Agent</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-agents">31.6. Mail User Agents</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-advanced">31.7. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-42b19e05d30c4135c74b9878818747a9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-42b19e05d30c4135c74b9878818747a9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/network-servers/">
              Chapter 32. Network Servers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-servers-synopsis">32.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-inetd">32.2. The inetd Super-Server</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-nfs">32.3. Network File System (NFS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-nis">32.4. Network Information System (NIS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-dns">32.7. Domain Name System (DNS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-apache">32.8. Apache HTTP Server</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ftp">32.9. File Transfer Protocol (FTP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ntp">32.11. Clock Synchronization with NTP</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-iscsi">32.12. iSCSI Initiator and Target Configuration</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9554a5177d00d0e87ada408809a1fc67" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9554a5177d00d0e87ada408809a1fc67"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/firewalls/">
              Chapter 33. Firewalls
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-intro">33.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-concepts">33.2. Firewall Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-pf">33.3. PF</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-ipfw">33.4. IPFW</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-ipf">33.5. IPFILTER (IPF)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-blacklistd">33.6. Blacklistd</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9903a1d844ed803a436595e93ec33572" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9903a1d844ed803a436595e93ec33572"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/">
              Chapter 34. Advanced Networking
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#advanced-networking-synopsis">34.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-routing">34.2. Gateways and Routes</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#configtuning-virtual-hosts">34.3. Virtual Hosts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-advanced-wireless">34.4. Wireless Advanced Authentication</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#wireless-ad-hoc-mode">34.5. Wireless Ad-hoc Mode</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-usb-tethering">34.6. USB Tethering</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-bluetooth">34.7. Bluetooth</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-bridging">34.8. Bridging</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-aggregation">34.9. Link Aggregation and Failover</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-diskless">34.10. Diskless Operation with PXE</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#carp">34.11. Common Address Redundancy Protocol (CARP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-vlan">34.12. VLANs</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ca29f99c249993ee9234cb4632af7a5" class="toggle"  />
          <label  for="chapter-8ca29f99c249993ee9234cb4632af7a5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partv/">
              Part V. Appendices
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0229d553ebf23ffeb945be6f32836221" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0229d553ebf23ffeb945be6f32836221"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mirrors/">
              Appendix A. Obtaining FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#mirrors">A.1. Mirrors</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#git">A.2. Using Git</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#svn">A.3. Using Subversion</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#mirrors-cdrom">A.4. CD and DVD Sets</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-743c99fa278b8138914ff018e40c9231" class="toggle"  />
          <label  class="icon cursor"  for="chapter-743c99fa278b8138914ff018e40c9231"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/bibliography/">
              Appendix B. Bibliography
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-freebsd">B.1. FreeBSD Bibliography</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-security">B.2. Security Reference</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-history">B.3. UNIX® History</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-journals">B.4. Periodicals, Journals, and Magazines</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-de7eade4b8b64f298c0cbac44c2278da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-de7eade4b8b64f298c0cbac44c2278da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/eresources/">
              Appendix C. Resources on the Internet
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-www">C.1. Websites</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-mail">C.2. Mailing Lists</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-news">C.3. Usenet Newsgroups</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/pgpkeys/">
              Appendix D. OpenPGP Keys
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/pgpkeys/#pgpkeys-officers">D.1. Officers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-2a8deedf14429128049622ec007c9d3f" class="toggle"  />
          <label  for="chapter-2a8deedf14429128049622ec007c9d3f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/glossary/">
              FreeBSD Glossary
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-110dbb242491bf200e51e76db171f670" class="toggle"  />
          <label  for="chapter-110dbb242491bf200e51e76db171f670"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/colophon/">
              Colophon
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-caffbcba74982e4b26b9263ac0232bc3" class="toggle"  />
          <label  for="chapter-caffbcba74982e4b26b9263ac0232bc3"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/introduction/">
              
            </a>
            
            
          

        
      </li>
    
      <li>
        
      </li>
    
  </ul>


      </nav>
    </div>
  </aside>
  
  <div class="book">
    
    <div class="book-menu-mobile">
      <label for="menu-control">
        <span class="menu-control-button">
          <i class="fa fa-list" aria-hidden="true" title="Book menu"></i>
          Book menu
        </span>
      </label>
    </div>
    
    <h1 class="title">Chapter 18. Mandatory Access Control</h1>
    
    
    
    
    <div class="toc-mobile">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#mac-synopsis">18.1. Synopsis</a></li>
    <li><a href="#mac-inline-glossary">18.2. Key Terms</a></li>
    <li><a href="#mac-understandlabel">18.3. Understanding MAC Labels</a></li>
    <li><a href="#mac-planning">18.4. Planning the Security Configuration</a></li>
    <li><a href="#mac-policies">18.5. Available MAC Policies</a></li>
    <li><a href="#mac-userlocked">18.6. User Lock Down</a></li>
    <li><a href="#mac-implementing">18.7. Nagios in a MAC Jail</a></li>
    <li><a href="#mac-troubleshoot">18.8. Troubleshooting the MAC Framework</a></li>
  </ul>
</nav>
    </div>
    
      
      
    
    <div class="book-content">
      <div id="preamble">
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="mac-synopsis">18.1. Synopsis<a class="anchor" href="#mac-synopsis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>FreeBSD supports security extensions based on the POSIX®.1e draft.
These security mechanisms include file system Access Control Lists (<a href="../security/#fs-acl">“Access Control Lists”</a>) and Mandatory Access Control (MAC).
MAC allows access control modules to be loaded in order to implement security policies.
Some modules provide protections for a narrow subset of the system, hardening a particular service.
Others provide comprehensive labeled security across all subjects and objects.
The mandatory part of the definition indicates that enforcement of controls is performed by administrators and the operating system.
This is in contrast to the default security mechanism of Discretionary Access Control (DAC) where enforcement is left to the discretion of users.</p>
</div>
<div class="paragraph">
<p>This chapter focuses on the MAC framework and the set of pluggable security policy modules FreeBSD provides for enabling various security mechanisms.</p>
</div>
<div class="paragraph">
<p>After reading this chapter, you will know:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The terminology associated with the MAC framework.</p>
</li>
<li>
<p>The capabilities of MAC security policy modules as well as the difference between a labeled and non-labeled policy.</p>
</li>
<li>
<p>The considerations to take into account before configuring a system to use the MAC framework.</p>
</li>
<li>
<p>Which MAC security policy modules are included in FreeBSD and how to configure them.</p>
</li>
<li>
<p>How to implement a more secure environment using the MAC framework.</p>
</li>
<li>
<p>How to test the MAC configuration to ensure the framework has been properly implemented.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before reading this chapter, you should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand UNIX® and FreeBSD basics (<a href="../basics/#basics">FreeBSD Basics</a>).</p>
</li>
<li>
<p>Have some familiarity with security and how it pertains to FreeBSD (<a href="../security/#security">Security</a>).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Improper MAC configuration may cause loss of system access, aggravation of users, or inability to access the features provided by Xorg.
More importantly, MAC should not be relied upon to completely secure a system.
The MAC framework only augments an existing security policy.
Without sound security practices and regular security checks, the system will never be completely secure.</p>
</div>
<div class="paragraph">
<p>The examples contained within this chapter are for demonstration purposes and the example settings should <em>not</em> be implemented on a production system.
Implementing any security policy takes a good deal of understanding, proper design, and thorough testing.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>While this chapter covers a broad range of security issues relating to the MAC framework, the development of new MAC security policy modules will not be covered.
A number of security policy modules included with the MAC framework have specific characteristics which are provided for both testing and new module development.
Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_test&amp;sektion=4&amp;format=html">mac_test(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_stub&amp;sektion=4&amp;format=html">mac_stub(4)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_none&amp;sektion=4&amp;format=html">mac_none(4)</a> for more information on these security policy modules and the various mechanisms they provide.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-inline-glossary">18.2. Key Terms<a class="anchor" href="#mac-inline-glossary"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following key terms are used when referring to the MAC framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>compartment</em>: a set of programs and data to be partitioned or separated, where users are given explicit access to specific component of a system. A compartment represents a grouping, such as a work group, department, project, or topic. Compartments make it possible to implement a need-to-know-basis security policy.</p>
</li>
<li>
<p><em>integrity</em>: the level of trust which can be placed on data. As the integrity of the data is elevated, so does the ability to trust that data.</p>
</li>
<li>
<p><em>level</em>: the increased or decreased setting of a security attribute. As the level increases, its security is considered to elevate as well.</p>
</li>
<li>
<p><em>label</em>: a security attribute which can be applied to files, directories, or other items in the system. It could be considered a confidentiality stamp. When a label is placed on a file, it describes the security properties of that file and will only permit access by files, users, and resources with a similar security setting. The meaning and interpretation of label values depends on the policy configuration. Some policies treat a label as representing the integrity or secrecy of an object while other policies might use labels to hold rules for access.</p>
</li>
<li>
<p><em>multilabel</em>: this property is a file system option which can be set in single-user mode using <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a>, during boot using <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>, or during the creation of a new file system. This option permits an administrator to apply different MAC labels on different objects. This option only applies to security policy modules which support labeling.</p>
</li>
<li>
<p><em>single label</em>: a policy where the entire file system uses one label to enforce access control over the flow of data. Whenever <code>multilabel</code> is not set, all files will conform to the same label setting.</p>
</li>
<li>
<p><em>object</em>: an entity through which information flows under the direction of a <em>subject</em>. This includes directories, files, fields, screens, keyboards, memory, magnetic storage, printers or any other data storage or moving device. An object is a data container or a system resource. Access to an object effectively means access to its data.</p>
</li>
<li>
<p><em>subject</em>: any active entity that causes information to flow between <em>objects</em> such as a user, user process, or system process. On FreeBSD, this is almost always a thread acting in a process on behalf of a user.</p>
</li>
<li>
<p><em>policy</em>: a collection of rules which defines how objectives are to be achieved. A policy usually documents how certain items are to be handled. This chapter considers a policy to be a collection of rules which controls the flow of data and information and defines who has access to that data and information.</p>
</li>
<li>
<p><em>high-watermark</em>: this type of policy permits the raising of security levels for the purpose of accessing higher level information. In most cases, the original level is restored after the process is complete. Currently, the FreeBSD MAC framework does not include this type of policy.</p>
</li>
<li>
<p><em>low-watermark</em>: this type of policy permits lowering security levels for the purpose of accessing information which is less secure. In most cases, the original security level of the user is restored after the process is complete. The only security policy module in FreeBSD to use this is <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a>.</p>
</li>
<li>
<p><em>sensitivity</em>: usually used when discussing Multilevel Security (MLS). A sensitivity level describes how important or secret the data should be. As the sensitivity level increases, so does the importance of the secrecy, or confidentiality, of the data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-understandlabel">18.3. Understanding MAC Labels<a class="anchor" href="#mac-understandlabel"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A MAC label is a security attribute which may be applied to subjects and objects throughout the system.
When setting a label, the administrator must understand its implications in order to prevent unexpected or undesired behavior of the system.
The attributes available on an object depend on the loaded policy module, as policy modules interpret their attributes in different ways.</p>
</div>
<div class="paragraph">
<p>The security label on an object is used as a part of a security access control decision by a policy.
With some policies, the label contains all of the information necessary to make a decision.
In other policies, the labels may be processed as part of a larger rule set.</p>
</div>
<div class="paragraph">
<p>There are two types of label policies: single label and multi label.
By default, the system will use single label.
The administrator should be aware of the pros and cons of each in order to implement policies which meet the requirements of the system’s security model.</p>
</div>
<div class="paragraph">
<p>A single label security policy only permits one label to be used for every subject or object.
Since a single label policy enforces one set of access permissions across the entire system, it provides lower administration overhead, but decreases the flexibility of policies which support labeling.
However, in many environments, a single label policy may be all that is required.</p>
</div>
<div class="paragraph">
<p>A single label policy is somewhat similar to DAC as <code>root</code> configures the policies so that users are placed in the appropriate categories and access levels.
A notable difference is that many policy modules can also restrict <code>root</code>.
Basic control over objects will then be released to the group, but <code>root</code> may revoke or modify the settings at any time.</p>
</div>
<div class="paragraph">
<p>When appropriate, a multi label policy can be set on a UFS file system by passing <code>multilabel</code> to <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a>.
A multi label policy permits each subject or object to have its own independent MAC label.
The decision to use a multi label or single label policy is only required for policies which implement the labeling feature, such as <code>biba</code>, <code>lomac</code>, and <code>mls</code>.
Some policies, such as <code>seeotheruids</code>, <code>portacl</code> and <code>partition</code>, do not use labels at all.</p>
</div>
<div class="paragraph">
<p>Using a multi label policy on a partition and establishing a multi label security model can increase administrative overhead as everything in that file system has a label.
This includes directories, files, and even device nodes.</p>
</div>
<div class="paragraph">
<p>The following command will set <code>multilabel</code> on the specified UFS file system.
This may only be done in single-user mode and is not a requirement for the swap file system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># tunefs -l enable /</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some users have experienced problems with setting the <code>multilabel</code> flag on the root partition.
If this is the case, please review <a href="#mac-troubleshoot">Troubleshooting the MAC Framework</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Since the multi label policy is set on a per-file system basis, a multi label policy may not be needed if the file system layout is well designed.
Consider an example security MAC model for a FreeBSD web server.
This machine uses the single label, <code>biba/high</code>, for everything in the default file systems.
If the web server needs to run at <code>biba/low</code> to prevent write up capabilities, it could be installed to a separate UFS <span class="filename">/usr/local</span> file system set at <code>biba/low</code>.</p>
</div>
<div class="sect2">
<h3 id="_label_configuration">18.3.1. Label Configuration<a class="anchor" href="#_label_configuration"></a></h3>
<div class="paragraph">
<p>Virtually all aspects of label policy module configuration will be performed using the base system utilities.
These commands provide a simple interface for object or subject configuration or the manipulation and verification of the configuration.</p>
</div>
<div class="paragraph">
<p>All configuration may be done using <code>setfmac</code>, which is used to set MAC labels on system objects, and <code>setpmac</code>, which is used to set the labels on system subjects.
For example, to set the <code>biba</code> MAC label to <code>high</code> on <span class="filename">test</span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfmac biba/high test</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the configuration is successful, the prompt will be returned without error.
A common error is <code>Permission denied</code> which usually occurs when the label is being set or modified on a restricted object.
Other conditions may produce different failures.
For instance, the file may not be owned by the user attempting to relabel the object, the object may not exist, or the object may be read-only.
A mandatory policy will not allow the process to relabel the file, maybe because of a property of the file, a property of the process, or a property of the proposed new label value.
For example, if a user running at low integrity tries to change the label of a high integrity file, or a user running at low integrity tries to change the label of a low integrity file to a high integrity label, these operations will fail.</p>
</div>
<div class="paragraph">
<p>The system administrator may use <code>setpmac</code> to override the policy module’s settings by assigning a different label to the invoked process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfmac biba/high test</span>
Permission denied
<span class="c"># setpmac biba/low setfmac biba/high test</span>
<span class="c"># getfmac test</span>
<span class="nb">test</span>: biba/high</code></pre>
</div>
</div>
<div class="paragraph">
<p>For currently running processes, such as sendmail, <code>getpmac</code> is usually used instead.
This command takes a process ID (PID) in place of a command name.
If users attempt to manipulate a file not in their access, subject to the rules of the loaded policy modules, the <code>Operation not permitted</code> error will be displayed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_predefined_labels">18.3.2. Predefined Labels<a class="anchor" href="#_predefined_labels"></a></h3>
<div class="paragraph">
<p>A few FreeBSD policy modules which support the labeling feature offer three predefined labels: <code>low</code>, <code>equal</code>, and <code>high</code>, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>low</code> is considered the lowest label setting an object or subject may have. Setting this on objects or subjects blocks their access to objects or subjects marked high.</p>
</li>
<li>
<p><code>equal</code> sets the subject or object to be disabled or unaffected and should only be placed on objects considered to be exempt from the policy.</p>
</li>
<li>
<p><code>high</code> grants an object or subject the highest setting available in the Biba and MLS policy modules.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such policy modules include <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a>.
Each of the predefined labels establishes a different information flow directive.
Refer to the manual page of the module to determine the traits of the generic label configurations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_numeric_labels">18.3.3. Numeric Labels<a class="anchor" href="#_numeric_labels"></a></h3>
<div class="paragraph">
<p>The Biba and MLS policy modules support a numeric label which may be set to indicate the precise level of hierarchical control.
This numeric level is used to partition or sort information into different groups of classification, only permitting access to that group or a higher group level.
For example:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>biba/10:2+3+6(5:2+3-20:2+3+4+5+6)</pre>
</div>
</div>
<div class="paragraph">
<p>may be interpreted as &#34;Biba Policy Label/Grade 10:Compartments 2, 3 and 6: (grade 5 …​&#34;)</p>
</div>
<div class="paragraph">
<p>In this example, the first grade would be considered the effective grade with effective compartments, the second grade is the low grade, and the last one is the high grade.
In most configurations, such fine-grained settings are not needed as they are considered to be advanced configurations.</p>
</div>
<div class="paragraph">
<p>System objects only have a current grade and compartment.
System subjects reflect the range of available rights in the system, and network interfaces, where they are used for access control.</p>
</div>
<div class="paragraph">
<p>The grade and compartments in a subject and object pair are used to construct a relationship known as <em>dominance</em>, in which a subject dominates an object, the object dominates the subject, neither dominates the other, or both dominate each other.
The &#34;both dominate&#34; case occurs when the two labels are equal.
Due to the information flow nature of Biba, a user has rights to a set of compartments that might correspond to projects, but objects also have a set of compartments.
Users may have to subset their rights using <code>su</code> or <code>setpmac</code> in order to access objects in a compartment from which they are not restricted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_user_labels">18.3.4. User Labels<a class="anchor" href="#_user_labels"></a></h3>
<div class="paragraph">
<p>Users are required to have labels so that their files and processes properly interact with the security policy defined on the system.
This is configured in <span class="filename">/etc/login.conf</span> using login classes.
Every policy module that uses labels will implement the user class setting.</p>
</div>
<div class="paragraph">
<p>To set the user class default label which will be enforced by MAC, add a <code>label</code> entry.
An example <code>label</code> entry containing every policy module is displayed below.
Note that in a real configuration, the administrator would never enable every policy module.
It is recommended that the rest of this chapter be reviewed before any configuration is implemented.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>default:\
	:copyright=/etc/COPYRIGHT:\
	:welcome=/etc/motd:\
	:setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
	:path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin:\
	:manpath=/usr/share/man /usr/local/man:\
	:nologin=/usr/sbin/nologin:\
	:cputime=1h30m:\
	:datasize=8M:\
	:vmemoryuse=100M:\
	:stacksize=2M:\
	:memorylocked=4M:\
	:memoryuse=8M:\
	:filesize=8M:\
	:coredumpsize=8M:\
	:openfiles=24:\
	:maxproc=32:\
	:priority=0:\
	:requirehome:\
	:passwordtime=91d:\
	:umask=022:\
	:ignoretime@:\
	:label=partition/13,mls/5,biba/10(5-15),lomac/10[2]:</pre>
</div>
</div>
<div class="paragraph">
<p>While users can not modify the default value, they may change their label after they login, subject to the constraints of the policy.
The example above tells the Biba policy that a process’s minimum integrity is <code>5</code>, its maximum is <code>15</code>, and the default effective label is <code>10</code>.
The process will run at <code>10</code> until it chooses to change label, perhaps due to the user using <code>setpmac</code>, which will be constrained by Biba to the configured range.</p>
</div>
<div class="paragraph">
<p>After any change to <span class="filename">login.conf</span>, the login class capability database must be rebuilt using <code>cap_mkdb</code>.</p>
</div>
<div class="paragraph">
<p>Many sites have a large number of users requiring several different user classes.
In depth planning is required as this can become difficult to manage.</p>
</div>
</div>
<div class="sect2">
<h3 id="_network_interface_labels">18.3.5. Network Interface Labels<a class="anchor" href="#_network_interface_labels"></a></h3>
<div class="paragraph">
<p>Labels may be set on network interfaces to help control the flow of data across the network.
Policies using network interface labels function in the same way that policies function with respect to objects.
Users at high settings in Biba, for example, will not be permitted to access network interfaces with a label of <code>low</code>.</p>
</div>
<div class="paragraph">
<p>When setting the MAC label on network interfaces, <code>maclabel</code> may be passed to <code>ifconfig</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ifconfig bge0 maclabel biba/equal</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example will set the MAC label of <code>biba/equal</code> on the <code>bge0</code> interface.
When using a setting similar to <code>biba/high(low-high)</code>, the entire label should be quoted to prevent an error from being returned.</p>
</div>
<div class="paragraph">
<p>Each policy module which supports labeling has a tunable which may be used to disable the MAC label on network interfaces.
Setting the label to <code>equal</code> will have a similar effect.
Review the output of <code>sysctl</code>, the policy manual pages, and the information in the rest of this chapter for more information on those tunables.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-planning">18.4. Planning the Security Configuration<a class="anchor" href="#mac-planning"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before implementing any MAC policies, a planning phase is recommended.
During the planning stages, an administrator should consider the implementation requirements and goals, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to classify information and resources available on the target systems.</p>
</li>
<li>
<p>Which information or resources to restrict access to along with the type of restrictions that should be applied.</p>
</li>
<li>
<p>Which MAC modules will be required to achieve this goal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A trial run of the trusted system and its configuration should occur <em>before</em> a MAC implementation is used on production systems.
Since different environments have different needs and requirements, establishing a complete security profile will decrease the need of changes once the system goes live.</p>
</div>
<div class="paragraph">
<p>Consider how the MAC framework augments the security of the system as a whole.
The various security policy modules provided by the MAC framework could be used to protect the network and file systems or to block users from accessing certain ports and sockets.
Perhaps the best use of the policy modules is to load several security policy modules at a time in order to provide a MLS environment.
This approach differs from a hardening policy, which typically hardens elements of a system which are used only for specific purposes.
The downside to MLS is increased administrative overhead.</p>
</div>
<div class="paragraph">
<p>The overhead is minimal when compared to the lasting effect of a framework which provides the ability to pick and choose which policies are required for a specific configuration and which keeps performance overhead down.
The reduction of support for unneeded policies can increase the overall performance of the system as well as offer flexibility of choice.
A good implementation would consider the overall security requirements and effectively implement the various security policy modules offered by the framework.</p>
</div>
<div class="paragraph">
<p>A system utilizing MAC guarantees that a user will not be permitted to change security attributes at will.
All user utilities, programs, and scripts must work within the constraints of the access rules provided by the selected security policy modules and control of the MAC access rules is in the hands of the system administrator.</p>
</div>
<div class="paragraph">
<p>It is the duty of the system administrator to carefully select the correct security policy modules.
For an environment that needs to limit access control over the network, the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a>, and <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> policy modules make good starting points.
For an environment where strict confidentiality of file system objects is required, consider the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> policy modules.</p>
</div>
<div class="paragraph">
<p>Policy decisions could be made based on network configuration.
If only certain users should be permitted access to <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>, the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> policy module is a good choice.
In the case of file systems, access to objects might be considered confidential to some users, but not to others.
As an example, a large development team might be broken off into smaller projects where developers in project A might not be permitted to access objects written by developers in project B.
Yet both projects might need to access objects created by developers in project C.
Using the different security policy modules provided by the MAC framework, users could be divided into these groups and then given access to the appropriate objects.</p>
</div>
<div class="paragraph">
<p>Each security policy module has a unique way of dealing with the overall security of a system.
Module selection should be based on a well thought out security policy which may require revision and reimplementation.
Understanding the different security policy modules offered by the MAC framework will help administrators choose the best policies for their situations.</p>
</div>
<div class="paragraph">
<p>The rest of this chapter covers the available modules, describes their use and configuration, and in some cases, provides insight on applicable situations.</p>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Implementing MAC is much like implementing a firewall since care must be taken to prevent being completely locked out of the system.
The ability to revert back to a previous configuration should be considered and the implementation of MAC over a remote connection should be done with extreme caution.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-policies">18.5. Available MAC Policies<a class="anchor" href="#mac-policies"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default FreeBSD kernel includes <code>options MAC</code>.
This means that every module included with the MAC framework can be loaded with <code>kldload</code> as a run-time kernel module.
After testing the module, add the module name to <span class="filename">/boot/loader.conf</span> so that it will load during boot.
Each module also provides a kernel option for those administrators who choose to compile their own custom kernel.</p>
</div>
<div class="paragraph">
<p>FreeBSD includes a group of policies that will cover most security requirements. Each policy is summarized below.
The last three policies support integer settings in place of the three default labels.</p>
</div>
<div class="sect2">
<h3 id="mac-seeotheruids">18.5.1. The MAC See Other UIDs Policy<a class="anchor" href="#mac-seeotheruids"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_seeotheruids.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_SEEOTHERUIDS</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_seeotheruids_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> module extends the <code>security.bsd.see_other_uids</code> and <code>security.bsd.see_other_gids sysctl</code> tunables.
This option does not require any labels to be set before configuration and can operate transparently with other modules.</p>
</div>
<div class="paragraph">
<p>After loading the module, the following <code>sysctl</code> tunables may be used to control its features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.seeotheruids.enabled</code> enables the module and implements the default settings which deny users the ability to view processes and sockets owned by other users.</p>
</li>
<li>
<p><code>security.mac.seeotheruids.specificgid_enabled</code> allows specified groups to be exempt from this policy. To exempt specific groups, use the <code>security.mac.seeotheruids.specificgid=<em>XXX</em> sysctl</code> tunable, replacing <em>XXX</em> with the numeric group ID to be exempted.</p>
</li>
<li>
<p><code>security.mac.seeotheruids.primarygroup_enabled</code> is used to exempt specific primary groups from this policy. When using this tunable, <code>security.mac.seeotheruids.specificgid_enabled</code> may not be set.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mac-bsdextended">18.5.2. The MAC BSD Extended Policy<a class="anchor" href="#mac-bsdextended"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_bsdextended.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_BSDEXTENDED</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_bsdextended_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> module enforces a file system firewall.
It provides an extension to the standard file system permissions model, permitting an administrator to create a firewall-like ruleset to protect files, utilities, and directories in the file system hierarchy.
When access to a file system object is attempted, the list of rules is iterated until either a matching rule is located or the end is reached.
This behavior may be changed using <code>security.mac.bsdextended.firstmatch_enabled</code>.
Similar to other firewall modules in FreeBSD, a file containing the access control rules can be created and read by the system at boot time using an <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> variable.</p>
</div>
<div class="paragraph">
<p>The rule list may be entered using <a href="https://man.freebsd.org/cgi/man.cgi?query=ugidfw&amp;sektion=8&amp;format=html">ugidfw(8)</a> which has a syntax similar to <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>.
More tools can be written by using the functions in the <a href="https://man.freebsd.org/cgi/man.cgi?query=libugidfw&amp;sektion=3&amp;format=html">libugidfw(3)</a> library.</p>
</div>
<div class="paragraph">
<p>After the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> module has been loaded, the following command may be used to list the current rule configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ugidfw list</span>
0 slots, 0 rules</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, no rules are defined and everything is completely accessible.
To create a rule which blocks all access by users but leaves <code>root</code> unaffected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ugidfw add subject not uid root new object not uid root mode n</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While this rule is simple to implement, it is a very bad idea as it blocks all users from issuing any commands.
A more realistic example blocks <code>user1</code> all access, including directory listings, to <code><em>user2</em></code>&#39;s home directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ugidfw set 2 subject uid user1 object uid user2 mode n</span>
<span class="c"># ugidfw set 3 subject uid user1 object gid user2 mode n</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of <code>user1</code>, <code>not uid <em>user2</em></code> could be used in order to enforce the same access restrictions for all users.
However, the <code>root</code> user is unaffected by these rules.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Extreme caution should be taken when working with this module as incorrect use could block access to certain parts of the file system.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="mac-ifoff">18.5.3. The MAC Interface Silencing Policy<a class="anchor" href="#mac-ifoff"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_ifoff.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_IFOFF</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_ifoff_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> module is used to disable network interfaces on the fly and to keep network interfaces from being brought up during system boot.
It does not use labels and does not depend on any other MAC modules.</p>
</div>
<div class="paragraph">
<p>Most of this module’s control is performed through these <code>sysctl</code> tunables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.ifoff.lo_enabled</code> enables or disables all traffic on the loopback, <a href="https://man.freebsd.org/cgi/man.cgi?query=lo&amp;sektion=4&amp;format=html">lo(4)</a>, interface.</p>
</li>
<li>
<p><code>security.mac.ifoff.bpfrecv_enabled</code> enables or disables all traffic on the Berkeley Packet Filter interface, <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>.</p>
</li>
<li>
<p><code>security.mac.ifoff.other_enabled</code> enables or disables traffic on all other interfaces.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One of the most common uses of <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> is network monitoring in an environment where network traffic should not be permitted during the boot sequence.
Another use would be to write a script which uses an application such as <a class="package" href="https://cgit.freebsd.org/ports/tree/security/aide/">security/aide</a> to automatically block network traffic if it finds new or altered files in protected directories.</p>
</div>
</div>
<div class="sect2">
<h3 id="mac-portacl">18.5.4. The MAC Port Access Control List Policy<a class="anchor" href="#mac-portacl"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_portacl.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>MAC_PORTACL</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_portacl_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> module is used to limit binding to local TCP and UDP ports, making it possible to allow non-<code>root</code> users to bind to specified privileged ports below 1024.</p>
</div>
<div class="paragraph">
<p>Once loaded, this module enables the MAC policy on all sockets.
The following tunables are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.portacl.enabled</code> enables or disables the policy completely.</p>
</li>
<li>
<p><code>security.mac.portacl.port_high</code> sets the highest port number that <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> protects.</p>
</li>
<li>
<p><code>security.mac.portacl.suser_exempt</code>, when set to a non-zero value, exempts the <code>root</code> user from this policy.</p>
</li>
<li>
<p><code>security.mac.portacl.rules</code> specifies the policy as a text string of the form <code>rule[,rule,…​]</code>, with as many rules as needed, and where each rule is of the form <code>idtype:id:protocol:port</code>. The <code>idtype</code> is either <code>uid</code> or <code>gid</code>. The <code>protocol</code> parameter can be <code>tcp</code> or <code>udp</code>. The <code>port</code> parameter is the port number to allow the specified user or group to bind to. Only numeric values can be used for the user ID, group ID, and port parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, ports below 1024 can only be used by privileged processes which run as <code>root</code>.
For <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> to allow non-privileged processes to bind to ports below 1024, set the following tunables as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysctl security.mac.portacl.port_high=1023</span>
<span class="c"># sysctl net.inet.ip.portrange.reservedlow=0</span>
<span class="c"># sysctl net.inet.ip.portrange.reservedhigh=0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To prevent the <code>root</code> user from being affected by this policy, set <code>security.mac.portacl.suser_exempt</code> to a non-zero value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysctl security.mac.portacl.suser_exempt=1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow the <code>www</code> user with UID 80 to bind to port 80 without ever needing <code>root</code> privilege:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysctl security.mac.portacl.rules=uid:80:tcp:80</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This next example permits the user with the UID of 1001 to bind to TCP ports 110 (POP3) and 995 (POP3s):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysctl security.mac.portacl.rules=uid:1001:tcp:110,uid:1001:tcp:995</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mac-partition">18.5.5. The MAC Partition Policy<a class="anchor" href="#mac-partition"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_partition.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_PARTITION</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_partition_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_partition&amp;sektion=4&amp;format=html">mac_partition(4)</a> policy drops processes into specific &#34;partitions&#34; based on their MAC label.
Most configuration for this policy is done using <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a>.
One <code>sysctl</code> tunable is available for this policy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.partition.enabled</code> enables the enforcement of MAC process partitions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this policy is enabled, users will only be permitted to see their processes, and any others within their partition, but will not be permitted to work with utilities outside the scope of this partition.
For instance, a user in the <code>insecure</code> class will not be permitted to access <code>top</code> as well as many other commands that must spawn a process.</p>
</div>
<div class="paragraph">
<p>This example adds <code>top</code> to the label set on users in the <code>insecure</code> class.
All processes spawned by users in the <code>insecure</code> class will stay in the <code>partition/13</code> label.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setpmac partition/13 top</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This command displays the partition label and the process list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ps Zax</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This command displays another user’s process partition label and that user’s currently running processes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ps -ZU trhodes</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Users can see processes in <code>root</code>&#39;s label unless the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> policy is loaded.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="mac-mls">18.5.6. The MAC Multi-Level Security Module<a class="anchor" href="#mac-mls"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_mls.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_MLS</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_mls_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> policy controls access between subjects and objects in the system by enforcing a strict information flow policy.</p>
</div>
<div class="paragraph">
<p>In MLS environments, a &#34;clearance&#34; level is set in the label of each subject or object, along with compartments.
Since these clearance levels can reach numbers greater than several thousand, it would be a daunting task to thoroughly configure every subject or object.
To ease this administrative overhead, three labels are included in this policy: <code>mls/low</code>, <code>mls/equal</code>, and <code>mls/high</code>, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Anything labeled with <code>mls/low</code> will have a low clearance level and not be permitted to access information of a higher level. This label also prevents objects of a higher clearance level from writing or passing information to a lower level.</p>
</li>
<li>
<p><code>mls/equal</code> should be placed on objects which should be exempt from the policy.</p>
</li>
<li>
<p><code>mls/high</code> is the highest level of clearance possible. Objects assigned this label will hold dominance over all other objects in the system; however, they will not permit the leaking of information to objects of a lower class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>MLS provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A hierarchical security level with a set of non-hierarchical categories.</p>
</li>
<li>
<p>Fixed rules of <code>no read up, no write down</code>. This means that a subject can have read access to objects on its own level or below, but not above. Similarly, a subject can have write access to objects on its own level or above, but not beneath.</p>
</li>
<li>
<p>Secrecy, or the prevention of inappropriate disclosure of data.</p>
</li>
<li>
<p>A basis for the design of systems that concurrently handle data at multiple sensitivity levels without leaking information between secret and confidential.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following <code>sysctl</code> tunables are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.mls.enabled</code> is used to enable or disable the MLS policy.</p>
</li>
<li>
<p><code>security.mac.mls.ptys_equal</code> labels all <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a> devices as <code>mls/equal</code> during creation.</p>
</li>
<li>
<p><code>security.mac.mls.revocation_enabled</code> revokes access to objects after their label changes to a label of a lower grade.</p>
</li>
<li>
<p><code>security.mac.mls.max_compartments</code> sets the maximum number of compartment levels allowed on a system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To manipulate MLS labels, use <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a>. To assign a label to an object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfmac mls/5 test</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the MLS label for the file <span class="filename">test</span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># getfmac test</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another approach is to create a master policy file in <span class="filename">/etc/</span> which specifies the MLS policy information and to feed that file to <code>setfmac</code>.</p>
</div>
<div class="paragraph">
<p>When using the MLS policy module, an administrator plans to control the flow of sensitive information.
The default <code>block read up block write down</code> sets everything to a low state.
Everything is accessible and an administrator slowly augments the confidentiality of the information.</p>
</div>
<div class="paragraph">
<p>Beyond the three basic label options, an administrator may group users and groups as required to block the information flow between them.
It might be easier to look at the information in clearance levels using descriptive words, such as classifications of <code>Confidential</code>, <code>Secret</code>, and <code>Top Secret</code>.
Some administrators instead create different groups based on project levels.
Regardless of the classification method, a well thought out plan must exist before implementing a restrictive policy.</p>
</div>
<div class="paragraph">
<p>Some example situations for the MLS policy module include an e-commerce web server, a file server holding critical company information, and financial institution environments.</p>
</div>
</div>
<div class="sect2">
<h3 id="mac-biba">18.5.7. The MAC Biba Module<a class="anchor" href="#mac-biba"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_biba.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_BIBA</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_biba_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> module loads the MAC Biba policy.
This policy is similar to the MLS policy with the exception that the rules for information flow are slightly reversed.
This is to prevent the downward flow of sensitive information whereas the MLS policy prevents the upward flow of sensitive information.</p>
</div>
<div class="paragraph">
<p>In Biba environments, an &#34;integrity&#34; label is set on each subject or object.
These labels are made up of hierarchical grades and non-hierarchical components.
As a grade ascends, so does its integrity.</p>
</div>
<div class="paragraph">
<p>Supported labels are <code>biba/low</code>, <code>biba/equal</code>, and <code>biba/high</code>, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>biba/low</code> is considered the lowest integrity an object or subject may have. Setting this on objects or subjects blocks their write access to objects or subjects marked as <code>biba/high</code>, but will not prevent read access.</p>
</li>
<li>
<p><code>biba/equal</code> should only be placed on objects considered to be exempt from the policy.</p>
</li>
<li>
<p><code>biba/high</code> permits writing to objects set at a lower label, but does not permit reading that object. It is recommended that this label be placed on objects that affect the integrity of the entire system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Biba provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hierarchical integrity levels with a set of non-hierarchical integrity categories.</p>
</li>
<li>
<p>Fixed rules are <code>no write up, no read down</code>, the opposite of MLS. A subject can have write access to objects on its own level or below, but not above. Similarly, a subject can have read access to objects on its own level or above, but not below.</p>
</li>
<li>
<p>Integrity by preventing inappropriate modification of data.</p>
</li>
<li>
<p>Integrity levels instead of MLS sensitivity levels.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following tunables can be used to manipulate the Biba policy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>security.mac.biba.enabled</code> is used to enable or disable enforcement of the Biba policy on the target machine.</p>
</li>
<li>
<p><code>security.mac.biba.ptys_equal</code> is used to disable the Biba policy on <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a> devices.</p>
</li>
<li>
<p><code>security.mac.biba.revocation_enabled</code> forces the revocation of access to objects if the label is changed to dominate the subject.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To access the Biba policy setting on system objects, use <code>setfmac</code> and <code>getfmac</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfmac biba/low test</span>
<span class="c"># getfmac test</span>
<span class="nb">test</span>: biba/low</code></pre>
</div>
</div>
<div class="paragraph">
<p>Integrity, which is different from sensitivity, is used to guarantee that information is not manipulated by untrusted parties.
This includes information passed between subjects and objects.
It ensures that users will only be able to modify or access information they have been given explicit access to.
The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> security policy module permits an administrator to configure which files and programs a user may see and invoke while assuring that the programs and files are trusted by the system for that user.</p>
</div>
<div class="paragraph">
<p>During the initial planning phase, an administrator must be prepared to partition users into grades, levels, and areas.
The system will default to a high label once this policy module is enabled, and it is up to the administrator to configure the different grades and levels for users.
Instead of using clearance levels, a good planning method could include topics.
For instance, only allow developers modification access to the source code repository, source code compiler, and other development utilities.
Other users would be grouped into other categories such as testers, designers, or end users and would only be permitted read access.</p>
</div>
<div class="paragraph">
<p>A lower integrity subject is unable to write to a higher integrity subject and a higher integrity subject cannot list or read a lower integrity object.
Setting a label at the lowest possible grade could make it inaccessible to subjects.
Some prospective environments for this security policy module would include a constrained web server, a development and test machine, and a source code repository.
A less useful implementation would be a personal workstation, a machine used as a router, or a network firewall.</p>
</div>
</div>
<div class="sect2">
<h3 id="mac-lomac">18.5.8. The MAC Low-watermark Module<a class="anchor" href="#mac-lomac"></a></h3>
<div class="paragraph">
<p>Module name: <span class="filename">mac_lomac.ko</span></p>
</div>
<div class="paragraph">
<p>Kernel configuration line: <code>options MAC_LOMAC</code></p>
</div>
<div class="paragraph">
<p>Boot option: <code>mac_lomac_load=&#34;YES&#34;</code></p>
</div>
<div class="paragraph">
<p>Unlike the MAC Biba policy, the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> policy permits access to lower integrity objects only after decreasing the integrity level to not disrupt any integrity rules.</p>
</div>
<div class="paragraph">
<p>The Low-watermark integrity policy works almost identically to Biba, with the exception of using floating labels to support subject demotion via an auxiliary grade compartment.
This secondary compartment takes the form <code>[auxgrade]</code>.
When assigning a policy with an auxiliary grade, use the syntax <code>lomac/10[2]</code>, where <code>2</code> is the auxiliary grade.</p>
</div>
<div class="paragraph">
<p>This policy relies on the ubiquitous labeling of all system objects with integrity labels, permitting subjects to read from low integrity objects and then downgrading the label on the subject to prevent future writes to high integrity objects using <code>[auxgrade]</code>.
The policy may provide greater compatibility and require less initial configuration than Biba.</p>
</div>
<div class="paragraph">
<p>Like the Biba and MLS policies, <code>setfmac</code> and <code>setpmac</code> are used to place labels on system objects:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfmac /usr/home/trhodes lomac/high[low]</span>
<span class="c"># getfmac /usr/home/trhodes lomac/high[low]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The auxiliary grade <code>low</code> is a feature provided only by the MACLOMAC policy.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-userlocked">18.6. User Lock Down<a class="anchor" href="#mac-userlocked"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This example considers a relatively small storage system with fewer than fifty users.
Users will have login capabilities and are permitted to store data and access resources.</p>
</div>
<div class="paragraph">
<p>For this scenario, the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> policy modules could co-exist and block access to system objects while hiding user processes.</p>
</div>
<div class="paragraph">
<p>Begin by adding the following line to <span class="filename">/boot/loader.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>mac_seeotheruids_load=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> security policy module may be activated by adding this line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ugidfw_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Default rules stored in <span class="filename">/etc/rc.bsdextended</span> will be loaded at system initialization.
However, the default entries may need modification.
Since this machine is expected only to service users, everything may be left commented out except the last two lines in order to force the loading of user owned system objects by default.</p>
</div>
<div class="paragraph">
<p>Add the required users to this machine and reboot.
For testing purposes, try logging in as a different user across two consoles.
Run <code>ps aux</code> to see if processes of other users are visible.
Verify that running <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> on another user’s home directory fails.</p>
</div>
<div class="paragraph">
<p>Do not try to test with the <code>root</code> user unless the specific <code>sysctl</code>s have been modified to block super user access.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a new user is added, their <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> rule will not be in the ruleset list.
To update the ruleset quickly, unload the security policy module and reload it again using <a href="https://man.freebsd.org/cgi/man.cgi?query=kldunload&amp;sektion=8&amp;format=html">kldunload(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-implementing">18.7. Nagios in a MAC Jail<a class="anchor" href="#mac-implementing"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section demonstrates the steps that are needed to implement the Nagios network monitoring system in a MAC environment.
This is meant as an example which still requires the administrator to test that the implemented policy meets the security requirements of the network before using in a production environment.</p>
</div>
<div class="paragraph">
<p>This example requires <code>multilabel</code> to be set on each file system.
It also assumes that <a class="package" href="https://cgit.freebsd.org/ports/tree/net-mgmt/nagios-plugins/">net-mgmt/nagios-plugins</a>, <a class="package" href="https://cgit.freebsd.org/ports/tree/net-mgmt/nagios/">net-mgmt/nagios</a>, and <a class="package" href="https://cgit.freebsd.org/ports/tree/www/apache22/">www/apache22</a> are all installed, configured, and working correctly before attempting the integration into the MAC framework.</p>
</div>
<div class="sect2">
<h3 id="_create_an_insecure_user_class">18.7.1. Create an Insecure User Class<a class="anchor" href="#_create_an_insecure_user_class"></a></h3>
<div class="paragraph">
<p>Begin the procedure by adding the following user class to <span class="filename">/etc/login.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>insecure:\
:copyright=/etc/COPYRIGHT:\
:welcome=/etc/motd:\
:setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
:path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin
:manpath=/usr/share/man /usr/local/man:\
:nologin=/usr/sbin/nologin:\
:cputime=1h30m:\
:datasize=8M:\
:vmemoryuse=100M:\
:stacksize=2M:\
:memorylocked=4M:\
:memoryuse=8M:\
:filesize=8M:\
:coredumpsize=8M:\
:openfiles=24:\
:maxproc=32:\
:priority=0:\
:requirehome:\
:passwordtime=91d:\
:umask=022:\
:ignoretime@:\
:label=biba/10(10-10):</pre>
</div>
</div>
<div class="paragraph">
<p>Then, add the following line to the default user class section:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>:label=biba/high:</pre>
</div>
</div>
<div class="paragraph">
<p>Save the edits and issue the following command to rebuild the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cap_mkdb /etc/login.conf</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_users">18.7.2. Configure Users<a class="anchor" href="#_configure_users"></a></h3>
<div class="paragraph">
<p>Set the <code>root</code> user to the default class using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pw usermod root -L default</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All user accounts that are not <code>root</code> will now require a login class.
The login class is required, otherwise users will be refused access to common commands.
The following <code>sh</code> script should do the trick:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># for x in `awk -F: &#39;($3 &gt;= 1001) &amp;&amp; ($3 != 65534) { print $1 }&#39; \</span>
	/etc/passwd<span class="sb">`</span>; <span class="k">do </span>pw usermod <span class="nv">$x</span> -L default; <span class="k">done</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, drop the <code>nagios</code> and <code>www</code> accounts into the insecure class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pw usermod nagios -L insecure</span>
<span class="c"># pw usermod www -L insecure</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_the_contexts_file">18.7.3. Create the Contexts File<a class="anchor" href="#_create_the_contexts_file"></a></h3>
<div class="paragraph">
<p>A contexts file should now be created as <span class="filename">/etc/policy.contexts</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># This is the default BIBA policy for this system.

# System:
/var/run(/.*)?			biba/equal

/dev/(/.*)?			biba/equal

/var				biba/equal
/var/spool(/.*)?		biba/equal

/var/log(/.*)?			biba/equal

/tmp(/.*)?			biba/equal
/var/tmp(/.*)?			biba/equal

/var/spool/mqueue		biba/equal
/var/spool/clientmqueue		biba/equal

# For Nagios:
/usr/local/etc/nagios(/.*)?	biba/10

/var/spool/nagios(/.*)?		biba/10

# For apache
/usr/local/etc/apache(/.*)?	biba/10</pre>
</div>
</div>
<div class="paragraph">
<p>This policy enforces security by setting restrictions on the flow of information.
In this specific configuration, users, including <code>root</code>, should never be allowed to access Nagios.
Configuration files and processes that are a part of Nagios will be completely self contained or jailed.</p>
</div>
<div class="paragraph">
<p>This file will be read after running <code>setfsmac</code> on every file system.
This example sets the policy on the root file system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setfsmac -ef /etc/policy.contexts /</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, add these edits to the main section of <span class="filename">/etc/mac.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>default_labels file ?biba
default_labels ifnet ?biba
default_labels process ?biba
default_labels socket ?biba</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loader_configuration">18.7.4. Loader Configuration<a class="anchor" href="#_loader_configuration"></a></h3>
<div class="paragraph">
<p>To finish the configuration, add the following lines to <span class="filename">/boot/loader.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>mac_biba_load=&#34;YES&#34;
mac_seeotheruids_load=&#34;YES&#34;
security.mac.biba.trust_all_interfaces=1</pre>
</div>
</div>
<div class="paragraph">
<p>And the following line to the network card configuration stored in <span class="filename">/etc/rc.conf</span>.
If the primary network configuration is done via DHCP, this may need to be configured manually after every system boot:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>maclabel biba/equal</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_configuration">18.7.5. Testing the Configuration<a class="anchor" href="#_testing_the_configuration"></a></h3>
<div class="paragraph">
<p>First, ensure that the web server and Nagios will not be started on system initialization and reboot.
Ensure that <code>root</code> cannot access any of the files in the Nagios configuration directory.
If <code>root</code> can list the contents of <span class="filename">/var/spool/nagios</span>, something is wrong.
Instead, a &#34;permission denied&#34; error should be returned.</p>
</div>
<div class="paragraph">
<p>If all seems well, Nagios, Apache, and Sendmail can now be started:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /etc/mail &amp;&amp; make stop &amp;&amp; \</span>
setpmac biba/equal make start <span class="o">&amp;&amp;</span> setpmac biba/10<span class="se">\(</span>10-10<span class="se">\)</span> apachectl start <span class="o">&amp;&amp;</span> <span class="se">\</span>
setpmac biba/10<span class="se">\(</span>10-10<span class="se">\)</span> /usr/local/etc/rc.d/nagios.sh forcestart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Double check to ensure that everything is working properly.
If not, check the log files for error messages.
If needed, use <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> to disable the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> security policy module and try starting everything again as usual.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>root</code> user can still change the security enforcement and edit its configuration files.
The following command will permit the degradation of the security policy to a lower grade for a newly spawned shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># setpmac biba/10 csh</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To block this from happening, force the user into a range using <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.
If <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a> attempts to run a command outside of the compartment’s range, an error will be returned and the command will not be executed.
In this case, set root to <code>biba/high(high-high)</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-troubleshoot">18.8. Troubleshooting the MAC Framework<a class="anchor" href="#mac-troubleshoot"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section discusses common configuration errors and how to resolve them.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>multilabel</code> flag does not stay enabled on the root (<span class="filename">/</span>) partition</dt>
<dd>
<p>The following steps may resolve this transient error:</p>
</dd>
</dl>
</div>
<div class="exampleblock procedure">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit <span class="filename">/etc/fstab</span> and set the root partition to <code>ro</code> for read-only.</p>
</li>
<li>
<p>Reboot into single user mode.</p>
</li>
<li>
<p>Run <code>tunefs -l enable</code> on <span class="filename">/</span>.</p>
</li>
<li>
<p>Reboot the system.</p>
</li>
<li>
<p>Run <code>mount -urw</code><span class="filename">/</span> and change the <code>ro</code> back to <code>rw</code> in <span class="filename">/etc/fstab</span> and reboot the system again.</p>
</li>
<li>
<p>Double-check the output from <code>mount</code> to ensure that <code>multilabel</code> has been properly set on the root file system.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">After establishing a secure environment with MAC, Xorg no longer starts</dt>
<dd>
<p>This could be caused by the MAC <code>partition</code> policy or by a mislabeling in one of the MAC labeling policies.
To debug, try the following:</p>
</dd>
</dl>
</div>
<div class="exampleblock procedure">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the error message. If the user is in the <code>insecure</code> class, the <code>partition</code> policy may be the culprit. Try setting the user’s class back to the <code>default</code> class and rebuild the database with <code>cap_mkdb</code>. If this does not alleviate the problem, go to step two.</p>
</li>
<li>
<p>Double-check that the label policies are set correctly for the user, Xorg, and the <span class="filename">/dev</span> entries.</p>
</li>
<li>
<p>If neither of these resolve the problem, send the error message and a description of the environment to the <a href="https://lists.FreeBSD.org/subscription/freebsd-questions">FreeBSD general questions mailing list</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>_secure_path: unable to stat .login_conf</code> error appears</dt>
<dd>
<p>This error can appear when a user attempts to switch from the <code>root</code> user to another user in the system.
This message usually occurs when the user has a higher label setting than that of the user they are attempting to become.
For instance, if <code>joe</code> has a default label of <code>biba/low</code> and <code>root</code> has a label of <code>biba/high</code>, <code>root</code> cannot view <code>joe</code>&#39;s home directory.
This will happen whether or not <code>root</code> has used <code>su</code> to become <code>joe</code> as the Biba integrity model will not permit <code>root</code> to view objects set at a lower integrity level.</p>
</dd>
<dt class="hdlist1">The system no longer recognizes <code>root</code></dt>
<dd>
<p>When this occurs, <code>whoami</code> returns <code>0</code> and <code>su</code> returns <code>who are you?</code>.</p>
<div class="paragraph">
<p>This can happen if a labeling policy has been disabled by <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> or the policy module was unloaded.
If the policy is disabled, the login capabilities database needs to be reconfigured.
Double check <span class="filename">/etc/login.conf</span> to ensure that all <code>label</code> options have been removed and rebuild the database with <code>cap_mkdb</code>.</p>
</div>
<div class="paragraph">
<p>This may also happen if a policy restricts access to <span class="filename">master.passwd</span>.
This is usually caused by an administrator altering the file under a label which conflicts with the general policy being used by the system.
In these cases, the user information would be read by the system and access would be blocked as the file has inherited the new label.
Disable the policy using <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> and everything should return to normal.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>

    </div>
    
    <hr />
    <div class="last-modified">
      <p><strong>Last modified on</strong>: March 21, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=0aafe98" target="_blank">fiercex</a></p>
    </div>
    
    <div class="buttons">
      
      <div class="prev">
        <i class="fa fa-angle-left" aria-hidden="true" title="Prev"></i>
        <div class="container">
          
            <a href=https://free.bsd-doc.org/en/books/handbook/jails class="direction">Prev</a>
          
        </div>
      </div>
      
      <div class="home">
        <i class="fa fa-home" aria-hidden="true" title="Home"></i>
        <div class="container">
          
            <a href="../" class="direction">Home</a>
          
        </div>
      </div>
      
      <div class="next">
        <div class="container">
          
            <a href=https://free.bsd-doc.org/en/books/handbook/audit  class="direction">Next</a>
          
        </div>
        <i class="fa fa-angle-right" aria-hidden="true" title="Next"></i>
      </div>
      
    </div>
    <label class="hidden book-menu-overlay" for="menu-control"></label>
  </div>
  <aside class="toc">
    <div class="toc-content">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#mac-synopsis">18.1. Synopsis</a></li>
    <li><a href="#mac-inline-glossary">18.2. Key Terms</a></li>
    <li><a href="#mac-understandlabel">18.3. Understanding MAC Labels</a></li>
    <li><a href="#mac-planning">18.4. Planning the Security Configuration</a></li>
    <li><a href="#mac-policies">18.5. Available MAC Policies</a></li>
    <li><a href="#mac-userlocked">18.6. User Lock Down</a></li>
    <li><a href="#mac-implementing">18.7. Nagios in a MAC Jail</a></li>
    <li><a href="#mac-troubleshoot">18.8. Troubleshooting the MAC Framework</a></li>
  </ul>
</nav>
      <hr />
      
    </div>
  </aside>
  <a class="to-top" href="#top">
    <i class="fa fa-arrow-circle-up" aria-hidden="true"></i>
  </a>
</main>

    <footer>
  <div class="footer-container">
    <section class="logo-column">
          <img src="https://free.bsd-doc.org/images/FreeBSD-colors.svg" width="160" height="50" alt="FreeBSD logo" />
        <div class="options-container">
          
            <div class="language-container">
              <a id="languages" href="https://free.bsd-doc.org/en/languages">
                
                <img src="https://free.bsd-doc.org/images/language.png" class="language-image" alt="Choose language">
                <span>English</span>
              </a>
            </div>
          
          <div class="theme-container">
            <select id="theme-chooser">
	      <option value="theme-system">System</option>
              <option value="theme-light">Light</option>
              <option value="theme-dark">Dark</option>
              <option value="theme-high-contrast">High contrast</option>
            </select>
          </div>
        </div>
      </section>
      
      <section class="copyright-column">
        <p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p>
        <span>Made with <span class="heart">♥</span> by the FreeBSD Community</span>
      </section>
  </div>
</footer>

  </body>
</html>
