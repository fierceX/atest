<!DOCTYPE html>
<html class="theme-light" lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="This chapter covers some of the more frequently used network services on UNIX systems"/>
  <meta name="keywords" content="network, servers, inetd, NFS, NIS, LDAP, DHCP, DNS, Apache HTTP, FTP, Samba, NTP, iSCSI"/>
  <meta name="copyright" content="1995-2024 The FreeBSD Foundation" />
  <link rel="canonical" href="https://free.bsd-doc.org/en/books/handbook/network-servers/" />

  <title>Chapter 32. Network Servers |  FreeBSD Documentation Portal</title>

  <meta name="theme-color" content="#790000">
  <meta name="color-scheme" content="system light dark high-contrast">

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.0/fuse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>


    <link rel="shortcut icon" href="https://free.bsd-doc.org/favicon.ico">
    <link rel="stylesheet" href="/styles/main.min.css">
    <link rel="stylesheet" href="https://free.bsd-doc.org/css/font-awesome-min.css">
    <script defer src="/js/theme-chooser.min.js"></script>
    <script defer src="/js/copy-clipboard.min.js"></script>
    <script defer src="/js/search.min.js"></script>
    <script defer src="/js/fssearch.min.js"></script>

  
  
    
    <meta property="og:title" content="Chapter 32. Network Servers" />
    <meta property="og:description" content="This chapter covers some of the more frequently used network services on UNIX systems" />
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://free.bsd-doc.orgfavicon.ico"/>
    <meta property="og:image:alt" content="FreeBSD Logo">
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="https://free.bsd-doc.org/en/books/handbook/network-servers/" />
    <meta property="og:site_name" content="FreeBSD Documentation Portal" />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "url": "https:\/\/free.bsd-doc.org\/en\/books\/handbook\/network-servers\/",
        "name": "FreeBSD Documentation Portal",
        "headline": "FreeBSD Documentation Portal",
        "description": "FreeBSD 中文文档"
      }
    </script>
    

  
</head>


  <body>
    <header>
  <div class="header-container">
    <div class="logo-menu-bars-container">
      <a href="https://free.bsd-doc.org" class="logo">
        <img src="https://free.bsd-doc.org/images/FreeBSD-monochromatic.svg" width="160" height="50" alt="FreeBSD logo" />
      </a>
      <label class="menu-bars" for="menu-bars">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </div>
    <input id="menu-bars" type="checkbox" />
    
    <div class="search-donate-container">
      
      <form class="search" method="get" id="search-header-form" action="https://free.bsd-doc.org/zh-cn/search" name="search-header-form">
        <input id="search-query" name="s" type="text" size="20" maxlength="255" value="" />
        <button>
          <i class="fa fa-search" aria-hidden="true"></i>
        </button>
      </form>
      <div class="donate">
        <a href="https://github.com/fierceX/freebsd-doc-cn" target="_blank">
          <span class="heart">♥</span>
          GitHub
        </a>
      </div>
    </div>
  </div>
</header>

    
<input type="checkbox" class="hidden toggle" id="menu-control">
<main class="main-wrapper-book">
  <a id="top"></a>
  
  <aside class="book-menu">
    <div class="book-menu-content">
      <input id="search-book" type="text" placeholder="Search" aria-label="Search" maxlength="128" />
      <nav id="MenuContents">
        
  <ul>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ada319c45e780947f82b569049480cc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-8ada319c45e780947f82b569049480cc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/preface/">
              Preface
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-audience">Intended Audience</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from4">Fourth Edition</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from3">Third Edition</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes-from2">Second Edition (2004)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-changes">First Edition (2001)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-overview">Organization of This Book</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-conv">Conventions used in this book</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/preface/#preface-acknowledgements">Acknowledgments</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-32a83d18a326852a8d9ae2582360bbc8" class="toggle"  />
          <label  for="chapter-32a83d18a326852a8d9ae2582360bbc8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/parti/">
              Part I. Getting Started
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a4909db05d872d16d5be86a57cbc2dc7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a4909db05d872d16d5be86a57cbc2dc7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/introduction/">
              Chapter 1. Introduction
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#introduction-synopsis">1.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#nutshell">1.2. Welcome to FreeBSD!</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/introduction/#history">1.3. About the FreeBSD Project</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3c2455cadf89eadd3f6e77461085d5e9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3c2455cadf89eadd3f6e77461085d5e9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/">
              Chapter 2. Installing FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-synopsis">2.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-hardware">2.2. Minimum Hardware Requirements</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-pre">2.3. Pre-Installation Tasks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-start">2.4. Starting the Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#using-bsdinstall">2.5. Using bsdinstall</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-partitioning">2.6. Allocating Disk Space</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-fetching-distribution">2.7. Fetching Distribution Files</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-post">2.8. Network Interfaces, Accounts, Time Zone, Services and Hardening</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#bsdinstall-install-trouble">2.9. Troubleshooting</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bsdinstall/#using-live-cd">2.10. Using the Live CD</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-709481b75d22ad36960f7ac166b3306c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-709481b75d22ad36960f7ac166b3306c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/basics/">
              Chapter 3. FreeBSD Basics
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-synopsis">3.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#consoles">3.2. Virtual Consoles and Terminals</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#users-synopsis">3.3. Users and Basic Account Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#permissions">3.4. Permissions</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#dirstructure">3.5. Directory Structure</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#disk-organization">3.6. Disk Organization</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#mount-unmount">3.7. Mounting and Unmounting File Systems</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-processes">3.8. Processes and Daemons</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#shells">3.9. Shells</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#editors">3.10. Text Editors</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-devices">3.11. Devices and Device Nodes</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/basics/#basics-more-information">3.12. Manual Pages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-58c050d31a1fbecd859248dacefeb567" class="toggle"  />
          <label  class="icon cursor"  for="chapter-58c050d31a1fbecd859248dacefeb567"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/ports/">
              Chapter 4. Installing Applications: Packages and Ports
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-synopsis">4.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-overview">4.2. Overview of Software Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-finding-applications">4.3. Finding Software</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#pkgng-intro">4.4. Using pkg for Binary Package Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-using">4.5. Using the Ports Collection</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-poudriere">4.6. Building Packages with poudriere</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-nextsteps">4.7. Post-Installation Considerations</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ports/#ports-broken">4.8. Dealing with Broken Ports</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e5a000ce7f50680a180e2c1b83c121bc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e5a000ce7f50680a180e2c1b83c121bc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/x11/">
              Chapter 5. The X Window System
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x11-synopsis">5.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-install">5.2. Installing Xorg</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-graphic-card-drivers">5.3. Graphic card drivers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-config">5.4. Xorg Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/x11/#x-fonts">5.5. Using Fonts in Xorg</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-235af08fb87fd7a58003348706d2111d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-235af08fb87fd7a58003348706d2111d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/wayland/">
              Chapter 6. Wayland
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-synopsis">6.1. Wayland Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-wayfire">6.2. The Wayfire Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-hikari">6.3. The Hikari Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-sway">6.4. The Sway Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-xwayland">6.5. Using Xwayland</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-remotedesktop">6.6. Remote Desktop Using VNC</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-ly">6.7. Wayland Login Manager</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wayland/#wayland-utilities">6.8. Useful Utilities</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4de18483dde20bf9ed0024176afd09da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4de18483dde20bf9ed0024176afd09da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/network/">
              Chapter 7. Network
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#network-synopsis">7.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#config-network-setup">7.2. Setting up the Network</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#config-network-connection">7.3. Wired Networks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#network-wireless">7.4. Wireless Networks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#hostname">7.5. Hostname</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#dns">7.6. DNS</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network/#troubleshooting">7.7. Troubleshooting</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-5eb30759c3a2873e716dc31d7760054c" class="toggle"  />
          <label  for="chapter-5eb30759c3a2873e716dc31d7760054c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partii/">
              Part II. Common Tasks
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-c96504f017c56f4bc7f71548cccf5382" class="toggle"  />
          <label  class="icon cursor"  for="chapter-c96504f017c56f4bc7f71548cccf5382"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/desktop/">
              Chapter 8. Desktop Environments
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-synopsis">8.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-environments">8.2. Desktop Environments</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-browsers">8.3. Browsers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-development">8.4. Development tools</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-productivity">8.5. Desktop office productivity</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-viewers">8.6. Document Viewers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/desktop/#desktop-finance">8.7. Finance</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e1898af36aaacc168e13b673d25b908f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e1898af36aaacc168e13b673d25b908f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/multimedia/">
              Chapter 9. Multimedia
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#multimedia-synopsis">9.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#sound-setup">9.2. Setting Up the Sound Card</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#audio-ports">9.3. Audio players</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#video-ports">9.4. Video players</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#conferencing-meetings">9.5. Conferencing and Meetings</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/multimedia/#scanners">9.6. Image Scanners</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6926664836e63c5cae4b2fa60855f91d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-6926664836e63c5cae4b2fa60855f91d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/">
              Chapter 10. Configuring the FreeBSD Kernel
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-synopsis">10.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-custom-kernel">10.2. Why Build a Custom Kernel?</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-devices">10.3. Finding the System Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-config">10.4. The Configuration File</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-building">10.5. Building and Installing a Custom Kernel</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/kernelconfig/#kernelconfig-trouble">10.6. If Something Goes Wrong</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-19d36bd70a320268f0ea1f66e4f3e224" class="toggle"  />
          <label  class="icon cursor"  for="chapter-19d36bd70a320268f0ea1f66e4f3e224"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/printing/">
              Chapter 11. Printing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-quick-start">11.1. Quick Start</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-connections">11.2. Printer Connections</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-pdls">11.3. Common Page Description Languages</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-direct">11.4. Direct Printing</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-lpd">11.5. LPD (Line Printer Daemon)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/printing/#printing-other">11.6. Other Printing Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/">
              Chapter 12. Linux Binary Compatibility
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-synopsis">12.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-lbc-install">12.2. Configuring Linux Binary Compatibility</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linux-userlands">12.3. Linux userlands</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/linuxemu/#linuxemu-advanced">12.4. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-af234c193ce95c480af0ff5ec3f32f5c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-af234c193ce95c480af0ff5ec3f32f5c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/wine/">
              Chapter 13. WINE
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-synopsis">13.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-overview-concepts">13.2. WINE Overview & Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#installing-wine-on-freebsd">13.3. Installing WINE on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#running-first-wine-program">13.4. Running a First WINE Program on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#configuring-wine-installation">13.5. Configuring WINE Installation</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-management-guis">13.6. WINE Management GUIs</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-in-multi-user-os-installations">13.7. WINE in Multi-User FreeBSD Installations</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/wine/#wine-on-os-faq">13.8. WINE on FreeBSD FAQ</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-51416fdea9d5a1dfa1c2718cd825213a" class="toggle"  />
          <label  for="chapter-51416fdea9d5a1dfa1c2718cd825213a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partiii/">
              Part III. System Administration
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-532d0380ba66d66e033765a0b6930ee7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-532d0380ba66d66e033765a0b6930ee7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/config/">
              Chapter 14. Configuration, Services, Logging and Power Management
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#config-synopsis">14.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-configfiles">14.2. Configuration Files</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-rcd">14.3. Managing Services in FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#cron-periodic">14.4. Cron and Periodic</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#configtuning-syslog">14.5. Configuring System Logging</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#acpi-overview">14.6. Power and Resource Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/config/#adding-swap-space">14.7. Adding Swap Space</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-d05f41680fb7e3d68b354ae03de368b1" class="toggle"  />
          <label  class="icon cursor"  for="chapter-d05f41680fb7e3d68b354ae03de368b1"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/boot/">
              Chapter 15. The FreeBSD Booting Process
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-synopsis">15.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-introduction">15.2. FreeBSD Boot Process</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#device-hints">15.3. Device Hints</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/boot/#boot-shutdown">15.4. Shutdown Sequence</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-513e8e407c57354df334059688e9b60a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-513e8e407c57354df334059688e9b60a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/security/">
              Chapter 16. Security
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-synopsis">16.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-intro">16.2. Introduction</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#sec-accounts">16.3. Securing Accounts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-ids">16.4. Intrusion Detection System (IDS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-secure-levels">16.5. Secure levels</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-file-flags">16.6. File flags</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#openssh">16.7. OpenSSH</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#openssl">16.8. OpenSSL</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#kerberos5">16.9. Kerberos</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#tcpwrappers">16.10. TCP Wrappers</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#fs-acl">16.11. Access Control Lists</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#capsicum">16.12. Capsicum</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-accounting">16.13. Process Accounting</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-resourcelimits">16.14. Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-pkg">16.15. Monitoring Third Party Security Issues</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/security/#security-advisories">16.16. FreeBSD Security Advisories</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0f7d2858504c83a029928c048d394e2a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0f7d2858504c83a029928c048d394e2a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/jails/">
              Chapter 17. Jails and Containers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jails-synopsis">17.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-types">17.2. Jail Types</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#host-configuration">17.3. Host Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#classic-jail">17.4. Classic Jail (Thick Jail)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#thin-jail">17.5. Thin Jails</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-management">17.6. Jail Management</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-upgrading">17.7. Jail Upgrading</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-resource-limits">17.8. Jail Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/jails/#jail-managers-and-containers">17.9. Jail Managers and Containers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-15be125ce5997f51c5499e3a0dee6c2c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-15be125ce5997f51c5499e3a0dee6c2c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mac/">
              Chapter 18. Mandatory Access Control
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-synopsis">18.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-inline-glossary">18.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-understandlabel">18.3. Understanding MAC Labels</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-planning">18.4. Planning the Security Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-policies">18.5. Available MAC Policies</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-userlocked">18.6. User Lock Down</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-implementing">18.7. Nagios in a MAC Jail</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mac/#mac-troubleshoot">18.8. Troubleshooting the MAC Framework</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3f7e8d763b17c7d0c44c60505cf0feea" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3f7e8d763b17c7d0c44c60505cf0feea"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/audit/">
              Chapter 19. Security Event Auditing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-synopsis">19.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-inline-glossary">19.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-config">19.3. Audit Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/audit/#audit-administration">19.4. Working with Audit Trails</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7bb1cb2287cd08a3672cc878e604f0d0" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7bb1cb2287cd08a3672cc878e604f0d0"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/disks/">
              Chapter 20. Storage
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-synopsis">20.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-adding">20.2. Adding Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-growing">20.3. Resizing and Growing Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#usb-disks">20.4. USB Storage Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#creating-cds">20.5. Creating and Using CD Media</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#creating-dvds">20.6. Creating and Using DVD Media</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#floppies">20.7. Creating and Using Floppy Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#using-ntfs">20.8. Using NTFS Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#backup-basics">20.9. Backup Basics</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-virtual">20.10. Memory Disks</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#snapshots">20.11. File System Snapshots</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#quotas">20.12. Disk Quotas</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-encrypting">20.13. Encrypting Disk Partitions</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#swap-encrypting">20.14. Encrypting Swap</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/disks/#disks-hast">20.15. Highly Available Storage (HAST)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-dec5fc4f0100e5030db0fb188d8d4b2f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-dec5fc4f0100e5030db0fb188d8d4b2f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/geom/">
              Chapter 21. GEOM: Modular Disk Transformation Framework
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-synopsis">21.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-striping">21.2. RAID0 - Striping</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-mirror">21.3. RAID1 - Mirroring</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-raid3">21.4. RAID3 - Byte-level Striping with Dedicated Parity</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-graid">21.5. Software RAID Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-ggate">21.6. GEOM Gate Network</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-glabel">21.7. Labeling Disk Devices</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/geom/#geom-gjournal">21.8. UFS Journaling Through GEOM</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f1657a05627dd16bad31d4c7f675604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f1657a05627dd16bad31d4c7f675604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/zfs/">
              Chapter 22. The Z File System (ZFS)
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-differences">22.1. What Makes ZFS Different</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-quickstart">22.2. Quick Start Guide</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zpool">22.3. <code>zpool</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zfs">22.4. <code>zfs</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-zfs-allow">22.5. Delegated Administration</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-advanced">22.6. Advanced Topics</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-links">22.7. Further Resources</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/zfs/#zfs-term">22.8. ZFS Features and Terminology</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4c6bf6828e601b79edb2813329ac6604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4c6bf6828e601b79edb2813329ac6604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/filesystems/">
              Chapter 23. Other File Systems
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/filesystems/#filesystems-synopsis">23.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/filesystems/#filesystems-linux">23.2. Linux® File Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-ae23289d4b6415f3f878893f9d3ef9b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-ae23289d4b6415f3f878893f9d3ef9b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/virtualization/">
              Chapter 24. Virtualization
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-synopsis">24.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-parallelsdesktop">24.2. FreeBSD as a Guest on Parallels Desktop for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-vmware">24.3. FreeBSD as a Guest on VMware Fusion for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-guest-virtualbox">24.4. FreeBSD as a Guest on VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-virtualbox">24.5. FreeBSD as a Host with VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-bhyve">24.6. FreeBSD as a Host with bhyve</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/virtualization/#virtualization-host-xen">24.7. FreeBSD as a Xen™-Host</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-b279d2b738963a45a059268d2fae00d5" class="toggle"  />
          <label  class="icon cursor"  for="chapter-b279d2b738963a45a059268d2fae00d5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/l10n/">
              Chapter 25. Localization - i18n/L10n Usage and Setup
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#l10n-synopsis">25.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#using-localization">25.2. Using Localization</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#l10n-compiling">25.3. Finding i18n Applications</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/l10n/#lang-setup">25.4. Locale Configuration for Specific Languages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9e3f99bd76c861ab2e9a5f31ac421842" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9e3f99bd76c861ab2e9a5f31ac421842"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/">
              Chapter 26. Updating and Upgrading FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-synopsis">26.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate">26.2. FreeBSD Update</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-bootcode">26.3. Updating Bootcode</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#updating-upgrading-documentation">26.4. Updating the Documentation Set</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#current-stable">26.5. Tracking a Development Branch</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#makeworld">26.6. Updating FreeBSD from Source</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#small-lan">26.7. Tracking for Multiple Machines</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/cutting-edge/#building-on-non-freebsd-hosts">26.8. Building on non-FreeBSD Hosts</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3ba999091575eb04ae88235cd0fb1afa" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3ba999091575eb04ae88235cd0fb1afa"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/dtrace/">
              Chapter 27. DTrace
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-synopsis">27.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-implementation">27.2. Implementation Differences</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-enable">27.3. Enabling DTrace Support</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/dtrace/#dtrace-using">27.4. Using DTrace</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bdb217202a0a3eef4571dd1fcd50863c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bdb217202a0a3eef4571dd1fcd50863c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/">
              Chapter 28. USB Device Mode / USB OTG
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-synopsis">28.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-terminals">28.2. USB Virtual Serial Ports</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-network">28.3. USB Device Mode Network Interfaces</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/usb-device-mode/#usb-device-mode-storage">28.4. USB Virtual Storage Device</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6d4439926bb106ac084ecc88cfd3cfa4" class="toggle"  />
          <label  for="chapter-6d4439926bb106ac084ecc88cfd3cfa4"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partiv/">
              Part IV. Network Communication
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-05a353fcb61d8e035f7c43e14725766e" class="toggle"  />
          <label  class="icon cursor"  for="chapter-05a353fcb61d8e035f7c43e14725766e"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/">
              Chapter 29. Serial Communications
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serial-synopsis">29.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serial">29.2. Serial Terminology and Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#term">29.3. Terminals</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#dialup">29.4. Dial-in Service</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#dialout">29.5. Dial-out Service</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/serialcomms/#serialconsole-setup">29.6. Setting Up the Serial Console</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/">
              Chapter 30. PPP
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis">30.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#userppp">30.2. Configuring PPP</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#ppp-troubleshoot">30.3. Troubleshooting PPP Connections</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#pppoe">30.4. Using PPP over Ethernet (PPPoE)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/ppp-and-slip/#pppoa">30.5. Using PPP over ATM (PPPoA)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9d023b545804f197d195dd9412749943" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9d023b545804f197d195dd9412749943"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mail/">
              Chapter 31. Electronic Mail
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-synopsis">31.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-using">31.2. Mail Components</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#dragonFly-mail-agent">31.3. DragonFly Mail Agent (DMA)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#sendmail">31.4. Sendmail</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-changingmta">31.5. Changing the Mail Transfer Agent</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-agents">31.6. Mail User Agents</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mail/#mail-advanced">31.7. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-42b19e05d30c4135c74b9878818747a9" class="toggle"  checked  />
          <label  class="icon cursor"  for="chapter-42b19e05d30c4135c74b9878818747a9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/network-servers/">
              Chapter 32. Network Servers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-servers-synopsis">32.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-inetd">32.2. The inetd Super-Server</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-nfs">32.3. Network File System (NFS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-nis">32.4. Network Information System (NIS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-dns">32.7. Domain Name System (DNS)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-apache">32.8. Apache HTTP Server</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ftp">32.9. File Transfer Protocol (FTP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-ntp">32.11. Clock Synchronization with NTP</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/network-servers/#network-iscsi">32.12. iSCSI Initiator and Target Configuration</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9554a5177d00d0e87ada408809a1fc67" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9554a5177d00d0e87ada408809a1fc67"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/firewalls/">
              Chapter 33. Firewalls
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-intro">33.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-concepts">33.2. Firewall Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-pf">33.3. PF</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-ipfw">33.4. IPFW</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-ipf">33.5. IPFILTER (IPF)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/firewalls/#firewalls-blacklistd">33.6. Blacklistd</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9903a1d844ed803a436595e93ec33572" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9903a1d844ed803a436595e93ec33572"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/">
              Chapter 34. Advanced Networking
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#advanced-networking-synopsis">34.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-routing">34.2. Gateways and Routes</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#configtuning-virtual-hosts">34.3. Virtual Hosts</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-advanced-wireless">34.4. Wireless Advanced Authentication</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#wireless-ad-hoc-mode">34.5. Wireless Ad-hoc Mode</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-usb-tethering">34.6. USB Tethering</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-bluetooth">34.7. Bluetooth</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-bridging">34.8. Bridging</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-aggregation">34.9. Link Aggregation and Failover</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-diskless">34.10. Diskless Operation with PXE</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#carp">34.11. Common Address Redundancy Protocol (CARP)</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/advanced-networking/#network-vlan">34.12. VLANs</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ca29f99c249993ee9234cb4632af7a5" class="toggle"  />
          <label  for="chapter-8ca29f99c249993ee9234cb4632af7a5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/partv/">
              Part V. Appendices
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0229d553ebf23ffeb945be6f32836221" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0229d553ebf23ffeb945be6f32836221"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/mirrors/">
              Appendix A. Obtaining FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#mirrors">A.1. Mirrors</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#git">A.2. Using Git</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#svn">A.3. Using Subversion</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/mirrors/#mirrors-cdrom">A.4. CD and DVD Sets</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-743c99fa278b8138914ff018e40c9231" class="toggle"  />
          <label  class="icon cursor"  for="chapter-743c99fa278b8138914ff018e40c9231"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/bibliography/">
              Appendix B. Bibliography
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-freebsd">B.1. FreeBSD Bibliography</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-security">B.2. Security Reference</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-history">B.3. UNIX® History</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/bibliography/#bibliography-journals">B.4. Periodicals, Journals, and Magazines</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-de7eade4b8b64f298c0cbac44c2278da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-de7eade4b8b64f298c0cbac44c2278da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/eresources/">
              Appendix C. Resources on the Internet
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-www">C.1. Websites</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-mail">C.2. Mailing Lists</a></li>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/eresources/#eresources-news">C.3. Usenet Newsgroups</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/pgpkeys/">
              Appendix D. OpenPGP Keys
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/en/books/handbook/pgpkeys/#pgpkeys-officers">D.1. Officers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-2a8deedf14429128049622ec007c9d3f" class="toggle"  />
          <label  for="chapter-2a8deedf14429128049622ec007c9d3f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/glossary/">
              FreeBSD Glossary
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-110dbb242491bf200e51e76db171f670" class="toggle"  />
          <label  for="chapter-110dbb242491bf200e51e76db171f670"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/colophon/">
              Colophon
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-caffbcba74982e4b26b9263ac0232bc3" class="toggle"  />
          <label  for="chapter-caffbcba74982e4b26b9263ac0232bc3"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/en/books/handbook/introduction/">
              
            </a>
            
            
          

        
      </li>
    
      <li>
        
      </li>
    
  </ul>


      </nav>
    </div>
  </aside>
  
  <div class="book">
    
    <div class="book-menu-mobile">
      <label for="menu-control">
        <span class="menu-control-button">
          <i class="fa fa-list" aria-hidden="true" title="Book menu"></i>
          Book menu
        </span>
      </label>
    </div>
    
    <h1 class="title">Chapter 32. Network Servers</h1>
    
    
    
    
    <div class="toc-mobile">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#network-servers-synopsis">32.1. Synopsis</a></li>
    <li><a href="#network-inetd">32.2. The inetd Super-Server</a></li>
    <li><a href="#network-nfs">32.3. Network File System (NFS)</a></li>
    <li><a href="#network-nis">32.4. Network Information System (NIS)</a></li>
    <li><a href="#network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="#network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="#network-dns">32.7. Domain Name System (DNS)</a></li>
    <li><a href="#network-apache">32.8. Apache HTTP Server</a></li>
    <li><a href="#network-ftp">32.9. File Transfer Protocol (FTP)</a></li>
    <li><a href="#network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="#network-ntp">32.11. Clock Synchronization with NTP</a></li>
    <li><a href="#network-iscsi">32.12. iSCSI Initiator and Target Configuration</a></li>
  </ul>
</nav>
    </div>
    
      
      
    
    <div class="book-content">
      <div id="preamble">
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="network-servers-synopsis">32.1. Synopsis<a class="anchor" href="#network-servers-synopsis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter covers some of the more frequently used network services on UNIX® systems.
This includes installing, configuring, testing, and maintaining many different types of network services.
Example configuration files are included throughout this chapter for reference.</p>
</div>
<div class="paragraph">
<p>By the end of this chapter, readers will know:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to manage the inetd daemon.</p>
</li>
<li>
<p>How to set up the Network File System (NFS).</p>
</li>
<li>
<p>How to set up the Network Information Server (NIS) for centralizing and sharing user accounts.</p>
</li>
<li>
<p>How to set FreeBSD up to act as an LDAP server or client</p>
</li>
<li>
<p>How to set up automatic network settings using DHCP.</p>
</li>
<li>
<p>How to set up a Domain Name Server (DNS).</p>
</li>
<li>
<p>How to set up the Apache HTTP Server.</p>
</li>
<li>
<p>How to set up a File Transfer Protocol (FTP) server.</p>
</li>
<li>
<p>How to set up a file and print server for Windows® clients using Samba.</p>
</li>
<li>
<p>How to synchronize the time and date, and set up a time server using the Network Time Protocol (NTP).</p>
</li>
<li>
<p>How to set up iSCSI.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter assumes a basic knowledge of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="filename">/etc/rc</span> scripts.</p>
</li>
<li>
<p>Network terminology.</p>
</li>
<li>
<p>Installation of additional third-party software (<a href="../ports/#ports">Installing Applications: Packages and Ports</a>).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-inetd">32.2. The inetd Super-Server<a class="anchor" href="#network-inetd"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> daemon is sometimes referred to as a Super-Server because it manages connections for many services.
Instead of starting multiple applications, only the inetd service needs to be started.
When a connection is received for a service that is managed by inetd, it determines which program the connection is destined for, spawns a process for that program, and delegates the program a socket.
Using inetd for services that are not heavily used can reduce system load, when compared to running each daemon individually in stand-alone mode.</p>
</div>
<div class="paragraph">
<p>Primarily, inetd is used to spawn other daemons, but several trivial protocols are handled internally, such as chargen, auth, time, echo, discard, and daytime.</p>
</div>
<div class="paragraph">
<p>This section covers the basics of configuring inetd.</p>
</div>
<div class="sect2">
<h3 id="network-inetd-conf">32.2.1. Configuration File<a class="anchor" href="#network-inetd-conf"></a></h3>
<div class="paragraph">
<p>Configuration of inetd is done by editing <span class="filename">/etc/inetd.conf</span>.
Each line of this configuration file represents an application which can be started by inetd.
By default, every line starts with a comment (<code>#</code>), meaning that inetd is not listening for any applications.
To configure inetd to listen for an application’s connections, remove the <code>#</code> at the beginning of the line for that application.</p>
</div>
<div class="paragraph">
<p>After saving your edits, configure inetd to start at system boot by editing <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>inetd_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>To start inetd now, so that it listens for the service you configured, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service inetd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once inetd is started, it needs to be notified whenever a modification is made to <span class="filename">/etc/inetd.conf</span>:</p>
</div>
<div id="network-inetd-reread" class="exampleblock">
<div class="title">Example 1. Reloading the inetd Configuration File</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service inetd reload</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Typically, the default entry for an application does not need to be edited beyond removing the <code>#</code>.
In some situations, it may be appropriate to edit the default entry.</p>
</div>
<div class="paragraph">
<p>As an example, this is the default entry for <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> over IPv4:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre>
</div>
</div>
<div class="paragraph">
<p>The seven columns in an entry are as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>service-name
socket-type
protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments</pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">service-name</dt>
<dd>
<p>The service name of the daemon to start.
It must correspond to a service listed in <span class="filename">/etc/services</span>.
This determines which port inetd listens on for incoming connections to that service.
When using a custom service, it must first be added to <span class="filename">/etc/services</span>.</p>
</dd>
<dt class="hdlist1">socket-type</dt>
<dd>
<p>Either <code>stream</code>, <code>dgram</code>, <code>raw</code>, or <code>seqpacket</code>.
Use <code>stream</code> for TCP connections and <code>dgram</code> for UDP services.</p>
</dd>
<dt class="hdlist1">protocol</dt>
<dd>
<p>Use one of the following protocol names:</p>
<table class="tableblock frame-none grid-all stretch informaltable">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Protocol Name</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp or tcp4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP IPv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">udp or udp4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP IPv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP IPv6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">udp6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UDP IPv6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp46</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both TCP IPv4 and IPv6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">udp46</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both UDP IPv4 and IPv6</p></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</dt>
<dd>
<p>In this field, <code>wait</code> or <code>nowait</code> must be specified.
<code>max-child</code>, <code>max-connections-per-ip-per-minute</code> and <code>max-child-per-ip</code> are optional.</p>
<div class="paragraph">
<p><code>wait|nowait</code> indicates whether or not the service is able to handle its own socket.
<code>dgram</code> socket types must use <code>wait</code> while <code>stream</code> daemons, which are usually multi-threaded, should use <code>nowait</code>.
<code>wait</code> usually hands off multiple sockets to a single daemon, while <code>nowait</code> spawns a child daemon for each new socket.</p>
</div>
<div class="paragraph">
<p>The maximum number of child daemons inetd may spawn is set by <code>max-child</code>.
For example, to limit ten instances of the daemon, place a <code>/10</code> after <code>nowait</code>.
Specifying <code>/0</code> allows an unlimited number of children.</p>
</div>
<div class="paragraph">
<p><code>max-connections-per-ip-per-minute</code> limits the number of connections from any particular IP address per minute.
Once the limit is reached, further connections from this IP address will be dropped until the end of the minute.
For example, a value of <code>/10</code> would limit any particular IP address to ten connection attempts per minute.
<code>max-child-per-ip</code> limits the number of child processes that can be started on behalf on any single IP address at any moment.
These options can limit excessive resource consumption and help to prevent Denial of Service attacks.</p>
</div>
<div class="paragraph">
<p>An example can be seen in the default settings for <a href="https://man.freebsd.org/cgi/man.cgi?query=fingerd&amp;sektion=8&amp;format=html">fingerd(8)</a>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -k -s</pre>
</div>
</div>
</dd>
<dt class="hdlist1">user</dt>
<dd>
<p>The username the daemon will run as.
Daemons typically run as <code>root</code>, <code>daemon</code>, or <code>nobody</code>.</p>
</dd>
<dt class="hdlist1">server-program</dt>
<dd>
<p>The full path to the daemon.
If the daemon is a service provided by inetd internally, use <code>internal</code>.</p>
</dd>
<dt class="hdlist1">server-program-arguments</dt>
<dd>
<p>Used to specify any command arguments to be passed to the daemon on invocation.
If the daemon is an internal service, use <code>internal</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="network-inetd-cmdline">32.2.2. Command-Line Options<a class="anchor" href="#network-inetd-cmdline"></a></h3>
<div class="paragraph">
<p>Like most server daemons, inetd has a number of options that can be used to modify its behavior.
By default, inetd is started with <code>-wW -C 60</code>.
These options enable TCP wrappers for all services, including internal services, and prevent any IP address from requesting any service more than 60 times per minute.</p>
</div>
<div class="paragraph">
<p>To change the default options which are passed to inetd, add an entry for <code>inetd_flags</code> in <span class="filename">/etc/rc.conf</span>.
If inetd is already running, restart it with <code>service inetd restart</code>.</p>
</div>
<div class="paragraph">
<p>The available rate limiting options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">-c maximum</dt>
<dd>
<p>Specify the default maximum number of simultaneous invocations of each service, where the default is unlimited.
May be overridden on a per-service basis by using <code>max-child</code> in <span class="filename">/etc/inetd.conf</span>.</p>
</dd>
<dt class="hdlist1">-C rate</dt>
<dd>
<p>Specify the default maximum number of times a service can be invoked from a single IP address per minute.
May be overridden on a per-service basis by using <code>max-connections-per-ip-per-minute</code> in <span class="filename">/etc/inetd.conf</span>.</p>
</dd>
<dt class="hdlist1">-R rate</dt>
<dd>
<p>Specify the maximum number of times a service can be invoked in one minute, where the default is <code>256</code>.
A rate of <code>0</code> allows an unlimited number.</p>
</dd>
<dt class="hdlist1">-s maximum</dt>
<dd>
<p>Specify the maximum number of times a service can be invoked from a single IP address at any one time, where the default is unlimited.
May be overridden on a per-service basis by using <code>max-child-per-ip</code> in <span class="filename">/etc/inetd.conf</span>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Additional options are available. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> for the full list of options.</p>
</div>
</div>
<div class="sect2">
<h3 id="network-inetd-security">32.2.3. Security Considerations<a class="anchor" href="#network-inetd-security"></a></h3>
<div class="paragraph">
<p>Many of the daemons which can be managed by inetd are not security-conscious.
Some daemons, such as fingerd, can provide information that may be useful to an attacker.
Only enable the services which are needed and monitor the system for excessive connection attempts.
<code>max-connections-per-ip-per-minute</code>, <code>max-child</code> and <code>max-child-per-ip</code> can be used to limit such attacks.</p>
</div>
<div class="paragraph">
<p>By default, TCP wrappers are enabled.
Consult <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> for more information on placing TCP restrictions on various inetd invoked daemons.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-nfs">32.3. Network File System (NFS)<a class="anchor" href="#network-nfs"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>FreeBSD supports the Network File System (NFS), which allows a server to share directories and files with clients over a network.
With NFS, users and programs can access files on remote systems as if they were stored locally.</p>
</div>
<div class="paragraph">
<p>NFS has many practical uses.
Some of the more common uses include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data that would otherwise be duplicated on each client can be kept in a single location and accessed by clients on the network.</p>
</li>
<li>
<p>Several clients may need access to the <span class="filename">/usr/ports/distfiles</span> directory. Sharing that directory allows for quick access to the source files without having to download them to each client.</p>
</li>
<li>
<p>On large networks, it is often more convenient to configure a central NFS server on which all user home directories are stored. Users can log into a client anywhere on the network and have access to their home directories.</p>
</li>
<li>
<p>Administration of NFS exports is simplified. For example, there is only one file system where security or backup policies must be set.</p>
</li>
<li>
<p>Removable media storage devices can be used by other machines on the network. This reduces the number of devices throughout the network and provides a centralized location to manage their security. It is often more convenient to install software on multiple machines from a centralized installation media.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>NFS consists of a server and one or more clients.
The client remotely accesses the data that is stored on the server machine.
In order for this to function properly, a few processes have to be configured and running.</p>
</div>
<div class="paragraph">
<p>These daemons must be running on the server:</p>
</div>
<table class="tableblock frame-none grid-all stretch informaltable">
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Daemon</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nfsd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The NFS daemon which services requests from NFS clients.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mountd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The NFS mount daemon which carries out requests received from nfsd.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rpcbind</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This daemon allows NFS clients to discover which port the NFS server is using.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Running <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsiod&amp;sektion=8&amp;format=html">nfsiod(8)</a> on the client can improve performance, but is not required.</p>
</div>
<div class="sect2">
<h3 id="network-configuring-nfs">32.3.1. Configuring the Server<a class="anchor" href="#network-configuring-nfs"></a></h3>
<div class="paragraph">
<p>The file systems which the NFS server will share are specified in <span class="filename">/etc/exports</span>.
Each line in this file specifies a file system to be exported, which clients have access to that file system, and any access options.
When adding entries to this file, each exported file system, its properties, and allowed hosts must occur on a single line.
If no clients are listed in the entry, then any client on the network can mount that file system.</p>
</div>
<div class="paragraph">
<p>The following <span class="filename">/etc/exports</span> entries demonstrate how to export file systems.
The examples can be modified to match the file systems and client names on the reader’s network.
There are many options that can be used in this file, but only a few will be mentioned here.
See <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a> for the full list of options.</p>
</div>
<div class="paragraph">
<p>This example shows how to export <span class="filename">/cdrom</span> to three hosts named <em>alpha</em>, <em>bravo</em>, and <em>charlie</em>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>/cdrom -ro alpha bravo charlie</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-ro</code> flag makes the file system read-only, preventing clients from making any changes to the exported file system.
This example assumes that the host names are either in DNS or in <span class="filename">/etc/hosts</span>.
Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> if the network does not have a DNS server.</p>
</div>
<div class="paragraph">
<p>The next example exports <span class="filename">/home</span> to three clients by IP address.
This can be useful for networks without DNS or <span class="filename">/etc/hosts</span> entries.
The <code>-alldirs</code> flag allows subdirectories to be mount points.
In other words, it will not automatically mount the subdirectories, but will permit the client to mount the directories that are required as needed.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>/usr/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre>
</div>
</div>
<div class="paragraph">
<p>This next example exports <span class="filename">/a</span> so that two clients from different domains may access that file system.
The <code>-maproot=root</code> allows <code>root</code> on the remote system to write data on the exported file system as <code>root</code>.
If <code>-maproot=root</code> is not specified, the client’s <code>root</code> user will be mapped to the server’s <code>nobody</code> account and will be subject to the access limitations defined for <code>nobody</code>.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>/a  -maproot=root  host.example.com box.example.org</pre>
</div>
</div>
<div class="paragraph">
<p>A client can only be specified once per file system.
For example, if <span class="filename">/usr</span> is a single file system, these entries would be invalid as both entries specify the same host:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Invalid when /usr is one file system
/usr/src   client
/usr/ports client</pre>
</div>
</div>
<div class="paragraph">
<p>The correct format for this situation is to use one entry:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>/usr/src /usr/ports  client</pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of a valid export list, where <span class="filename">/usr</span> and <span class="filename">/exports</span> are local file systems:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Export src and ports to client01 and client02, but only
# client01 has root privileges on it
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports               client02
# The client machines have root and can mount anywhere
# on /exports. Anyone in the world can mount /exports/obj read-only
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre>
</div>
</div>
<div class="paragraph">
<p>To enable the processes required by the NFS server at boot time, add these options to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>rpcbind_enable=&#34;YES&#34;
nfs_server_enable=&#34;YES&#34;
mountd_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>The server can be started now by running this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service nfsd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Whenever the NFS server is started, mountd also starts automatically.
However, mountd only reads <span class="filename">/etc/exports</span> when it is started.
To make subsequent <span class="filename">/etc/exports</span> edits take effect immediately, force mountd to reread it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service mountd reload</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsv4&amp;sektion=4&amp;format=html">nfsv4(4)</a> for a description of an NFS Version 4 setup.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_client">32.3.2. Configuring the Client<a class="anchor" href="#_configuring_the_client"></a></h3>
<div class="paragraph">
<p>To enable NFS clients, set this option in each client’s <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>nfs_client_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Then, run this command on each NFS client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service nfsclient start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The client now has everything it needs to mount a remote file system.
In these examples, the server’s name is <code>server</code> and the client’s name is <code>client</code>.
To mount <span class="filename">/home</span> on <code>server</code> to the <span class="filename">/mnt</span> mount point on <code>client</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mount server:/home /mnt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The files and directories in <span class="filename">/home</span> will now be available on <code>client</code>, in the <span class="filename">/mnt</span> directory.</p>
</div>
<div class="paragraph">
<p>To mount a remote file system each time the client boots, add it to <span class="filename">/etc/fstab</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>server:/home	/mnt	nfs	rw	0	0</pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> for a description of all available options.</p>
</div>
</div>
<div class="sect2">
<h3 id="_locking">32.3.3. Locking<a class="anchor" href="#_locking"></a></h3>
<div class="paragraph">
<p>Some applications require file locking to operate correctly.
To enable locking, execute the following command on both the client and server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysrc rpc_lockd_enable=&#34;YES&#34;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then start the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service lockd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If locking is not required on the server, the NFS client can be configured to lock locally by including <code>-L</code> when running mount.
Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> for further details.</p>
</div>
</div>
<div class="sect2">
<h3 id="network-autofs">32.3.4. Automating Mounts with <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a><a class="anchor" href="#network-autofs"></a></h3>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> automount facility is supported starting with FreeBSD 10.1-RELEASE.
To use the automounter functionality in older versions of FreeBSD, use <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> instead.
This chapter only describes the <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> automounter.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> facility is a common name for several components that, together, allow for automatic mounting of remote and local filesystems whenever a file or directory within that file system is accessed.
It consists of the kernel component, <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a>, and several userspace applications: <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a>.
It serves as an alternative for <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> from previous FreeBSD releases.
amd is still provided for backward compatibility purposes, as the two use different map formats; the one used by autofs is the same as with other SVR4 automounters, such as the ones in Solaris, MacOS X, and Linux.</p>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> virtual filesystem is mounted on specified mountpoints by <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, usually invoked during boot.</p>
</div>
<div class="paragraph">
<p>Whenever a process attempts to access a file within the <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> mountpoint, the kernel will notify <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> daemon and pause the triggering process.
The <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> daemon will handle kernel requests by finding the proper map and mounting the filesystem according to it, then signal the kernel to release blocked process.
The <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a> daemon automatically unmounts automounted filesystems after some time, unless they are still being used.</p>
</div>
<div class="paragraph">
<p>The primary autofs configuration file is <span class="filename">/etc/auto_master</span>. It assigns individual maps to top-level mounts.
For an explanation of <span class="filename">auto_master</span> and the map syntax, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=auto_master&amp;sektion=5&amp;format=html">auto_master(5)</a>.</p>
</div>
<div class="paragraph">
<p>There is a special automounter map mounted on <span class="filename">/net</span>.
When a file is accessed within this directory, <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> looks up the corresponding remote mount and automatically mounts it.
For instance, an attempt to access a file within <span class="filename">/net/foobar/usr</span> would tell <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> to mount the <span class="filename">/usr</span> export from the host <code>foobar</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Mounting an Export with <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a></div>
<div class="content">
<div class="paragraph">
<p>In this example, <code>showmount -e</code> shows the exported file systems that can be mounted from the NFS server, <code>foobar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>showmount -e foobar
Exports list on foobar:
/usr                               10.10.10.0
/a                                 10.10.10.0
<span class="gp">% </span><span class="nb">cd</span> /net/foobar/usr</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The output from <code>showmount</code> shows <span class="filename">/usr</span> as an export.
When changing directories to <span class="filename">/host/foobar/usr</span>, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> intercepts the request and attempts to resolve the hostname <code>foobar</code>.
If successful, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> automatically mounts the source export.</p>
</div>
<div class="paragraph">
<p>To enable <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> at boot time, add this line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>autofs_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Then <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> can be started by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service automount start</span>
<span class="c"># service automountd start</span>
<span class="c"># service autounmountd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> map format is the same as in other operating systems.
Information about this format from other sources can be useful, like the <a href="http://web.archive.org/web/20160813071113/http://images.apple.com/business/docs/Autofs.pdf">Mac OS X document</a>.</p>
</div>
<div class="paragraph">
<p>Consult the <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a>, and <a href="https://man.freebsd.org/cgi/man.cgi?query=auto_master&amp;sektion=5&amp;format=html">auto_master(5)</a> manual pages for more information.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-nis">32.4. Network Information System (NIS)<a class="anchor" href="#network-nis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Network Information System (NIS) is designed to centralize administration of UNIX®-like systems such as Solaris™, HP-UX, AIX®, Linux, NetBSD, OpenBSD, and FreeBSD.
NIS was originally known as Yellow Pages but the name was changed due to trademark issues.
This is the reason why NIS commands begin with <code>yp</code>.</p>
</div>
<div class="paragraph">
<p>NIS is a Remote Procedure Call (RPC)-based client/server system that allows a group of machines within an NIS domain to share a common set of configuration files.
This permits a system administrator to set up NIS client systems with only minimal configuration data and to add, remove, or modify configuration data from a single location.</p>
</div>
<div class="paragraph">
<p>FreeBSD uses version 2 of the NIS protocol.</p>
</div>
<div class="sect2">
<h3 id="_nis_terms_and_processes">32.4.1. NIS Terms and Processes<a class="anchor" href="#_nis_terms_and_processes"></a></h3>
<div class="paragraph">
<p>Table 28.1 summarizes the terms and important processes used by NIS:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<caption class="title">Table 1. NIS Terminology</caption>
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIS domain name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIS servers and clients share an NIS domain name. Typically, this name does not have anything to do with DNS.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://man.freebsd.org/cgi/man.cgi?query=rpcbind&amp;sektion=8&amp;format=html">rpcbind(8)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This service enables RPC and must be running in order to run an NIS server or act as an NIS client.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This service binds an NIS client to its NIS server. It will take the NIS domain name and use RPC to connect to the server. It is the core of client/server communication in an NIS environment. If this service is not running on a client machine, it will not be able to access the NIS server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the process for the NIS server. If this service stops running, the server will no longer be able to respond to NIS requests so hopefully, there is a slave server to take over. Some non-FreeBSD clients will not try to reconnect using a slave server and the ypbind process may need to be restarted on these clients.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.yppasswdd&amp;sektion=8&amp;format=html">rpc.yppasswdd(8)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This process only runs on NIS master servers. This daemon allows NIS clients to change their NIS passwords. If this daemon is not running, users will have to login to the NIS master server and change their passwords there.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_machine_types">32.4.2. Machine Types<a class="anchor" href="#_machine_types"></a></h3>
<div class="paragraph">
<p>There are three types of hosts in an NIS environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NIS master server</p>
<div class="paragraph">
<p>This server acts as a central repository for host configuration information and maintains the authoritative copy of the files used by all of the NIS clients.
The <span class="filename">passwd</span>, <span class="filename">group</span>, and other various files used by NIS clients are stored on the master server.
While it is possible for one machine to be an NIS master server for more than one NIS domain, this type of configuration will not be covered in this chapter as it assumes a relatively small-scale NIS environment.</p>
</div>
</li>
<li>
<p>NIS slave servers</p>
<div class="paragraph">
<p>NIS slave servers maintain copies of the NIS master’s data files in order to provide redundancy.
Slave servers also help to balance the load of the master server as NIS clients always attach to the NIS server which responds first.</p>
</div>
</li>
<li>
<p>NIS clients</p>
<div class="paragraph">
<p>NIS clients authenticate against the NIS server during log on.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Information in many files can be shared using NIS.
The <span class="filename">master.passwd</span>, <span class="filename">group</span>, and <span class="filename">hosts</span> files are commonly shared via NIS.
Whenever a process on a client needs information that would normally be found in these files locally, it makes a query to the NIS server that it is bound to instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_planning_considerations">32.4.3. Planning Considerations<a class="anchor" href="#_planning_considerations"></a></h3>
<div class="paragraph">
<p>This section describes a sample NIS environment which consists of 15 FreeBSD machines with no centralized point of administration.
Each machine has its own <span class="filename">/etc/passwd</span> and <span class="filename">/etc/master.passwd</span>.
These files are kept in sync with each other only through manual intervention.
Currently, when a user is added to the lab, the process must be repeated on all 15 machines.</p>
</div>
<div class="paragraph">
<p>The configuration of the lab will be as follows:</p>
</div>
<table class="tableblock frame-none grid-all stretch informaltable">
<colgroup>
<col style="width: 33.3333%;"/>
<col style="width: 33.3333%;"/>
<col style="width: 33.3334%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Machine name</th>
<th class="tableblock halign-left valign-top">IP address</th>
<th class="tableblock halign-left valign-top">Machine role</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ellington</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIS master</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>coltrane</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NIS slave</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>basie</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Faculty workstation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bird</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cli[1-11]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.[6-17]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other client machines</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If this is the first time an NIS scheme is being developed, it should be thoroughly planned ahead of time.
Regardless of network size, several decisions need to be made as part of the planning process.</p>
</div>
<div class="sect3">
<h4 id="_choosing_a_nis_domain_name">32.4.3.1. Choosing a NIS Domain Name<a class="anchor" href="#_choosing_a_nis_domain_name"></a></h4>
<div class="paragraph">
<p>When a client broadcasts its requests for info, it includes the name of the NIS domain that it is part of.
This is how multiple servers on one network can tell which server should answer which request.
Think of the NIS domain name as the name for a group of hosts.</p>
</div>
<div class="paragraph">
<p>Some organizations choose to use their Internet domain name for their NIS domain name.
This is not recommended as it can cause confusion when trying to debug network problems.
The NIS domain name should be unique within the network and it is helpful if it describes the group of machines it represents.
For example, the Art department at Acme Inc. might be in the &#34;acme-art&#34; NIS domain.
This example will use the domain name <code>test-domain</code>.</p>
</div>
<div class="paragraph">
<p>However, some non-FreeBSD operating systems require the NIS domain name to be the same as the Internet domain name.
If one or more machines on the network have this restriction, the Internet domain name <em>must</em> be used as the NIS domain name.</p>
</div>
</div>
<div class="sect3">
<h4 id="_physical_server_requirements">32.4.3.2. Physical Server Requirements<a class="anchor" href="#_physical_server_requirements"></a></h4>
<div class="paragraph">
<p>There are several things to keep in mind when choosing a machine to use as a NIS server.
Since NIS clients depend upon the availability of the server, choose a machine that is not rebooted frequently.
The NIS server should ideally be a stand alone machine whose sole purpose is to be an NIS server.
If the network is not heavily used, it is acceptable to put the NIS server on a machine running other services.
However, if the NIS server becomes unavailable, it will adversely affect all NIS clients.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_nis_master_server">32.4.4. Configuring the NIS Master Server<a class="anchor" href="#_configuring_the_nis_master_server"></a></h3>
<div class="paragraph">
<p>The canonical copies of all NIS files are stored on the master server.
The databases used to store the information are called NIS maps.
In FreeBSD, these maps are stored in <span class="filename">/var/yp/[domainname]</span> where <span class="filename">[domainname]</span> is the name of the NIS domain.
Since multiple domains are supported, it is possible to have several directories, one for each domain.
Each domain will have its own independent set of maps.</p>
</div>
<div class="paragraph">
<p>NIS master and slave servers handle all NIS requests through <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a>.
This daemon is responsible for receiving incoming requests from NIS clients, translating the requested domain and map name to a path to the corresponding database file, and transmitting data from the database back to the client.</p>
</div>
<div class="paragraph">
<p>Setting up a master NIS server can be relatively straight forward, depending on environmental needs.
Since FreeBSD provides built-in NIS support, it only needs to be enabled by adding the following lines to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>nisdomainname=&#34;test-domain&#34;	<i class="conum" data-value="1"></i><b>(1)</b>
nis_server_enable=&#34;YES&#34;		<i class="conum" data-value="2"></i><b>(2)</b>
nis_yppasswdd_enable=&#34;YES&#34;	<i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This line sets the NIS domain name to <code>test-domain</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This automates the start up of the NIS server processes when the system boots.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This enables the <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.yppasswdd&amp;sektion=8&amp;format=html">rpc.yppasswdd(8)</a> daemon so that users can change their NIS password from a client machine.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Care must be taken in a multi-server domain where the server machines are also NIS clients.
It is generally a good idea to force the servers to bind to themselves rather than allowing them to broadcast bind requests and possibly become bound to each other.
Strange failure modes can result if one server goes down and others are dependent upon it.
Eventually, all the clients will time out and attempt to bind to other servers, but the delay involved can be considerable and the failure mode is still present since the servers might bind to each other all over again.</p>
</div>
<div class="paragraph">
<p>A server that is also a client can be forced to bind to a particular server by adding these additional lines to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>nis_client_enable=&#34;YES&#34;				<i class="conum" data-value="1"></i><b>(1)</b>
nis_client_flags=&#34;-S test-domain,server&#34;	<i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This enables running client stuff as well.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This line sets the NIS domain name to <code>test-domain</code> and bind to itself.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>After saving the edits, type <code>/etc/netstart</code> to restart the network and apply the values defined in <span class="filename">/etc/rc.conf</span>.
Before initializing the NIS maps, start <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service ypserv start</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_initializing_the_nis_maps">32.4.4.1. Initializing the NIS Maps<a class="anchor" href="#_initializing_the_nis_maps"></a></h4>
<div class="paragraph">
<p>NIS maps are generated from the configuration files in <span class="filename">/etc</span> on the NIS master, with one exception: <span class="filename">/etc/master.passwd</span>.
This is to prevent the propagation of passwords to all the servers in the NIS domain.
Therefore, before the NIS maps are initialized, configure the primary password files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cp /etc/master.passwd /var/yp/master.passwd</span>
<span class="c"># cd /var/yp</span>
<span class="c"># vi master.passwd</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is advisable to remove all entries for system accounts as well as any user accounts that do not need to be propagated to the NIS clients, such as the <code>root</code> and any other administrative accounts.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that the <span class="filename">/var/yp/master.passwd</span> is neither group or world readable by setting its permissions to <code>600</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>After completing this task, initialize the NIS maps.
FreeBSD includes the <a href="https://man.freebsd.org/cgi/man.cgi?query=ypinit&amp;sektion=8&amp;format=html">ypinit(8)</a> script to do this.
When generating maps for the master server, include <code>-m</code> and specify the NIS domain name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">ellington# </span>ypinit -m <span class="nb">test</span>-domain
Server Type: MASTER Domain: <span class="nb">test</span>-domain
Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.
Do you want this procedure to quit on non-fatal errors? <span class="o">[</span>y/n: n] n
Ok, please remember to go back and redo manually whatever fails.
If not, something might not work.
At this point, we have to construct a list of this domains YP servers.
rod.darktech.org is already known as master server.
Please <span class="k">continue </span>to add any slave servers, one per line. When you are
<span class="k">done </span>with the list, <span class="nb">type </span>a &lt;control D&gt;.
master server   :  ellington
next host to add:  coltrane
next host to add:  ^D
The current list of NIS servers looks like this:
ellington
coltrane
Is this correct?  <span class="o">[</span>y/n: y] y

<span class="o">[</span>..output from map generation..]

NIS Map update completed.
ellington has been setup as an YP master server without any errors.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create <span class="filename">/var/yp/Makefile</span> from <span class="filename">/var/yp/Makefile.dist</span>.
By default, this file assumes that the environment has a single NIS server with only FreeBSD clients.
Since <code>test-domain</code> has a slave server, edit this line in <span class="filename">/var/yp/Makefile</span> so that it begins with a comment (<code>#</code>):</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>NOPUSH = &#34;True&#34;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_new_users">32.4.4.2. Adding New Users<a class="anchor" href="#_adding_new_users"></a></h4>
<div class="paragraph">
<p>Every time a new user is created, the user account must be added to the master NIS server and the NIS maps rebuilt.
Until this occurs, the new user will not be able to login anywhere except on the NIS master.
For example, to add the new user <code>jsmith</code> to the <code>test-domain</code> domain, run these commands on the master server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pw useradd jsmith</span>
<span class="c"># cd /var/yp</span>
<span class="c"># make test-domain</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The user could also be added using <code>adduser jsmith</code> instead of <code>pw useradd smith</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_a_nis_slave_server">32.4.5. Setting up a NIS Slave Server<a class="anchor" href="#_setting_up_a_nis_slave_server"></a></h3>
<div class="paragraph">
<p>To set up an NIS slave server, log on to the slave server and edit <span class="filename">/etc/rc.conf</span> as for the master server.
Do not generate any NIS maps, as these already exist on the master server.
When running <code>ypinit</code> on the slave server, use <code>-s</code> (for slave) instead of <code>-m</code> (for master).
This option requires the name of the NIS master in addition to the domain name, as seen in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">coltrane# </span>ypinit -s ellington <span class="nb">test</span>-domain

Server Type: SLAVE Domain: <span class="nb">test</span>-domain Master: ellington

Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.

Do you want this procedure to quit on non-fatal errors? <span class="o">[</span>y/n: n]  n

Ok, please remember to go back and redo manually whatever fails.
If not, something might not work.
There will be no further questions. The remainder of the procedure
should take a few minutes, to copy the databases from ellington.
Transferring netgroup...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byuser...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byhost...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring group.bygid...
ypxfr: Exiting: Map successfully transferred
Transferring group.byname...
ypxfr: Exiting: Map successfully transferred
Transferring services.byname...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.byname...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.byname...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring netid.byname...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring ypservers...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byname...
ypxfr: Exiting: Map successfully transferred

coltrane has been setup as an YP slave server without any errors.
Remember to update map ypservers on ellington.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate a directory on the slave server called <span class="filename">/var/yp/test-domain</span> which contains copies of the NIS master server’s maps.
Adding these <span class="filename">/etc/crontab</span> entries on each slave server will force the slaves to sync their maps with the maps on the master server:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>20      *       *       *       *       root   /usr/libexec/ypxfr passwd.byname
21      *       *       *       *       root   /usr/libexec/ypxfr passwd.byuid</pre>
</div>
</div>
<div class="paragraph">
<p>These entries are not mandatory because the master server automatically attempts to push any map changes to its slaves.
However, since clients may depend upon the slave server to provide correct password information, it is recommended to force frequent password map updates.
This is especially important on busy networks where map updates might not always complete.</p>
</div>
<div class="paragraph">
<p>To finish the configuration, run <code>/etc/netstart</code> on the slave server in order to start the NIS services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_an_nis_client">32.4.6. Setting Up an NIS Client<a class="anchor" href="#_setting_up_an_nis_client"></a></h3>
<div class="paragraph">
<p>An NIS client binds to an NIS server using <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a>.
This daemon broadcasts RPC requests on the local network.
These requests specify the domain name configured on the client.
If an NIS server in the same domain receives one of the broadcasts, it will respond to ypbind, which will record the server’s address.
If there are several servers available, the client will use the address of the first server to respond and will direct all of its NIS requests to that server.
The client will automatically ping the server on a regular basis to make sure it is still available.
If it fails to receive a reply within a reasonable amount of time, ypbind will mark the domain as unbound and begin broadcasting again in the hopes of locating another server.</p>
</div>
<div class="paragraph">
<p>To configure a FreeBSD machine to be an NIS client:</p>
</div>
<div class="exampleblock procedure">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit <span class="filename">/etc/rc.conf</span> and add the following lines in order to set the NIS domain name and start <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a> during network startup:</p>
<div class="literalblock programlisting">
<div class="content">
<pre>nisdomainname=&#34;test-domain&#34;
nis_client_enable=&#34;YES&#34;</pre>
</div>
</div>
</li>
<li>
<p>To import all possible password entries from the NIS server, use <code>vipw</code> to remove all user accounts except one from <span class="filename">/etc/master.passwd</span>. When removing the accounts, keep in mind that at least one local account should remain and this account should be a member of <code>wheel</code>. If there is a problem with NIS, this local account can be used to log in remotely, become the superuser, and fix the problem. Before saving the edits, add the following line to the end of the file:</p>
<div class="literalblock programlisting">
<div class="content">
<pre>+:::::::::</pre>
</div>
</div>
<div class="paragraph">
<p>This line configures the client to provide anyone with a valid account in the NIS server’s password maps an account on the client.
There are many ways to configure the NIS client by modifying this line.
One method is described in <a href="#network-netgroups">Using Netgroups</a>.
For more detailed reading, refer to the book <code>Managing NFS and NIS</code>, published by O’Reilly Media.</p>
</div>
</li>
<li>
<p>To import all possible group entries from the NIS server, add this line to <span class="filename">/etc/group</span>:</p>
<div class="literalblock programlisting">
<div class="content">
<pre>+:*::</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>To start the NIS client immediately, execute the following commands as the superuser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># /etc/netstart</span>
<span class="c"># service ypbind start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After completing these steps, running <code>ypcat passwd</code> on the client should show the server’s <span class="filename">passwd</span> map.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nis_security">32.4.7. NIS Security<a class="anchor" href="#_nis_security"></a></h3>
<div class="paragraph">
<p>Since RPC is a broadcast-based service, any system running ypbind within the same domain can retrieve the contents of the NIS maps.
To prevent unauthorized transactions, <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> supports a feature called &#34;securenets&#34; which can be used to restrict access to a given set of hosts.
By default, this information is stored in <span class="filename">/var/yp/securenets</span>, unless <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> is started with <code>-p</code> and an alternate path.
This file contains entries that consist of a network specification and a network mask separated by white space.
Lines starting with <code>&#34;#&#34;</code> are considered to be comments.
A sample <span class="filename">securenets</span> might look like this:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># allow connections from local host -- mandatory
127.0.0.1     255.255.255.255
# allow connections from any host
# on the 192.168.128.0 network
192.168.128.0 255.255.255.0
# allow connections from any host
# between 10.0.0.0 to 10.0.15.255
# this includes the machines in the testlab
10.0.0.0      255.255.240.0</pre>
</div>
</div>
<div class="paragraph">
<p>If <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> receives a request from an address that matches one of these rules, it will process the request normally.
If the address fails to match a rule, the request will be ignored and a warning message will be logged.
If the <span class="filename">securenets</span> does not exist, <code>ypserv</code> will allow connections from any host.</p>
</div>
<div class="paragraph">
<p><a href="../security/#tcpwrappers">TCP Wrapper</a> is an alternate mechanism for providing access control instead of <span class="filename">securenets</span>.
While either access control mechanism adds some security, they are both vulnerable to &#34;IP spoofing&#34; attacks.
All NIS-related traffic should be blocked at the firewall.</p>
</div>
<div class="paragraph">
<p>Servers using <span class="filename">securenets</span> may fail to serve legitimate NIS clients with archaic TCP/IP implementations.
Some of these implementations set all host bits to zero when doing broadcasts or fail to observe the subnet mask when calculating the broadcast address.
While some of these problems can be fixed by changing the client configuration, other problems may force the retirement of these client systems or the abandonment of <span class="filename">securenets</span>.</p>
</div>
<div class="paragraph">
<p>The use of TCP Wrapper increases the latency of the NIS server.
The additional delay may be long enough to cause timeouts in client programs, especially in busy networks with slow NIS servers.
If one or more clients suffer from latency, convert those clients into NIS slave servers and force them to bind to themselves.</p>
</div>
<div class="sect3">
<h4 id="_barring_some_users">32.4.7.1. Barring Some Users<a class="anchor" href="#_barring_some_users"></a></h4>
<div class="paragraph">
<p>In this example, the <code>basie</code> system is a faculty workstation within the NIS domain.
The <span class="filename">passwd</span> map on the master NIS server contains accounts for both faculty and students.
This section demonstrates how to allow faculty logins on this system while refusing student logins.</p>
</div>
<div class="paragraph">
<p>To prevent specified users from logging on to a system, even if they are present in the NIS database, use <code>vipw</code> to add <code>-<em>username</em></code> with the correct number of colons towards the end of <span class="filename">/etc/master.passwd</span> on the client, where <em>username</em> is the username of a user to bar from logging in.
The line with the blocked user must be before the <code>+</code> line that allows NIS users.
In this example, <code>bill</code> is barred from logging on to <code>basie</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">basie# </span>cat /etc/master.passwd
root:[password]:0:0::0:0:The super-user:/root:/bin/csh
toor:[password]:0:0::0:0:The other super-user:/root:/bin/sh
daemon:<span class="k">*</span>:1:1::0:0:Owner of many system processes:/root:/usr/sbin/nologin
operator:<span class="k">*</span>:2:5::0:0:System &amp;:/:/usr/sbin/nologin
bin:<span class="k">*</span>:3:7::0:0:Binaries Commands and Source,,,:/:/usr/sbin/nologin
tty:<span class="k">*</span>:4:65533::0:0:Tty Sandbox:/:/usr/sbin/nologin
kmem:<span class="k">*</span>:5:65533::0:0:KMem Sandbox:/:/usr/sbin/nologin
games:<span class="k">*</span>:7:13::0:0:Games pseudo-user:/usr/games:/usr/sbin/nologin
news:<span class="k">*</span>:8:8::0:0:News Subsystem:/:/usr/sbin/nologin
man:<span class="k">*</span>:9:9::0:0:Mister Man Pages:/usr/share/man:/usr/sbin/nologin
<span class="nb">bind</span>:<span class="k">*</span>:53:53::0:0:Bind Sandbox:/:/usr/sbin/nologin
uucp:<span class="k">*</span>:66:66::0:0:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:<span class="k">*</span>:67:67::0:0:X-10 daemon:/usr/local/xten:/usr/sbin/nologin
pop:<span class="k">*</span>:68:6::0:0:Post Office Owner:/nonexistent:/usr/sbin/nologin
nobody:<span class="k">*</span>:65534:65534::0:0:Unprivileged user:/nonexistent:/usr/sbin/nologin
-bill:::::::::
+:::::::::

basie#</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="network-netgroups">32.4.8. Using Netgroups<a class="anchor" href="#network-netgroups"></a></h3>
<div class="paragraph">
<p>Barring specified users from logging on to individual systems becomes unscaleable on larger networks and quickly loses the main benefit of NIS: <em>centralized</em> administration.</p>
</div>
<div class="paragraph">
<p>Netgroups were developed to handle large, complex networks with hundreds of users and machines.
Their use is comparable to UNIX® groups, where the main difference is the lack of a numeric ID and the ability to define a netgroup by including both user accounts and other netgroups.</p>
</div>
<div class="paragraph">
<p>To expand on the example used in this chapter, the NIS domain will be extended to add the users and systems shown in Tables 28.2 and 28.3:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<caption class="title">Table 2. Additional Users</caption>
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User Name(s)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>alpha</code>, <code>beta</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IT department employees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>charlie</code>, <code>delta</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IT department apprentices</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>echo</code>, <code>foxtrott</code>, <code>golf</code>, …​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>able</code>, <code>baker</code>, …​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interns</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-none grid-all stretch">
<caption class="title">Table 3. Additional Systems</caption>
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Machine Name(s)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>war</code>, <code>death</code>, <code>famine</code>, <code>pollution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only IT employees are allowed to log onto these servers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pride</code>, <code>greed</code>, <code>envy</code>, <code>wrath</code>, <code>lust</code>, <code>sloth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All members of the IT department are allowed to login onto these servers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>one</code>, <code>two</code>, <code>three</code>, <code>four</code>, …​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ordinary workstations used by employees.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trashcan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A very old machine without any critical data. Even interns are allowed to use this system.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When using netgroups to configure this scenario, each user is assigned to one or more netgroups and logins are then allowed or forbidden for all members of the netgroup.
When adding a new machine, login restrictions must be defined for all netgroups.
When a new user is added, the account must be added to one or more netgroups.
If the NIS setup is planned carefully, only one central configuration file needs modification to grant or deny access to machines.</p>
</div>
<div class="paragraph">
<p>The first step is the initialization of the NIS`netgroup` map.
In FreeBSD, this map is not created by default.
On the NIS master server, use an editor to create a map named <span class="filename">/var/yp/netgroup</span>.</p>
</div>
<div class="paragraph">
<p>This example creates four netgroups to represent IT employees, IT apprentices, employees, and interns:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>IT_EMP  (,alpha,test-domain)    (,beta,test-domain)
IT_APP  (,charlie,test-domain)  (,delta,test-domain)
USERS   (,echo,test-domain)     (,foxtrott,test-domain) \
        (,golf,test-domain)
INTERNS (,able,test-domain)     (,baker,test-domain)</pre>
</div>
</div>
<div class="paragraph">
<p>Each entry configures a netgroup. The first column in an entry is the name of the netgroup.
Each set of parentheses represents either a group of one or more users or the name of another netgroup.
When specifying a user, the three comma-delimited fields inside each group represent:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The name of the host(s) where the other fields representing the user are valid. If a hostname is not specified, the entry is valid on all hosts.</p>
</li>
<li>
<p>The name of the account that belongs to this netgroup.</p>
</li>
<li>
<p>The NIS domain for the account. Accounts may be imported from other NIS domains into a netgroup.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a group contains multiple users, separate each user with whitespace.
Additionally, each field may contain wildcards.
See <a href="https://man.freebsd.org/cgi/man.cgi?query=netgroup&amp;sektion=5&amp;format=html">netgroup(5)</a> for details.</p>
</div>
<div class="paragraph">
<p>Netgroup names longer than 8 characters should not be used.
The names are case sensitive and using capital letters for netgroup names is an easy way to distinguish between user, machine and netgroup names.</p>
</div>
<div class="paragraph">
<p>Some non-FreeBSD NIS clients cannot handle netgroups containing more than 15 entries.
This limit may be circumvented by creating several sub-netgroups with 15 users or fewer and a real netgroup consisting of the sub-netgroups, as seen in this example:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>BIGGRP1  (,joe1,domain)  (,joe2,domain)  (,joe3,domain) [...]
BIGGRP2  (,joe16,domain)  (,joe17,domain) [...]
BIGGRP3  (,joe31,domain)  (,joe32,domain)
BIGGROUP  BIGGRP1 BIGGRP2 BIGGRP3</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat this process if more than 225 (15 times 15) users exist within a single netgroup.</p>
</div>
<div class="paragraph">
<p>To activate and distribute the new NIS map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">ellington# </span><span class="nb">cd</span> /var/yp
<span class="gp">ellington# </span>make</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate the three NIS maps <span class="filename">netgroup</span>, <span class="filename">netgroup.byhost</span> and <span class="filename">netgroup.byuser</span>.
Use the map key option of <a href="https://man.freebsd.org/cgi/man.cgi?query=ypcat&amp;sektion=1&amp;format=html">ypcat(1)</a> to check if the new NIS maps are available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">ellington% </span>ypcat -k netgroup
<span class="gp">ellington% </span>ypcat -k netgroup.byhost
<span class="gp">ellington% </span>ypcat -k netgroup.byuser</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of the first command should resemble the contents of <span class="filename">/var/yp/netgroup</span>.
The second command only produces output if host-specific netgroups were created.
The third command is used to get the list of netgroups for a user.</p>
</div>
<div class="paragraph">
<p>To configure a client, use <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> to specify the name of the netgroup.
For example, on the server named <code>war</code>, replace this line:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+:::::::::</pre>
</div>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+@IT_EMP:::::::::</pre>
</div>
</div>
<div class="paragraph">
<p>This specifies that only the users defined in the netgroup <code>IT_EMP</code> will be imported into this system’s password database and only those users are allowed to login to this system.</p>
</div>
<div class="paragraph">
<p>This configuration also applies to the <code>~</code> function of the shell and all routines which convert between user names and numerical user IDs.
In other words, <code>cd ~<em>user</em></code> will not work, <code>ls -l</code> will show the numerical ID instead of the username, and <code>find . -user joe -print</code> will fail with the message <code>No such user</code>.
To fix this, import all user entries without allowing them to login into the servers.
This can be achieved by adding an extra line:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+:::::::::/usr/sbin/nologin</pre>
</div>
</div>
<div class="paragraph">
<p>This line configures the client to import all entries but to replace the shell in those entries with <span class="filename">/usr/sbin/nologin</span>.</p>
</div>
<div class="paragraph">
<p>Make sure that extra line is placed <em>after</em> <code>+@IT_EMP:::::::::</code>.
Otherwise, all user accounts imported from NIS will have <span class="filename">/usr/sbin/nologin</span> as their login shell and no one will be able to login to the system.</p>
</div>
<div class="paragraph">
<p>To configure the less important servers, replace the old <code>+:::::::::</code> on the servers with these lines:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+@IT_EMP:::::::::
+@IT_APP:::::::::
+:::::::::/usr/sbin/nologin</pre>
</div>
</div>
<div class="paragraph">
<p>The corresponding lines for the workstations would be:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+@IT_EMP:::::::::
+@USERS:::::::::
+:::::::::/usr/sbin/nologin</pre>
</div>
</div>
<div class="paragraph">
<p>NIS supports the creation of netgroups from other netgroups which can be useful if the policy regarding user access changes.
One possibility is the creation of role-based netgroups.
For example, one might create a netgroup called <code>BIGSRV</code> to define the login restrictions for the important servers, another netgroup called <code>SMALLSRV</code> for the less important servers, and a third netgroup called <code>USERBOX</code> for the workstations.
Each of these netgroups contains the netgroups that are allowed to login onto these machines.
The new entries for the NIS`netgroup` map would look like this:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>BIGSRV    IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP  ITINTERN
USERBOX   IT_EMP  ITINTERN USERS</pre>
</div>
</div>
<div class="paragraph">
<p>This method of defining login restrictions works reasonably well when it is possible to define groups of machines with identical restrictions.
Unfortunately, this is the exception and not the rule.
Most of the time, the ability to define login restrictions on a per-machine basis is required.</p>
</div>
<div class="paragraph">
<p>Machine-specific netgroup definitions are another possibility to deal with the policy changes.
In this scenario, the <span class="filename">/etc/master.passwd</span> of each system contains two lines starting with &#34;+&#34;.
The first line adds a netgroup with the accounts allowed to login onto this machine and the second line adds all other accounts with <span class="filename">/usr/sbin/nologin</span> as shell.
It is recommended to use the &#34;ALL-CAPS&#34; version of the hostname as the name of the netgroup:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>+@BOXNAME:::::::::
+:::::::::/usr/sbin/nologin</pre>
</div>
</div>
<div class="paragraph">
<p>Once this task is completed on all the machines, there is no longer a need to modify the local versions of <span class="filename">/etc/master.passwd</span> ever again.
All further changes can be handled by modifying the NIS map.
Here is an example of a possible <code>netgroup</code> map for this scenario:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Define groups of users first
IT_EMP    (,alpha,test-domain)    (,beta,test-domain)
IT_APP    (,charlie,test-domain)  (,delta,test-domain)
DEPT1     (,echo,test-domain)     (,foxtrott,test-domain)
DEPT2     (,golf,test-domain)     (,hotel,test-domain)
DEPT3     (,india,test-domain)    (,juliet,test-domain)
ITINTERN  (,kilo,test-domain)     (,lima,test-domain)
D_INTERNS (,able,test-domain)     (,baker,test-domain)
#
# Now, define some groups based on roles
USERS     DEPT1   DEPT2     DEPT3
BIGSRV    IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP    ITINTERN
USERBOX   IT_EMP  ITINTERN  USERS
#
# And a groups for a special tasks
# Allow echo and golf to access our anti-virus-machine
SECURITY  IT_EMP  (,echo,test-domain)  (,golf,test-domain)
#
# machine-based netgroups
# Our main servers
WAR       BIGSRV
FAMINE    BIGSRV
# User india needs access to this server
POLLUTION  BIGSRV  (,india,test-domain)
#
# This one is really important and needs more access restrictions
DEATH     IT_EMP
#
# The anti-virus-machine mentioned above
ONE       SECURITY
#
# Restrict a machine to a single user
TWO       (,hotel,test-domain)
# [...more groups to follow]</pre>
</div>
</div>
<div class="paragraph">
<p>It may not always be advisable to use machine-based netgroups.
When deploying a couple of dozen or hundreds of systems, role-based netgroups instead of machine-based netgroups may be used to keep the size of the NIS map within reasonable limits.</p>
</div>
</div>
<div class="sect2">
<h3 id="_password_formats">32.4.9. Password Formats<a class="anchor" href="#_password_formats"></a></h3>
<div class="paragraph">
<p>NIS requires that all hosts within an NIS domain use the same format for encrypting passwords.
If users have trouble authenticating on an NIS client, it may be due to a differing password format.
In a heterogeneous network, the format must be supported by all operating systems, where DES is the lowest common standard.</p>
</div>
<div class="paragraph">
<p>To check which format a server or client is using, look at this section of <span class="filename">/etc/login.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>default:\
	:passwd_format=des:\
	:copyright=/etc/COPYRIGHT:\
	[Further entries elided]</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the system is using the DES format for password hashing.
Other possible values include <code>blf</code> for Blowfish, <code>md5</code> for MD5, <code>sha256</code> and <code>sha512</code> for SHA-256 and SHA-512 respectively.
For more information and the up to date list of what is available on your system, consult the <a href="https://man.freebsd.org/cgi/man.cgi?query=crypt&amp;sektion=3&amp;format=html">crypt(3)</a> manpage.</p>
</div>
<div class="paragraph">
<p>If the format on a host needs to be edited to match the one being used in the NIS domain, the login capability database must be rebuilt after saving the change:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cap_mkdb /etc/login.conf</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The format of passwords for existing user accounts will not be updated until each user changes their password <em>after</em> the login capability database is rebuilt.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)<a class="anchor" href="#network-ldap"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Lightweight Directory Access Protocol (LDAP) is an application layer protocol used to access, modify, and authenticate objects using a distributed directory information service.
Think of it as a phone or record book which stores several levels of hierarchical, homogeneous information.
It is used in Active Directory and OpenLDAP networks and allows users to access to several levels of internal information utilizing a single account.
For example, email authentication, pulling employee contact information, and internal website authentication might all make use of a single user account in the LDAP server’s record base.</p>
</div>
<div class="paragraph">
<p>This section provides a quick start guide for configuring an LDAP server on a FreeBSD system.
It assumes that the administrator already has a design plan which includes the type of information to store, what that information will be used for, which users should have access to that information, and how to secure this information from unauthorized access.</p>
</div>
<div class="sect2">
<h3 id="_ldap_terminology_and_structure">32.5.1. LDAP Terminology and Structure<a class="anchor" href="#_ldap_terminology_and_structure"></a></h3>
<div class="paragraph">
<p>LDAP uses several terms which should be understood before starting the configuration.
All directory entries consist of a group of <em>attributes</em>.
Each of these attribute sets contains a unique identifier known as a <em>Distinguished Name</em> (DN) which is normally built from several other attributes such as the common or <em>Relative Distinguished Name</em> (RDN).
Similar to how directories have absolute and relative paths, consider a DN as an absolute path and the RDN as the relative path.</p>
</div>
<div class="paragraph">
<p>An example LDAP entry looks like the following.
This example searches for the entry for the specified user account (<code>uid</code>), organizational unit (<code>ou</code>), and organization (<code>o</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>ldapsearch -xb <span class="s2">&#34;uid=trhodes,ou=users,o=example.com&#34;</span>
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;uid=trhodes,ou=users,o=example.com&gt; with scope subtree</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: ALL</span>
<span class="c">#</span>

<span class="c"># trhodes, users, example.com</span>
dn: <span class="nv">uid</span><span class="o">=</span>trhodes,ou<span class="o">=</span>users,o<span class="o">=</span>example.com
mail: trhodes@example.com
cn: Tom Rhodes
uid: trhodes
telephoneNumber: <span class="o">(</span>123<span class="o">)</span> 456-7890

<span class="c"># search result</span>
search: 2
result: 0 Success

<span class="c"># numResponses: 2</span>
<span class="c"># numEntries: 1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example entry shows the values for the <code>dn</code>, <code>mail</code>, <code>cn</code>, <code>uid</code>, and <code>telephoneNumber</code> attributes.
The cn attribute is the RDN.</p>
</div>
<div class="paragraph">
<p>More information about LDAP and its terminology can be found at <a href="http://www.openldap.org/doc/admin24/intro.html">http://www.openldap.org/doc/admin24/intro.html</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="ldap-config">32.5.2. Configuring an LDAP Server<a class="anchor" href="#ldap-config"></a></h3>
<div class="paragraph">
<p>FreeBSD does not provide a built-in LDAP server.
Begin the configuration by installing <a class="package" href="https://cgit.freebsd.org/ports/tree/net/openldap-server/">net/openldap-server</a> package or port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install openldap-server</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a large set of default options enabled in the <a href="https://docs.freebsd.org/en/articles/linux-users/#software">package</a>.
Review them by running <code>pkg info openldap-server</code>.
If they are not sufficient (for example if SQL support is needed), please consider recompiling the port using the appropriate <a href="../ports/#ports-using">framework</a>.</p>
</div>
<div class="paragraph">
<p>The installation creates the directory <span class="filename">/var/db/openldap-data</span> to hold the data.
The directory to store the certificates must be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/etc/openldap/private</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next phase is to configure the Certificate Authority.
The following commands must be executed from <span class="filename">/usr/local/etc/openldap/private</span>.
This is important as the file permissions need to be restrictive and users should not have access to these files.
More detailed information about certificates and their parameters can be found in <a href="../security/#openssl">OpenSSL</a>.
To create the Certificate Authority, start with this command and follow the prompts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># openssl req -days 365 -nodes -new -x509 -keyout ca.key -out ../ca.crt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The entries for the prompts may be generic <em>except</em> for the <code>Common Name</code>.
This entry must be <em>different</em> than the system hostname.
If this will be a self signed certificate, prefix the hostname with <code>CA</code> for Certificate Authority.</p>
</div>
<div class="paragraph">
<p>The next task is to create a certificate signing request and a private key.
Input this command and follow the prompts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># openssl req -days 365 -nodes -new -keyout server.key -out server.csr</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>During the certificate generation process, be sure to correctly set the <code>Common Name</code> attribute.
The Certificate Signing Request must be signed with the Certificate Authority in order to be used as a valid certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># openssl x509 -req -days 365 -in server.csr -out ../server.crt -CA ../ca.crt -CAkey ca.key -CAcreateserial</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The final part of the certificate generation process is to generate and sign the client certificates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># openssl req -days 365 -nodes -new -keyout client.key -out client.csr</span>
<span class="c"># openssl x509 -req -days 3650 -in client.csr -out ../client.crt -CA ../ca.crt -CAkey ca.key</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Remember to use the same <code>Common Name</code> attribute when prompted.
When finished, ensure that a total of eight (8) new files have been generated through the proceeding commands.</p>
</div>
<div class="paragraph">
<p>The daemon running the OpenLDAP server is <span class="filename">slapd</span>.
Its configuration is performed through <span class="filename">slapd.ldif</span>: the old <span class="filename">slapd.conf</span> has been deprecated by OpenLDAP.</p>
</div>
<div class="paragraph">
<p><a href="http://www.openldap.org/doc/admin24/slapdconf2.html">Configuration examples</a> for <span class="filename">slapd.ldif</span> are available and can also be found in <span class="filename">/usr/local/etc/openldap/slapd.ldif.sample</span>.
Options are documented in slapd-config(5).
Each section of <span class="filename">slapd.ldif</span>, like all the other LDAP attribute sets, is uniquely identified through a DN.
Be sure that no blank lines are left between the <code>dn:</code> statement and the desired end of the section.
In the following example, TLS will be used to implement a secure channel.
The first section represents the global configuration:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>#
# See slapd-config(5) for details on configuration options.
# This file should NOT be world readable.
#
dn: cn=config
objectClass: olcGlobal
cn: config
#
#
# Define global ACLs to disable default read access.
#
olcArgsFile: /var/run/openldap/slapd.args
olcPidFile: /var/run/openldap/slapd.pid
olcTLSCertificateFile: /usr/local/etc/openldap/server.crt
olcTLSCertificateKeyFile: /usr/local/etc/openldap/private/server.key
olcTLSCACertificateFile: /usr/local/etc/openldap/ca.crt
#olcTLSCipherSuite: HIGH
olcTLSProtocolMin: 3.1
olcTLSVerifyClient: never</pre>
</div>
</div>
<div class="paragraph">
<p>The Certificate Authority, server certificate and server private key files must be specified here.
It is recommended to let the clients choose the security cipher and omit option <code>olcTLSCipherSuite</code> (incompatible with TLS clients other than <span class="filename">openssl</span>). Option <code>olcTLSProtocolMin</code> lets the server require a minimum security level: it is recommended.
While verification is mandatory for the server, it is not for the client: <code>olcTLSVerifyClient: never</code>.</p>
</div>
<div class="paragraph">
<p>The second section is about the backend modules and can be configured as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>#
# Load dynamic backend modules:
#
dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulepath:	/usr/local/libexec/openldap
olcModuleload:	back_mdb.la
#olcModuleload:	back_bdb.la
#olcModuleload:	back_hdb.la
#olcModuleload:	back_ldap.la
#olcModuleload:	back_passwd.la
#olcModuleload:	back_shell.la</pre>
</div>
</div>
<div class="paragraph">
<p>The third section is devoted to load the needed <code>ldif</code> schemas to be used by the databases: they are essential.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>dn: cn=schema,cn=config
objectClass: olcSchemaConfig
cn: schema

include: file:///usr/local/etc/openldap/schema/core.ldif
include: file:///usr/local/etc/openldap/schema/cosine.ldif
include: file:///usr/local/etc/openldap/schema/inetorgperson.ldif
include: file:///usr/local/etc/openldap/schema/nis.ldif</pre>
</div>
</div>
<div class="paragraph">
<p>Next, the frontend configuration section:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Frontend settings
#
dn: olcDatabase={-1}frontend,cn=config
objectClass: olcDatabaseConfig
objectClass: olcFrontendConfig
olcDatabase: {-1}frontend
olcAccess: to * by * read
#
# Sample global access control policy:
#	Root DSE: allow anyone to read it
#	Subschema (sub)entry DSE: allow anyone to read it
#	Other DSEs:
#		Allow self write access
#		Allow authenticated users read access
#		Allow anonymous users to authenticate
#
#olcAccess: to dn.base=&#34;&#34; by * read
#olcAccess: to dn.base=&#34;cn=Subschema&#34; by * read
#olcAccess: to *
#	by self write
#	by users read
#	by anonymous auth
#
# if no access controls are present, the default policy
# allows anyone and everyone to read anything but restricts
# updates to rootdn.  (e.g., &#34;access to * by * read&#34;)
#
# rootdn can always read and write EVERYTHING!
#
olcPasswordHash: {SSHA}
# {SSHA} is already the default for olcPasswordHash</pre>
</div>
</div>
<div class="paragraph">
<p>Another section is devoted to the <em>configuration backend</em>, the only way to later access the OpenLDAP server configuration is as a global super-user.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>dn: olcDatabase={0}config,cn=config
objectClass: olcDatabaseConfig
olcDatabase: {0}config
olcAccess: to * by * none
olcRootPW: {SSHA}iae+lrQZILpiUdf16Z9KmDmSwT77Dj4U</pre>
</div>
</div>
<div class="paragraph">
<p>The default administrator username is <code>cn=config</code>.
Type <span class="filename">slappasswd</span> in a shell, choose a password and use its hash in <code>olcRootPW</code>.
If this option is not specified now, before <span class="filename">slapd.ldif</span> is imported, no one will be later able to modify the <em>global configuration</em> section.</p>
</div>
<div class="paragraph">
<p>The last section is about the database backend:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>#######################################################################
# LMDB database definitions
#######################################################################
#
dn: olcDatabase=mdb,cn=config
objectClass: olcDatabaseConfig
objectClass: olcMdbConfig
olcDatabase: mdb
olcDbMaxSize: 1073741824
olcSuffix: dc=domain,dc=example
olcRootDN: cn=mdbadmin,dc=domain,dc=example
# Cleartext passwords, especially for the rootdn, should
# be avoided.  See slappasswd(8) and slapd-config(5) for details.
# Use of strong authentication encouraged.
olcRootPW: {SSHA}X2wHvIWDk6G76CQyCMS1vDCvtICWgn0+
# The database directory MUST exist prior to running slapd AND
# should only be accessible by the slapd and slap tools.
# Mode 700 recommended.
olcDbDirectory:	/var/db/openldap-data
# Indices to maintain
olcDbIndex: objectClass eq</pre>
</div>
</div>
<div class="paragraph">
<p>This database hosts the <em>actual contents</em> of the LDAP directory.
Types other than <code>mdb</code> are available.
Its super-user, not to be confused with the global one, is configured here: a (possibly custom) username in <code>olcRootDN</code> and the password hash in <code>olcRootPW</code>; <span class="filename">slappasswd</span> can be used as before.</p>
</div>
<div class="paragraph">
<p>This <a href="http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=tree;f=tests/data/regressions/its8444;h=8a5e808e63b0de3d2bdaf2cf34fecca8577ca7fd;hb=HEAD">repository</a> contains four examples of <span class="filename">slapd.ldif</span>.
To convert an existing <span class="filename">slapd.conf</span> into <span class="filename">slapd.ldif</span>, refer to <a href="http://www.openldap.org/doc/admin24/slapdconf2.html">this page</a> (please note that this may introduce some unuseful options).</p>
</div>
<div class="paragraph">
<p>When the configuration is completed, <span class="filename">slapd.ldif</span> must be placed in an empty directory.
It is recommended to create it as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/etc/openldap/slapd.d/</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Import the configuration database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># /usr/local/sbin/slapadd -n0 -F /usr/local/etc/openldap/slapd.d/ -l /usr/local/etc/openldap/slapd.ldif</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the <span class="filename">slapd</span> daemon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># /usr/local/libexec/slapd -F /usr/local/etc/openldap/slapd.d/</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Option <code>-d</code> can be used for debugging, as specified in slapd(8).
To verify that the server is running and working:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ldapsearch -x -b &#39;&#39; -s base &#39;(objectclass=*)&#39; namingContexts</span>
<span class="c"># extended LDIF</span>
<span class="c">#</span>
<span class="c"># LDAPv3</span>
<span class="c"># base &lt;&gt; with scope baseObject</span>
<span class="c"># filter: (objectclass=*)</span>
<span class="c"># requesting: namingContexts</span>
<span class="c">#</span>

<span class="c">#</span>
dn:
namingContexts: <span class="nv">dc</span><span class="o">=</span>domain,dc<span class="o">=</span>example

<span class="c"># search result</span>
search: 2
result: 0 Success

<span class="c"># numResponses: 2</span>
<span class="c"># numEntries: 1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The server must still be trusted.
If that has never been done before, follow these instructions.
Install the OpenSSL package or port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install openssl</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>From the directory where <span class="filename">ca.crt</span> is stored (in this example, <span class="filename">/usr/local/etc/openldap</span>), run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># c_rehash .</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the CA and the server certificate are now correctly recognized in their respective roles.
To verify this, run this command from the <span class="filename">server.crt</span> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># openssl verify -verbose -CApath . server.crt</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If <span class="filename">slapd</span> was running, restart it.
As stated in <span class="filename">/usr/local/etc/rc.d/slapd</span>, to properly run <span class="filename">slapd</span> at boot the following lines must be added to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>slapd_enable=&#34;YES&#34;
slapd_flags=&#39;-h &#34;ldapi://%2fvar%2frun%2fopenldap%2fldapi/
ldap://0.0.0.0/&#34;&#39;
slapd_sockets=&#34;/var/run/openldap/ldapi&#34;
slapd_cn_config=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p><span class="filename">slapd</span> does not provide debugging at boot.
Check <span class="filename">/var/log/debug.log</span>, <span class="filename">dmesg -a</span> and <span class="filename">/var/log/messages</span> for this purpose.</p>
</div>
<div class="paragraph">
<p>The following example adds the group <code>team</code> and the user <code>john</code> to the <code>domain.example</code> LDAP database, which is still empty.
First, create the file <span class="filename">domain.ldif</span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cat domain.ldif</span>
dn: <span class="nv">dc</span><span class="o">=</span>domain,dc<span class="o">=</span>example
objectClass: dcObject
objectClass: organization
o: domain.example
dc: domain

dn: <span class="nv">ou</span><span class="o">=</span>groups,dc<span class="o">=</span>domain,dc<span class="o">=</span>example
objectClass: top
objectClass: organizationalunit
ou: groups

dn: <span class="nv">ou</span><span class="o">=</span>users,dc<span class="o">=</span>domain,dc<span class="o">=</span>example
objectClass: top
objectClass: organizationalunit
ou: users

dn: <span class="nv">cn</span><span class="o">=</span>team,ou<span class="o">=</span>groups,dc<span class="o">=</span>domain,dc<span class="o">=</span>example
objectClass: top
objectClass: posixGroup
cn: team
gidNumber: 10001

dn: <span class="nv">uid</span><span class="o">=</span>john,ou<span class="o">=</span>users,dc<span class="o">=</span>domain,dc<span class="o">=</span>example
objectClass: top
objectClass: account
objectClass: posixAccount
objectClass: shadowAccount
cn: John McUser
uid: john
uidNumber: 10001
gidNumber: 10001
homeDirectory: /home/john/
loginShell: /usr/bin/bash
userPassword: secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the OpenLDAP documentation for more details.
Use <span class="filename">slappasswd</span> to replace the plain text password <code>secret</code> with a hash in <code>userPassword</code>.
The path specified as <code>loginShell</code> must exist in all the systems where <code>john</code> is allowed to login.
Finally, use the <code>mdb</code> administrator to modify the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ldapadd -W -D &#34;cn=mdbadmin,dc=domain,dc=example&#34; -f domain.ldif</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Modifications to the <em>global configuration</em> section can only be performed by the global super-user.
For example, assume that the option <code>olcTLSCipherSuite: HIGH:MEDIUM:SSLv3</code> was initially specified and must now be deleted.
First, create a file that contains the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cat global_mod</span>
dn: <span class="nv">cn</span><span class="o">=</span>config
changetype: modify
delete: olcTLSCipherSuite</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, apply the modifications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ldapmodify -f global_mod -x -D &#34;cn=config&#34; -W</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When asked, provide the password chosen in the <em>configuration backend</em> section.
The username is not required: here, <code>cn=config</code> represents the DN of the database section to be modified.
Alternatively, use <code>ldapmodify</code> to delete a single line of the database, <code>ldapdelete</code> to delete a whole entry.</p>
</div>
<div class="paragraph">
<p>If something goes wrong, or if the global super-user cannot access the configuration backend, it is possible to delete and re-write the whole configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># rm -rf /usr/local/etc/openldap/slapd.d/</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="filename">slapd.ldif</span> can then be edited and imported again.
Please, follow this procedure only when no other solution is available.</p>
</div>
<div class="paragraph">
<p>This is the configuration of the server only.
The same machine can also host an LDAP client, with its own separate configuration.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)<a class="anchor" href="#network-dhcp"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Dynamic Host Configuration Protocol (DHCP) allows a system to connect to a network in order to be assigned the necessary addressing information for communication on that network.
FreeBSD includes the OpenBSD version of <code>dhclient</code> which is used by the client to obtain the addressing information.
FreeBSD does not install a DHCP server, but several servers are available in the FreeBSD Ports Collection.
The DHCP protocol is fully described in <a href="http://www.freesoft.org/CIE/RFC/2131/">RFC 2131</a>.
Informational resources are also available at <a href="http://www.isc.org/downloads/dhcp/">isc.org/downloads/dhcp/</a>.</p>
</div>
<div class="paragraph">
<p>This section describes how to use the built-in DHCP client.
It then describes how to install and configure a DHCP server.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In FreeBSD, the <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> device is needed by both the DHCP server and DHCP client.
This device is included in the <span class="filename">GENERIC</span> kernel that is installed with FreeBSD.
Users who prefer to create a custom kernel need to keep this device if DHCP is used.</p>
</div>
<div class="paragraph">
<p>It should be noted that <span class="filename">bpf</span> also allows privileged users to run network packet sniffers on that system.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_configuring_a_dhcp_client">32.6.1. Configuring a DHCP Client<a class="anchor" href="#_configuring_a_dhcp_client"></a></h3>
<div class="paragraph">
<p>DHCP client support is included in the FreeBSD installer, making it easy to configure a newly installed system to automatically receive its networking addressing information from an existing DHCP server.
Refer to <a href="../bsdinstall/#bsdinstall-post">Accounts, Time Zone, Services and Hardening</a> for examples of network configuration.</p>
</div>
<div class="paragraph">
<p>When <code>dhclient</code> is executed on the client machine, it begins broadcasting requests for configuration information.
By default, these requests use UDP port 68.
The server replies on UDP port 67, giving the client an IP address and other relevant network information such as a subnet mask, default gateway, and DNS server addresses.
This information is in the form of a DHCP &#34;lease&#34; and is valid for a configurable time.
This allows stale IP addresses for clients no longer connected to the network to automatically be reused.
DHCP clients can obtain a great deal of information from the server.
An exhaustive list may be found in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a>.</p>
</div>
<div class="paragraph">
<p>By default, when a FreeBSD system boots, its DHCP client runs in the background, or <em>asynchronously</em>.
Other startup scripts continue to run while the DHCP process completes, which speeds up system startup.</p>
</div>
<div class="paragraph">
<p>Background DHCP works well when the DHCP server responds quickly to the client’s requests.
However, DHCP may take a long time to complete on some systems.
If network services attempt to run before DHCP has assigned the network addressing information, they will fail.
Using DHCP in <em>synchronous</em> mode prevents this problem as it pauses startup until the DHCP configuration has completed.</p>
</div>
<div class="paragraph">
<p>This line in <span class="filename">/etc/rc.conf</span> is used to configure background or asynchronous mode:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ifconfig_fxp0=&#34;DHCP&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>This line may already exist if the system was configured to use DHCP during installation.
Replace the <em>fxp0</em> shown in these examples with the name of the interface to be dynamically configured, as described in <a href="../config/#config-network-setup">“Setting Up Network Interface Cards”</a>.</p>
</div>
<div class="paragraph">
<p>To instead configure the system to use synchronous mode, and to pause during startup while DHCP completes, use “SYNCDHCP”:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ifconfig_fxp0=&#34;SYNCDHCP&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Additional client options are available.
Search for <code>dhclient</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> for details.</p>
</div>
<div class="paragraph">
<p>The DHCP client uses the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="filename">/etc/dhclient.conf</span></p>
<div class="paragraph">
<p>The configuration file used by <code>dhclient</code>.
Typically, this file contains only comments as the defaults are suitable for most clients.
This configuration file is described in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a>.</p>
</div>
</li>
<li>
<p><span class="filename">/sbin/dhclient</span></p>
<div class="paragraph">
<p>More information about the command itself can be found in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>.</p>
</div>
</li>
<li>
<p><span class="filename">/sbin/dhclient-script</span></p>
<div class="paragraph">
<p>The FreeBSD-specific DHCP client configuration script.
It is described in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient-script&amp;sektion=8&amp;format=html">dhclient-script(8)</a>, but should not need any user modification to function properly.</p>
</div>
</li>
<li>
<p><span class="filename">/var/db/dhclient.leases.interface</span></p>
<div class="paragraph">
<p>The DHCP client keeps a database of valid leases in this file, which is written as a log and is described in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.leases&amp;sektion=5&amp;format=html">dhclient.leases(5)</a>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="network-dhcp-server">32.6.2. Installing and Configuring a DHCP Server<a class="anchor" href="#network-dhcp-server"></a></h3>
<div class="paragraph">
<p>This section demonstrates how to configure a FreeBSD system to act as a DHCP server using the Internet Systems Consortium (ISC) implementation of the DHCP server.
This implementation and its documentation can be installed using the <a class="package" href="https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-server/">net/isc-dhcp44-server</a> package or port.</p>
</div>
<div class="paragraph">
<p>The installation of <a class="package" href="https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-server/">net/isc-dhcp44-server</a> installs a sample configuration file.
Copy <span class="filename">/usr/local/etc/dhcpd.conf.example</span> to <span class="filename">/usr/local/etc/dhcpd.conf</span> and make any edits to this new file.</p>
</div>
<div class="paragraph">
<p>The configuration file is comprised of declarations for subnets and hosts which define the information that is provided to DHCP clients.
For example, these lines configure the following:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>option domain-name &#34;example.org&#34;;<i class="conum" data-value="1"></i><b>(1)</b>
option domain-name-servers ns1.example.org;<i class="conum" data-value="2"></i><b>(2)</b>
option subnet-mask 255.255.255.0;<i class="conum" data-value="3"></i><b>(3)</b>

default-lease-time 600;<i class="conum" data-value="4"></i><b>(4)</b>
max-lease-time 72400;<i class="conum" data-value="5"></i><b>(5)</b>
ddns-update-style none;<i class="conum" data-value="6"></i><b>(6)</b>

subnet 10.254.239.0 netmask 255.255.255.224 {
  range 10.254.239.10 10.254.239.20;<i class="conum" data-value="7"></i><b>(7)</b>
  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;<i class="conum" data-value="8"></i><b>(8)</b>
}

host fantasia {
  hardware ethernet 08:00:07:26:c0:a5;<i class="conum" data-value="9"></i><b>(9)</b>
  fixed-address fantasia.fugue.com;<i class="conum" data-value="10"></i><b>(10)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This option specifies the default search domain that will be provided to clients. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5&amp;format=html">resolv.conf(5)</a> for more information.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This option specifies a comma separated list of DNS servers that the client should use. They can be listed by their Fully Qualified Domain Names (FQDN), as seen in the example, or by their IP addresses.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The subnet mask that will be provided to clients.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The default lease expiry time in seconds. A client can be configured to override this value.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The maximum allowed length of time, in seconds, for a lease. Should a client request a longer lease, a lease will still be issued, but it will only be valid for <code>max-lease-time</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The default of <code>none</code> disables dynamic DNS updates. Changing this to <code>interim</code> configures the DHCP server to update a DNS server whenever it hands out a lease so that the DNS server knows which IP addresses are associated with which computers in the network. Do not change the default setting unless the DNS server has been configured to support dynamic DNS.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>This line creates a pool of available IP addresses which are reserved for allocation to DHCP clients. The range of addresses must be valid for the network or subnet specified in the previous line.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Declares the default gateway that is valid for the network or subnet specified before the opening <code>{</code> bracket.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Specifies the hardware MAC address of a client so that the DHCP server can recognize the client when it makes a request.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Specifies that this host should always be given the same IP address. Using the hostname is correct, since the DHCP server will resolve the hostname before returning the lease information.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This configuration file supports many more options.
Refer to dhcpd.conf(5), installed with the server, for details and examples.</p>
</div>
<div class="paragraph">
<p>Once the configuration of <span class="filename">dhcpd.conf</span> is complete, enable the DHCP server in <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>dhcpd_enable=&#34;YES&#34;
dhcpd_ifaces=&#34;dc0&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Replace the <code>dc0</code> with the interface (or interfaces, separated by whitespace) that the DHCP server should listen on for DHCP client requests.</p>
</div>
<div class="paragraph">
<p>Start the server by issuing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service isc-dhcpd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Any future changes to the configuration of the server will require the dhcpd service to be stopped and then started using <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a>.</p>
</div>
<div class="paragraph">
<p>The DHCP server uses the following files.
Note that the manual pages are installed with the server software.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="filename">/usr/local/sbin/dhcpd</span></p>
<div class="paragraph">
<p>More information about the dhcpd server can be found in dhcpd(8).</p>
</div>
</li>
<li>
<p><span class="filename">/usr/local/etc/dhcpd.conf</span></p>
<div class="paragraph">
<p>The server configuration file needs to contain all the information that should be provided to clients, along with information regarding the operation of the server.
This configuration file is described in dhcpd.conf(5).</p>
</div>
</li>
<li>
<p><span class="filename">/var/db/dhcpd.leases</span></p>
<div class="paragraph">
<p>The DHCP server keeps a database of leases it has issued in this file, which is written as a log.
Refer to dhcpd.leases(5), which gives a slightly longer description.</p>
</div>
</li>
<li>
<p><span class="filename">/usr/local/sbin/dhcrelay</span></p>
<div class="paragraph">
<p>This daemon is used in advanced environments where one DHCP server forwards a request from a client to another DHCP server on a separate network.
If this functionality is required, install the <a class="package" href="https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-relay/">net/isc-dhcp44-relay</a> package or port.
The installation includes dhcrelay(8) which provides more detail.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-dns">32.7. Domain Name System (DNS)<a class="anchor" href="#network-dns"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Domain Name System (DNS) is the protocol through which domain names are mapped to IP addresses, and vice versa.
DNS is coordinated across the Internet through a somewhat complex system of authoritative root, Top Level Domain (TLD), and other smaller-scale name servers, which host and cache individual domain information.
It is not necessary to run a name server to perform DNS lookups on a system.</p>
</div>
<div class="paragraph">
<p>The following table describes some of the terms associated with DNS:</p>
</div>
<table class="tableblock frame-none grid-all stretch">
<caption class="title">Table 4. DNS Terminology</caption>
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Term</th>
<th class="tableblock halign-left valign-top">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forward DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mapping of hostnames to IP addresses.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Origin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refers to the domain covered in a particular zone file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A system process through which a machine queries a name server for zone information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reverse DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mapping of IP addresses to hostnames.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The beginning of the Internet zone hierarchy. All zones fall under the root zone, similar to how all files in a file system fall under the root directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An individual domain, subdomain, or portion of the DNS administered by the same authority.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Examples of zones:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.</code> is how the root zone is usually referred to in documentation.</p>
</li>
<li>
<p><code>org.</code> is a Top Level Domain (TLD) under the root zone.</p>
</li>
<li>
<p><code>example.org.</code> is a zone under the `org.`TLD.</p>
</li>
<li>
<p><code>1.168.192.in-addr.arpa</code> is a zone referencing all IP addresses which fall under the `192.168.1.*`IP address space.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As one can see, the more specific part of a hostname appears to its left.
For example, <code>example.org.</code> is more specific than <code>org.</code>, as <code>org.</code> is more specific than the root zone.
The layout of each part of a hostname is much like a file system: the <span class="filename">/dev</span> directory falls within the root, and so on.</p>
</div>
<div class="sect2">
<h3 id="_reasons_to_run_a_name_server">32.7.1. Reasons to Run a Name Server<a class="anchor" href="#_reasons_to_run_a_name_server"></a></h3>
<div class="paragraph">
<p>Name servers generally come in two forms: authoritative name servers, and caching (also known as resolving) name servers.</p>
</div>
<div class="paragraph">
<p>An authoritative name server is needed when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One wants to serve DNS information to the world, replying authoritatively to queries.</p>
</li>
<li>
<p>A domain, such as <code>example.org</code>, is registered and IP addresses need to be assigned to hostnames under it.</p>
</li>
<li>
<p>An IP address block requires reverse DNS entries (IP to hostname).</p>
</li>
<li>
<p>A backup or second name server, called a slave, will reply to queries.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A caching name server is needed when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A local DNS server may cache and respond more quickly than querying an outside name server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When one queries for <code>www.FreeBSD.org</code>, the resolver usually queries the uplink ISP’s name server, and retrieves the reply.
With a local, caching DNS server, the query only has to be made once to the outside world by the caching DNS server.
Additional queries will not have to go outside the local network, since the information is cached locally.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dns_server_configuration">32.7.2. DNS Server Configuration<a class="anchor" href="#_dns_server_configuration"></a></h3>
<div class="paragraph">
<p>Unbound is provided in the FreeBSD base system.
By default, it will provide DNS resolution to the local machine only.
While the base system package can be configured to provide resolution services beyond the local machine, it is recommended that such requirements be addressed by installing Unbound from the FreeBSD Ports Collection.</p>
</div>
<div class="paragraph">
<p>To enable Unbound, add the following to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>local_unbound_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Any existing nameservers in <span class="filename">/etc/resolv.conf</span> will be configured as forwarders in the new Unbound configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If any of the listed nameservers do not support DNSSEC, local DNS resolution will fail.
Be sure to test each nameserver and remove any that fail the test.
The following command will show the trust tree or a failure for a nameserver running on <code>192.168.1.1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>drill -S FreeBSD.org @192.168.1.1</code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Once each nameserver is confirmed to support DNSSEC, start Unbound:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service local_unbound onestart</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will take care of updating <span class="filename">/etc/resolv.conf</span> so that queries for DNSSEC secured domains will now work.
For example, run the following to validate the FreeBSD.org DNSSEC trust tree:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>drill -S FreeBSD.org
;; Number of trusted keys: 1
;; Chasing: freebsd.org. A

DNSSEC Trust tree:
freebsd.org. <span class="o">(</span>A<span class="o">)</span>
|---freebsd.org. <span class="o">(</span>DNSKEY keytag: 36786 alg: 8 flags: 256<span class="o">)</span>
    |---freebsd.org. <span class="o">(</span>DNSKEY keytag: 32659 alg: 8 flags: 257<span class="o">)</span>
    |---freebsd.org. <span class="o">(</span>DS keytag: 32659 digest <span class="nb">type</span>: 2<span class="o">)</span>
        |---org. <span class="o">(</span>DNSKEY keytag: 49587 alg: 7 flags: 256<span class="o">)</span>
            |---org. <span class="o">(</span>DNSKEY keytag: 9795 alg: 7 flags: 257<span class="o">)</span>
            |---org. <span class="o">(</span>DNSKEY keytag: 21366 alg: 7 flags: 257<span class="o">)</span>
            |---org. <span class="o">(</span>DS keytag: 21366 digest <span class="nb">type</span>: 1<span class="o">)</span>
            |   |---. <span class="o">(</span>DNSKEY keytag: 40926 alg: 8 flags: 256<span class="o">)</span>
            |       |---. <span class="o">(</span>DNSKEY keytag: 19036 alg: 8 flags: 257<span class="o">)</span>
            |---org. <span class="o">(</span>DS keytag: 21366 digest <span class="nb">type</span>: 2<span class="o">)</span>
                |---. <span class="o">(</span>DNSKEY keytag: 40926 alg: 8 flags: 256<span class="o">)</span>
                    |---. <span class="o">(</span>DNSKEY keytag: 19036 alg: 8 flags: 257<span class="o">)</span>
;; Chase successful</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_authoritative_name_server_configuration">32.7.3. Authoritative Name Server Configuration<a class="anchor" href="#_authoritative_name_server_configuration"></a></h3>
<div class="paragraph">
<p>FreeBSD does not provide authoritative name server software in the base system.
Users are encouraged to install third party applications, like <a class="package" href="https://cgit.freebsd.org/ports/tree/dns/nsd/">dns/nsd</a> or <a class="package" href="https://cgit.freebsd.org/ports/tree/dns/bind918/">dns/bind918</a> package or port.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-apache">32.8. Apache HTTP Server<a class="anchor" href="#network-apache"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The open source Apache HTTP Server is the most widely used web server.
FreeBSD does not install this web server by default, but it can be installed from the <a class="package" href="https://cgit.freebsd.org/ports/tree/www/apache24/">www/apache24</a> package or port.</p>
</div>
<div class="paragraph">
<p>This section summarizes how to configure and start version 2.<em>x</em> of the Apache HTTP Server on FreeBSD.
For more detailed information about Apache 2.X and its configuration directives, refer to <a href="http://httpd.apache.org/">httpd.apache.org</a>.</p>
</div>
<div class="sect2">
<h3 id="_configuring_and_starting_apache">32.8.1. Configuring and Starting Apache<a class="anchor" href="#_configuring_and_starting_apache"></a></h3>
<div class="paragraph">
<p>In FreeBSD, the main Apache HTTP Server configuration file is installed as <span class="filename">/usr/local/etc/apache2x/httpd.conf</span>, where <em>x</em> represents the version number.
This ASCII text file begins comment lines with a <code>#</code>.
The most frequently modified directives are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ServerRoot &#34;/usr/local&#34;</code></dt>
<dd>
<p>Specifies the default directory hierarchy for the Apache installation.
Binaries are stored in the <span class="filename">bin</span> and <span class="filename">sbin</span> subdirectories of the server root and configuration files are stored in the <span class="filename">etc/apache2x</span> subdirectory.</p>
</dd>
<dt class="hdlist1"><code>ServerAdmin <a href="mailto:you@example.com">you@example.com</a></code></dt>
<dd>
<p>Change this to the email address to receive problems with the server.
This address also appears on some server-generated pages, such as error documents.</p>
</dd>
<dt class="hdlist1"><code>ServerName www.example.com:80</code></dt>
<dd>
<p>Allows an administrator to set a hostname which is sent back to clients for the server.
For example, <code>www</code> can be used instead of the actual hostname.
If the system does not have a registered DNS name, enter its IP address instead.
If the server will listen on an alternate report, change <code>80</code> to the alternate port number.</p>
</dd>
<dt class="hdlist1"><code>DocumentRoot &#34;/usr/local/www/apache2_x_/data&#34;</code></dt>
<dd>
<p>The directory where documents will be served from.
By default, all requests are taken from this directory, but symbolic links and aliases may be used to point to other locations.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>It is always a good idea to make a backup copy of the default Apache configuration file before making changes.
When the configuration of Apache is complete, save the file and verify the configuration using <code>apachectl</code>.
Running <code>apachectl configtest</code> should return <code>Syntax OK</code>.</p>
</div>
<div class="paragraph">
<p>To launch Apache at system startup, add the following line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>apache24_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>If Apache should be started with non-default options, the following line may be added to <span class="filename">/etc/rc.conf</span> to specify the needed flags:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>apache24_flags=&#34;&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>If apachectl does not report configuration errors, start <code>httpd</code> now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service apache24 start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>httpd</code> service can be tested by entering <code>http://<em>localhost</em></code> in a web browser, replacing <em>localhost</em> with the fully-qualified domain name of the machine running <code>httpd</code>.
The default web page that is displayed is <span class="filename">/usr/local/www/apache24/data/index.html</span>.</p>
</div>
<div class="paragraph">
<p>The Apache configuration can be tested for errors after making subsequent configuration changes while <code>httpd</code> is running using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service apache24 configtest</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is important to note that <code>configtest</code> is not an <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> standard, and should not be expected to work for all startup scripts.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_virtual_hosting">32.8.2. Virtual Hosting<a class="anchor" href="#_virtual_hosting"></a></h3>
<div class="paragraph">
<p>Virtual hosting allows multiple websites to run on one Apache server.
The virtual hosts can be <em>IP-based</em> or <em>name-based</em>.
IP-based virtual hosting uses a different IP address for each website.
Name-based virtual hosting uses the clients HTTP/1.1 headers to figure out the hostname, which allows the websites to share the same IP address.</p>
</div>
<div class="paragraph">
<p>To setup Apache to use name-based virtual hosting, add a <code>VirtualHost</code> block for each website.
For example, for the webserver named <code>www.domain.tld</code> with a virtual domain of <code>www.someotherdomain.tld</code>, add the following entries to <span class="filename">httpd.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>&lt;VirtualHost *&gt;
    ServerName www.domain.tld
    DocumentRoot /www/domain.tld
&lt;/VirtualHost&gt;

&lt;VirtualHost *&gt;
    ServerName www.someotherdomain.tld
    DocumentRoot /www/someotherdomain.tld
&lt;/VirtualHost&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For each virtual host, replace the values for <code>ServerName</code> and <code>DocumentRoot</code> with the values to be used.</p>
</div>
<div class="paragraph">
<p>For more information about setting up virtual hosts, consult the official Apache documentation at: <a href="http://httpd.apache.org/docs/vhosts/">http://httpd.apache.org/docs/vhosts/</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_apache_modules">32.8.3. Apache Modules<a class="anchor" href="#_apache_modules"></a></h3>
<div class="paragraph">
<p>Apache uses modules to augment the functionality provided by the basic server.
Refer to <a href="http://httpd.apache.org/docs/current/mod/">http://httpd.apache.org/docs/current/mod/</a> for a complete listing of and the configuration details for the available modules.</p>
</div>
<div class="paragraph">
<p>In FreeBSD, some modules can be compiled with the <a class="package" href="https://cgit.freebsd.org/ports/tree/www/apache24/">www/apache24</a> port.
Type <code>make config</code> within <span class="filename">/usr/ports/www/apache24</span> to see which modules are available and which are enabled by default.
If the module is not compiled with the port, the FreeBSD Ports Collection provides an easy way to install many modules.
This section describes three of the most commonly used modules.</p>
</div>
<div class="sect3">
<h4 id="_ssl_support">32.8.3.1. SSL support<a class="anchor" href="#_ssl_support"></a></h4>
<div class="paragraph">
<p>At one in point in time, support for SSL inside of Apache required a secondary module called <span class="filename">mod_ssl</span>.
This is no longer the case and the default install of Apache comes with SSL built into the web server.
An example of how to enable support for SSL websites is available in the installed file, <span class="filename">httpd-ssl.conf</span> inside of the <span class="filename">/usr/local/etc/apache24/extra</span> directory
Inside this directory is also a sample file called named <span class="filename">ssl.conf-sample</span>.
It is recommended that both files be evaluated to properly set up secure websites in the Apache web server.</p>
</div>
<div class="paragraph">
<p>After the configuration of SSL is complete, the following line must be uncommented in the main <span class="filename">http.conf</span> to activate the changes on the next restart or reload of Apache:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>#Include etc/apache24/extra/httpd-ssl.conf</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SSL version two and version three have known vulnerability issues.
It is highly recommended TLS version 1.2 and 1.3 be enabled in place of the older SSL options.
This can be accomplished by setting the following options in the <span class="filename">ssl.conf</span>:</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>SSLProtocol all -SSLv3 -SSLv2 +TLSv1.2 +TLSv1.3
SSLProxyProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1</pre>
</div>
</div>
<div class="paragraph">
<p>To complete the configuration of SSL in the web server, uncomment the following line to ensure that the configuration will be pulled into Apache during restart or reload:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Secure (SSL/TLS) connections
Include etc/apache24/extra/httpd-ssl.conf</pre>
</div>
</div>
<div class="paragraph">
<p>The following lines must also be uncommented in the <span class="filename">httpd.conf</span> to fully support SSL in Apache:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>LoadModule authn_socache_module libexec/apache24/mod_authn_socache.so
LoadModule socache_shmcb_module libexec/apache24/mod_socache_shmcb.so
LoadModule ssl_module libexec/apache24/mod_ssl.so</pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to work with a certificate authority to have the appropriate certificates installed on the system.
This will set up a chain of trust for the site and prevent any warnings of self-signed certificates.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mod_perl">32.8.3.2. <span class="filename">mod_perl</span><a class="anchor" href="#_mod_perl"></a></h4>
<div class="paragraph">
<p>The <span class="filename">mod_perl</span> module makes it possible to write Apache modules in Perl.
In addition, the persistent interpreter embedded in the server avoids the overhead of starting an external interpreter and the penalty of Perl start-up time.</p>
</div>
<div class="paragraph">
<p>The <span class="filename">mod_perl</span> can be installed using the <a class="package" href="https://cgit.freebsd.org/ports/tree/www/mod_perl2/">www/mod_perl2</a> package or port.
Documentation for using this module can be found at <a href="http://perl.apache.org/docs/2.0/index.html">http://perl.apache.org/docs/2.0/index.html</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mod_php">32.8.3.3. <span class="filename">mod_php</span><a class="anchor" href="#_mod_php"></a></h4>
<div class="paragraph">
<p><em>PHP: Hypertext Preprocessor</em> (PHP) is a general-purpose scripting language that is especially suited for web development.
Capable of being embedded into HTML, its syntax draws upon C, Java™, and Perl with the intention of allowing web developers to write dynamically generated webpages quickly.</p>
</div>
<div class="paragraph">
<p>Support for PHP for Apache and any other feature written in the language, can be added by installing the appropriate port.</p>
</div>
<div class="paragraph">
<p>For all supported versions, search the package database using <code>pkg</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg search php</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A list will be displayed including the versions and additional features they provide.
The components are completely modular, meaning features are enabled by installing the appropriate port.
To install PHP version 7.4 for Apache, issue the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install mod_php74</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If any dependency packages need to be installed, they will be installed as well.</p>
</div>
<div class="paragraph">
<p>By default, PHP will not be enabled.
The following lines will need to be added to the Apache configuration file located in <span class="filename">/usr/local/etc/apache24</span> to make it active:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>&lt;FilesMatch &#34;\.php$&#34;&gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
&lt;FilesMatch &#34;\.phps$&#34;&gt;
    SetHandler application/x-httpd-php-source
&lt;/FilesMatch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In addition, the <code>DirectoryIndex</code> in the configuration file will also need to be updated and Apache will either need to be restarted or reloaded for the changes to take effect.</p>
</div>
<div class="paragraph">
<p>Support for many of the PHP features may also be installed by using <code>pkg</code>.
For example, to install support for XML or SSL, install their respective ports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install php74-xml php74-openssl</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, the Apache configuration will need to be reloaded for the changes to take effect, even in cases where it was just a module install.</p>
</div>
<div class="paragraph">
<p>To perform a graceful restart to reload the configuration, issue the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># apachectl graceful</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the install is complete, there are two methods of obtaining the installed PHP support modules and the environmental information of the build.
The first is to install the full PHP binary and running the command to gain the information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install php74</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># php -i |less</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is necessary to pass the output to a pager, such as the <code>more</code> or <code>less</code> to easier digest the amount of output.</p>
</div>
<div class="paragraph">
<p>Finally, to make any changes to the global configuration of PHP there is a well documented file installed into <span class="filename">/usr/local/etc/php.ini</span>.
At the time of install, this file will not exist because there are two versions to choose from, one is <span class="filename">php.ini-development</span> and the other is <span class="filename">php.ini-production</span>.
These are starting points to assist administrators in their deployment.</p>
</div>
</div>
<div class="sect3">
<h4 id="_http2_support">32.8.3.4. HTTP2 Support<a class="anchor" href="#_http2_support"></a></h4>
<div class="paragraph">
<p>Apache support for the HTTP2 protocol is included by default when installing the port with <code>pkg</code>.
The new version of HTTP includes many improvements over the previous version, including utilizing a single connection to a website, reducing overall roundtrips of TCP connections.
Also, packet header data is compressed and HTTP2 requires encryption by default.</p>
</div>
<div class="paragraph">
<p>When Apache is configured to only use HTTP2, web browsers will require secure, encrypted HTTPS connections.
When Apache is configured to use both versions, HTTP1.1 will be considered a fall back option if any issues arise during the connection.</p>
</div>
<div class="paragraph">
<p>While this change does require administrators to make changes, they are positive and equate to a more secure Internet for everyone.
The changes are only required for sites not currently implementing SSL and TLS.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This configuration depends on the previous sections, including TLS support.
It is recommended those instructions be followed before continuing with this configuration.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Start the process by enabling the http2 module by uncommenting the line in <span class="filename">/usr/local/etc/apache24/httpd.conf</span> and replace the mpm_prefork module with mpm_event as the former does not support HTTP2.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>LoadModule http2_module libexec/apache24/mod_http2.so
LoadModule mpm_event_module libexec/apache24/mod_mpm_event.so</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is a separate <span class="filename">mod_http2</span> port that is available.
It exists to deliver security and bug fixes quicker than the module installed with the bundled <span class="filename">apache24</span> port.
It is not required for HTTP2 support but is available.
When installed, the <span class="filename">mod_h2.so</span> should be used in place of <span class="filename">mod_http2.so</span> in the Apache configuration.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>There are two methods to implement HTTP2 in Apache; one way is globally for all sites and each VirtualHost running on the system.
To enable HTTP2 globally, add the following line under the ServerName directive:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Protocols h2 http/1.1</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To enable HTTP2 over plaintext, use h2h2chttp/1.1 in the <span class="filename">httpd.conf</span>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Having the h2c here will allow plaintext HTTP2 data to pass on the system but is not recommended.
In addition, using the http/1.1 here will allow fallback to the HTTP1.1 version of the protocol should it be needed by the system.</p>
</div>
<div class="paragraph">
<p>To enable HTTP2 for individual VirtualHosts, add the same line within the VirtualHost directive in either <span class="filename">httpd.conf</span> or <span class="filename">httpd-ssl.conf</span>.</p>
</div>
<div class="paragraph">
<p>Reload the configuration using the <code>apachectl</code><span class="parameter">reload</span> command and test the configuration either by using either of the following methods after visiting one of the hosted pages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># grep &#34;HTTP/2.0&#34; /var/log/httpd-access.log</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This should return something similar to the following:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>192.168.1.205 - - [18/Oct/2020:18:34:36 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.2.205 - - [18/Oct/2020:19:19:57 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.0.205 - - [18/Oct/2020:19:20:52 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.2.205 - - [18/Oct/2020:19:23:10 -0400] &#34;GET / HTTP/2.0&#34; 304 -</pre>
</div>
</div>
<div class="paragraph">
<p>The other method is using the web browser’s built in site debugger or <code>tcpdump</code>; however, using either method is beyond the scope of this document.</p>
</div>
<div class="paragraph">
<p>Support for HTTP2 reverse proxy connections by using the <span class="filename">mod_proxy_http2.so</span> module.
When configuring the ProxyPass or RewriteRules [P] statements, they should use h2:// for the connection.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_websites">32.8.4. Dynamic Websites<a class="anchor" href="#_dynamic_websites"></a></h3>
<div class="paragraph">
<p>In addition to mod_perl and mod_php, other languages are available for creating dynamic web content.
These include Django and Ruby on Rails.</p>
</div>
<div class="sect3">
<h4 id="_django">32.8.4.1. Django<a class="anchor" href="#_django"></a></h4>
<div class="paragraph">
<p>Django is a BSD-licensed framework designed to allow developers to write high performance, elegant web applications quickly.
It provides an object-relational mapper so that data types are developed as Python objects.
A rich dynamic database-access API is provided for those objects without the developer ever having to write SQL.
It also provides an extensible template system so that the logic of the application is separated from the HTML presentation.</p>
</div>
<div class="paragraph">
<p>Django depends on <span class="filename">mod_python</span>, and an SQL database engine.
In FreeBSD, the <a class="package" href="https://cgit.freebsd.org/ports/tree/www/py-django/">www/py-django</a> port automatically installs <span class="filename">mod_python</span> and supports the PostgreSQL, MySQL, or SQLite databases, with the default being SQLite.
To change the database engine, type <code>make config</code> within <span class="filename">/usr/ports/www/py-django</span>, then install the port.</p>
</div>
<div class="paragraph">
<p>Once Django is installed, the application will need a project directory along with the Apache configuration in order to use the embedded Python interpreter.
This interpreter is used to call the application for specific URLs on the site.</p>
</div>
<div class="paragraph">
<p>To configure Apache to pass requests for certain URLs to the web application, add the following to <span class="filename">httpd.conf</span>, specifying the full path to the project directory:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>&lt;Location &#34;/&#34;&gt;
    SetHandler python-program
    PythonPath &#34;[&#39;/dir/to/the/django/packages/&#39;] + sys.path&#34;
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonAutoReload On
    PythonDebug On
&lt;/Location&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="https://docs.djangoproject.com">https://docs.djangoproject.com</a> for more information on how to use Django.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ruby_on_rails">32.8.4.2. Ruby on Rails<a class="anchor" href="#_ruby_on_rails"></a></h4>
<div class="paragraph">
<p>Ruby on Rails is another open source web framework that provides a full development stack.
It is optimized to make web developers more productive and capable of writing powerful applications quickly.
On FreeBSD, it can be installed using the <a class="package" href="https://cgit.freebsd.org/ports/tree/www/rubygem-rails/">www/rubygem-rails</a> package or port.</p>
</div>
<div class="paragraph">
<p>Refer to <a href="http://guides.rubyonrails.org">http://guides.rubyonrails.org</a> for more information on how to use Ruby on Rails.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-ftp">32.9. File Transfer Protocol (FTP)<a class="anchor" href="#network-ftp"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The File Transfer Protocol (FTP) provides users with a simple way to transfer files to and from an FTP server.
FreeBSD includes FTP server software, ftpd, in the base system.</p>
</div>
<div class="paragraph">
<p>FreeBSD provides several configuration files for controlling access to the FTP server.
This section summarizes these files.
Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> for more details about the built-in FTP server.</p>
</div>
<div class="sect2">
<h3 id="_configuration">32.9.1. Configuration<a class="anchor" href="#_configuration"></a></h3>
<div class="paragraph">
<p>The most important configuration step is deciding which accounts will be allowed access to the FTP server.
A FreeBSD system has a number of system accounts which should not be allowed FTP access.
The list of users disallowed any FTP access can be found in <span class="filename">/etc/ftpusers</span>. By default, it includes system accounts.
Additional users that should not be allowed access to FTP can be added.</p>
</div>
<div class="paragraph">
<p>In some cases it may be desirable to restrict the access of some users without preventing them completely from using FTP.
This can be accomplished be creating <span class="filename">/etc/ftpchroot</span> as described in <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpchroot&amp;sektion=5&amp;format=html">ftpchroot(5)</a>.
This file lists users and groups subject to FTP access restrictions.</p>
</div>
<div class="paragraph">
<p>To enable anonymous FTP access to the server, create a user named <code>ftp</code> on the FreeBSD system.
Users will then be able to log on to the FTP server with a username of <code>ftp</code> or <code>anonymous</code>.
When prompted for the password, any input will be accepted, but by convention, an email address should be used as the password.
The FTP server will call <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> when an anonymous user logs in, to restrict access to only the home directory of the <code>ftp</code> user.</p>
</div>
<div class="paragraph">
<p>There are two text files that can be created to specify welcome messages to be displayed to FTP clients.
The contents of <span class="filename">/etc/ftpwelcome</span> will be displayed to users before they reach the login prompt.
After a successful login, the contents of <span class="filename">/etc/ftpmotd</span> will be displayed.
Note that the path to this file is relative to the login environment, so the contents of <span class="filename">~ftp/etc/ftpmotd</span> would be displayed for anonymous users.</p>
</div>
<div class="paragraph">
<p>Once the FTP server has been configured, set the appropriate variable in <span class="filename">/etc/rc.conf</span> to start the service during boot:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ftpd_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>To start the service now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service ftpd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Test the connection to the FTP server by typing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="gp">% </span>ftp localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ftpd daemon uses <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> to log messages.
By default, the system log daemon will write messages related to FTP in <span class="filename">/var/log/xferlog</span>.
The location of the FTP log can be modified by changing the following line in <span class="filename">/etc/syslog.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ftp.info      /var/log/xferlog</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Be aware of the potential problems involved with running an anonymous FTP server.
In particular, think twice about allowing anonymous users to upload files.
It may turn out that the FTP site becomes a forum for the trade of unlicensed commercial software or worse.
If anonymous FTP uploads are required, then verify the permissions so that these files cannot be read by other anonymous users until they have been reviewed by an administrator.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)<a class="anchor" href="#network-samba"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Samba is a popular open source software package that provides file and print services using the SMB/CIFS protocol.
This protocol is built into Microsoft® Windows® systems.
It can be added to non-Microsoft® Windows® systems by installing the Samba client libraries.
The protocol allows clients to access shared data and printers.
These shares can be mapped as a local disk drive and shared printers can be used as if they were local printers.</p>
</div>
<div class="paragraph">
<p>On FreeBSD, the Samba client libraries can be installed using the <a class="package" href="https://cgit.freebsd.org/ports/tree/net/samba413/">net/samba413</a> port or package.
The client provides the ability for a FreeBSD system to access SMB/CIFS shares in a Microsoft® Windows® network.</p>
</div>
<div class="paragraph">
<p>A FreeBSD system can also be configured to act as a Samba server by installing the same <a class="package" href="https://cgit.freebsd.org/ports/tree/net/samba413/">net/samba413</a> port or package.
This allows the administrator to create SMB/CIFS shares on the FreeBSD system which can be accessed by clients running Microsoft® Windows® or the Samba client libraries.</p>
</div>
<div class="sect2">
<h3 id="_server_configuration">32.10.1. Server Configuration<a class="anchor" href="#_server_configuration"></a></h3>
<div class="paragraph">
<p>Samba is configured in <span class="filename">/usr/local/etc/smb4.conf</span>.
This file must be created before Samba can be used.</p>
</div>
<div class="paragraph">
<p>A simple <span class="filename">smb4.conf</span> to share directories and printers with Windows® clients in a workgroup is shown here.
For more complex setups involving LDAP or Active Directory, it is easier to use <a href="https://man.freebsd.org/cgi/man.cgi?query=samba-tool&amp;sektion=8&amp;format=html">samba-tool(8)</a> to create the initial <span class="filename">smb4.conf</span>.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>[global]
workgroup = WORKGROUP
server string = Samba Server Version %v
netbios name = ExampleMachine
wins support = Yes
security = user
passdb backend = tdbsam

# Example: share /usr/src accessible only to &#39;developer&#39; user
[src]
path = /usr/src
valid users = developer
writable  = yes
browsable = yes
read only = no
guest ok = no
public = no
create mask = 0666
directory mask = 0755</pre>
</div>
</div>
<div class="sect3">
<h4 id="_global_settings">32.10.1.1. Global Settings<a class="anchor" href="#_global_settings"></a></h4>
<div class="paragraph">
<p>Settings that describe the network are added in <span class="filename">/usr/local/etc/smb4.conf</span>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>workgroup</code></dt>
<dd>
<p>The name of the workgroup to be served.</p>
</dd>
<dt class="hdlist1"><code>netbios name</code></dt>
<dd>
<p>The NetBIOS name by which a Samba server is known.
By default, it is the same as the first component of the host’s DNS name.</p>
</dd>
<dt class="hdlist1"><code>server string</code></dt>
<dd>
<p>The string that will be displayed in the output of <code>net view</code> and some other networking tools that seek to display descriptive text about the server.</p>
</dd>
<dt class="hdlist1"><code>wins support</code></dt>
<dd>
<p>Whether Samba will act as a WINS server.
Do not enable support for WINS on more than one server on the network.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_security_settings">32.10.1.2. Security Settings<a class="anchor" href="#_security_settings"></a></h4>
<div class="paragraph">
<p>The most important settings in <span class="filename">/usr/local/etc/smb4.conf</span> are the security model and the backend password format.
These directives control the options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>security</code></dt>
<dd>
<p>The most common settings are <code>security = share</code> and <code>security = user</code>.
If the clients use usernames that are the same as their usernames on the FreeBSD machine, user level security should be used.
This is the default security policy and it requires clients to first log on before they can access shared resources.</p>
<div class="paragraph">
<p>In share level security, clients do not need to log onto the server with a valid username and password before attempting to connect to a shared resource.
This was the default security model for older versions of Samba.</p>
</div>
</dd>
<dt class="hdlist1"><code>passdb backend</code></dt>
<dd>
<p>Samba has several different backend authentication models.
Clients may be authenticated with LDAP, NIS+, an SQL database, or a modified password file.
The recommended authentication method, <code>tdbsam</code>, is ideal for simple networks and is covered here.
For larger or more complex networks, <code>ldapsam</code> is recommended.
<code>smbpasswd</code> was the former default and is now obsolete.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_samba_users">32.10.1.3. Samba Users<a class="anchor" href="#_samba_users"></a></h4>
<div class="paragraph">
<p>FreeBSD user accounts must be mapped to the <code>SambaSAMAccount</code> database for Windows® clients to access the share.
Map existing FreeBSD user accounts using <a href="https://man.freebsd.org/cgi/man.cgi?query=pdbedit&amp;sektion=8&amp;format=html">pdbedit(8)</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pdbedit -a -u username</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This section has only mentioned the most commonly used settings.
Refer to the <a href="https://wiki.samba.org">Official Samba Wiki</a> for additional information about the available configuration options.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_starting_samba">32.10.2. Starting Samba<a class="anchor" href="#_starting_samba"></a></h3>
<div class="paragraph">
<p>To enable Samba at boot time, add the following line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>samba_server_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>To start Samba now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service samba_server start</span>
Performing sanity check on Samba configuration: OK
Starting nmbd.
Starting smbd.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Samba consists of three separate daemons.
Both the nmbd and smbd daemons are started by <code>samba_enable</code>.
If winbind name resolution is also required, set:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>winbindd_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Samba can be stopped at any time by typing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service samba_server stop</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Samba is a complex software suite with functionality that allows broad integration with Microsoft® Windows® networks.
For more information about functionality beyond the basic configuration described here, refer to <a href="https://www.samba.org">https://www.samba.org</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-ntp">32.11. Clock Synchronization with NTP<a class="anchor" href="#network-ntp"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Over time, a computer’s clock is prone to drift.
This is problematic as many network services require the computers on a network to share the same accurate time.
Accurate time is also needed to ensure that file timestamps stay consistent.
The Network Time Protocol (NTP) is one way to provide clock accuracy in a network.</p>
</div>
<div class="paragraph">
<p>FreeBSD includes <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> which can be configured to query other NTP servers to synchronize the clock on that machine or to provide time services to other computers in the network.</p>
</div>
<div class="paragraph">
<p>This section describes how to configure ntpd on FreeBSD.
Further documentation can be found in <span class="filename">/usr/share/doc/ntp/</span> in HTML format.</p>
</div>
<div class="sect2">
<h3 id="_ntp_configuration">32.11.1. NTP Configuration<a class="anchor" href="#_ntp_configuration"></a></h3>
<div class="paragraph">
<p>On FreeBSD, the built-in ntpd can be used to synchronize a system’s clock.
ntpd is configured using <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> variables and <span class="filename">/etc/ntp.conf</span>, as detailed in the following sections.</p>
</div>
<div class="paragraph">
<p>ntpd communicates with its network peers using UDP packets.
Any firewalls between your machine and its NTP peers must be configured to allow UDP packets in and out on port 123.</p>
</div>
<div class="sect3">
<h4 id="_the_etcntp_conf_file">32.11.1.1. The <span class="filename">/etc/ntp.conf</span> file<a class="anchor" href="#_the_etcntp_conf_file"></a></h4>
<div class="paragraph">
<p>ntpd reads <span class="filename">/etc/ntp.conf</span> to determine which NTP servers to query.
Choosing several NTP servers is recommended in case one of the servers becomes unreachable or its clock proves unreliable.
As ntpd receives responses, it favors reliable servers over the less reliable ones.
The servers which are queried can be local to the network, provided by an ISP, or selected from an <a href="http://support.ntp.org/bin/view/Servers/WebHome"> online list of publicly accessible NTP servers</a>.
When choosing a public NTP server, select one that is geographically close and review its usage policy.
The <code>pool</code> configuration keyword selects one or more servers from a pool of servers.
An <a href="http://support.ntp.org/bin/view/Servers/NTPPoolServers"> online list of publicly accessible NTP pools</a> is available, organized by geographic area.
In addition, FreeBSD provides a project-sponsored pool, <code>0.freebsd.pool.ntp.org</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Sample <span class="filename">/etc/ntp.conf</span></div>
<div class="content">
<div class="paragraph">
<p>This is a simple example of an <span class="filename">ntp.conf</span> file.
It can safely be used as-is; it contains the recommended <code>restrict</code> options for operation on a publicly-accessible network connection.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre># Disallow ntpq control/query access.  Allow peers to be added only
# based on pool and server statements in this file.
restrict default limited kod nomodify notrap noquery nopeer
restrict source  limited kod nomodify notrap noquery

# Allow unrestricted access from localhost for queries and control.
restrict 127.0.0.1
restrict ::1

# Add a specific server.
server ntplocal.example.com iburst

# Add FreeBSD pool servers until 3-6 good servers are available.
tos minclock 3 maxclock 6
pool 0.freebsd.pool.ntp.org iburst

# Use a local leap-seconds file.
leapfile &#34;/var/db/ntpd.leap-seconds.list&#34;</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The format of this file is described in <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.
The descriptions below provide a quick overview of just the keywords used in the sample file above.</p>
</div>
<div class="paragraph">
<p>By default, an NTP server is accessible to any network host.
The <code>restrict</code> keyword controls which systems can access the server.
Multiple <code>restrict</code> entries are supported, each one refining the restrictions given in previous statements.
The values shown in the example grant the local system full query and control access, while allowing remote systems only the ability to query the time.
For more details, refer to the <code>Access Control Support</code> subsection of <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.</p>
</div>
<div class="paragraph">
<p>The <code>server</code> keyword specifies a single server to query.
The file can contain multiple server keywords, with one server listed on each line.
The <code>pool</code> keyword specifies a pool of servers.
ntpd will add one or more servers from this pool as needed to reach the number of peers specified using the <code>tos minclock</code> value.
The <code>iburst</code> keyword directs ntpd to perform a burst of eight quick packet exchanges with a server when contact is first established, to help quickly synchronize system time.</p>
</div>
<div class="paragraph">
<p>The <code>leapfile</code> keyword specifies the location of a file containing information about leap seconds.
The file is updated automatically by <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>.
The file location specified by this keyword must match the location set in the <code>ntp_db_leapfile</code> variable in <span class="filename">/etc/rc.conf</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ntp_entries_in_etcrc_conf">32.11.1.2. NTP entries in <span class="filename">/etc/rc.conf</span><a class="anchor" href="#_ntp_entries_in_etcrc_conf"></a></h4>
<div class="paragraph">
<p>Set <code>ntpd_enable=YES</code> to start ntpd at boot time.
Once <code>ntpd_enable=YES</code> has been added to <span class="filename">/etc/rc.conf</span>, ntpd can be started immediately without rebooting the system by typing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service ntpd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Only <code>ntpd_enable</code> must be set to use ntpd.
The <span class="filename">rc.conf</span> variables listed below may also be set as needed.</p>
</div>
<div class="paragraph">
<p>Set <code>ntpd_sync_on_start=YES</code> to allow ntpd to step the clock any amount, one time at startup.
Normally ntpd will log an error message and exit if the clock is off by more than 1000 seconds.
This option is especially useful on systems without a battery-backed realtime clock.</p>
</div>
<div class="paragraph">
<p>Set <code>ntpd_oomprotect=YES</code> to protect the ntpd daemon from being killed by the system attempting to recover from an Out Of Memory (OOM) condition.</p>
</div>
<div class="paragraph">
<p>Set <code>ntpd_config=</code> to the location of an alternate <span class="filename">ntp.conf</span> file.</p>
</div>
<div class="paragraph">
<p>Set <code>ntpd_flags=</code> to contain any other ntpd flags as needed, but avoid using these flags which are managed internally by <span class="filename">/etc/rc.d/ntpd</span>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-p</code> (pid file location)</p>
</li>
<li>
<p><code>-c</code> (set <code>ntpd_config=</code> instead)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ntpd_and_the_unpriveleged_ntpd_user">32.11.1.3. ntpd and the unpriveleged <code>ntpd</code> user<a class="anchor" href="#_ntpd_and_the_unpriveleged_ntpd_user"></a></h4>
<div class="paragraph">
<p>ntpd on FreeBSD can start and run as an unpriveleged user.
Doing so requires the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ntpd&amp;sektion=4&amp;format=html">mac_ntpd(4)</a> policy module.
The <span class="filename">/etc/rc.d/ntpd</span> startup script first examines the NTP configuration.
If possible, it loads the <code>mac_ntpd</code> module, then starts ntpd as unpriveleged user <code>ntpd</code> (user id 123).
To avoid problems with file and directory access, the startup script will not automatically start ntpd as <code>ntpd</code> when the configuration contains any file-related options.</p>
</div>
<div class="paragraph">
<p>The presence of any of the following in <code>ntpd_flags</code> requires manual configuration as described below to run as the <code>ntpd</code> user:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>-f or --driftfile</p>
</li>
<li>
<p>-i or --jaildir</p>
</li>
<li>
<p>-k or --keyfile</p>
</li>
<li>
<p>-l or --logfile</p>
</li>
<li>
<p>-s or --statsdir</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The presence of any of the following keywords in <span class="filename">ntp.conf</span> requires manual configuration as described below to run as the <code>ntpd</code> user:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>crypto</p>
</li>
<li>
<p>driftfile</p>
</li>
<li>
<p>key</p>
</li>
<li>
<p>logdir</p>
</li>
<li>
<p>statsdir</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To manually configure ntpd to run as user <code>ntpd</code> you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure that the <code>ntpd</code> user has access to all the files and directories specified in the configuration.</p>
</li>
<li>
<p>Arrange for the <code>mac_ntpd</code> module to be loaded or compiled into the kernel. See <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ntpd&amp;sektion=4&amp;format=html">mac_ntpd(4)</a> for details.</p>
</li>
<li>
<p>Set <code>ntpd_user=&#34;ntpd&#34;</code> in <span class="filename">/etc/rc.conf</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_ntp_with_a_ppp_connection">32.11.2. Using NTP with a PPP Connection<a class="anchor" href="#_using_ntp_with_a_ppp_connection"></a></h3>
<div class="paragraph">
<p>ntpd does not need a permanent connection to the Internet to function properly.
However, if a PPP connection is configured to dial out on demand, NTP traffic should be prevented from triggering a dial out or keeping the connection alive.
This can be configured with <code>filter</code> directives in <span class="filename">/etc/ppp/ppp.conf</span>. For example:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>set filter dial 0 deny udp src eq 123
# Prevent NTP traffic from initiating dial out
set filter dial 1 permit 0 0
set filter alive 0 deny udp src eq 123
# Prevent incoming NTP traffic from keeping the connection open
set filter alive 1 deny udp dst eq 123
# Prevent outgoing NTP traffic from keeping the connection open
set filter alive 2 permit 0/0 0/0</pre>
</div>
</div>
<div class="paragraph">
<p>For more details, refer to the <code>PACKET FILTERING</code> section in <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> and the examples in <span class="filename">/usr/share/examples/ppp/</span>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some Internet access providers block low-numbered ports, preventing NTP from functioning since replies never reach the machine.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="network-iscsi">32.12. iSCSI Initiator and Target Configuration<a class="anchor" href="#network-iscsi"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>iSCSI is a way to share storage over a network.
Unlike NFS, which works at the file system level, iSCSI works at the block device level.</p>
</div>
<div class="paragraph">
<p>In iSCSI terminology, the system that shares the storage is known as the <em>target</em>.
The storage can be a physical disk, or an area representing multiple disks or a portion of a physical disk.
For example, if the disk(s) are formatted with ZFS, a zvol can be created to use as the iSCSI storage.</p>
</div>
<div class="paragraph">
<p>The clients which access the iSCSI storage are called <em>initiators</em>.
To initiators, the storage available through iSCSI appears as a raw, unformatted disk known as a LUN.
Device nodes for the disk appear in <span class="filename">/dev/</span> and the device must be separately formatted and mounted.</p>
</div>
<div class="paragraph">
<p>FreeBSD provides a native, kernel-based iSCSI target and initiator.
This section describes how to configure a FreeBSD system as a target or an initiator.</p>
</div>
<div class="sect2">
<h3 id="network-iscsi-target">32.12.1. Configuring an iSCSI Target<a class="anchor" href="#network-iscsi-target"></a></h3>
<div class="paragraph">
<p>To configure an iSCSI target, create the <span class="filename">/etc/ctl.conf</span> configuration file, add a line to <span class="filename">/etc/rc.conf</span> to make sure the <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> daemon is automatically started at boot, and then start the daemon.</p>
</div>
<div class="paragraph">
<p>The following is an example of a simple <span class="filename">/etc/ctl.conf</span> configuration file.
Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=ctl.conf&amp;sektion=5&amp;format=html">ctl.conf(5)</a> for a more complete description of this file’s available options.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>portal-group pg0 {
	discovery-auth-group no-authentication
	listen 0.0.0.0
	listen [::]
}

target iqn.2012-06.com.example:target0 {
	auth-group no-authentication
	portal-group pg0

	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre>
</div>
</div>
<div class="paragraph">
<p>The first entry defines the <code>pg0</code> portal group.
Portal groups define which network addresses the <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> daemon will listen on.
The <code>discovery-auth-group no-authentication</code> entry indicates that any initiator is allowed to perform iSCSI target discovery without authentication.
Lines three and four configure <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> to listen on all IPv4 (<code>listen 0.0.0.0</code>) and IPv6 (<code>listen [::]</code>) addresses on the default port of 3260.</p>
</div>
<div class="paragraph">
<p>It is not necessary to define a portal group as there is a built-in portal group called <code>default</code>.
In this case, the difference between <code>default</code> and <code>pg0</code> is that with <code>default</code>, target discovery is always denied, while with <code>pg0</code>, it is always allowed.</p>
</div>
<div class="paragraph">
<p>The second entry defines a single target.
Target has two possible meanings: a machine serving iSCSI or a named group of LUNs.
This example uses the latter meaning, where <code>iqn.2012-06.com.example:target0</code> is the target name.
This target name is suitable for testing purposes.
For actual use, change <code>com.example</code> to the real domain name, reversed.
The <code>2012-06</code> represents the year and month of acquiring control of that domain name, and <code>target0</code> can be any value.
Any number of targets can be defined in this configuration file.</p>
</div>
<div class="paragraph">
<p>The <code>auth-group no-authentication</code> line allows all initiators to connect to the specified target and <code>portal-group pg0</code> makes the target reachable through the <code>pg0</code> portal group.</p>
</div>
<div class="paragraph">
<p>The next section defines the LUN.
To the initiator, each LUN will be visible as a separate disk device.
Multiple LUNs can be defined for each target.
Each LUN is identified by a number, where LUN 0 is mandatory.
The <code>path /data/target0-0</code> line defines the full path to a file or zvol backing the LUN.
That path must exist before starting <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a>.
The second line is optional and specifies the size of the LUN.</p>
</div>
<div class="paragraph">
<p>Next, to make sure the <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> daemon is started at boot, add this line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ctld_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>To start <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> now, run this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service ctld start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As the <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> daemon is started, it reads <span class="filename">/etc/ctl.conf</span>.
If this file is edited after the daemon starts, use this command so that the changes take effect immediately:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service ctld reload</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_authentication">32.12.1.1. Authentication<a class="anchor" href="#_authentication"></a></h4>
<div class="paragraph">
<p>The previous example is inherently insecure as it uses no authentication, granting anyone full access to all targets.
To require a username and password to access targets, modify the configuration as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>auth-group ag0 {
	chap username1 secretsecret
	chap username2 anothersecret
}

portal-group pg0 {
	discovery-auth-group no-authentication
	listen 0.0.0.0
	listen [::]
}

target iqn.2012-06.com.example:target0 {
	auth-group ag0
	portal-group pg0
	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>auth-group</code> section defines username and password pairs.
An initiator trying to connect to <code>iqn.2012-06.com.example:target0</code> must first specify a defined username and secret.
However, target discovery is still permitted without authentication.
To require target discovery authentication, set <code>discovery-auth-group</code> to a defined <code>auth-group</code> name instead of <code>no-authentication</code>.</p>
</div>
<div class="paragraph">
<p>It is common to define a single exported target for every initiator.
As a shorthand for the syntax above, the username and password can be specified directly in the target entry:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>target iqn.2012-06.com.example:target0 {
	portal-group pg0
	chap username1 secretsecret

	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="network-iscsi-initiator">32.12.2. Configuring an iSCSI Initiator<a class="anchor" href="#network-iscsi-initiator"></a></h3>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The iSCSI initiator described in this section is supported starting with FreeBSD 10.0-RELEASE.
To use the iSCSI initiator available in older versions, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=iscontrol&amp;sektion=8&amp;format=html">iscontrol(8)</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The iSCSI initiator requires that the <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> daemon is running.
This daemon does not use a configuration file.
To start it automatically at boot, add this line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>iscsid_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>To start <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> now, run this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service iscsid start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Connecting to a target can be done with or without an <span class="filename">/etc/iscsi.conf</span> configuration file.
This section demonstrates both types of connections.</p>
</div>
<div class="sect3">
<h4 id="_connecting_to_a_target_without_a_configuration_file">32.12.2.1. Connecting to a Target Without a Configuration File<a class="anchor" href="#_connecting_to_a_target_without_a_configuration_file"></a></h4>
<div class="paragraph">
<p>To connect an initiator to a single target, specify the IP address of the portal and the name of the target:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># iscsictl -A -p 10.10.10.10 -t iqn.2012-06.com.example:target0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To verify if the connection succeeded, run <code>iscsictl</code> without any arguments.
The output should look similar to this:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Connected: da0</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the iSCSI session was successfully established, with <span class="filename">/dev/da0</span> representing the attached LUN.
If the <code>iqn.2012-06.com.example:target0</code> target exports more than one LUN, multiple device nodes will be shown in that section of the output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">Connected: da0 da1 da2.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any errors will be reported in the output, as well as the system logs.
For example, this message usually means that the <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> daemon is not running:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Waiting for iscsid(8)</pre>
</div>
</div>
<div class="paragraph">
<p>The following message suggests a networking problem, such as a wrong IP address or port:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.11     Connection refused</pre>
</div>
</div>
<div class="paragraph">
<p>This message means that the specified target name is wrong:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Not found</pre>
</div>
</div>
<div class="paragraph">
<p>This message means that the target requires authentication:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Authentication failed</pre>
</div>
</div>
<div class="paragraph">
<p>To specify a CHAP username and secret, use this syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># iscsictl -A -p 10.10.10.10 -t iqn.2012-06.com.example:target0 -u user -s secretsecret</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_connecting_to_a_target_with_a_configuration_file">32.12.2.2. Connecting to a Target with a Configuration File<a class="anchor" href="#_connecting_to_a_target_with_a_configuration_file"></a></h4>
<div class="paragraph">
<p>To connect using a configuration file, create <span class="filename">/etc/iscsi.conf</span> with contents like this:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>t0 {
	TargetAddress   = 10.10.10.10
	TargetName      = iqn.2012-06.com.example:target0
	AuthMethod      = CHAP
	chapIName       = user
	chapSecret      = secretsecret
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>t0</code> specifies a nickname for the configuration file section.
It will be used by the initiator to specify which configuration to use.
The other lines specify the parameters to use during connection.
The <code>TargetAddress</code> and <code>TargetName</code> are mandatory, whereas the other options are optional.
In this example, the CHAP username and secret are shown.</p>
</div>
<div class="paragraph">
<p>To connect to the defined target, specify the nickname:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># iscsictl -An t0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternately, to connect to all targets defined in the configuration file, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># iscsictl -Aa</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To make the initiator automatically connect to all targets in <span class="filename">/etc/iscsi.conf</span>, add the following to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>iscsictl_enable=&#34;YES&#34;
iscsictl_flags=&#34;-Aa&#34;</pre>
</div>
</div>
</div>
</div>
</div>
</div>

    </div>
    
    <hr />
    <div class="last-modified">
      <p><strong>Last modified on</strong>: March 20, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=1791636" target="_blank">fiercex</a></p>
    </div>
    
    <div class="buttons">
      
      <div class="prev">
        <i class="fa fa-angle-left" aria-hidden="true" title="Prev"></i>
        <div class="container">
          
            <a href=https://free.bsd-doc.org/en/books/handbook/mail class="direction">Prev</a>
          
        </div>
      </div>
      
      <div class="home">
        <i class="fa fa-home" aria-hidden="true" title="Home"></i>
        <div class="container">
          
            <a href="../" class="direction">Home</a>
          
        </div>
      </div>
      
      <div class="next">
        <div class="container">
          
            <a href=https://free.bsd-doc.org/en/books/handbook/firewalls  class="direction">Next</a>
          
        </div>
        <i class="fa fa-angle-right" aria-hidden="true" title="Next"></i>
      </div>
      
    </div>
    <label class="hidden book-menu-overlay" for="menu-control"></label>
  </div>
  <aside class="toc">
    <div class="toc-content">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#network-servers-synopsis">32.1. Synopsis</a></li>
    <li><a href="#network-inetd">32.2. The inetd Super-Server</a></li>
    <li><a href="#network-nfs">32.3. Network File System (NFS)</a></li>
    <li><a href="#network-nis">32.4. Network Information System (NIS)</a></li>
    <li><a href="#network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="#network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="#network-dns">32.7. Domain Name System (DNS)</a></li>
    <li><a href="#network-apache">32.8. Apache HTTP Server</a></li>
    <li><a href="#network-ftp">32.9. File Transfer Protocol (FTP)</a></li>
    <li><a href="#network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="#network-ntp">32.11. Clock Synchronization with NTP</a></li>
    <li><a href="#network-iscsi">32.12. iSCSI Initiator and Target Configuration</a></li>
  </ul>
</nav>
      <hr />
      
    </div>
  </aside>
  <a class="to-top" href="#top">
    <i class="fa fa-arrow-circle-up" aria-hidden="true"></i>
  </a>
</main>

    <footer>
  <div class="footer-container">
    <section class="logo-column">
          <img src="https://free.bsd-doc.org/images/FreeBSD-colors.svg" width="160" height="50" alt="FreeBSD logo" />
        <div class="options-container">
          
            <div class="language-container">
              <a id="languages" href="https://free.bsd-doc.org/en/languages">
                
                <img src="https://free.bsd-doc.org/images/language.png" class="language-image" alt="Choose language">
                <span>English</span>
              </a>
            </div>
          
          <div class="theme-container">
            <select id="theme-chooser">
	      <option value="theme-system">System</option>
              <option value="theme-light">Light</option>
              <option value="theme-dark">Dark</option>
              <option value="theme-high-contrast">High contrast</option>
            </select>
          </div>
        </div>
      </section>
      
      <section class="copyright-column">
        <p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p>
        <span>Made with <span class="heart">♥</span> by the FreeBSD Community</span>
      </section>
  </div>
</footer>

  </body>
</html>
