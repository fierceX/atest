<!DOCTYPE html>
<html class="theme-light" lang="zh-cn">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Jails improve on the concept of the traditional chroot environment in several ways"/>
  <meta name="keywords" content="91, 34, 106, 97, 105, 108, 115, 34, 44, 32, 34, 99, 114, 101, 97, 116, 105, 110, 103, 34, 44, 32, 34, 109, 97, 110, 97, 103, 105, 110, 103, 34, 44, 32, 34, 117, 112, 100, 97, 116, 105, 110, 103, 34, 93"/>
  <meta name="copyright" content="1995-2023 The FreeBSD Foundation" />
  <link rel="canonical" href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/" />

  <title>Chapter 17. Jails and Containers |  FreeBSD Documentation Portal</title>

  <meta name="theme-color" content="#790000">
  <meta name="color-scheme" content="system light dark high-contrast">

    <link rel="shortcut icon" href="https://free.bsd-doc.org/favicon.ico">
    <link rel="stylesheet" href="/styles/main.min.css">
    <link rel="stylesheet" href="https://free.bsd-doc.org/css/font-awesome-min.css">
    <script defer src="/js/theme-chooser.min.js"></script>
    <script defer src="/js/copy-clipboard.min.js"></script>
    <script defer src="/js/search.min.js"></script>

  
  
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:domain" content="docs.FreeBSD.org"/>
    <meta name="twitter:site" content="@freebsd"/>
    <meta name="twitter:url" content="https://twitter.com/freebsd"/>
    <meta property="og:title" content="Chapter 17. Jails and Containers" />
    <meta property="og:description" content="Jails improve on the concept of the traditional chroot environment in several ways" />
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://free.bsd-doc.orgfavicon.ico"/>
    <meta property="og:image:alt" content="FreeBSD Logo">
    <meta property="og:locale" content="zh-cn" />
    <meta property="og:url" content="https://free.bsd-doc.org/zh-cn/books/handbook/jails/" />
    <meta property="og:site_name" content="FreeBSD Documentation Portal" />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "url": "https:\/\/free.bsd-doc.org\/zh-cn\/books\/handbook\/jails\/",
        "name": "FreeBSD Documentation Portal",
        "headline": "FreeBSD Documentation Portal",
        "description": "FreeBSD Documentation Portal"
      }
    </script>
    

  
</head>


  <body>
    <header>
  <div class="header-container">
    <div class="logo-menu-bars-container">
      <a href="https://free.bsd-doc.org" class="logo">
        <img src="https://free.bsd-doc.org/images/FreeBSD-monochromatic.svg" width="160" height="50" alt="FreeBSD logo" />
      </a>
      <label class="menu-bars" for="menu-bars">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </div>
    <input id="menu-bars" type="checkbox" />
    
    <div class="search-donate-container">
      
      <div class="donate">
        <a href="https://github.com/fierceX/freebsd-doc-cn" target="_blank">
          <span class="heart">♥</span>
          GitHub
        </a>
      </div>
    </div>
  </div>
</header>

    
<input type="checkbox" class="hidden toggle" id="menu-control">
<main class="main-wrapper-book">
  <a id="top"></a>
  
  <aside class="book-menu">
    <div class="book-menu-content">
      <input id="search-book" type="text" placeholder="Search" aria-label="Search" maxlength="128" />
      <nav id="MenuContents">
        
  <ul>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ada319c45e780947f82b569049480cc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-8ada319c45e780947f82b569049480cc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/">
              Preface
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-audience">Intended Audience</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-changes-from4">Fourth Edition</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-changes-from3">Third Edition</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-changes-from2">Second Edition (2004)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-changes">First Edition (2001)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-overview">Organization of This Book</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-conv">Conventions used in this book</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/preface/#preface-acknowledgements">Acknowledgments</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-32a83d18a326852a8d9ae2582360bbc8" class="toggle"  />
          <label  for="chapter-32a83d18a326852a8d9ae2582360bbc8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/parti/">
              第一部分：入门指南
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a4909db05d872d16d5be86a57cbc2dc7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a4909db05d872d16d5be86a57cbc2dc7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/introduction/">
              第一章 引言
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/introduction/#introduction-synopsis">1.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/introduction/#nutshell">1.2. 欢迎来到 FreeBSD ！</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/introduction/#history">1.3. 关于 FreeBSD 项目</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3c2455cadf89eadd3f6e77461085d5e9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3c2455cadf89eadd3f6e77461085d5e9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/">
              第二章 安装 FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-synopsis">2.1. 简介</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-hardware">2.2. 最低硬件要求</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-pre">2.3. 安装前的任务</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-start">2.4. Starting the Installation</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#using-bsdinstall">2.5. 使用 bsdinstall</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-partitioning">2.6. Allocating Disk Space</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-fetching-distribution">2.7. Fetching Distribution Files</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-post">2.8. Network Interfaces, Accounts, Time Zone, Services and Hardening</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#bsdinstall-install-trouble">2.9. Troubleshooting</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bsdinstall/#using-live-cd">2.10. Using the Live CD</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-709481b75d22ad36960f7ac166b3306c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-709481b75d22ad36960f7ac166b3306c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/">
              第三章. FreeBSD 基础知识
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#basics-synopsis">3.1. 概要</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#consoles">3.2. 虚拟控制台和终端</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#users-synopsis">3.3. 用户和基本账户管理</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#permissions">3.4. 权限</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#dirstructure">3.5. 目录结构</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#disk-organization">3.6. 磁盘组织</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#mount-unmount">3.7. 挂载和卸载文件系统</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#basics-processes">3.8. 进程和守护进程</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#shells">3.9. Shells</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#editors">3.10. Text Editors</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#basics-devices">3.11. Devices and Device Nodes</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/basics/#basics-more-information">3.12. Manual Pages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-58c050d31a1fbecd859248dacefeb567" class="toggle"  />
          <label  class="icon cursor"  for="chapter-58c050d31a1fbecd859248dacefeb567"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/">
              Chapter 4. Installing Applications: Packages and Ports
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-synopsis">4.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-overview">4.2. Overview of Software Installation</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-finding-applications">4.3. Finding Software</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#pkgng-intro">4.4. Using pkg for Binary Package Management</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-using">4.5. Using the Ports Collection</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-poudriere">4.6. Building Packages with poudriere</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-nextsteps">4.7. Post-Installation Considerations</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ports/#ports-broken">4.8. Dealing with Broken Ports</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e5a000ce7f50680a180e2c1b83c121bc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e5a000ce7f50680a180e2c1b83c121bc"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/">
              Chapter 5. The X Window System
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/#x11-synopsis">5.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/#x-install">5.2. Installing Xorg</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/#x-graphic-card-drivers">5.3. Graphic card drivers</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/#x-config">5.4. Xorg Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/x11/#x-fonts">5.5. Using Fonts in Xorg</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-235af08fb87fd7a58003348706d2111d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-235af08fb87fd7a58003348706d2111d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/">
              Chapter 6. Wayland
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-synopsis">6.1. Wayland Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-wayfire">6.2. The Wayfire Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-hikari">6.3. The Hikari Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-sway">6.4. The Sway Compositor</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-xwayland">6.5. Using Xwayland</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-remotedesktop">6.6. Remote Desktop Using VNC</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-ly">6.7. Wayland Login Manager</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wayland/#wayland-utilities">6.8. Useful Utilities</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4de18483dde20bf9ed0024176afd09da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4de18483dde20bf9ed0024176afd09da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/">
              Chapter 7. Network
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#network-synopsis">7.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#config-network-setup">7.2. Setting up the Network</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#config-network-connection">7.3. Wired Networks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#network-wireless">7.4. Wireless Networks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#hostname">7.5. Hostname</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#dns">7.6. DNS</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network/#troubleshooting">7.7. Troubleshooting</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-5eb30759c3a2873e716dc31d7760054c" class="toggle"  />
          <label  for="chapter-5eb30759c3a2873e716dc31d7760054c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/partii/">
              第二部分：常见任务
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-c96504f017c56f4bc7f71548cccf5382" class="toggle"  />
          <label  class="icon cursor"  for="chapter-c96504f017c56f4bc7f71548cccf5382"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/">
              Chapter 8. Desktop Environments
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-synopsis">8.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-environments">8.2. Desktop Environments</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-browsers">8.3. Browsers</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-development">8.4. Development tools</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-productivity">8.5. Desktop office productivity</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-viewers">8.6. Document Viewers</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/desktop/#desktop-finance">8.7. Finance</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e1898af36aaacc168e13b673d25b908f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e1898af36aaacc168e13b673d25b908f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/">
              Chapter 9. Multimedia
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#multimedia-synopsis">9.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#sound-setup">9.2. Setting Up the Sound Card</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#audio-ports">9.3. Audio players</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#video-ports">9.4. Video players</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#conferencing-meetings">9.5. Conferencing and Meetings</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/multimedia/#scanners">9.6. Image Scanners</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6926664836e63c5cae4b2fa60855f91d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-6926664836e63c5cae4b2fa60855f91d"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/">
              Chapter 10. Configuring the FreeBSD Kernel
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-synopsis">10.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-custom-kernel">10.2. Why Build a Custom Kernel?</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-devices">10.3. Finding the System Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-config">10.4. The Configuration File</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-building">10.5. Building and Installing a Custom Kernel</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/kernelconfig/#kernelconfig-trouble">10.6. If Something Goes Wrong</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-19d36bd70a320268f0ea1f66e4f3e224" class="toggle"  />
          <label  class="icon cursor"  for="chapter-19d36bd70a320268f0ea1f66e4f3e224"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/">
              Chapter 11. Printing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-quick-start">11.1. Quick Start</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-connections">11.2. Printer Connections</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-pdls">11.3. Common Page Description Languages</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-direct">11.4. Direct Printing</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-lpd">11.5. LPD (Line Printer Daemon)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/printing/#printing-other">11.6. Other Printing Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/linuxemu/">
              Chapter 12. Linux Binary Compatibility
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/linuxemu/#linuxemu-synopsis">12.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/linuxemu/#linuxemu-lbc-install">12.2. Configuring Linux Binary Compatibility</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/linuxemu/#linux-userlands">12.3. Linux userlands</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/linuxemu/#linuxemu-advanced">12.4. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-af234c193ce95c480af0ff5ec3f32f5c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-af234c193ce95c480af0ff5ec3f32f5c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/">
              Chapter 13. WINE
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#wine-synopsis">13.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#wine-overview-concepts">13.2. WINE Overview & Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#installing-wine-on-freebsd">13.3. Installing WINE on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#running-first-wine-program">13.4. Running a First WINE Program on FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#configuring-wine-installation">13.5. Configuring WINE Installation</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#wine-management-guis">13.6. WINE Management GUIs</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#wine-in-multi-user-os-installations">13.7. WINE in Multi-User FreeBSD Installations</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/wine/#wine-on-os-faq">13.8. WINE on FreeBSD FAQ</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-51416fdea9d5a1dfa1c2718cd825213a" class="toggle"  />
          <label  for="chapter-51416fdea9d5a1dfa1c2718cd825213a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/partiii/">
              第三部分：系统管理
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-532d0380ba66d66e033765a0b6930ee7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-532d0380ba66d66e033765a0b6930ee7"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/">
              Chapter 14. Configuration, Services, Logging and Power Management
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#config-synopsis">14.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#configtuning-configfiles">14.2. Configuration Files</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#configtuning-rcd">14.3. Managing Services in FreeBSD</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#cron-periodic">14.4. Cron and Periodic</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#configtuning-syslog">14.5. Configuring System Logging</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#acpi-overview">14.6. Power and Resource Management</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/config/#adding-swap-space">14.7. Adding Swap Space</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-d05f41680fb7e3d68b354ae03de368b1" class="toggle"  />
          <label  class="icon cursor"  for="chapter-d05f41680fb7e3d68b354ae03de368b1"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/boot/">
              Chapter 15. The FreeBSD Booting Process
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/boot/#boot-synopsis">15.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/boot/#boot-introduction">15.2. FreeBSD Boot Process</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/boot/#device-hints">15.3. Device Hints</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/boot/#boot-shutdown">15.4. Shutdown Sequence</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-513e8e407c57354df334059688e9b60a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-513e8e407c57354df334059688e9b60a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/">
              Chapter 16. Security
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-synopsis">16.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-intro">16.2. Introduction</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#sec-accounts">16.3. Securing Accounts</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-ids">16.4. Intrusion Detection System (IDS)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-secure-levels">16.5. Secure levels</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-file-flags">16.6. File flags</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#openssh">16.7. OpenSSH</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#openssl">16.8. OpenSSL</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#kerberos5">16.9. Kerberos</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#tcpwrappers">16.10. TCP Wrappers</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#fs-acl">16.11. Access Control Lists</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#capsicum">16.12. Capsicum</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-accounting">16.13. Process Accounting</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-resourcelimits">16.14. Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-pkg">16.15. Monitoring Third Party Security Issues</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/security/#security-advisories">16.16. FreeBSD Security Advisories</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0f7d2858504c83a029928c048d394e2a" class="toggle"  checked  />
          <label  class="icon cursor"  for="chapter-0f7d2858504c83a029928c048d394e2a"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/">
              Chapter 17. Jails and Containers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jails-synopsis">17.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jail-types">17.2. Jail Types</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#host-configuration">17.3. Host Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#classic-jail">17.4. Classic Jail (Thick Jail)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#thin-jail">17.5. Thin Jails</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jail-management">17.6. Jail Management</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jail-upgrading">17.7. Jail Upgrading</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jail-resource-limits">17.8. Jail Resource Limits</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/jails/#jail-managers-and-containers">17.9. Jail Managers and Containers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-15be125ce5997f51c5499e3a0dee6c2c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-15be125ce5997f51c5499e3a0dee6c2c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/">
              Chapter 18. Mandatory Access Control
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-synopsis">18.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-inline-glossary">18.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-understandlabel">18.3. Understanding MAC Labels</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-planning">18.4. Planning the Security Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-policies">18.5. Available MAC Policies</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-userlocked">18.6. User Lock Down</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-implementing">18.7. Nagios in a MAC Jail</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mac/#mac-troubleshoot">18.8. Troubleshooting the MAC Framework</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3f7e8d763b17c7d0c44c60505cf0feea" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3f7e8d763b17c7d0c44c60505cf0feea"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/audit/">
              Chapter 19. Security Event Auditing
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/audit/#audit-synopsis">19.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/audit/#audit-inline-glossary">19.2. Key Terms</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/audit/#audit-config">19.3. Audit Configuration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/audit/#audit-administration">19.4. Working with Audit Trails</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7bb1cb2287cd08a3672cc878e604f0d0" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7bb1cb2287cd08a3672cc878e604f0d0"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/">
              Chapter 20. Storage
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-synopsis">20.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-adding">20.2. Adding Disks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-growing">20.3. Resizing and Growing Disks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#usb-disks">20.4. USB Storage Devices</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#creating-cds">20.5. Creating and Using CD Media</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#creating-dvds">20.6. Creating and Using DVD Media</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#floppies">20.7. Creating and Using Floppy Disks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#using-ntfs">20.8. Using NTFS Disks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#backup-basics">20.9. Backup Basics</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-virtual">20.10. Memory Disks</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#snapshots">20.11. File System Snapshots</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#quotas">20.12. Disk Quotas</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-encrypting">20.13. Encrypting Disk Partitions</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#swap-encrypting">20.14. Encrypting Swap</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/disks/#disks-hast">20.15. Highly Available Storage (HAST)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-dec5fc4f0100e5030db0fb188d8d4b2f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-dec5fc4f0100e5030db0fb188d8d4b2f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/">
              Chapter 21. GEOM: Modular Disk Transformation Framework
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-synopsis">21.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-striping">21.2. RAID0 - Striping</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-mirror">21.3. RAID1 - Mirroring</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-raid3">21.4. RAID3 - Byte-level Striping with Dedicated Parity</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-graid">21.5. Software RAID Devices</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-ggate">21.6. GEOM Gate Network</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-glabel">21.7. Labeling Disk Devices</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/geom/#geom-gjournal">21.8. UFS Journaling Through GEOM</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f1657a05627dd16bad31d4c7f675604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f1657a05627dd16bad31d4c7f675604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/">
              Chapter 22. The Z File System (ZFS)
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-differences">22.1. What Makes ZFS Different</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-quickstart">22.2. Quick Start Guide</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-zpool">22.3. <code>zpool</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-zfs">22.4. <code>zfs</code> Administration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-zfs-allow">22.5. Delegated Administration</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-advanced">22.6. Advanced Topics</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-links">22.7. Further Resources</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/zfs/#zfs-term">22.8. ZFS Features and Terminology</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4c6bf6828e601b79edb2813329ac6604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4c6bf6828e601b79edb2813329ac6604"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/filesystems/">
              Chapter 23. Other File Systems
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/filesystems/#filesystems-synopsis">23.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/filesystems/#filesystems-linux">23.2. Linux® File Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-ae23289d4b6415f3f878893f9d3ef9b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-ae23289d4b6415f3f878893f9d3ef9b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/">
              Chapter 24. Virtualization
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-synopsis">24.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-guest-parallelsdesktop">24.2. FreeBSD as a Guest on Parallels Desktop for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-guest-vmware">24.3. FreeBSD as a Guest on VMware Fusion for macOS®</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-guest-virtualbox">24.4. FreeBSD as a Guest on VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-host-virtualbox">24.5. FreeBSD as a Host with VirtualBox™</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-host-bhyve">24.6. FreeBSD as a Host with bhyve</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/virtualization/#virtualization-host-xen">24.7. FreeBSD as a Xen™-Host</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-b279d2b738963a45a059268d2fae00d5" class="toggle"  />
          <label  class="icon cursor"  for="chapter-b279d2b738963a45a059268d2fae00d5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/l10n/">
              Chapter 25. Localization - i18n/L10n Usage and Setup
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/l10n/#l10n-synopsis">25.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/l10n/#using-localization">25.2. Using Localization</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/l10n/#l10n-compiling">25.3. Finding i18n Applications</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/l10n/#lang-setup">25.4. Locale Configuration for Specific Languages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9e3f99bd76c861ab2e9a5f31ac421842" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9e3f99bd76c861ab2e9a5f31ac421842"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/">
              Chapter 26. Updating and Upgrading FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#updating-upgrading-synopsis">26.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate">26.2. FreeBSD Update</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#updating-bootcode">26.3. Updating Bootcode</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#updating-upgrading-documentation">26.4. Updating the Documentation Set</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#current-stable">26.5. Tracking a Development Branch</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#makeworld">26.6. Updating FreeBSD from Source</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#small-lan">26.7. Tracking for Multiple Machines</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/cutting-edge/#building-on-non-freebsd-hosts">26.8. Building on non-FreeBSD Hosts</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3ba999091575eb04ae88235cd0fb1afa" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3ba999091575eb04ae88235cd0fb1afa"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/dtrace/">
              Chapter 27. DTrace
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/dtrace/#dtrace-synopsis">27.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/dtrace/#dtrace-implementation">27.2. Implementation Differences</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/dtrace/#dtrace-enable">27.3. Enabling DTrace Support</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/dtrace/#dtrace-using">27.4. Using DTrace</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bdb217202a0a3eef4571dd1fcd50863c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bdb217202a0a3eef4571dd1fcd50863c"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/usb-device-mode/">
              Chapter 28. USB Device Mode / USB OTG
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/usb-device-mode/#usb-device-mode-synopsis">28.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/usb-device-mode/#usb-device-mode-terminals">28.2. USB Virtual Serial Ports</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/usb-device-mode/#usb-device-mode-network">28.3. USB Device Mode Network Interfaces</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/usb-device-mode/#usb-device-mode-storage">28.4. USB Virtual Storage Device</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6d4439926bb106ac084ecc88cfd3cfa4" class="toggle"  />
          <label  for="chapter-6d4439926bb106ac084ecc88cfd3cfa4"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/partiv/">
              第四部分：网络通信
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-05a353fcb61d8e035f7c43e14725766e" class="toggle"  />
          <label  class="icon cursor"  for="chapter-05a353fcb61d8e035f7c43e14725766e"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/">
              Chapter 29. Serial Communications
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#serial-synopsis">29.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#serial">29.2. Serial Terminology and Hardware</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#term">29.3. Terminals</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#dialup">29.4. Dial-in Service</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#dialout">29.5. Dial-out Service</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/serialcomms/#serialconsole-setup">29.6. Setting Up the Serial Console</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/">
              Chapter 30. PPP
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis">30.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/#userppp">30.2. Configuring PPP</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/#ppp-troubleshoot">30.3. Troubleshooting PPP Connections</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/#pppoe">30.4. Using PPP over Ethernet (PPPoE)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/ppp-and-slip/#pppoa">30.5. Using PPP over ATM (PPPoA)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9d023b545804f197d195dd9412749943" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9d023b545804f197d195dd9412749943"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/">
              Chapter 31. Electronic Mail
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#mail-synopsis">31.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#mail-using">31.2. Mail Components</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#dragonFly-mail-agent">31.3. DragonFly Mail Agent (DMA)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#sendmail">31.4. Sendmail</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#mail-changingmta">31.5. Changing the Mail Transfer Agent</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#mail-agents">31.6. Mail User Agents</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mail/#mail-advanced">31.7. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-42b19e05d30c4135c74b9878818747a9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-42b19e05d30c4135c74b9878818747a9"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/">
              Chapter 32. Network Servers
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-servers-synopsis">32.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-inetd">32.2. The inetd Super-Server</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-nfs">32.3. Network File System (NFS)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-nis">32.4. Network Information System (NIS)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-ldap">32.5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-dhcp">32.6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-dns">32.7. Domain Name System (DNS)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-apache">32.8. Apache HTTP Server</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-ftp">32.9. File Transfer Protocol (FTP)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-samba">32.10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-ntp">32.11. Clock Synchronization with NTP</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/network-servers/#network-iscsi">32.12. iSCSI Initiator and Target Configuration</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9554a5177d00d0e87ada408809a1fc67" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9554a5177d00d0e87ada408809a1fc67"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/">
              Chapter 33. Firewalls
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-intro">33.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-concepts">33.2. Firewall Concepts</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-pf">33.3. PF</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-ipfw">33.4. IPFW</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-ipf">33.5. IPFILTER (IPF)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/firewalls/#firewalls-blacklistd">33.6. Blacklistd</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9903a1d844ed803a436595e93ec33572" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9903a1d844ed803a436595e93ec33572"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/">
              Chapter 34. Advanced Networking
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#advanced-networking-synopsis">34.1. Synopsis</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-routing">34.2. Gateways and Routes</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#configtuning-virtual-hosts">34.3. Virtual Hosts</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-advanced-wireless">34.4. Wireless Advanced Authentication</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#wireless-ad-hoc-mode">34.5. Wireless Ad-hoc Mode</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-usb-tethering">34.6. USB Tethering</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-bluetooth">34.7. Bluetooth</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-bridging">34.8. Bridging</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-aggregation">34.9. Link Aggregation and Failover</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-diskless">34.10. Diskless Operation with PXE</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#carp">34.11. Common Address Redundancy Protocol (CARP)</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/advanced-networking/#network-vlan">34.12. VLANs</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ca29f99c249993ee9234cb4632af7a5" class="toggle"  />
          <label  for="chapter-8ca29f99c249993ee9234cb4632af7a5"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/partv/">
              第五部分. 附录
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0229d553ebf23ffeb945be6f32836221" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0229d553ebf23ffeb945be6f32836221"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/mirrors/">
              Appendix A. Obtaining FreeBSD
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mirrors/#mirrors">A.1. Mirrors</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mirrors/#git">A.2. Using Git</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mirrors/#svn">A.3. Using Subversion</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/mirrors/#mirrors-cdrom">A.4. CD and DVD Sets</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-743c99fa278b8138914ff018e40c9231" class="toggle"  />
          <label  class="icon cursor"  for="chapter-743c99fa278b8138914ff018e40c9231"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/bibliography/">
              Appendix B. Bibliography
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bibliography/#bibliography-freebsd">B.1. FreeBSD Bibliography</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bibliography/#bibliography-security">B.2. Security Reference</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bibliography/#bibliography-history">B.3. UNIX® History</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/bibliography/#bibliography-journals">B.4. Periodicals, Journals, and Magazines</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-de7eade4b8b64f298c0cbac44c2278da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-de7eade4b8b64f298c0cbac44c2278da"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/eresources/">
              Appendix C. Resources on the Internet
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/eresources/#eresources-www">C.1. Websites</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/eresources/#eresources-mail">C.2. Mailing Lists</a></li>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/eresources/#eresources-news">C.3. Usenet Newsgroups</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/pgpkeys/">
              Appendix D. OpenPGP Keys
            </a>
            
            
  <ul>
    <li><a href="https://free.bsd-doc.org/zh-cn/books/handbook/pgpkeys/#pgpkeys-officers">D.1. Officers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-2a8deedf14429128049622ec007c9d3f" class="toggle"  />
          <label  for="chapter-2a8deedf14429128049622ec007c9d3f"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/glossary/">
              FreeBSD Glossary
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-110dbb242491bf200e51e76db171f670" class="toggle"  />
          <label  for="chapter-110dbb242491bf200e51e76db171f670"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/colophon/">
              Colophon
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-caffbcba74982e4b26b9263ac0232bc3" class="toggle"  />
          <label  for="chapter-caffbcba74982e4b26b9263ac0232bc3"><a role="button"></a></label>

          
            
            <a href="https://free.bsd-doc.org/zh-cn/books/handbook/introduction/">
              
            </a>
            
            
          

        
      </li>
    
      <li>
        
      </li>
    
  </ul>


      </nav>
    </div>
  </aside>
  
  <div class="book">
    
    <div class="book-menu-mobile">
      <label for="menu-control">
        <span class="menu-control-button">
          <i class="fa fa-list" aria-hidden="true" title="Book menu"></i>
          Book menu
        </span>
      </label>
    </div>
    
    <h1 class="title">Chapter 17. Jails and Containers</h1>
    
    
      <div class="admonitionblock note">
        <p>
          <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
          如果发现翻译错误，请直接 <a href="https://github.com/fierceX/freebsd-doc-cn/pulls" target="_blank">发起PR修改</a>。
        </p>
      </div>
    
    
    
    <div class="toc-mobile">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#jails-synopsis">17.1. Synopsis</a></li>
    <li><a href="#jail-types">17.2. Jail Types</a></li>
    <li><a href="#host-configuration">17.3. Host Configuration</a></li>
    <li><a href="#classic-jail">17.4. Classic Jail (Thick Jail)</a></li>
    <li><a href="#thin-jail">17.5. Thin Jails</a></li>
    <li><a href="#jail-management">17.6. Jail Management</a></li>
    <li><a href="#jail-upgrading">17.7. Jail Upgrading</a></li>
    <li><a href="#jail-resource-limits">17.8. Jail Resource Limits</a></li>
    <li><a href="#jail-managers-and-containers">17.9. Jail Managers and Containers</a></li>
  </ul>
</nav>
    </div>
    
      
      
    
    <div class="book-content">
      <div id="preamble">
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="jails-synopsis">17.1. Synopsis<a class="anchor" href="#jails-synopsis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since system administration is a difficult task, many tools have been developed to make life easier for the administrator. These tools often enhance the way systems are installed, configured, and maintained. One of the tools which can be used to enhance the security of a FreeBSD system is <em>jails</em>. Jails have been available since FreeBSD 4.X and continue to be enhanced in their usefulness, performance, reliability, and security.</p>
</div>
<div class="paragraph">
<p>Jails build upon the <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> concept, which is used to change the root directory of a set of processes. This creates a safe environment, separate from the rest of the system. Processes created in the chrooted environment can not access files or resources outside of it. For that reason, compromising a service running in a chrooted environment should not allow the attacker to compromise the entire system.</p>
</div>
<div class="paragraph">
<p>However, a chroot has several limitations. It is suited to easy tasks which do not require much flexibility or complex, advanced features. Over time, many ways have been found to escape from a chrooted environment, making it a less than ideal solution for securing services.</p>
</div>
<div class="paragraph">
<p>Jails improve on the concept of the traditional chroot environment in several ways.</p>
</div>
<div class="paragraph">
<p>In a traditional chroot environment, processes are only limited in the part of the file system they can access. The rest of the system resources, system users, running processes, and the networking subsystem are shared by the chrooted processes and the processes of the host system. Jails expand this model by virtualizing access to the file system, the set of users, and the networking subsystem. More fine-grained controls are available for tuning the access of a jailed environment. Jails can be considered as a type of operating system-level virtualization.</p>
</div>
<div class="paragraph">
<p>This chapter covers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What a jail is and what purpose it may serve in FreeBSD installations.</p>
</li>
<li>
<p>The different types of jail.</p>
</li>
<li>
<p>The different ways to configure the network for a jail.</p>
</li>
<li>
<p>The jail configuration file.</p>
</li>
<li>
<p>How to create the different types of jail.</p>
</li>
<li>
<p>How to start, stop, and restart a jail.</p>
</li>
<li>
<p>The basics of jail administration, both from inside and outside the jail.</p>
</li>
<li>
<p>How to upgrade the different types of jail.</p>
</li>
<li>
<p>A incomplete list of the different FreeBSD jail managers.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jail-types">17.2. Jail Types<a class="anchor" href="#jail-types"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some administrators divide jails into different types, although the underlying technology is the same. Each administrator will have to assess what type of jail to create in each case depending on the problem they have to solve.</p>
</div>
<div class="paragraph">
<p>Below can be found a list of the different types, their characteristics, and considerations for use.</p>
</div>
<div class="sect2">
<h3 id="thick-jails">17.2.1. Thick Jails<a class="anchor" href="#thick-jails"></a></h3>
<div class="paragraph">
<p>A thick jail is a traditional form of FreeBSD Jail. In a thick jail, a complete copy of the base system is replicated within the jail’s environment. This means that the jail has its own separate instance of the FreeBSD base system, including libraries, executables, and configuration files. The jail can be thought of as an almost complete standalone FreeBSD installation, but running within the confines of the host system. This isolation ensures that the processes within the jail are kept separate from those on the host and other jails.</p>
</div>
<div class="paragraph">
<p>Advantages of Thick Jails:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>High degree of isolation: Processes within the jail are isolated from the host system and other jails.</p>
</li>
<li>
<p>Independence: Thick jails can have different versions of libraries, configurations, and software than the host system or other jails.</p>
</li>
<li>
<p>Security: Since the jail contains its own base system, vulnerabilities or issues affecting the jail environment won’t directly impact the host or other jails.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Disadvantages of Thick Jails:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource overhead: Because each jail maintains its own separate base system, thick jails consume more resources compared to thin jails.</p>
</li>
<li>
<p>Maintenance: Each jail requires its own maintenance and updates for its base system components.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="thin-jails">17.2.2. Thin Jails<a class="anchor" href="#thin-jails"></a></h3>
<div class="paragraph">
<p>A thin jail shares the base system using OpenZFS snapshots or NullFS mounts from a template. Only a minimal subset of base system is duplicated for each thin jail, resulting in less resource consumption compared to a thick jail. However, this also means that thin jails have less isolation and independence compared to thick jails. Changes in shared components could potentially affect multiple thin jails simultaneously.</p>
</div>
<div class="paragraph">
<p>In summary, a FreeBSD Thin Jail is a type of FreeBSD Jail that replicates a substantial portion, but not all, of the base system within the isolated environment.</p>
</div>
<div class="paragraph">
<p>Advantages of Thin Jails:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource Efficiency: Thin jails are more resource-efficient compared to thick jails. Since they share most of the base system, they consume less disk space and memory. This makes it possible to run more jails on the same hardware without consuming excessive resources.</p>
</li>
<li>
<p>Faster Deployment: Creating and launching thin jails is generally faster compared to thick jails. This can be particularly advantageous when you need to rapidly deploy multiple instances.</p>
</li>
<li>
<p>Unified Maintenance: Since thin jails share the majority of their base system with the host system, updates and maintenance of common base system components (such as libraries and binaries) only need to be done once on the host. This simplifies the maintenance process compared to maintaining an individual base system for each thick jail.</p>
</li>
<li>
<p>Shared Resources: Thin jails can more easily share common resources such as libraries and binaries with the host system. This can potentially lead to more efficient disk caching and improved performance for applications within the jail.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Disadvantages of Thin Jails:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reduced Isolation: The primary disadvantage of thin jails is that they offer less isolation compared to thick jails. Since they share a significant portion of the template’s base system, vulnerabilities or issues affecting shared components could potentially impact multiple jails simultaneously.</p>
</li>
<li>
<p>Security Concerns: The reduced isolation in thin jails could pose security risks, as a compromise in one jail might have a greater potential to affect other jails or the host system.</p>
</li>
<li>
<p>Dependency Conflicts: If multiple thin jails require different versions of the same libraries or software, managing dependencies can become complex. In some cases, this might require additional effort to ensure compatibility.</p>
</li>
<li>
<p>Compatibility Challenges: Applications within a thin jail might encounter compatibility issues if they assume a certain base system environment that differs from the shared components provided by the template.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="vnet-jails">17.2.3. VNET Jails<a class="anchor" href="#vnet-jails"></a></h3>
<div class="paragraph">
<p>A FreeBSD VNET jail is a virtualized environment that allows for the isolation and control of network resources for processes running within it. It provides a high level of network segmentation and security by creating a separate network stack for processes within the jail, ensuring that network traffic within the jail is isolated from the host system and other jails.</p>
</div>
<div class="paragraph">
<p>In essence, FreeBSD VNET jails add a network configuration mechanism. This means a VNET jail can be created as a Thick or Thin Jail.</p>
</div>
</div>
<div class="sect2">
<h3 id="linux-jails">17.2.4. Linux Jails<a class="anchor" href="#linux-jails"></a></h3>
<div class="paragraph">
<p>A FreeBSD Linux Jail is a feature in the FreeBSD operating system that enables the use of Linux binaries and applications within a FreeBSD jail. This functionality is achieved by incorporating a compatibility layer that allows certain Linux system calls and libraries to be translated and executed on the FreeBSD kernel. The purpose of a Linux Jail is to facilitate the execution of Linux software on a FreeBSD system without needing a separate Linux virtual machine or environment.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="host-configuration">17.3. Host Configuration<a class="anchor" href="#host-configuration"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before creating any jail on the host system it is necessary to perform certain configuration and obtain some information from the host system.</p>
</div>
<div class="paragraph">
<p>It will be necessary to configure the <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> utility, create the necessary directories to configure and install jails, obtain information from the host’s network, and check whether the host uses OpenZFS or UFS as its file system.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The FreeBSD version running in the jail can not be newer than the version running in the host.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="host-configuration-jail-utility">17.3.1. Jail Utility<a class="anchor" href="#host-configuration-jail-utility"></a></h3>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> utility manages jails.</p>
</div>
<div class="paragraph">
<p>To start jails when the system boots, run the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysrc jail_enable=&#34;YES&#34;</span>
<span class="c"># sysrc jail_parallel_start=&#34;YES&#34;</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With <code>jail_parallel_start</code>, all configured jails will be started in the background.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="jails-networking">17.3.2. Networking<a class="anchor" href="#jails-networking"></a></h3>
<div class="paragraph">
<p>Networking for FreeBSD jails can be configured several different ways:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Host Networking Mode (IP Sharing)</dt>
<dd>
<p>In host networking mode, a jail shares the same networking stack as the host system. When a jail is created in host networking mode it uses the same network interface and IP address. This means that the jail doesn’t have a separate IP address, and its network traffic is associated with the host’s IP.</p>
</dd>
<dt class="hdlist1">Virtual Networks (VNET)</dt>
<dd>
<p>Virtual Networks are a feature of FreeBSD jails that offer more advanced and flexible networking solutions than a basic networking mode like host networking. VNET allows the creation of isolated network stacks for each jail, providing them with their own separate IP addresses, routing tables, and network interfaces. This offers a higher level of network isolation and allows jails to function as if they are running on separate virtual machines.</p>
</dd>
<dt class="hdlist1">The netgraph system</dt>
<dd>
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=netgraph&amp;sektion=4&amp;format=html">netgraph(4)</a> is a versatile kernel framework for creating custom network configurations. It can be used to define how network traffic flows between jails and the host system and between different jails.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="host-configuration-directories">17.3.3. Setting Up the Jail Directory Tree<a class="anchor" href="#host-configuration-directories"></a></h3>
<div class="paragraph">
<p>There is no specific place to put the files for the jails.</p>
</div>
<div class="paragraph">
<p>Some administrators use <span class="filename">/jail</span>, others <span class="filename">/usr/jail</span>, and still others <span class="filename">/usr/local/jails</span>. In this chapter <span class="filename">/usr/local/jails</span> will be used.</p>
</div>
<div class="paragraph">
<p>Apart from <span class="filename">/usr/local/jails</span> other directories will be created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="filename">media</span> will contain the compressed files of the downloaded userlands.</p>
</li>
<li>
<p><span class="filename">templates</span> will contain the templates when using Thin Jails.</p>
</li>
<li>
<p><span class="filename">containers</span> will contain the jails.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When using OpenZFS, execute the following commands to create datasets for these directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs create -o mountpoint=/usr/local/jails zroot/jails</span>
<span class="c"># zfs create zroot/jails/media</span>
<span class="c"># zfs create zroot/jails/templates</span>
<span class="c"># zfs create zroot/jails/containers</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In this case, <code>zroot</code> was used for the parent dataset, but other datasets could have been used.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When using UFS, execute the following commands to create the directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/jails/</span>
<span class="c"># mkdir /usr/local/jails/media</span>
<span class="c"># mkdir /usr/local/jails/templates</span>
<span class="c"># mkdir /usr/local/jails/containers</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jail-configuration-files">17.3.4. Jail Configuration Files<a class="anchor" href="#jail-configuration-files"></a></h3>
<div class="paragraph">
<p>There are two ways to configure jails.</p>
</div>
<div class="paragraph">
<p>The first one is to add an entry for each jail to the file <span class="filename">/etc/jail.conf</span>. The other option is to create a file for each jail in the directory <span class="filename">/etc/jail.conf.d/</span>.</p>
</div>
<div class="paragraph">
<p>There is no right or wrong option. Each administrator must choose the one that best suits their needs.</p>
</div>
<div class="paragraph">
<p>In case a host system has few jails, an entry for each jail can be added in the file <span class="filename">/etc/jail.conf</span>. If the host system has many jails, it is good idea to have one configuration file for each jail in the <span class="filename">/etc/jail.conf.d/</span> directory.</p>
</div>
<div class="paragraph">
<p>A typical jail entry would look like this:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>jailname { <i class="conum" data-value="1"></i><b>(1)</b>
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;; <i class="conum" data-value="2"></i><b>(2)</b>
  exec.stop = &#34;/bin/sh /etc/rc.shutdown&#34;; <i class="conum" data-value="3"></i><b>(3)</b>
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;; <i class="conum" data-value="4"></i><b>(4)</b>

  # PERMISSIONS
  allow.raw_sockets; <i class="conum" data-value="5"></i><b>(5)</b>
  exec.clean; <i class="conum" data-value="6"></i><b>(6)</b>
  mount.devfs; <i class="conum" data-value="7"></i><b>(7)</b>

  # HOSTNAME/PATH
  host.hostname = &#34;${name}&#34;; <i class="conum" data-value="8"></i><b>(8)</b>
  path = &#34;/usr/local/jails/containers/${name}&#34;; <i class="conum" data-value="9"></i><b>(9)</b>

  # NETWORK
  ip4.addr = 192.168.1.151; <i class="conum" data-value="10"></i><b>(10)</b>
  ip6.addr = ::ffff:c0a8:197 <i class="conum" data-value="11"></i><b>(11)</b>
  interface = em0; <i class="conum" data-value="12"></i><b>(12)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>jailname</code> - Name of the jail. &lt;.&gt; <code>exec.start</code> - Command(s) to run in the jail environment when a jail is created. A typical command to run is &#34;/bin/sh /etc/rc&#34;. &lt;.&gt; <code>exec.stop</code> - Command(s) to run in the jail environment before a jail is removed. A typical command to run is &#34;/bin/sh /etc/rc.shutdown&#34;. &lt;.&gt; <code>exec.consolelog</code> - A file to direct command output (stdout and stderr) to. &lt;.&gt; <code>allow.raw_sockets</code> - Allow creating raw sockets inside the jail. Setting this parameter allows utilities like <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> to operate inside the jail. &lt;.&gt; <code>exec.clean</code> - Run commands in a clean environment. &lt;.&gt; <code>mount.devfs</code> - Mount a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> filesystem on the chrooted <span class="filename">/dev</span> directory, and apply the ruleset in the devfs_ruleset parameter to restrict the devices visible inside the jail. &lt;.&gt; <code>host.hostname</code> - The hostname of the jail. &lt;.&gt; <code>path</code> - The directory which is to be the root of the jail. Any commands that are run inside the jail, either by jail or from <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a>, are run from this directory. &lt;.&gt; <code>ip4.addr</code> - IPv4 address. There are two configuration possibilities for IPv4. The first is to establish an IP or a list of IPs as has been done in the example. The other is to use <code>ip4</code> instead and set the <code>inherit</code> value to inherit the host’s IP address. &lt;.&gt; <code>ip6.addr</code> - IPv6 address. There are two configuration possibilities for IPv6. The first is to establish an IP or a list of IPs as has been done in the example. The other is to use <code>ip6</code> instead and set the <code>inherit</code> value to inherit the host’s IP address. &lt;.&gt; <code>interface</code> - A network interface to add the jail’s IP addresses. Usually the host interface.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>More information about configuration variables can be found in <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=jail.conf&amp;sektion=5&amp;format=html">jail.conf(5)</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="classic-jail">17.4. Classic Jail (Thick Jail)<a class="anchor" href="#classic-jail"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>These jails resemble a real FreeBSD system. They can be managed more or less like a normal host system and updated independently.</p>
</div>
<div class="sect2">
<h3 id="creating-classic-jail">17.4.1. Creating a Classic Jail<a class="anchor" href="#creating-classic-jail"></a></h3>
<div class="paragraph">
<p>In principle, a jail only needs a hostname, a root directory, an IP address, and a userland.</p>
</div>
<div class="paragraph">
<p>The userland for the jail can be obtained from the official FreeBSD download servers.</p>
</div>
<div class="paragraph">
<p>Execute the following command to download the userland:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># fetch https://download.freebsd.org/ftp/releases/amd64/amd64/13.2-RELEASE/base.txz -o /usr/local/jails/media/13.2-RELEASE-base.txz</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the download is complete, it will be necessary to extract the contents into the jail directory.</p>
</div>
<div class="paragraph">
<p>Execute the following commands to extract the userland into the jail’s directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir -p /usr/local/jails/containers/classic</span>
<span class="c"># tar -xf /usr/local/jails/media/13.2-RELEASE-base.txz -C /usr/local/jails/containers/classic --unlink</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the userland extracted in the jail directory, it will be necessary to copy the timezone and DNS server files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cp /etc/resolv.conf /usr/local/jails/containers/classic/etc/resolv.conf</span>
<span class="c"># cp /etc/localtime /usr/local/jails/containers/classic/etc/localtime</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the files copied, the next thing to do is update to the latest patch level by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -b /usr/local/jails/containers/classic/ fetch install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The last step is to configure the jail. It will be necessary to add an entry to the configuration file <span class="filename">/etc/jail.conf</span> or in <span class="filename">jail.conf.d</span> with the parameters of the jail.</p>
</div>
<div class="paragraph">
<p>An example would be the following:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>classic {
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;;
  exec.stop = &#34;/bin/sh /etc/rc.shutdown&#34;;
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;;

  # PERMISSIONS
  allow.raw_sockets;
  exec.clean;
  mount.devfs;

  # HOSTNAME/PATH
  host.hostname = &#34;${name}&#34;;
  path = &#34;/usr/local/jails/containers/${name}&#34;;

  # NETWORK
  ip4.addr = 192.168.1.151;
  interface = em0;
}</pre>
</div>
</div>
<div class="paragraph">
<p>Execute the following command to start the jail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail start classic</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>More information on how to manage jails can be found in the section <a href="#jail-management">Jail Management</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="thin-jail">17.5. Thin Jails<a class="anchor" href="#thin-jail"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although Thin Jails use the same technology as Thick Jails, the creation procedure is different. Thin jails can be created using OpenZFS snapshots or using templates and NullFS. The use of OpenZFS snapshots and templates using NullFS have certain advantages over classic jails, such as being able to create them faster from snapshots or being able to update multiple jails using NullFS.</p>
</div>
<div class="sect2">
<h3 id="creating-thin-jail-openzfs-snapshots">17.5.1. Creating a Thin Jail Using OpenZFS Snapshots<a class="anchor" href="#creating-thin-jail-openzfs-snapshots"></a></h3>
<div class="paragraph">
<p>Due to the good integration between FreeBSD and OpenZFS it is very easy to create new Thin Jails using OpenZFS Snapshots.</p>
</div>
<div class="paragraph">
<p>To create a Thin Jail using OpenZFS Snapshots the first step is to create a template.</p>
</div>
<div class="paragraph">
<p>Templates will only be used to create new jails. For this reason they are created in &#34;read-only&#34; mode so that jails are created with an immutable base.</p>
</div>
<div class="paragraph">
<p>To create the dataset for the template, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs create -p zroot/jails/templates/13.2-RELEASE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then execute the following command to download the userland:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># fetch https://download.freebsd.org/ftp/releases/amd64/amd64/13.2-RELEASE/base.txz -o /usr/local/jails/media/13.2-RELEASE-base.txz</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the download is complete, it will be necessary to extract the contents in the template directory by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># tar -xf /usr/local/jails/media/13.2-RELEASE-base.txz -C /usr/local/jails/templates/13.2-RELEASE --unlink</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the userland extracted in the templates directory, it will be necessary to copy the timezone and DNS server files to the template directory by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cp /etc/resolv.conf /usr/local/jails/templates/13.2-RELEASE/etc/resolv.conf</span>
<span class="c"># cp /etc/localtime /usr/local/jails/templates/13.2-RELEASE/etc/localtime</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next thing to do is update to the latest patch level by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -b /usr/local/jails/templates/13.2-RELEASE/ fetch install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the update is finished, the template is ready.</p>
</div>
<div class="paragraph">
<p>To create an OpenZFS Snapshot from the template, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs snapshot zroot/jails/templates/13.2-RELEASE@base</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the OpenZFS Snapshot has been created, infinite jails can be created using the OpenZFS clone function.</p>
</div>
<div class="paragraph">
<p>To create a Thin Jail named <code>thinjail</code>, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs clone zroot/jails/templates/13.2-RELEASE@base zroot/jails/containers/thinjail</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The last step is to configure the jail. It will be necessary to add an entry to the configuration file <span class="filename">/etc/jail.conf</span> or in <span class="filename">jail.conf.d</span> with the parameters of the jail.</p>
</div>
<div class="paragraph">
<p>An example would be the following:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>thinjail {
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;;
  exec.stop = &#34;/bin/sh /etc/rc.shutdown&#34;;
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;;

  # PERMISSIONS
  allow.raw_sockets;
  exec.clean;
  mount.devfs;

  # HOSTNAME/PATH
  host.hostname = &#34;${name}&#34;;
  path = &#34;/usr/local/jails/containers/${name}&#34;;

  # NETWORK
  ip4 = inherit;
  interface = em0;
}</pre>
</div>
</div>
<div class="paragraph">
<p>Execute the following command to start the jail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail start thinjail</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>More information on how to manage jails can be found in the section <a href="#jail-management">Jail Management</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-thin-jail-nullfs">17.5.2. Creating a Thin Jail Using NullFS<a class="anchor" href="#creating-thin-jail-nullfs"></a></h3>
<div class="paragraph">
<p>A jail can be created with reduced duplication of system files by using the Thin Jail technique and using NullFS to selectively share specific directories from the host system into the jail.</p>
</div>
<div class="paragraph">
<p>The first step is to create the dataset to save the template, execute the following command if using OpenZFS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs create -p zroot/jails/templates/13.2-RELEASE-base</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or this one if using UFS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/jails/templates/13.2-RELEASE-base</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then execute the following command to download the userland:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># fetch https://download.freebsd.org/ftp/releases/amd64/amd64/13.2-RELEASE/base.txz -o /usr/local/jails/media/13.2-RELEASE-base.txz</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the download is complete, it will be necessary to extract the contents in the template directory by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># tar -xf /usr/local/jails/media/13.2-RELEASE-base.txz -C /usr/local/jails/templates/13.2-RELEASE-base --unlink</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the userland is extracted in the templates directory, it will be necessary to copy the timezone and DNS server files to the template directory by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cp /etc/resolv.conf /usr/local/jails/templates/13.2-RELEASE-base/etc/resolv.conf</span>
<span class="c"># cp /etc/localtime /usr/local/jails/templates/13.2-RELEASE-base/etc/localtime</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the files moved to the template, the next thing to do is update to the latest patch level by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -b /usr/local/jails/templates/13.2-RELEASE-base/ fetch install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the base template, it is also necessary to create a directory where the <code>skeleton</code> will be located. Some directories will be copied from the template to the <code>skeleton</code>.</p>
</div>
<div class="paragraph">
<p>Execute the following command to create the dataset for the <code>skeleton</code> in case of using OpenZFS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs create -p zroot/jails/templates/13.2-RELEASE-skeleton</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or this one in case of using UFS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/jails/templates/13.2-RELEASE-skeleton</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then create the <code>skeleton</code> directories. The <code>skeleton</code> directories will hold the local directories of the jails.</p>
</div>
<div class="paragraph">
<p>Execute the following commands to create the directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir -p /usr/local/jails/templates/13.2-RELEASE-skeleton/home</span>
<span class="c"># mkdir -p /usr/local/jails/templates/13.2-RELEASE-skeleton/usr</span>
<span class="c"># mv /usr/local/jails/templates/13.2-RELEASE-base/etc /usr/local/jails/templates/13.2-RELEASE-skeleton/etc</span>
<span class="c"># mv /usr/local/jails/templates/13.2-RELEASE-base/usr/local /usr/local/jails/templates/13.2-RELEASE-skeleton/usr/local</span>
<span class="c"># mv /usr/local/jails/templates/13.2-RELEASE-base/tmp /usr/local/jails/templates/13.2-RELEASE-skeleton/tmp</span>
<span class="c"># mv /usr/local/jails/templates/13.2-RELEASE-base/var /usr/local/jails/templates/13.2-RELEASE-skeleton/var</span>
<span class="c"># mv /usr/local/jails/templates/13.2-RELEASE-base/root /usr/local/jails/templates/13.2-RELEASE-skeleton/root</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to create the symlinks to the <code>skeleton</code> by executing the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># cd /usr/local/jails/templates/13.2-RELEASE-base/</span>
<span class="c"># mkdir skeleton</span>
<span class="c"># ln -s skeleton/etc etc</span>
<span class="c"># ln -s skeleton/home home</span>
<span class="c"># ln -s skeleton/root root</span>
<span class="c"># ln -s skeleton/usr/local usr/local</span>
<span class="c"># ln -s skeleton/tmp tmp</span>
<span class="c"># ln -s skeleton/var var</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>skeleton</code> ready, it will be necessary to copy the data to the jail directory.</p>
</div>
<div class="paragraph">
<p>In case of using OpenZFS, OpenZFS snapshots can be used to easily create as many jails as necessary by executing the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># zfs snapshot zroot/jails/templates/13.2-RELEASE-skeleton@base</span>
<span class="c"># zfs clone zroot/jails/templates/13.2-RELEASE-skeleton@base zroot/jails/containers/thinjail</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case of using UFS the <a href="https://man.freebsd.org/cgi/man.cgi?query=cp&amp;sektion=1&amp;format=html">cp(1)</a> program can be used by executing the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir /usr/local/jails/containers/thinjail</span>
<span class="c"># cp -R /usr/local/jails/templates/13.2-RELEASE-skeleton /usr/local/jails/containers/thinjail</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then create the directory in which the base template and the skeleton will be mounted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># mkdir -p /usr/local/jails/thinjail-nullfs-base</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Add a jail entry in <span class="filename">/etc/jail.conf</span> or a file in <span class="filename">jail.conf.d</span> as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>thinjail {
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;;
  exec.stop = &#34;/bin/sh /etc/rc.shutdown&#34;;
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;;

  # PERMISSIONS
  allow.raw_sockets;
  exec.clean;
  mount.devfs;

  # HOSTNAME/PATH
  host.hostname = &#34;${name}&#34;;
  path = &#34;/usr/local/jails/containers/${name}&#34;;

  # NETWORK
  ip4.addr = 192.168.1.153;
  interface = em0;

  # MOUNT
  mount.fstab = &#34;/usr/local/jails/thinjail-nullfs-base.fstab&#34;;
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then the create the <span class="filename">/usr/local/jails/thinjail-nullfs-base.fstab</span> file as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>/usr/local/jails/templates/13.2-RELEASE-base  /usr/local/jails/thinjail-nullfs-base/ nullfs   ro          0 0
/usr/local/jails/containers/thinjail     /usr/local/jails/thinjail-nullfs-base/skeleton nullfs  rw  0 0</pre>
</div>
</div>
<div class="paragraph">
<p>Execute the following command to start the jail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail start thinjail</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating-vnet-jail">17.5.3. Creating a VNET Jail<a class="anchor" href="#creating-vnet-jail"></a></h3>
<div class="paragraph">
<p>FreeBSD VNET Jails have their own distinct networking stack, including interfaces, IP addresses, routing tables, and firewall rules.</p>
</div>
<div class="paragraph">
<p>The first step to create a VNET jail is to create the <a href="https://man.freebsd.org/cgi/man.cgi?query=bridge&amp;sektion=4&amp;format=html">bridge(4)</a> by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ifconfig bridge create</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should be similar to the following:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>bridge0</pre>
</div>
</div>
<div class="paragraph">
<p>With the <code>bridge</code> created, it will be necessary to attach it to the <code>em0</code> interface by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># ifconfig bridge0 addm em0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To make this setting persist across reboots, add the following lines to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>defaultrouter=&#34;192.168.1.1&#34;
cloned_interfaces=&#34;bridge0&#34;
ifconfig_bridge0=&#34;inet 192.168.1.150/24 addm em0 up&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to create the jail as indicated above.</p>
</div>
<div class="paragraph">
<p>Either the <a href="#classic-jail">Classic Jail (Thick Jail)</a> procedure and the <a href="#thin-jail">Thin Jails</a> procedure can be used. The only thing that will change is the configuration in the <span class="filename">/etc/jail.conf</span> file.</p>
</div>
<div class="paragraph">
<p>The path <span class="filename">/usr/local/jails/containers/vnet</span> will be used as an example for the created jail.</p>
</div>
<div class="paragraph">
<p>The following is an example configuration for a VNET jail:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>vnet {
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;;
  exec.stop  = &#34;/bin/sh /etc/rc.shutdown&#34;;
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;;

  # PERMISSIONS
  allow.raw_sockets;
  exec.clean;
  mount.devfs;
  devfs_ruleset = 5;

  # PATH/HOSTNAME
  path = &#34;/usr/local/jails/containers/${name}&#34;;
  host.hostname = &#34;${name}&#34;;

  # VNET/VIMAGE
  vnet;
  vnet.interface = &#34;${epair}b&#34;;

  # NETWORKS/INTERFACES
  $id = &#34;154&#34;; <i class="conum" data-value="1"></i><b>(1)</b>
  $ip = &#34;192.168.1.${id}/24&#34;;
  $gateway = &#34;192.168.1.1&#34;;
  $bridge = &#34;bridge0&#34;; <i class="conum" data-value="2"></i><b>(2)</b>
  $epair = &#34;epair${id}&#34;;

  # ADD TO bridge INTERFACE
  exec.prestart += &#34;ifconfig ${epair} create up&#34;;
  exec.prestart += &#34;ifconfig ${epair}a up descr jail:${name}&#34;;
  exec.prestart += &#34;ifconfig ${bridge} addm ${epair}a up&#34;;
  exec.start    += &#34;ifconfig ${epair}b ${ip} up&#34;;
  exec.start    += &#34;route add default ${gateway}&#34;;
  exec.poststop = &#34;ifconfig ${bridge} deletem ${epair}a&#34;;
  exec.poststop += &#34;ifconfig ${epair}a destroy&#34;;
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Represents the IP of the Jail, it must be <strong>unique</strong>. &lt;.&gt; Refers to the bridge created previously.</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="creating-linux-jail">17.5.4. Creating a Linux Jail<a class="anchor" href="#creating-linux-jail"></a></h3>
<div class="paragraph">
<p>FreeBSD can run Linux inside a jail using <a href="../linuxemu/#linuxemu">Linux Binary Compatibility</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=debootstrap&amp;sektion=8&amp;format=html">debootstrap(8)</a>. Jails do not have a kernel. They run on the host’s kernel. Therefore it is necessary to enable Linux Binary Compatibility in the host system.</p>
</div>
<div class="paragraph">
<p>To enable the Linux ABI at boot time, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># sysrc linux_enable=&#34;YES&#34;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once enabled, it can be started without rebooting by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service linux start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step will be to create a jail as indicated above, for example in <a href="#creating-thin-jail-openzfs-snapshots">Creating a Thin Jail Using OpenZFS Snapshots</a>, but <strong>without</strong> performing the configuration. FreeBSD Linux jails require a specific configuration that will be detailed below.</p>
</div>
<div class="paragraph">
<p>Once the jail has been created as explained above, execute the following command to perform required configuration for the jail and start it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jail -cm \</span>
    <span class="nv">name</span><span class="o">=</span>ubuntu <span class="se">\</span>
    host.hostname<span class="o">=</span><span class="s2">&#34;ubuntu.example.com&#34;</span> <span class="se">\</span>
    <span class="nv">path</span><span class="o">=</span><span class="s2">&#34;/usr/local/jails/ubuntu&#34;</span> <span class="se">\</span>
    <span class="nv">interface</span><span class="o">=</span><span class="s2">&#34;em0&#34;</span> <span class="se">\</span>
    ip4.addr<span class="o">=</span><span class="s2">&#34;192.168.1.150&#34;</span> <span class="se">\</span>
    exec.start<span class="o">=</span><span class="s2">&#34;/bin/sh /etc/rc&#34;</span> <span class="se">\</span>
    exec.stop<span class="o">=</span><span class="s2">&#34;/bin/sh /etc/rc.shutdown&#34;</span> <span class="se">\</span>
    mount.devfs <span class="se">\</span>
    <span class="nv">devfs_ruleset</span><span class="o">=</span>4 <span class="se">\</span>
    allow.mount <span class="se">\</span>
    allow.mount.devfs <span class="se">\</span>
    allow.mount.fdescfs <span class="se">\</span>
    allow.mount.procfs <span class="se">\</span>
    allow.mount.linprocfs <span class="se">\</span>
    allow.mount.linsysfs <span class="se">\</span>
    allow.mount.tmpfs <span class="se">\</span>
    <span class="nv">enforce_statfs</span><span class="o">=</span>1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access the jail, it will be necessary to install <a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/debootstrap/">sysutils/debootstrap</a>.</p>
</div>
<div class="paragraph">
<p>Execute the following command to access the FreeBSD Linux jail:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jexec -u root ubuntu</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the jail, execute the following commands to install <a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/debootstrap/">sysutils/debootstrap</a> and prepare the Ubuntu environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg install debootstrap</span>
<span class="c"># debootstrap jammy /compat/ubuntu</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the process has finished and the message <code>Base system installed successfully</code> is displayed on the console, it will be necessary to stop the jail from the host system by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail ubuntu onestop</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then add an entry in <span class="filename">/etc/jail.conf</span> for the Linux jail:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>ubuntu {
  # STARTUP/LOGGING
  exec.start = &#34;/bin/sh /etc/rc&#34;;
  exec.stop = &#34;/bin/sh /etc/rc.shutdown&#34;;
  exec.consolelog = &#34;/var/log/jail_console_${name}.log&#34;;

  # PERMISSIONS
  allow.raw_sockets;
  exec.clean;
  mount.devfs;
  devfs_ruleset=4;

  # HOSTNAME/PATH
  host.hostname = &#34;${name}&#34;;
  path = &#34;/usr/local/jails/containers/${name}&#34;;

  # NETWORK
  ip4.addr = 192.168.1.155;
  interface = em0;

  # MOUNT
  mount += &#34;devfs     $path/compat/ubuntu/dev     devfs     rw  0 0&#34;;
  mount += &#34;tmpfs     $path/compat/ubuntu/dev/shm tmpfs     rw,size=1g,mode=1777  0 0&#34;;
  mount += &#34;fdescfs   $path/compat/ubuntu/dev/fd  fdescfs   rw,linrdlnk 0 0&#34;;
  mount += &#34;linprocfs $path/compat/ubuntu/proc    linprocfs rw  0 0&#34;;
  mount += &#34;linsysfs  $path/compat/ubuntu/sys     linsysfs  rw  0 0&#34;;
  mount += &#34;/tmp      $path/compat/ubuntu/tmp     nullfs    rw  0 0&#34;;
  mount += &#34;/home     $path/compat/ubuntu/home    nullfs    rw  0 0&#34;;
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then the jail can be started as usual with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail start ubuntu</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Ubuntu environment can be accessed using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jexec ubuntu chroot /compat/ubuntu /bin/bash</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>More information can be found in the chapter <a href="../linuxemu/#linuxemu">Linux Binary Compatibility</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jail-management">17.6. Jail Management<a class="anchor" href="#jail-management"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the jail is created, there are a number of operations that can be performed, like starting, rebooting or deleting the jail, installing software in it, etc. In this section the different actions that can be done with jails from the host will be described.</p>
</div>
<div class="sect2">
<h3 id="list-running-jails">17.6.1. List Running Jails<a class="anchor" href="#list-running-jails"></a></h3>
<div class="paragraph">
<p>To list the jails that are running on the host system, the command <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jls</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should be similar to the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>   JID  IP Address      Hostname                      Path
     1  192.168.250.70  classic                       /usr/local/jails/containers/classic</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> supports the <code>--libxo</code> argument, which through the <a href="https://man.freebsd.org/cgi/man.cgi?query=libxo&amp;sektion=3&amp;format=html">libxo(3)</a> library allows other types of formats to be displayed, such as <code>JSON</code>, <code>HTML</code>, etc.</p>
</div>
<div class="paragraph">
<p>For example, execute the following command to get the <code>JSON</code> output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jls --libxo=json</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should be similar to the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{&#34;__version&#34;: &#34;2&#34;, &#34;jail-information&#34;: {&#34;jail&#34;: [{&#34;jid&#34;:1,&#34;ipv4&#34;:&#34;192.168.250.70&#34;,&#34;hostname&#34;:&#34;classic&#34;,&#34;path&#34;:&#34;/usr/local/jails/containers/classic&#34;}]}}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="start-jail">17.6.2. Start, Restart, and Stop a Jail<a class="anchor" href="#start-jail"></a></h3>
<div class="paragraph">
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> is used to start, reboot, or stop a jail on the host.</p>
</div>
<div class="paragraph">
<p>For example, to start a jail, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail start jailname</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Change the <code>start</code> argument to <code>restart</code> or <code>stop</code> to perform other actions on the jail.</p>
</div>
</div>
<div class="sect2">
<h3 id="destroy-jail">17.6.3. Destroy a Jail<a class="anchor" href="#destroy-jail"></a></h3>
<div class="paragraph">
<p>Destroying a jail is not as simple as stopping the jail using <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> and removing the jail directory and <span class="filename">/etc/jail.conf</span> entry.</p>
</div>
<div class="paragraph">
<p>FreeBSD takes system security very seriously. For this reason there are certain files that not even the root user can delete. This functionality is known as File Flags.</p>
</div>
<div class="paragraph">
<p>The first step is to stop the desired jail executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service jail stop jailname</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second step is to remove these flags with <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> by executing the following command, in which <code>classic</code> is the name of the jail to remove:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># chflags -R 0 /usr/local/jails/classic</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The third step is to delete the directory where the jail was:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># rm -rf /usr/local/jails/classic</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, it will be necessary to remove the jail entry in <span class="filename">/etc/jail.conf</span> or in <span class="filename">jail.conf.d</span>.</p>
</div>
</div>
<div class="sect2">
<h3 id="handle-packages-jail">17.6.4. Handle Packages in a Jail<a class="anchor" href="#handle-packages-jail"></a></h3>
<div class="paragraph">
<p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg&amp;sektion=8&amp;format=html">pkg(8)</a> tool supports the <code>-j</code> argument in order to handle packages installed inside the jail.</p>
</div>
<div class="paragraph">
<p>For example, to install <a class="package" href="https://cgit.freebsd.org/ports/tree/nginx-lite/">nginx-lite</a> in the jail, the next command can be executed <strong>from the host</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg -j classic install nginx-lite</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on working with packages in FreeBSD, see <a href="../ports/#ports">Installing Applications: Packages and Ports</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="access-jail">17.6.5. Access a Jail<a class="anchor" href="#access-jail"></a></h3>
<div class="paragraph">
<p>While it has been stated above that it is best to manage jails from the host system, a jail can be entered with <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a>.</p>
</div>
<div class="paragraph">
<p>The jail can be entered by running <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> from the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jexec -u root jailname</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When gaining access to the jail, the message configured in <a href="https://man.freebsd.org/cgi/man.cgi?query=motd&amp;sektion=5&amp;format=html">motd(5)</a> will be displayed.</p>
</div>
</div>
<div class="sect2">
<h3 id="execute-commands-jail">17.6.6. Execute Commands in a Jail<a class="anchor" href="#execute-commands-jail"></a></h3>
<div class="paragraph">
<p>To execute a command from the host system in a jail the <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> can be used.</p>
</div>
<div class="paragraph">
<p>For example, to stop a service that is running inside a jail, the command will be executed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># jexec -l jailname service stop nginx</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jail-upgrading">17.7. Jail Upgrading<a class="anchor" href="#jail-upgrading"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Upgrading FreeBSD Jails ensures that the isolated environments remain secure, up-to-date, and in line with the latest features and improvements available in the FreeBSD ecosystem.</p>
</div>
<div class="sect2">
<h3 id="jails-updating">17.7.1. Upgrading a Classic Jail or a Thin Jail using OpenZFS Snapshots<a class="anchor" href="#jails-updating"></a></h3>
<div class="paragraph">
<p>Jails <strong>must be updated from the host</strong> operating system. The default behavior in FreeBSD is to disallow the use of <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> in a jail. This will prevent the update of some files so updating from withing the jail will fail.</p>
</div>
<div class="paragraph">
<p>To update the jail to the latest patch release of the version of FreeBSD it is running, execute the following commands on the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -j classic fetch install</span>
<span class="c"># service jail restart classic</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To upgrade the jail to a new major or minor version, first upgrade the host system as described in <a href="../cutting-edge/#freebsdupdate-upgrade">Performing Major and Minor Version Upgrades</a>. Once the host has been upgraded and rebooted, the jail can then be upgraded.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In case of upgrade from one version to another, it is easier to create a new jail than to upgrade completely.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>For example to upgrade from 13.1-RELEASE to 13.2-RELEASE, execute the following commands on the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -j classic -r 13.2-RELEASE upgrade</span>
<span class="c"># freebsd-update -j classic install</span>
<span class="c"># service jail restart classic</span>
<span class="c"># freebsd-update -j classic install</span>
<span class="c"># service jail restart classic</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is necessary to execute the <code>install</code> step two times. The first one upgrades the kernel, and the second one upgrades the rest of the components.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Then, if it was a major version upgrade, reinstall all installed packages and restart the jail again. This is required because the ABI version changes when upgrading between major versions of FreeBSD.</p>
</div>
<div class="paragraph">
<p>From the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># pkg -j jailname upgrade -f</span>
<span class="c"># service jail restart jailname</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading-thin-jail">17.7.2. Upgrading a Thin Jail Using NullFS<a class="anchor" href="#upgrading-thin-jail"></a></h3>
<div class="paragraph">
<p>Since Thin Jails that use NullFS share the majority of system directories, they are very easy to update. It is enough to update the template. This allows updating multiple jails at the same time.</p>
</div>
<div class="paragraph">
<p>To update the template to the latest patch release of the version of FreeBSD it is running, execute the following commands on the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -b /usr/local/jails/templates/13.1-RELEASE-base/ fetch install</span>
<span class="c"># service jail restart</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To upgrade the template to a new major or minor version, first upgrade the host system as described in <a href="../cutting-edge/#freebsdupdate-upgrade">Performing Major and Minor Version Upgrades</a>. Once the host has been upgraded and rebooted, the template can then be upgraded.</p>
</div>
<div class="paragraph">
<p>For example, to upgrade from 13.1-RELEASE to 13.2-RELEASE, execute the following commands on the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># freebsd-update -b /usr/local/jails/templates/13.1-RELEASE-base/ -r 13.2-RELEASE upgrade</span>
<span class="c"># freebsd-update -b /usr/local/jails/templates/13.1-RELEASE-base/ install</span>
<span class="c"># service jail restart</span>
<span class="c"># freebsd-update -b /usr/local/jails/templates/13.1-RELEASE-base/ install</span>
<span class="c"># service jail restart</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jail-resource-limits">17.8. Jail Resource Limits<a class="anchor" href="#jail-resource-limits"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Controlling the resources that a jail uses from the host system is a task to be taken into account by the system administrator.</p>
</div>
<div class="paragraph">
<p><a href="https://man.freebsd.org/cgi/man.cgi?query=rctl&amp;sektion=8&amp;format=html">rctl(8)</a> allows you to manage the resources that a jail can use from the host system.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>kern.racct.enable</code> tunable must be enabled at <span class="filename">/boot/loader.conf</span>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The syntax to limit the resources of a jail is as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>rctl -a jail:&lt;jailname&gt;:resource:action=amount/percentage</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to limit the maximum RAM that a jail can access, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># rctl -a jail:classic:memoryuse:deny=2G</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To make the limitation persistent across reboots of the host system, it will be necessary to add the rule to the <span class="filename">/etc/rctl.conf</span> file as follows:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>jail:classic:memoryuse:deny=2G/jail</pre>
</div>
</div>
<div class="paragraph">
<p>More information on resource limits can be found in the security chapter in the <a href="../security/#security-resourcelimits">Resource Limits section</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jail-managers-and-containers">17.9. Jail Managers and Containers<a class="anchor" href="#jail-managers-and-containers"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As previously explained, each type of FreeBSD Jail can be created and configured manually, but FreeBSD also has third-party utilities to make configuration and administration easier.</p>
</div>
<div class="paragraph">
<p>Below is an incomplete list of the different FreeBSD Jail managers:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">表 1. Jail Managers</caption>
<colgroup>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">License</th>
<th class="tableblock halign-left valign-top">Package</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BastilleBSD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD-3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/bastille/">sysutils/bastille</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://bastille.readthedocs.io/en/latest/">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD-3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/pot/">sysutils/pot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://pot.pizzamig.dev/">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cbsd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/cbsd/">sysutils/cbsd</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.bsdstore.ru/en/docs.html">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AppJail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD-3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/appjail/">sysutils/appjail</a>, for devel <a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/appjail-devel/">sysutils/appjail-devel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/DtxdF/AppJail#getting-started">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iocage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/iocage/">sysutils/iocage</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://iocage.readthedocs.io/en/latest/">Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ezjail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://erdgeist.org/beerware.html">Beer Ware</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a class="package" href="https://cgit.freebsd.org/ports/tree/sysutils/ezjail/">sysutils/ezjail</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://erdgeist.org/arts/software/ezjail/">Documentation</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>

    </div>
    
    <hr />
    <div class="last-modified">
      <p><strong>Last modified on</strong>: December 21, 2023 by <a href="https://cgit.freebsd.org/doc/commit/?id=0503c8e" target="_blank">fiercex</a></p>
    </div>
    
    <div class="buttons">
      
      <div class="prev">
        <i class="fa fa-angle-left" aria-hidden="true" title="Prev"></i>
        <div class="container">
          
            <a href=https://free.bsd-doc.org/zh-cn/books/handbook/security class="direction">Prev</a>
          
        </div>
      </div>
      
      <div class="home">
        <i class="fa fa-home" aria-hidden="true" title="Home"></i>
        <div class="container">
          
            <a href="../" class="direction">Home</a>
          
        </div>
      </div>
      
      <div class="next">
        <div class="container">
          
            <a href=https://free.bsd-doc.org/zh-cn/books/handbook/mac  class="direction">Next</a>
          
        </div>
        <i class="fa fa-angle-right" aria-hidden="true" title="Next"></i>
      </div>
      
    </div>
    <label class="hidden book-menu-overlay" for="menu-control"></label>
  </div>
  <aside class="toc">
    <div class="toc-content">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#jails-synopsis">17.1. Synopsis</a></li>
    <li><a href="#jail-types">17.2. Jail Types</a></li>
    <li><a href="#host-configuration">17.3. Host Configuration</a></li>
    <li><a href="#classic-jail">17.4. Classic Jail (Thick Jail)</a></li>
    <li><a href="#thin-jail">17.5. Thin Jails</a></li>
    <li><a href="#jail-management">17.6. Jail Management</a></li>
    <li><a href="#jail-upgrading">17.7. Jail Upgrading</a></li>
    <li><a href="#jail-resource-limits">17.8. Jail Resource Limits</a></li>
    <li><a href="#jail-managers-and-containers">17.9. Jail Managers and Containers</a></li>
  </ul>
</nav>
      <hr />
      
    </div>
  </aside>
  <a class="to-top" href="#top">
    <i class="fa fa-arrow-circle-up" aria-hidden="true"></i>
  </a>
</main>

    <footer>
  <div class="footer-container">
    <section class="logo-column">
          <img src="https://free.bsd-doc.org/images/FreeBSD-colors.svg" width="160" height="50" alt="FreeBSD logo" />
        <div class="options-container">
          
            <div class="language-container">
              <a id="languages" href="https://free.bsd-doc.org/zh-cn/languages">
                
                <img src="https://free.bsd-doc.org/images/language.png" class="language-image" alt="Choose language">
                <span>简体中文</span>
              </a>
            </div>
          
          <div class="theme-container">
            <select id="theme-chooser">
	      <option value="theme-system">System</option>
              <option value="theme-light">Light</option>
              <option value="theme-dark">Dark</option>
              <option value="theme-high-contrast">High contrast</option>
            </select>
          </div>
        </div>
      </section>
      
      <section class="copyright-column">
        <p>&copy; 1994-2023 The FreeBSD Project. All rights reserved</p>
        <span>Made with <span class="heart">♥</span> by the FreeBSD Community</span>
      </section>
  </div>
</footer>

  </body>
</html>
