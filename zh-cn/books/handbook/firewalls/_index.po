# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2023-12-17 04:24+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: YAML Front Matter: description
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1
#, fuzzy, no-wrap
msgid ""
"FreeBSD has three firewalls built into the base system: PF, IPFW, and "
"IPFILTER. This chapter covers how to define packet filtering rules, the "
"differences between the firewalls built into FreeBSD and how to use them"
msgstr ""
"FreeBSD的基本系统内置了三个防火墙：PF、IPFW和IPFILTER。本章介绍如何定义数据包过滤规则，介绍FreeBSD内置防火墙之间的差异以及如何使用它们。"

#. type: YAML Front Matter: part
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1
#, fuzzy, no-wrap
msgid "IV. Network Communication"
msgstr "IV. 网络通信"

#. type: YAML Front Matter: title
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1
#, fuzzy, no-wrap
msgid "Chapter 33. Firewalls"
msgstr "第33章 防火墙"

#. type: Title =
#: documentation/content/en/books/handbook/firewalls/_index.adoc:14
#, fuzzy, no-wrap
msgid "Firewalls"
msgstr "防火墙"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:39
#, fuzzy
msgid ""
"include::shared/attributes/attributes-{{% lang %}}.adoc[] "
"include::shared/{{% lang %}}/teams.adoc[] include::shared/{{% lang "
"%}}/mailing-lists.adoc[] include::shared/{{% lang %}}/urls.adoc[]"
msgstr ""
"包括::shared/attributes/attributes-{{% lang %}}.adoc[] 包括::shared/{{% lang "
"%}}/团队.adoc[] 包括::shared/{{% lang %}}/邮件列表.adoc[] 包括::shared/{{% lang "
"%}}/网址.adoc[]"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:52
#, fuzzy, no-wrap
msgid "Synopsis"
msgstr "简介"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:57
#, fuzzy
msgid ""
"Firewalls make it possible to filter the incoming and outgoing traffic that "
"flows through a system.  A firewall can use one or more sets of \"rules\" to"
" inspect network packets as they come in or go out of network connections "
"and either allows the traffic through or blocks it.  The rules of a firewall"
" can inspect one or more characteristics of the packets such as the protocol"
" type, source or destination host address, and source or destination port."
msgstr ""
"防火墙使得过滤通过系统流动的进出流量成为可能。防火墙可以使用一个或多个“规则”来检查进出网络连接的网络数据包，然后允许流量通过或阻止它。防火墙的规则可以检查数据包的一个或多个特征，如协议类型、源或目标主机地址、源或目标端口。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:60
#, fuzzy
msgid ""
"Firewalls can enhance the security of a host or a network.  They can be used"
" to do one or more of the following:"
msgstr "防火墙可以增强主机或网络的安全性。它们可用于执行以下一个或多个功能："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:62
#, fuzzy
msgid ""
"Protect and insulate the applications, services, and machines of an internal"
" network from unwanted traffic from the public Internet."
msgstr "从公共互联网中保护和隔离内部网络的应用程序、服务和机器，以避免不需要的流量进入。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:63
#, fuzzy
msgid ""
"Limit or disable access from hosts of the internal network to services of "
"the public Internet."
msgstr "限制或禁止内部网络主机访问公共互联网服务。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:64
#, fuzzy
msgid ""
"Support network address translation (NAT), which allows an internal network "
"to use private IP addresses and share a single connection to the public "
"Internet using either a single IP address or a shared pool of automatically "
"assigned public addresses."
msgstr "支持网络地址转换（NAT），它使内部网络能够使用私有IP地址，并使用单个IP地址或共享的自动分配的公共地址池共享与公共互联网的连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:69
#, fuzzy
msgid ""
"FreeBSD has three firewalls built into the base system: PF, IPFW, and "
"IPFILTER, also known as IPF.  FreeBSD also provides two traffic shapers for "
"controlling bandwidth usage: man:altq[4] and man:dummynet[4].  ALTQ has "
"traditionally been closely tied with PF and dummynet with IPFW.  Each "
"firewall uses rules to control the access of packets to and from a FreeBSD "
"system, although they go about it in different ways and each has a different"
" rule syntax."
msgstr ""
"FreeBSD基本系统中内置了三个防火墙：PF、IPFW和IPFILTER，也被称为IPF。 "
"FreeBSD还提供了两个流量整形器用于控制带宽使用：man:altq[4]和man:dummynet[4]。 "
"ALTQ传统上与PF密切相关，而dummynet与IPFW密切相关。每个防火墙使用规则来控制数据包对FreeBSD系统的访问，尽管它们的实现方式不同，并且每个防火墙都有不同的规则语法。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:72
#, fuzzy
msgid ""
"FreeBSD provides multiple firewalls in order to meet the different "
"requirements and preferences for a wide variety of users.  Each user should "
"evaluate which firewall best meets their needs."
msgstr "FreeBSD提供了多个防火墙选项，以满足广大用户的不同需求和偏好。每个用户应根据自己的需求评估哪个防火墙最适合他们的需要。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:74
#, fuzzy
msgid "After reading this chapter, you will know:"
msgstr "阅读完本章后，你将了解到："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:76
#, fuzzy
msgid "How to define packet filtering rules."
msgstr "如何定义包过滤规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:77
#, fuzzy
msgid "The differences between the firewalls built into FreeBSD."
msgstr "FreeBSD内置的防火墙之间的区别。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:78
#, fuzzy
msgid "How to use and configure the PF firewall."
msgstr "如何使用和配置 PF 防火墙。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:79
#, fuzzy
msgid "How to use and configure the IPFW firewall."
msgstr "如何使用和配置IPFW防火墙。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:80
#, fuzzy
msgid "How to use and configure the IPFILTER firewall."
msgstr "如何使用和配置IPFILTER防火墙。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:82
#, fuzzy
msgid "Before reading this chapter, you should:"
msgstr "在阅读本章之前，你应该："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:84
#, fuzzy
msgid "Understand basic FreeBSD and Internet concepts."
msgstr "了解基本的FreeBSD和互联网概念。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:89
#, fuzzy
msgid ""
"Since all firewalls are based on inspecting the values of selected packet "
"control fields, the creator of the firewall ruleset must have an "
"understanding of how TCP/IP works, what the different values in the packet "
"control fields are, and how these values are used in a normal session "
"conversation.  For a good introduction, refer to "
"http://www.ipprimer.com[Daryl's TCP/IP Primer]."
msgstr ""
"由于所有防火墙都是基于检查所选择的数据包控制字段的值，所以防火墙规则集的创建者必须了解TCP/IP的工作原理，数据包控制字段中的不同值是什么，以及这些值在正常会话中如何使用。对于一个很好的介绍，请参考[Daryl's"
" TCP/IP Primer](http://www.ipprimer.com)。"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:92
#, fuzzy, no-wrap
msgid "Firewall Concepts"
msgstr ""
"防火墙概念\n"
"\n"
"== 什么是防火墙？==\n"
"\n"
"防火墙是计算机网络中的一种安全设备，用于监控和控制网络流量。它通过筛选和限制网络数据包的传输，以保护网络免受潜在的安全威胁。\n"
"\n"
"== 防火墙的工作原理 ==\n"
"\n"
"防火墙基于一组预定义的规则来决定是否允许或阻止网络流量通过。这些规则可以基于源和目标IP地址、端口号、协议类型等多个因素来进行过滤判断。当防火墙检测到违反规则的流量时，它会执行相应的操作，如阻止、记录或警告。\n"
"\n"
"== 防火墙的类型 ==\n"
"\n"
"1. **网络层防火墙**：根据网络层（IP地址、端口号）来过滤流量。这是最常见的防火墙类型，能够阻止未经授权的访问和破坏性攻击。\n"
"\n"
"2. **应用层防火墙**：不仅考虑网络层，还对应用层数据进行过滤和检测。它可以识别特定应用程序协议，并根据协议规则来阻止或允许流量。\n"
"\n"
"3. **代理防火墙**：在数据传输过程中充当客户端和服务器之间的中间代理。它能够更深入地检查数据流，并提供高级的安全功能，如内容过滤和反病毒扫描。\n"
"\n"
"4. **主机防火墙**：安装在单个主机上的防火墙，用于保护该主机免受网络威胁。它可以限制进出主机的网络流量，并提供额外的安全措施。\n"
"\n"
"== 防火墙的优点和应用场景 ==\n"
"\n"
"防火墙的主要优点包括：\n"
"\n"
"- 提供网络安全和保护机制，防止未经授权的访问。\n"
"- 帮助阻止恶意入侵和网络攻击，保护敏感数据不受损失。\n"
"- 监控和记录网络流量，用于审计和故障排除。\n"
"\n"
"防火墙在以下场景中广泛应用：\n"
"\n"
"- 企业网络：保护企业内部网络免受外部威胁和攻击，确保数据的安全性和隐私性。\n"
"- 个人电脑：防止恶意软件、病毒和黑客攻击，保护个人计算机的安全。\n"
"- 数据中心：为服务器和存储系统提供安全保护，确保数据的完整性和可靠性。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:100
#, fuzzy
msgid ""
"A ruleset contains a group of rules which pass or block packets based on the"
" values contained in the packet.  The bi-directional exchange of packets "
"between hosts comprises a session conversation.  The firewall ruleset "
"processes both the packets arriving from the public Internet, as well as the"
" packets produced by the system as a response to them.  Each TCP/IP service "
"is predefined by its protocol and listening port.  Packets destined for a "
"specific service originate from the source address using an unprivileged "
"port and target the specific service port on the destination address.  All "
"the above parameters can be used as selection criteria to create rules which"
" will pass or block services."
msgstr ""
"一个规则集包含一组规则，这些规则根据数据包中包含的值来通过或阻止数据包。主机之间数据包的双向交换构成一个会话对话。防火墙规则集处理来自公共互联网的数据包，以及系统作为对它们的响应而产生的数据包。每个TCP/IP服务以其协议和监听端口进行预定义。针对特定服务的数据包来自源地址，使用一个非特权端口，并指向目标地址上的特定服务端口。所有上述参数都可以用作筛选条件，用于创建通过或阻止服务的规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:103
#, fuzzy
msgid ""
"To lookup unknown port numbers, refer to [.filename]#/etc/services#.  "
"Alternatively, visit "
"http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers[http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers]"
" and do a port number lookup to find the purpose of a particular port "
"number."
msgstr ""
"要查找未知的端口号，请参考/etc/services文件。或者，访问http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers，并进行端口号查找以找到特定端口号的用途。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:105
#, fuzzy
msgid ""
"Check out this link for "
"http://web.archive.org/web/20150803024617/http://www.sans.org/security-"
"resources/idfaq/oddports.php[port numbers used by Trojans]."
msgstr ""
"请查看此链接以获取 "
"[特洛伊木马使用的端口号](http://web.archive.org/web/20150803024617/http://www.sans.org/security-"
"resources/idfaq/oddports.php) 。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:110
#, fuzzy
msgid ""
"FTP has two modes: active mode and passive mode.  The difference is in how "
"the data channel is acquired.  Passive mode is more secure as the data "
"channel is acquired by the ordinal ftp session requester.  For a good "
"explanation of FTP and the different modes, see "
"http://www.slacksite.com/other/ftp.html[http://www.slacksite.com/other/ftp.html]."
msgstr ""
"FTP有两种模式：主动模式和被动模式。它们的区别在于数据通道的获取方式。被动模式更安全，因为数据通道是由原始的FTP会话请求者获取的。关于FTP和不同的模式有一个很好的解释，请参考[http://www.slacksite.com/other/ftp.html](http://www.slacksite.com/other/ftp.html)。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:114
#, fuzzy
msgid ""
"A firewall ruleset can be either \"exclusive\" or \"inclusive\".  An "
"exclusive firewall allows all traffic through except for the traffic "
"matching the ruleset.  An inclusive firewall does the reverse as it only "
"allows traffic matching the rules through and blocks everything else."
msgstr ""
"防火墙规则集可以是“排他性的”或“包容性的”。排他性防火墙允许所有流量通过，除了与规则集匹配的流量。包容性防火墙则相反，它仅允许与规则匹配的流量通过，阻止其他所有流量。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:119
#, fuzzy
msgid ""
"An inclusive firewall offers better control of the outgoing traffic, making "
"it a better choice for systems that offer services to the public Internet.  "
"It also controls the type of traffic originating from the public Internet "
"that can gain access to a private network.  All traffic that does not match "
"the rules is blocked and logged.  Inclusive firewalls are generally safer "
"than exclusive firewalls because they significantly reduce the risk of "
"allowing unwanted traffic."
msgstr ""
"一个包容性防火墙提供更好的对外流量控制，使其成为为公共互联网提供服务的系统的更好选择。它还控制源自公共互联网的流量类型，以便访问私有网络。所有不符合规则的流量都会被阻止并记录。相比独占性防火墙，包容性防火墙通常更安全，因为它们显着减少了允许不受欢迎流量进入的风险。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:123
#, fuzzy
msgid ""
"Unless noted otherwise, all configuration and example rulesets in this "
"chapter create inclusive firewall rulesets."
msgstr "除非另有说明，本章中所有的配置和示例规则集都创建包含的防火墙规则集。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:127
#, fuzzy
msgid ""
"Security can be tightened further using a \"stateful firewall\".  This type "
"of firewall keeps track of open connections and only allows traffic which "
"either matches an existing connection or opens a new, allowed connection."
msgstr "安全性可以进一步加强通过使用\"有状态防火墙\"。这种类型的防火墙跟踪打开的连接，并且只允许与现有连接匹配或打开一个新的允许连接的流量通过。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:132
#, fuzzy
msgid ""
"Stateful filtering treats traffic as a bi-directional exchange of packets "
"comprising a session.  When state is specified on a matching rule the "
"firewall dynamically generates internal rules for each anticipated packet "
"being exchanged during the session.  It has sufficient matching capabilities"
" to determine if a packet is valid for a session.  Any packets that do not "
"properly fit the session template are automatically rejected."
msgstr ""
"有状态过滤将流量视为一个由会话组成的双向数据包交换。当匹配规则上指定了状态时，防火墙会动态生成针对每个预期在会话期间进行交换的数据包的内部规则。它具有足够的匹配能力，以确定数据包是否适用于会话。不符合会话模板的所有数据包将自动被拒绝。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:134
#, fuzzy
msgid ""
"When the session completes, it is removed from the dynamic state table."
msgstr "当会话完成时，它将从动态状态表中删除。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:139
#, fuzzy
msgid ""
"Stateful filtering allows one to focus on blocking/passing new sessions.  If"
" the new session is passed, all its subsequent packets are allowed "
"automatically and any impostor packets are automatically rejected.  If a new"
" session is blocked, none of its subsequent packets are allowed.  Stateful "
"filtering provides advanced matching abilities capable of defending against "
"the flood of different attack methods employed by attackers."
msgstr ""
"有状态的过滤允许我们专注于阻止/通过新会话。如果新会话被允许通过，那么它的所有后续数据包将自动被允许通过，而任何伪造的数据包将被自动拒绝。如果新会话被阻止，它的所有后续数据包都不会被允许通过。有状态的过滤提供了先进的匹配能力，能够抵御攻击者采用的各种攻击方法的洪流。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:143
#, fuzzy
msgid ""
"NAT stands for _Network Address Translation_.  NAT function enables the "
"private LAN behind the firewall to share a single ISP-assigned IP address, "
"even if that address is dynamically assigned.  NAT allows each computer in "
"the LAN to have Internet access, without having to pay the ISP for multiple "
"Internet accounts or IP addresses."
msgstr ""
"NAT代表网络地址转换。NAT功能使得防火墙后面的私有局域网可以共享一个ISP分配的IP地址，即使该地址是动态分配的。NAT允许局域网中的每台计算机都可以访问互联网，而不需要为多个互联网账户或IP地址支付ISP费用。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:146
#, fuzzy
msgid ""
"NAT will automatically translate the private LAN IP address for each system "
"on the LAN to the single public IP address as packets exit the firewall "
"bound for the public Internet.  It also performs the reverse translation for"
" returning packets."
msgstr ""
"NAT将自动在出防火墙进入公共互联网的数据包上，将局域网上每个系统的私有LAN IP地址转换为单个公共IP地址。它还负责返回数据包的反向转换。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:148
#, fuzzy
msgid ""
"According to RFC 1918, the following IP address ranges are reserved for "
"private networks which will never be routed directly to the public Internet,"
" and therefore are available for use with NAT:"
msgstr "根据 RFC 1918，以下 IP 地址范围被保留用于私有网络，直接连接到公共互联网的路由会被忽略，因此可用于与 NAT 一起使用："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:150
#, fuzzy
msgid "`10.0.0.0/8`."
msgstr ""
"`10.0.0.0/8`是一个IPv4地址空间，其中的`10.0.0.0`是网络的起始地址，`/8`表示网络前缀的长度为8位。这个地址空间中可以包含256个具有相同前缀的网络，每个网络中可以有约16,777,216个可用的IP地址。它通常用作私有网络，供内部使用。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:151
#, fuzzy
msgid "`172.16.0.0/12`."
msgstr ""
"`172.16.0.0/12`是一个CIDR（无类别域间路由）网络地址。它表示一个私有IP地址范围，该范围从172.16.0.0到172.31.255.255，共包含2^20个IP地址。CIDR是一种用于划分IP地址空间的方法，其中前缀长度（/12）指示了网络地址的位数。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:152
#, fuzzy
msgid "`192.168.0.0/16`."
msgstr ""
"`192.168.0.0/16` 表示一个 IP 地址块，IP 地址是 `192.168.0.0`，子网掩码为 "
"`16`，用于表示该IP地址块所属的子网范围。在CIDR（无类别域间路由）标记法中，`/16` 等同于子网掩码 `255.255.0.0`，它指示了 "
"IP 地址中的前16位是网络标识，后16位是主机标识。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:158
#, fuzzy
msgid ""
"When working with the firewall rules, be _very careful_.  Some "
"configurations _can lock the administrator out_ of the server.  To be on the"
" safe side, consider performing the initial firewall configuration from the "
"local console rather than doing it remotely over ssh."
msgstr ""
"在处理防火墙规则时，务必非常小心。某些配置可能会将管理员锁在服务器外。为了安全起见，建议从本地控制台进行初始防火墙配置，而不是通过ssh远程操作。"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:161
#, fuzzy, no-wrap
msgid "PF"
msgstr ""
"PF（Packet "
"Filter）是一种在计算机网络中使用的数据包过滤器。它可以根据预先定义的规则来检查和过滤传输的网络数据包。PF通常用于防火墙配置，可以帮助保护计算机或网络免受潜在的威胁和攻击。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:165
#, fuzzy
msgid ""
"Since FreeBSD 5.3, a ported version of OpenBSD's PF firewall has been "
"included as an integrated part of the base system.  PF is a complete, full-"
"featured firewall that has optional support for ALTQ (Alternate Queuing), "
"which provides Quality of Service (QoS)."
msgstr ""
"自从FreeBSD "
"5.3版本以后，OpenBSD的PF防火墙的移植版本已被包含为基础系统的一个集成部分。PF是一个完整、功能齐全的防火墙，可选择性地支持ALTQ（Alternate"
" Queuing）技术，该技术提供了服务质量（QoS）功能。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:168
#, fuzzy
msgid ""
"The OpenBSD Project maintains the definitive reference for PF in the "
"http://www.openbsd.org/faq/pf/[PF FAQ].  Peter Hansteen maintains a thorough"
" PF tutorial at "
"http://home.nuug.no/\\~peter/pf/[http://home.nuug.no/~peter/pf/]."
msgstr ""
"OpenBSD项目在[PF FAQ]（http://www.openbsd.org/faq/pf/）中提供了PF的权威参考。Peter "
"Hansteen在[http://home.nuug.no/~peter/pf/]维护了一份详尽的PF教程。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:173
#, fuzzy
msgid ""
"When reading the http://www.openbsd.org/faq/pf/[PF FAQ], keep in mind that "
"FreeBSD's version of PF has diverged substantially from the upstream OpenBSD"
" version over the years.  Not all features work the same way on FreeBSD as "
"they do in OpenBSD and vice versa."
msgstr ""
"阅读 http://www.openbsd.org/faq/pf/[PF FAQ] 时，请记住多年来，FreeBSD 版本的 PF 与上游的 "
"OpenBSD 版本有很大的差异。在 FreeBSD 上，并非所有功能与 OpenBSD 的工作方式相同，反之亦然。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:177
#, fuzzy
msgid ""
"The {freebsd-pf} is a good place to ask questions about configuring and "
"running the PF firewall.  Check the mailing list archives before asking a "
"question as it may have already been answered."
msgstr ""
"{freebsd-pf} 是一个很好的地方，用来提问关于配置和运行 PF 防火墙的问题。在提问之前，请先查阅邮件列表的存档，因为可能已经有人回答过了。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:181
#, fuzzy
msgid ""
"This section of the Handbook focuses on PF as it pertains to FreeBSD.  It "
"demonstrates how to enable PF and ALTQ.  It also provides several examples "
"for creating rulesets on a FreeBSD system."
msgstr "本手册的这个部分专注于FreeBSD上的PF。它展示了如何启用PF和ALTQ，并提供了在FreeBSD系统上创建规则集的几个示例。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:182
#, fuzzy, no-wrap
msgid "Enabling PF"
msgstr ""
"启用PFAsciidoc字样。\n"
"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:186
#, fuzzy
msgid ""
"To use PF, its kernel module must be first loaded.  This section describes "
"the entries that can be added to [.filename]#/etc/rc.conf# to enable PF."
msgstr "要使用 PF，首先必须加载其内核模块。本节描述了可以添加到 [/etc/rc.conf] 文件中以启用 PF 的条目。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:188
#, fuzzy
msgid "Start by adding `pf_enable=yes` to [.filename]#/etc/rc.conf#:"
msgstr "首先，在 [.filename]#/etc/rc.conf# 文件中添加 `pf_enable=yes`。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:192
#, no-wrap
msgid "# sysrc pf_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:196
#, fuzzy
msgid ""
"Additional options, described in man:pfctl[8], can be passed to PF when it "
"is started.  Add or change this entry in [.filename]#/etc/rc.conf# and "
"specify any required flags between the two quotes (`\"\"`):"
msgstr ""
"当启动PF时，可以通过man:pfctl[8]中描述的附加选项传递给它。在.filename中添加或更改此条目#/etc/rc.conf#并在两个引号(`\"\"`)之间指定所需的任何标志。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:200
#, no-wrap
msgid "pf_flags=\"\"                     # additional flags for pfctl startup\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:206
#, fuzzy
msgid ""
"PF will not start if it cannot find its ruleset configuration file.  By "
"default, FreeBSD does not ship with a ruleset and there is no "
"[.filename]#/etc/pf.conf#.  Example rulesets can be found in "
"[.filename]#/usr/share/examples/pf/#.  If a custom ruleset has been saved "
"somewhere else, add a line to [.filename]#/etc/rc.conf# which specifies the "
"full path to the file:"
msgstr ""
"如果PF无法找到其规则集配置文件，则无法启动。默认情况下，FreeBSD不附带规则集，并且没有`/etc/pf.conf`文件。可以在`/usr/share/examples/pf/`目录中找到示例规则集。如果自定义的规则集已保存在其他地方，请在`/etc/rc.conf`文件中添加一行，指定文件的完整路径："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:210
#, no-wrap
msgid "pf_rules=\"/path/to/pf.conf\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:214
#, fuzzy
msgid ""
"Logging support for PF is provided by man:pflog[4].  To enable logging "
"support, add `pflog_enable=yes` to [.filename]#/etc/rc.conf#:"
msgstr ""
"PF提供了日志支持，可以通过man:pflog[4]来了解。要启用日志支持，在[.filename]#/etc/rc.conf#文件中添加`pflog_enable=yes`。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:218
#, no-wrap
msgid "# sysrc pflog_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:221
#, fuzzy
msgid ""
"The following lines can also be added to change the default location of the "
"log file or to specify any additional flags to pass to man:pflog[4] when it "
"is started:"
msgstr "还可以添加下面的行来更改日志文件的默认位置，或者指定在启动man:pflog[4]时传递的任何其他标志:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:226
#, no-wrap
msgid ""
"pflog_logfile=\"/var/log/pflog\"  # where pflogd should store the logfile\n"
"pflog_flags=\"\"                  # additional flags for pflogd startup\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:229
#, fuzzy
msgid ""
"Finally, if there is a LAN behind the firewall and packets need to be "
"forwarded for the computers on the LAN, or NAT is required, enable the "
"following option:"
msgstr "最后，如果防火墙后面有一个局域网（LAN），并且需要转发LAN上的计算机的数据包，或者需要进行网络地址转换（NAT），则启用以下选项："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:233
#, no-wrap
msgid "gateway_enable=\"YES\"            # Enable as LAN gateway\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:236
#, fuzzy
msgid ""
"After saving the needed edits, PF can be started with logging support by "
"typing:"
msgstr "保存所需的编辑后，可以通过输入以下命令启动具有日志记录支持的PF："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:241
#, no-wrap
msgid ""
"# service pf start\n"
"# service pflog start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:246
#, fuzzy
msgid ""
"By default, PF reads its configuration rules from [.filename]#/etc/pf.conf# "
"and modifies, drops, or passes packets according to the rules or definitions"
" specified in this file.  The FreeBSD installation includes several sample "
"files located in [.filename]#/usr/share/examples/pf/#.  Refer to the "
"http://www.openbsd.org/faq/pf/[PF FAQ] for complete coverage of PF rulesets."
msgstr ""
"默认情况下，PF从 [.filename]#/etc/pf.conf# "
"读取配置规则，并根据该文件中指定的规则或定义来修改、丢弃或通过数据包。FreeBSD安装包中包含了一些示例文件，位于 "
"[.filename]#/usr/share/examples/pf/#目录下。完整的PF规则集覆盖请参考 "
"http://www.openbsd.org/faq/pf/ 的[PF FAQ]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:250
#, fuzzy
msgid ""
"To control PF, use `pfctl`.  <<pfctl>> summarizes some useful options to "
"this command.  Refer to man:pfctl[8] for a description of all available "
"options:"
msgstr ""
"要控制PF，请使用`pfctl`命令。`pfctl`命令<<pfctl>>总结了一些有用的选项。有关所有可用选项的描述，请参阅man:pfctl[8]。"

#. type: Block title
#: documentation/content/en/books/handbook/firewalls/_index.adoc:251
#, fuzzy, no-wrap
msgid "Useful `pfctl` Options"
msgstr ""
"有用的 `pfctl` 选项\n"
"\n"
"`pfctl` 是一个用于管理 OpenBSD 系统的 PF（Packet Filter）防火墙的命令行工具。以下是一些有用的 `pfctl` 选项：\n"
"\n"
"* `-e` （启用）：启用 PF 防火墙。\n"
"* `-d` （禁用）：禁用 PF 防火墙。\n"
"* `-v` （显示）：显示当前 PF 防火墙的状态。\n"
"* `-f` （文件）：指定一个配置文件来加载 PF 防火墙规则。\n"
"* `-T` （表达式）：使用表达式来测试 PF 防火墙规则。\n"
"* `-s` （状态）：显示 PF 防火墙状态表信息。\n"
"* `-N` （网络）：显示网络地址及端口信息。\n"
"* `-R` （规则）：显示 PF 防火墙规则集信息。\n"
"* `-i` （接口）：显示接口信息。\n"
"* `-t` （计时器）：显示计时器信息。\n"
"* `-F` （刷新）：刷新 PF 防火墙状态表。\n"
"* `-S` （保存）：保存当前 PF 防火墙状态表变化到磁盘配置文件。\n"
"\n"
"这些选项可用于管理和配置 PF 防火墙，以确保网络安全和流量控制。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:255
#, fuzzy, no-wrap
msgid "Command"
msgstr "命令"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:257
#, fuzzy, no-wrap
msgid "Purpose"
msgstr "目的"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:258
#, fuzzy, no-wrap
msgid "`pfctl -e`"
msgstr "`pfctl -e` 是一个在 BSD 系统中使用的命令，用于启用网络包过滤和网络地址转换的功能。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:260
#, fuzzy, no-wrap
msgid "Enable PF."
msgstr "启用 PF。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:261
#, fuzzy, no-wrap
msgid "`pfctl -d`"
msgstr "`pfctl -d` 是一个用于禁用 PF 防火墙的命令。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:263
#, fuzzy, no-wrap
msgid "Disable PF."
msgstr "禁用 PF。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:264
#, fuzzy, no-wrap
msgid "`pfctl -F all -f /etc/pf.conf`"
msgstr ""
"`pfctl -F all -f "
"/etc/pf.conf`是一个使用pfctl命令的示例。该命令用于使用指定的配置文件`/etc/pf.conf`来清除并重新加载所有的pf规则。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:266
#, fuzzy, no-wrap
msgid ""
"Flush all NAT, filter, state, and table rules and reload "
"[.filename]#/etc/pf.conf#."
msgstr "刷新所有的NAT、过滤、状态和表规则，并重新加载/etc/pf.conf文件。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:266
#, fuzzy, no-wrap
msgid "`pfctl -s [ rules \\"
msgstr ""
"`pfctl -s [ rules \\`\n"
"\n"
"将会显示当前的 pf 防火墙规则。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:266
#, fuzzy, no-wrap
msgid "nat \\"
msgstr "NAT（网络地址转换）"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:267
#, fuzzy, no-wrap
msgid "states ]`"
msgstr ""
"states 是 asciidoc 中的一个标签，用于创建一个状态集合。在计算机科学中，该术语通常用于描述有限状态机或状态转换图中的状态。在这里，states 可以理解为一组状态的集合。\n"
"\n"
"如果要完整翻译整个句子，可能是：\"状态集合\"`states`。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:269
#, fuzzy, no-wrap
msgid "Report on the filter rules, NAT rules, or state table."
msgstr "关于过滤规则、网络地址转换规则或状态表的报告。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:270
#, fuzzy, no-wrap
msgid "`pfctl -vnf /etc/pf.conf`"
msgstr ""
"`pfctl -vnf /etc/pf.conf` 是一条在计算机中使用的命令。该命令用于在OpenBSD操作系统上启动和配置PF（Packet Filter）防火墙。通过 `pfctl` 命令，可以加载并验证 `/etc/pf.conf` 文件中的防火墙规则，并将规则应用到网络接口上。 `-v` 选项用于显示详细的验证结果，`-n` 选项用于仅验证配置文件而不应用规则，`-f` 选项后指定了要加载的配置文件路径。\n"
"\n"
"简而言之，`pfctl -vnf /etc/pf.conf` 命令的作用是加载并验证位于 `/etc/pf.conf` 文件中的防火墙规则，并显示详细的验证结果，同时不应用这些规则。"

#. type: Table
#: documentation/content/en/books/handbook/firewalls/_index.adoc:271
#, fuzzy, no-wrap
msgid "Check [.filename]#/etc/pf.conf# for errors, but do not load ruleset."
msgstr "检查 [.filename]#/etc/pf.conf# 中的错误，但不加载规则集。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:277
#, fuzzy
msgid ""
"package:security/sudo[] is useful for running commands like `pfctl` that "
"require elevated privileges.  It can be installed from the Ports Collection."
msgstr ""
"package:security/sudo[] 是一个有用的工具，用于以提升的权限运行诸如 `pfctl` 等需要特权的命令。可以从 Ports "
"Collection 安装它。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:281
#, fuzzy
msgid ""
"To keep an eye on the traffic that passes through the PF firewall, consider "
"installing the package:sysutils/pftop[] package or port.  Once installed, "
"pftop can be run to view a running snapshot of traffic in a format which is "
"similar to man:top[1]."
msgstr ""
"为了监视通过PF防火墙的流量，请考虑安装包：sysutils/pftop[]包或端口。安装后，可以运行pftop以以类似于man:top[1]的格式查看流量的实时快照。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:283
#, fuzzy, no-wrap
msgid "PF Rulesets"
msgstr "PF规则集"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:287
#, fuzzy
msgid ""
"This section demonstrates how to create a customized ruleset.  It starts "
"with the simplest of rulesets and builds upon its concepts using several "
"examples to demonstrate real-world usage of PF's many features."
msgstr "本节展示了如何创建一个定制的规则集。它从最简单的规则集开始，并通过多个示例来构建其概念，以展示PF的许多功能在实际应用中的用法。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:290
#, fuzzy
msgid ""
"The simplest possible ruleset is for a single machine that does not run any "
"services and which needs access to one network, which may be the Internet.  "
"To create this minimal ruleset, edit [.filename]#/etc/pf.conf# so it looks "
"like this:"
msgstr ""
"最简单的规则集适用于一台不运行任何服务但需要访问一个网络（可能是互联网）的单机。要创建这个最小的规则集，请编辑`/etc/pf.conf`文件，使其如下所示："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:295
#, no-wrap
msgid ""
"block in all\n"
"pass out all keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:301
#, fuzzy
msgid ""
"The first rule denies all incoming traffic by default.  The second rule "
"allows connections created by this system to pass out, while retaining state"
" information on those connections.  This state information allows return "
"traffic for those connections to pass back and should only be used on "
"machines that can be trusted.  The ruleset can be loaded with:"
msgstr ""
"第一条规则默认拒绝所有传入流量。第二条规则允许该系统创建的连接通过，同时保留这些连接的状态信息。这些状态信息允许相关连接的返回流量通过，并且只应该在可信任的机器上使用。可以使用以下命令加载规则集："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:305
#, no-wrap
msgid "# pfctl -e ; pfctl -f /etc/pf.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:310
#, fuzzy
msgid ""
"In addition to keeping state, PF provides _lists_ and _macros_ which can be "
"defined for use when creating rules.  Macros can include lists and need to "
"be defined before use.  As an example, insert these lines at the very top of"
" the ruleset:"
msgstr ""
"除了保持状态，PF还提供了可以在创建规则时定义和使用的列表和宏。宏可以包含列表，并且需要在使用之前定义。举个例子，在规则集的最顶部插入以下行："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:315
#, no-wrap
msgid ""
"tcp_services = \"{ ssh, smtp, domain, www, pop3, auth, pop3s }\"\n"
"udp_services = \"{ domain }\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:322
#, fuzzy
msgid ""
"PF understands port names as well as port numbers, as long as the names are "
"listed in [.filename]#/etc/services#.  This example creates two macros.  The"
" first is a list of seven TCP port names and the second is one UDP port "
"name.  Once defined, macros can be used in rules.  In this example, all "
"traffic is blocked except for the connections initiated by this system for "
"the seven specified TCP services and the one specified UDP service:"
msgstr ""
"PF不仅能理解端口号，还能理解端口名称，只要这些名称在[/etc/services]文件中列出来。这个例子创建了两个宏。第一个宏是七个TCP端口名称的列表，第二个宏是一个UDP端口名称。定义好之后，宏可以在规则中使用。在这个例子中，除了由系统发起的与这七个指定TCP服务和一个指定UDP服务建立的连接外，所有流量都被阻止："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:330
#, no-wrap
msgid ""
"tcp_services = \"{ ssh, smtp, domain, www, pop3, auth, pop3s }\"\n"
"udp_services = \"{ domain }\"\n"
"block all\n"
"pass out proto tcp to any port $tcp_services keep state\n"
"pass proto udp to any port $udp_services keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:334
#, fuzzy
msgid ""
"Even though UDP is considered to be a stateless protocol, PF is able to "
"track some state information.  For example, when a UDP request is passed "
"which asks a name server about a domain name, PF will watch for the response"
" to pass it back."
msgstr ""
"尽管UDP被认为是一种无状态协议，但PF能够跟踪一些状态信息。例如，当传输一个UDP请求给一个名称服务器以查询一个域名时，PF会监视响应并将其传递回去。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:336
#, fuzzy
msgid ""
"Whenever an edit is made to a ruleset, the new rules must be loaded so they "
"can be used:"
msgstr "每当对规则集进行编辑，新的规则必须被加载以便使用："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:340
#: documentation/content/en/books/handbook/firewalls/_index.adoc:558
#, no-wrap
msgid "# pfctl -f /etc/pf.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:344
#, fuzzy
msgid ""
"If there are no syntax errors, `pfctl` will not output any messages during "
"the rule load.  Rules can also be tested before attempting to load them:"
msgstr "如果没有语法错误，`pfctl`在加载规则期间不会输出任何消息。在尝试加载规则之前，也可以对规则进行测试："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:348
#, no-wrap
msgid "# pfctl -nf /etc/pf.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:353
#, fuzzy
msgid ""
"Including `-n` causes the rules to be interpreted only, but not loaded.  "
"This provides an opportunity to correct any errors.  At all times, the last "
"valid ruleset loaded will be enforced until either PF is disabled or a new "
"ruleset is loaded."
msgstr ""
"包括 `-n` 会导致规则只被解释而不被加载。这样可以纠正任何错误。在任何时候，最后一套有效的规则集将会被强制执行，直到 PF "
"被禁用或加载了新的规则集。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:358
#, fuzzy
msgid ""
"Adding `-v` to a `pfctl` ruleset verify or load will display the fully "
"parsed rules exactly the way they will be loaded.  This is extremely useful "
"when debugging rules."
msgstr "将`-v`添加到 `pfctl` 路由验证或加载指令中，将以与加载后的规则完全相同的方式显示已解析的规则。这在调试规则时非常有用。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:361
#, fuzzy, no-wrap
msgid "A Simple Gateway with NAT"
msgstr "一种简易的带有网络地址转换（NAT）的网关"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:366
#, fuzzy
msgid ""
"This section demonstrates how to configure a FreeBSD system running PF to "
"act as a gateway for at least one other machine.  The gateway needs at least"
" two network interfaces, each connected to a separate network.  In this "
"example, [.filename]#xl0# is connected to the Internet and [.filename]#xl1# "
"is connected to the internal network."
msgstr ""
"本节演示了如何配置运行PF的FreeBSD系统，将其作为至少一个其他机器的网关。网关需要至少两个网络接口，每个接口连接到不同的网络。在这个例子中，.filename#xl0#连接到互联网，.filename#xl1#连接到内部网络。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:369
#, fuzzy
msgid ""
"First, enable the gateway to let the machine forward the network traffic it "
"receives on one interface to another interface.  This sysctl setting will "
"forward IPv4 packets:"
msgstr "首先，启用网关，使得机器可以将其收到的网络流量从一个接口转发到另一个接口。这个 sysctl 设置将转发 IPv4 数据包："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:373
#, no-wrap
msgid "# sysctl net.inet.ip.forwarding=1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:376
#, fuzzy
msgid "To forward IPv6 traffic, use:"
msgstr "要转发IPv6流量，使用以下命令："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:380
#, no-wrap
msgid "# sysctl net.inet6.ip6.forwarding=1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:383
#, fuzzy
msgid ""
"To enable these settings at system boot, use man:sysrc[8] to add them to "
"[.filename]#/etc/rc.conf#:"
msgstr "要在系统启动时启用这些设置，请使用 man:sysrc[8] 将它们添加到 [.filename]#/etc/rc.conf# 文件中。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:388
#, no-wrap
msgid ""
"# sysrc gateway_enable=yes\n"
"# sysrc ipv6_gateway_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:391
#, fuzzy
msgid "Verify with `ifconfig` that both of the interfaces are up and running."
msgstr "使用 `ifconfig` 命令验证两个接口是否已启用并正在运行。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:394
#, fuzzy
msgid ""
"Next, create the PF rules to allow the gateway to pass traffic.  While the "
"following rule allows stateful traffic from hosts of the internal network to"
" pass to the gateway, the `to` keyword does not guarantee passage all the "
"way from source to destination:"
msgstr ""
"接下来，创建 PF 规则以允许网关经过流量。尽管下面的规则允许来自内部网络主机的有状态流量通过网关，但 `to` 关键字并不能保证源到目的地的完全通行:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:398
#, no-wrap
msgid "pass in on xl1 from xl1:network to xl0:network port $ports keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:402
#, fuzzy
msgid ""
"That rule only lets the traffic pass in to the gateway on the internal "
"interface.  To let the packets go further, a matching rule is needed:"
msgstr "那个规则只允许流量通过内部接口访问网关。为了让数据包继续传递，需要一个匹配的规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:406
#, no-wrap
msgid "pass out on xl0 from xl1:network to xl0:network port $ports keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:412
#, fuzzy
msgid ""
"While these two rules will work, rules this specific are rarely needed.  For"
" a busy network admin, a readable ruleset is a safer ruleset.  The remainder"
" of this section demonstrates how to keep the rules as simple as possible "
"for readability.  For example, those two rules could be replaced with one "
"rule:"
msgstr ""
"虽然这两条规则可以起作用，但这么具体的规则很少需要。对于忙碌的网络管理员来说，可读性强的规则集更加安全。本节的剩余部分演示了如何尽可能简化规则以提高可读性。例如，可以用一条规则取代这两条规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:416
#, no-wrap
msgid "pass from xl1:network to any port $ports keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:421
#, fuzzy
msgid ""
"The `interface:network` notation can be replaced with a macro to make the "
"ruleset even more readable.  For example, a `$localnet` macro could be "
"defined as the network directly attached to the internal interface "
"(`$xl1:network`).  Alternatively, the definition of `$localnet` could be "
"changed to an _IP address/netmask_ notation to denote a network, such as "
"`192.168.100.1/24` for a subnet of private addresses."
msgstr ""
"`interface:network` 表示可以用宏来替换以使规则集更易读。例如，可以定义一个 `$localnet` "
"宏，表示直接连接到内部接口的网络（`$xl1:network`）。另外，也可以将 `$localnet` 的定义更改为 _IP 地址/子网掩码_ "
"表示网络，例如 `192.168.100.1/24` 表示私有地址的子网。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:424
#, fuzzy
msgid ""
"If required, `$localnet` could even be defined as a list of networks.  "
"Whatever the specific needs, a sensible `$localnet` definition could be used"
" in a typical pass rule as follows:"
msgstr ""
"如果需要，`$localnet`甚至可以定义为一个网络列表。无论具体需求如何，一个合理的`$localnet`定义可以在典型的通过规则中使用，如下所示："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:428
#, no-wrap
msgid "pass from $localnet to any port $ports keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:432
#, fuzzy
msgid ""
"The following sample ruleset allows all traffic initiated by machines on the"
" internal network.  It first defines two macros to represent the external "
"and internal 3COM interfaces of the gateway."
msgstr "以下示例规则集允许内部网络中的机器发起的所有流量。它首先定义了两个宏，代表网关的外部和内部3COM接口。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:437
#, fuzzy
msgid ""
"For dialup users, the external interface will use [.filename]#tun0#.  For an"
" ADSL connection, specifically those using PPP over Ethernet (PPPoE), the "
"correct external interface is [.filename]#tun0#, not the physical Ethernet "
"interface."
msgstr ""
"对于拨号用户，外部接口将使用`.filename#tun0#`。对于ADSL连接，特别是使用以太网上的PPP (PPPoE) "
"连接的情况，正确的外部接口是`.filename#tun0#`，而不是物理以太网接口。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:448
#, no-wrap
msgid ""
"ext_if = \"xl0\"\t# macro for external interface - use tun0 for PPPoE\n"
"int_if = \"xl1\"\t# macro for internal interface\n"
"localnet = $int_if:network\n"
"# ext_if IP address could be dynamic, hence ($ext_if)\n"
"nat on $ext_if from $localnet to any -> ($ext_if)\n"
"block all\n"
"pass from { lo0, $localnet } to any keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:453
#, fuzzy
msgid ""
"This ruleset introduces the `nat` rule which is used to handle the network "
"address translation from the non-routable addresses inside the internal "
"network to the IP address assigned to the external interface.  The "
"parentheses surrounding the last part of the nat rule `($ext_if)` is "
"included when the IP address of the external interface is dynamically "
"assigned.  It ensures that network traffic runs without serious "
"interruptions even if the external IP address changes."
msgstr ""
"此规则集引入了`nat`规则，用于处理内部网络中的非路由地址到分配给外部接口的IP地址的网络地址转换。在`nat`规则的最后部分周围的括号`($ext_if)`会在外部接口的IP地址是动态分配的情况下包含进来。它确保即使外部IP地址发生变化，网络流量也能正常运行，不会产生严重的中断。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:456
#, fuzzy
msgid ""
"Note that this ruleset probably allows more traffic to pass out of the "
"network than is needed.  One reasonable setup could create this macro:"
msgstr "请注意，这个规则集可能允许比需要的更多的流量离开网络。一个合理的设置可以创建这个宏："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:461
#, no-wrap
msgid ""
"client_out = \"{ ftp-data, ftp, ssh, domain, pop3, auth, nntp, http, \\\n"
"    https, cvspserver, 2628, 5999, 8000, 8080 }\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:464
#, fuzzy
msgid "to use in the main pass rule:"
msgstr "用于主要通行规则的使用方式："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:469
#, no-wrap
msgid ""
"pass inet proto tcp from $localnet to any port $client_out \\\n"
"    flags S/SA keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:473
#, fuzzy
msgid ""
"A few other pass rules may be needed.  This one enables SSH on the external "
"interface:"
msgstr "可能还需要一些其他的通行规则。下面的规则允许在外部接口上使用SSH："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:477
#, no-wrap
msgid "pass in inet proto tcp to $ext_if port ssh\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:480
#, fuzzy
msgid ""
"This macro definition and rule allows DNS and NTP for internal clients:"
msgstr "这个宏定义和规则允许内部客户端使用 DNS 和 NTP。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:485
#, no-wrap
msgid ""
"udp_services = \"{ domain, ntp }\"\n"
"pass quick inet proto { tcp, udp } to any port $udp_services keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:493
#, fuzzy
msgid ""
"Note the `quick` keyword in this rule.  Since the ruleset consists of "
"several rules, it is important to understand the relationships between the "
"rules in a ruleset.  Rules are evaluated from top to bottom, in the sequence"
" they are written.  For each packet or connection evaluated by PF, _the last"
" matching rule_ in the ruleset is the one which is applied.  However, when a"
" packet matches a rule which contains the `quick` keyword, the rule "
"processing stops and the packet is treated according to that rule.  This is "
"very useful when an exception to the general rules is needed."
msgstr ""
"请注意此规则中的 `quick` "
"关键字。由于规则集包含多个规则，因此了解规则集中规则之间的关系非常重要。规则是按照从上到下的顺序进行评估的，按照它们的编写顺序。对于每个经过 PF "
"评估的数据包或连接，规则集中 _最后匹配的规则_ 将被应用。然而，当一个数据包匹配包含 `quick` "
"关键字的规则时，规则处理停止，并根据该规则对数据包进行处理。当需要对一般规则做出例外情况时，这非常有用。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:495
#, fuzzy, no-wrap
msgid "Creating an FTP Proxy"
msgstr "创建一个FTP代理"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:500
#, fuzzy
msgid ""
"Configuring working FTP rules can be problematic due to the nature of the "
"FTP protocol.  FTP pre-dates firewalls by several decades and is insecure in"
" its design.  The most common points against using FTP include:"
msgstr ""
"配置工作的FTP规则可能会存在问题，这是由于FTP协议的特性所致。 FTP比防火墙早数十年，并且在设计上存在不安全性。使用FTP的最常见的理由包括："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:502
#, fuzzy
msgid "Passwords are transferred in the clear."
msgstr "密码以明文形式传输。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:503
#, fuzzy
msgid ""
"The protocol demands the use of at least two TCP connections (control and "
"data) on separate ports."
msgstr "该协议要求在不同的端口上使用至少两个TCP连接（控制和数据连接）。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:504
#, fuzzy
msgid ""
"When a session is established, data is communicated using randomly selected "
"ports."
msgstr "当建立会话时，数据使用随机选择的端口进行通信。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:507
#, fuzzy
msgid ""
"All of these points present security challenges, even before considering any"
" potential security weaknesses in client or server software.  More secure "
"alternatives for file transfer exist, such as man:sftp[1] or man:scp[1], "
"which both feature authentication and data transfer over encrypted "
"connections."
msgstr ""
"在考虑客户端或服务器软件中的任何潜在安全弱点之前，所有这些要点都带来了安全挑战。存在更安全的文件传输替代方案，例如 man:sftp[1] 或 "
"man:scp[1]，它们都提供身份验证和数据传输加密连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:510
#, fuzzy
msgid ""
"For those situations when FTP is required, PF provides redirection of FTP "
"traffic to a small proxy program called man:ftp-proxy[8], which is included "
"in the base system of FreeBSD.  The role of the proxy is to dynamically "
"insert and delete rules in the ruleset, using a set of anchors, to correctly"
" handle FTP traffic."
msgstr ""
"在需要使用FTP的情况下，PF提供了将FTP流量重定向到一个名为man:ftp-"
"proxy[8]的小型代理程序的功能。这个代理程序包含在FreeBSD的基本系统中。代理的作用是使用一组锚点在规则集中动态插入和删除规则，以正确处理FTP流量。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:512
#, fuzzy
msgid "To enable the FTP proxy, add this line to [.filename]#/etc/rc.conf#:"
msgstr "要启用FTP代理，请将以下行添加到[/etc/rc.conf]文档中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:516
#, no-wrap
msgid "ftpproxy_enable=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:519
#, fuzzy
msgid "Then start the proxy by running:"
msgstr "然后通过运行以下命令来启动代理："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:523
#, no-wrap
msgid "# service ftp-proxy start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:527
#, fuzzy
msgid ""
"For a basic configuration, three elements need to be added to "
"[.filename]#/etc/pf.conf#.  First, the anchors which the proxy will use to "
"insert the rules it generates for the FTP sessions:"
msgstr "对于基本配置，需要向[/etc/pf.conf]文件添加三个元素。首先，是代理使用的锚点，用于插入生成的FTP会话规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:532
#, no-wrap
msgid ""
"nat-anchor \"ftp-proxy/*\"\n"
"rdr-anchor \"ftp-proxy/*\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:535
#, fuzzy
msgid "Second, a pass rule is needed to allow FTP traffic in to the proxy."
msgstr "其次，需要添加一个通过规则，允许将FTP流量传入代理服务器中。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:538
#, fuzzy
msgid ""
"Third, redirection and NAT rules need to be defined before the filtering "
"rules.  Insert this `rdr` rule immediately after the `nat` rule:"
msgstr "第三，在过滤规则之前需要定义重定向和NAT规则。在`nat`规则之后立即插入此`rdr`规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:542
#, no-wrap
msgid ""
"rdr pass on $int_if proto tcp from any to any port ftp -> 127.0.0.1 port "
"8021\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:545
#, fuzzy
msgid "Finally, allow the redirected traffic to pass:"
msgstr "最后，允许重定向的流量通过："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:549
#, no-wrap
msgid "pass out proto tcp from $proxy to any port ftp\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:552
#, fuzzy
msgid "where `$proxy` expands to the address the proxy daemon is bound to."
msgstr "其中`$proxy`会扩展为代理守护进程所绑定的地址。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:554
#, fuzzy
msgid ""
"Save [.filename]#/etc/pf.conf#, load the new rules, and verify from a client"
" that FTP connections are working:"
msgstr "保存 `/etc/pf.conf` 文件，加载新的规则，并从客户端验证 FTP 连接是否正常工作："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:564
#, fuzzy
msgid ""
"This example covers a basic setup where the clients in the local network "
"need to contact FTP servers elsewhere.  This basic configuration should work"
" well with most combinations of FTP clients and servers.  As shown in "
"man:ftp-proxy[8], the proxy's behavior can be changed in various ways by "
"adding options to the `ftpproxy_flags=` line.  Some clients or servers may "
"have specific quirks that must be compensated for in the configuration, or "
"there may be a need to integrate the proxy in specific ways such as "
"assigning FTP traffic to a specific queue."
msgstr ""
"这个例子涵盖了一个基本的设置，其中本地网络中的客户端需要联系其他地方的FTP服务器。这个基本配置应该可以很好地配合大多数组合的FTP客户端和服务器使用。如man:ftp-"
"proxy[8]所示，可以通过向`ftpproxy_flags=`行添加选项来改变代理的行为方式。一些客户端或服务器可能具有特定的怪癖，在配置中必须进行补偿，或者可能需要以特定的方式集成代理，例如将FTP流量分配给特定的队列。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:566
#, fuzzy
msgid ""
"For ways to run an FTP server protected by PF and man:ftp-proxy[8], "
"configure a separate `ftp-proxy` in reverse mode, using `-R`, on a separate "
"port with its own redirecting pass rule."
msgstr ""
"要通过 PF 和 man:ftp-proxy[8] 来运行一个受保护的 FTP 服务器的方式，请配置一个单独的 `ftp-proxy` "
"以反向模式运行，并且使用 `-R` 在一个独立的端口上，拥有自己的重定向透明代理规则。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:568
#, fuzzy, no-wrap
msgid "Managing ICMP"
msgstr ""
"管理 ICMP\n"
"\n"
"ICMP（Internet Control Message Protocol）是一种用于在网络中传送控制消息的协议。它可以用于错误报告、网络探测和诊断以及某些网络服务的管理。\n"
"\n"
"管理 ICMP 涉及对 ICMP 流量的监控、配置和控制。管理员可以使用以下方法来管理 ICMP：\n"
"\n"
"1. 监控 ICMP 流量：监控网络中的 ICMP 流量可以帮助管理员了解网络的健康状况。可以使用网络管理工具来捕获和分析 ICMP 报文，以便及时发现并解决问题。\n"
"\n"
"2. 配置 ICMP 参数：管理员可以根据需要配置 ICMP 参数。这包括启用或禁用特定类型的 ICMP 报文，设置 ICMP 错误报告的优先级和间隔以及调整 ICMP 报文的大小限制。\n"
"\n"
"3. 控制 ICMP 流量：管理员可以使用防火墙等安全工具来控制 ICMP 流量。这可以通过禁止或限制来自特定主机或网络的 ICMP 报文来防止潜在的攻击或滥用。\n"
"\n"
"管理 ICMP 对于确保网络的可靠性和安全性至关重要。通过监控、配置和控制 ICMP 流量，管理员可以更好地管理和保护网络资源。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:571
#, fuzzy
msgid ""
"Many of the tools used for debugging or troubleshooting a TCP/IP network "
"rely on the Internet Control Message Protocol (ICMP), which was designed "
"specifically with debugging in mind."
msgstr "许多用于调试或故障排除TCP/IP网络的工具依赖于Internet控制消息协议（ICMP），该协议专门设计用于调试。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:574
#, fuzzy
msgid ""
"The ICMP protocol sends and receives _control messages_ between hosts and "
"gateways, mainly to provide feedback to a sender about any unusual or "
"difficult conditions enroute to the target host.  Routers use ICMP to "
"negotiate packet sizes and other transmission parameters in a process often "
"referred to as _path MTU discovery_."
msgstr ""
"ICMP协议在主机和网关之间发送和接收“控制消息”，主要是为了向发送方提供有关传输到目标主机的任何异常或困难情况的反馈。路由器使用ICMP来协商数据包大小和其他传输参数，这个过程通常被称为“路径MTU发现”。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:578
#, fuzzy
msgid ""
"From a firewall perspective, some ICMP control messages are vulnerable to "
"known attack vectors.  Also, letting all diagnostic traffic pass "
"unconditionally makes debugging easier, but it also makes it easier for "
"others to extract information about the network.  For these reasons, the "
"following rule may not be optimal:"
msgstr ""
"从防火墙的角度来看，某些 ICMP "
"控制消息易受已知的攻击手段的影响。而且，让所有的诊断流量无条件通过会使调试变得更容易，但也会让他人更容易提取有关网络的信息。基于这些原因，以下规则可能不是最优的："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:582
#, no-wrap
msgid "pass inet proto icmp from any to any\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:585
#, fuzzy
msgid ""
"One solution is to let all ICMP traffic from the local network through while"
" stopping all probes from outside the network:"
msgstr "一种解决方案是允许内部网络的所有ICMP流量通过，同时阻止来自网络外部的所有探测："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:590
#, no-wrap
msgid ""
"pass inet proto icmp from $localnet to any keep state\n"
"pass inet proto icmp from any to $ext_if keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:595
#, fuzzy
msgid ""
"Additional options are available which demonstrate some of PF's flexibility."
"  For example, rather than allowing all ICMP messages, one can specify the "
"messages used by man:ping[8] and man:traceroute[8].  Start by defining a "
"macro for that type of message:"
msgstr ""
"有一些额外的选项可展示PF的灵活性。例如，不必允许所有的ICMP消息，可以指定由man:ping[8]和man:traceroute[8]使用的消息。首先，为该类型的消息定义一个宏："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:599
#, no-wrap
msgid "icmp_types = \"echoreq\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:602
#, fuzzy
msgid "and a rule which uses the macro:"
msgstr "和一个使用宏的规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:606
#: documentation/content/en/books/handbook/firewalls/_index.adoc:646
#, no-wrap
msgid "pass inet proto icmp all icmp-type $icmp_types keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:611
#, fuzzy
msgid ""
"If other types of ICMP packets are needed, expand `icmp_types` to a list of "
"those packet types.  Type `more /usr/src/sbin/pfctl/pfctl_parser.c` to see "
"the list of ICMP message types supported by PF.  Refer to "
"http://www.iana.org/assignments/icmp-parameters/icmp-"
"parameters.xhtml[http://www.iana.org/assignments/icmp-parameters/icmp-"
"parameters.xhtml] for an explanation of each message type."
msgstr ""
"如果需要其他类型的 ICMP 数据包，请将 `icmp_types` 扩展为该数据包类型的列表。键入 `more "
"/usr/src/sbin/pfctl/pfctl_parser.c` 查看 PF 支持的 ICMP 消息类型列表。请参考 "
"[http://www.iana.org/assignments/icmp-parameters/icmp-"
"parameters.xhtml](http://www.iana.org/assignments/icmp-parameters/icmp-"
"parameters.xhtml) 获取关于每种消息类型的说明。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:613
#, fuzzy
msgid ""
"Since Unix `traceroute` uses UDP by default, another rule is needed to allow"
" Unix `traceroute`:"
msgstr "由于Unix中的 `traceroute` 默认使用UDP，因此需要添加另一条规则来允许Unix的 `traceroute` ："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:618
#, no-wrap
msgid ""
"# allow out the default range for traceroute(8):\n"
"pass out on $ext_if inet proto udp from any to any port 33433 >< 33626 keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:623
#, fuzzy
msgid ""
"Since `TRACERT.EXE` on Microsoft Windows systems uses ICMP echo request "
"messages, only the first rule is needed to allow network traces from those "
"systems.  Unix `traceroute` can be instructed to use other protocols as "
"well, and will use ICMP echo request messages if `-I` is used.  Check the "
"man:traceroute[8] man page for details."
msgstr ""
"由于Microsoft Windows系统上的`TRACERT.EXE`使用ICMP "
"echo请求消息，因此只需要第一条规则来允许来自该系统的网络跟踪。Unix的`traceroute`还可以指示使用其他协议，并且如果使用了`-I`选项，它将使用ICMP"
" echo请求消息。详细信息请参阅man:traceroute[8]手册页。"

#. type: Title =====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:625
#, fuzzy, no-wrap
msgid "Path MTU Discovery"
msgstr "路径MTU发现"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:630
#, fuzzy
msgid ""
"Internet protocols are designed to be device independent, and one "
"consequence of device independence is that the optimal packet size for a "
"given connection cannot always be predicted reliably.  The main constraint "
"on packet size is the _Maximum Transmission Unit_ (MTU) which sets the upper"
" limit on the packet size for an interface.  Type `ifconfig` to view the "
"MTUs for a system's network interfaces."
msgstr ""
"互联网协议被设计为与设备无关，设备无关性的一个结果是对于特定连接来说，无法始终可靠地预测最佳数据包大小。数据包大小的主要约束是最大传输单元（MTU），它为接口设置了数据包大小的上限。输入`ifconfig`命令查看系统网络接口的MTU值。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:635
#, fuzzy
msgid ""
"TCP/IP uses a process known as path MTU discovery to determine the right "
"packet size for a connection.  This process sends packets of varying sizes "
"with the \"Do not fragment\" flag set, expecting an ICMP return packet of "
"\"type 3, code 4\" when the upper limit has been reached.  Type 3 means "
"\"destination unreachable\", and code 4 is short for \"fragmentation needed,"
" but the do-not-fragment flag is set\".  To allow path MTU discovery in "
"order to support connections to other MTUs, add the `destination "
"unreachable` type to the `icmp_types` macro:"
msgstr ""
"TCP/IP使用一种称为路径MTU发现的过程来确定连接的正确数据包大小。该过程发送大小不同的数据包，并设置\"不分片\"标志，期望在达到上限时收到一个ICMP的返回数据包，其类型为\"3\"(目标不可达)，代码为\"4\"(需要分片，但设置了不分片标志)。为了支持到其他MTU的连接，可以将\"目标不可达\"类型添加到\"icmp_types\"宏中，以允许路径MTU发现。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:639
#, no-wrap
msgid "icmp_types = \"{ echoreq, unreach }\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:642
#, fuzzy
msgid ""
"Since the pass rule already uses that macro, it does not need to be modified"
" to support the new ICMP type:"
msgstr "由于通行规则已经使用了该宏，它不需要修改以支持新的 ICMP 类型："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:650
#, fuzzy
msgid ""
"PF allows filtering on all variations of ICMP types and codes.  The list of "
"possible types and codes are documented in man:icmp[4] and man:icmp6[4]."
msgstr "PF允许过滤所有类型和代码的ICMP变体。 可能的类型和代码的列表已在 man:icmp[4] 和 man:icmp6[4] 中记录。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:652
#, fuzzy, no-wrap
msgid "Using Tables"
msgstr ""
"使用表格\n"
"\n"
"在asciidoc中，可以使用表格来以表格形式展示数据。表格由多个行和列组成，每个单元格可以包含文本和其他格式化内容。\n"
"\n"
"以下是一个简单的表格示例：\n"
"\n"
"|===           // 开始一个表格\n"
"|列1           // 表头\n"
"|列2\n"
"|列3\n"
"|行1           // 第一行的数据\n"
"|行2\n"
"|行3\n"
"|===           // 结束表格\n"
"\n"
"上面的示例中，表格有三列和三行。第一行是表头，每个单元格包含列标题。接下来的三行是数据行，每个单元格包含相应的数据。\n"
"\n"
"可以使用各种表格属性和选项来自定义表格的外观和行为，例如设置表格宽度、对齐表头和数据等。\n"
"\n"
"使用表格可以更容易地组织和呈现复杂的数据，在编写技术文档以及进行数据分析和比较时特别有用。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:657
#, fuzzy
msgid ""
"Some types of data are relevant to filtering and redirection at a given "
"time, but their definition is too long to be included in the ruleset file.  "
"PF supports the use of tables, which are defined lists that can be "
"manipulated without needing to reload the entire ruleset, and which can "
"provide fast lookups.  Table names are always enclosed within `< >`, like "
"this:"
msgstr ""
"在某个特定的时间点，一些数据类型对于过滤和重定向是相关的，但它们的定义太长了，无法包含在规则集文件中。PF支持使用表格，表格是定义的列表，可以在不重新加载整个规则集的情况下进行操作，并且可以提供快速查找。表格名称始终用`<"
" >`括起来，例如："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:661
#, no-wrap
msgid "table <clients> { 192.168.2.0/24, !192.168.2.5 }\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:665
#, fuzzy
msgid ""
"In this example, the `192.168.2.0/24` network is part of the table, except "
"for the address `192.168.2.5`, which is excluded using the `!` operator.  It"
" is also possible to load tables from files where each item is on a separate"
" line, as seen in this example [.filename]#/etc/clients#:"
msgstr ""
"在这个例子中，`192.168.2.0/24` 网络是表中的一部分，除了地址 `192.168.2.5`，通过使用 `!` "
"操作符进行排除。还可以从文件中加载表，其中每个项目都在单独的行中，就像这个例子中看到的 [.filename]#/etc/clients#。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:670
#, no-wrap
msgid ""
"192.168.2.0/24\n"
"!192.168.2.5\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:673
#, fuzzy
msgid "To refer to the file, define the table like this:"
msgstr "要引用该文件，请按照以下方式定义表格："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:677
#, no-wrap
msgid "table <clients> persist file \"/etc/clients\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:680
#, fuzzy
msgid "Once the table is defined, it can be referenced by a rule:"
msgstr "一旦表格被定义，就可以通过规则引用它："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:684
#, no-wrap
msgid ""
"pass inet proto tcp from <clients> to any port $client_out flags S/SA keep "
"state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:688
#, fuzzy
msgid ""
"A table's contents can be manipulated live, using `pfctl`.  This example "
"adds another network to the table:"
msgstr "可以使用 `pfctl` 实时操作表的内容。下面的例子将另一个网络添加到表中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:692
#, no-wrap
msgid "# pfctl -t clients -T add 192.168.1.0/16\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:698
#, fuzzy
msgid ""
"Note that any changes made this way will take affect now, making them ideal "
"for testing, but will not survive a power failure or reboot.  To make the "
"changes permanent, modify the definition of the table in the ruleset or edit"
" the file that the table refers to.  One can maintain the on-disk copy of "
"the table using a man:cron[8] job which dumps the table's contents to disk "
"at regular intervals, using a command such as `pfctl -t clients -T show "
">/etc/clients`.  Alternatively, [.filename]#/etc/clients# can be updated "
"with the in-memory table contents:"
msgstr ""
"请注意，通过这种方式进行的更改将立即生效，非常适合测试，但在断电或重启后将不会保留。要使更改永久生效，可以修改规则集中表的定义或编辑表所指向的文件。可以使用"
" man:cron[8] 任务来保持表的磁盘副本，并定期将表的内容转储到磁盘上，使用类似 `pfctl -t clients -T show "
">/etc/clients` 的命令。另外，也可以使用 [.filename]#/etc/clients# 更新内存表的内容："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:702
#, no-wrap
msgid "# pfctl -t clients -T replace -f /etc/clients\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:705
#, fuzzy, no-wrap
msgid "Using Overload Tables to Protect SSH"
msgstr ""
"使用过载表来保护SSH\n"
"\n"
"过载表是一种用于保护SSH的技术。它通过监视和控制网络连接的数量和频率来防止恶意行为。当网络连接的数量超过预设的阈值或频率过高时，过载表会自动切断这些连接，从而保护SSH服务的正常运行。\n"
"\n"
"使用过载表可以有效地防止诸如暴力破解、拒绝服务和其他网络攻击。它可以识别并阻止异常活动，提供对SSH服务器的保护和安全性。\n"
"\n"
"过载表的配置可以根据特定的需求进行调整。管理员可以设置连接数量阈值、频率限制和其他参数，以满足网络环境的要求。\n"
"\n"
"总之，使用过载表可以加强对SSH的保护，提高系统的安全性和稳定性。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:708
#, fuzzy
msgid ""
"Those who run SSH on an external interface have probably seen something like"
" this in the authentication logs:"
msgstr "那些在外部接口上运行SSH的人可能在身份验证日志中看到类似于以下内容的内容："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:717
#, no-wrap
msgid ""
"Sep 26 03:12:34 skapet sshd[25771]: Failed password for root from 200.72.41.31 port 40992 ssh2\n"
"Sep 26 03:12:34 skapet sshd[5279]: Failed password for root from 200.72.41.31 port 40992 ssh2\n"
"Sep 26 03:12:35 skapet sshd[5279]: Received disconnect from 200.72.41.31: 11: Bye Bye\n"
"Sep 26 03:12:44 skapet sshd[29635]: Invalid user admin from 200.72.41.31\n"
"Sep 26 03:12:44 skapet sshd[24703]: input_userauth_request: invalid user admin\n"
"Sep 26 03:12:44 skapet sshd[24703]: Failed password for invalid user admin from 200.72.41.31 port 41484 ssh2\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:720
#, fuzzy
msgid ""
"This is indicative of a brute force attack where somebody or some program is"
" trying to discover the user name and password which will let them into the "
"system."
msgstr "这表明有人或某个程序正在进行暴力攻击，尝试发现能够使其进入系统的用户名和密码。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:725
#, fuzzy
msgid ""
"If external SSH access is needed for legitimate users, changing the default "
"port used by SSH can offer some protection.  However, PF provides a more "
"elegant solution.  Pass rules can contain limits on what connecting hosts "
"can do and violators can be banished to a table of addresses which are "
"denied some or all access.  It is even possible to drop all existing "
"connections from machines which overreach the limits."
msgstr ""
"如果合法用户需要外部SSH访问，则更改SSH使用的默认端口可以提供一定的保护。但是，PF提供了一个更优雅的解决方案。 "
"通过规则可以限制连接主机可以做什么，并且违规者可以被放逐到被拒绝一些或全部访问的地址表中。 甚至可以删除超出限制的机器的所有现有连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:727
#, fuzzy
msgid ""
"To configure this, create this table in the tables section of the ruleset:"
msgstr "为了进行配置，请在规则集的表格部分创建这个表格："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:731
#, no-wrap
msgid "table <bruteforce> persist\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:734
#, fuzzy
msgid ""
"Then, somewhere early in the ruleset, add rules to block brute access while "
"allowing legitimate access:"
msgstr "然后，在规则集的早期位置添加规则，以阻止暴力访问，同时允许合法访问："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:742
#, no-wrap
msgid ""
"block quick from <bruteforce>\n"
"pass inet proto tcp from any to $localnet port $tcp_services \\\n"
"    flags S/SA keep state \\\n"
"    (max-src-conn 100, max-src-conn-rate 15/5, \\\n"
"    overload <bruteforce> flush global)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:746
#, fuzzy
msgid ""
"The part in parentheses defines the limits and the numbers should be changed"
" to meet local requirements.  It can be read as follows:"
msgstr "括号中的部分定义了限制条件，数字应根据当地要求进行更改。它的含义如下所示："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:748
#, fuzzy
msgid ""
"`max-src-conn` is the number of simultaneous connections allowed from one "
"host."
msgstr "`max-src-conn` 是允许来自一个主机的同时连接数。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:750
#, fuzzy
msgid ""
"`max-src-conn-rate` is the rate of new connections allowed from any single "
"host (_15_) per number of seconds (_5_)."
msgstr "`max-src-conn-rate` 是每个单个主机（_15_）在每个指定时间间隔（_5_）内允许的新连接速率。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:753
#, fuzzy
msgid ""
"`overload <bruteforce>` means that any host which exceeds these limits gets "
"its address added to the `bruteforce` table.  The ruleset blocks all traffic"
" from addresses in the `bruteforce` table."
msgstr ""
"`overload <bruteforce>` 表示超出这些限制的主机将把其地址添加到 `bruteforce` 表中。规则集将阻止来自 "
"`bruteforce` 表中地址的所有流量。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:755
#, fuzzy
msgid ""
"Finally, `flush global` says that when a host reaches the limit, that all "
"(`global`) of that host's connections will be terminated (`flush`)."
msgstr "最后，`flush global` 表示当主机达到限制时，该主机的所有连接 (`global`) 将被终止 (`flush`)。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:759
#, fuzzy
msgid ""
"These rules will _not_ block slow bruteforcers, as described in "
"http://home.nuug.no/\\~peter/hailmary2013/[http://home.nuug.no/~peter/hailmary2013/]."
msgstr "这些规则将不会阻止慢速暴力破解，详见[http://home.nuug.no/~peter/hailmary2013/]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:763
#, fuzzy
msgid ""
"This example ruleset is intended mainly as an illustration.  For example, if"
" a generous number of connections in general are wanted, but the desire is "
"to be more restrictive when it comes to ssh, supplement the rule above with "
"something like the one below, early on in the rule set:"
msgstr "这个示例规则集主要作为说明使用。例如，如果需要大量的连接，但在 ssh 方面希望更加限制，可以在规则集开头补充以下类似的规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:770
#, no-wrap
msgid ""
"pass quick proto { tcp, udp } from any to any port ssh \\\n"
"    flags S/SA keep state \\\n"
"    (max-src-conn 15, max-src-conn-rate 5/3, \\\n"
"    overload <bruteforce> flush global)\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:775
#, fuzzy, no-wrap
msgid "*It May Not be Necessary to Block All Overloaders:* +\n"
msgstr ""
"*可能不需要阻止所有超载器：* +\n"
"\n"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:777
#, fuzzy
msgid ""
"It is worth noting that the overload mechanism is a general technique which "
"does not apply exclusively to SSH, and it is not always optimal to entirely "
"block all traffic from offenders."
msgstr "值得注意的是，过载机制是一种通用技术，不仅适用于SSH，而且并不总是最佳选择将所有来自违规者的流量完全阻止。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:779
#, fuzzy
msgid ""
"For example, an overload rule could be used to protect a mail service or a "
"web service, and the overload table could be used in a rule to assign "
"offenders to a queue with a minimal bandwidth allocation or to redirect to a"
" specific web page."
msgstr "例如，可以使用过载规则来保护邮件服务或网络服务，而过载表则可以在规则中用于将违规者分配到具有最小带宽分配的队列或重定向到特定的网页。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:783
#, fuzzy
msgid ""
"Over time, tables will be filled by overload rules and their size will grow "
"incrementally, taking up more memory.  Sometimes an IP address that is "
"blocked is a dynamically assigned one, which has since been assigned to a "
"host who has a legitimate reason to communicate with hosts in the local "
"network."
msgstr ""
"随着时间的推移，表格将被超载规则填充，它们的大小会逐渐增长，占用更多的内存。有时候被阻止的IP地址是一个动态分配的，后来被分配给了一个有合法理由与本地网络中的主机进行通信的主机。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:786
#, fuzzy
msgid ""
"For situations like these, pfctl provides the ability to expire table "
"entries.  For example, this command will remove `<bruteforce>` table entries"
" which have not been referenced for `86400` seconds:"
msgstr "针对这类情况，pfctl 提供了过期表项的功能。例如，以下命令将删除在`86400`秒内未被引用的`<bruteforce>`表项："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:790
#, no-wrap
msgid "# pfctl -t bruteforce -T expire 86400\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:793
#, fuzzy
msgid ""
"Similar functionality is provided by package:security/expiretable[], which "
"removes table entries which have not been accessed for a specified period of"
" time."
msgstr "类似的功能由包security/expiretable[]提供，该包删除在指定时间段内未被访问的表项。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:796
#, fuzzy
msgid ""
"Once installed, expiretable can be run to remove `<bruteforce>` table "
"entries older than a specified age.  This example removes all entries older "
"than 24 hours:"
msgstr ""
"安装完毕后，可以运行 expiretable 来删除 `<bruteforce>` 表中超过指定年龄的条目。这个例子会删除所有超过24小时的条目："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:800
#, no-wrap
msgid "/usr/local/sbin/expiretable -v -d -t 24h bruteforce\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:803
#, fuzzy, no-wrap
msgid "Protecting Against SPAM"
msgstr ""
"防止垃圾邮件攻击\n"
"\n"
"Spam（垃圾邮件）攻击成为互联网用户普遍面对的问题。这些垃圾邮件包含广告、欺诈和恶意软件等内容，给用户带来了不便和威胁。为了保护用户的隐私和安全，采取一些措施来防止和减少垃圾邮件攻击变得至关重要。\n"
"\n"
"以下是一些保护措施，可以帮助用户抵御垃圾邮件攻击：\n"
"\n"
"1. 邮件过滤：使用有效的垃圾邮件过滤器来自动识别和过滤掉垃圾邮件。这些过滤器可以检测和阻止常见的垃圾邮件特征，如无效的发件人地址、奇怪的主题和大量的相似邮件。\n"
"\n"
"2. 强密码：使用强大的密码来保护邮件账户，以防止垃圾邮件发送者猜测和入侵你的账户。强密码应包括字母、数字和特殊字符，并避免使用常见的短语或个人信息。\n"
"\n"
"3. 慎重公开邮件地址：避免在公开场合（如论坛、社交媒体等）中公开你的邮件地址。垃圾邮件发送者通常会从这些公开渠道获取邮件地址，并将其添加到垃圾邮件列表中。\n"
"\n"
"4. 谨慎点击链接：避免点击垃圾邮件中的链接，因为这些链接可能引导你到欺诈网站或恶意软件下载页面。谨慎检查邮件中的链接，确保它们来自可信的发件人。\n"
"\n"
"5. 取消订阅：对于你不再感兴趣的订阅邮件，尽快取消订阅。这样可以避免你的邮箱被添加到垃圾邮件发送者的列表中。\n"
"\n"
"6. 更新软件和系统：确保你的电子邮件客户端、操作系统和安全软件处于最新状态。这样可以防止利用安全漏洞发送垃圾邮件的攻击。\n"
"\n"
"遵循这些保护措施可以帮助用户减少垃圾邮件攻击的风险，并提高网络使用体验。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:807
#, fuzzy
msgid ""
"Not to be confused with the spamd daemon which comes bundled with "
"spamassassin, package:mail/spamd[] can be configured with PF to provide an "
"outer defense against SPAM.  This spamd hooks into the PF configuration "
"using a set of redirections."
msgstr ""
"不要将其与与spamassassin捆绑在一起的spamd守护程序混淆，package:mail/spamd[]可以配置PF，以提供对垃圾邮件的外层防御。这个spamd通过一组重定向与PF配置进行连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:809
#, fuzzy
msgid ""
"Spammers tend to send a large number of messages, and SPAM is mainly sent "
"from a few spammer friendly networks and a large number of hijacked "
"machines, both of which are reported to _blocklists_ fairly quickly."
msgstr ""
"垃圾邮件发送者往往会发送大量的信息，而垃圾邮件主要来自于一些友好的垃圾邮件网络和被劫持的大量机器，这两者都被报告给\"封锁列表\"(_blocklists_)，封锁列表会很快地将其屏蔽。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:813
#, fuzzy
msgid ""
"When an SMTP connection from an address in a blocklist is received, spamd "
"presents its banner and immediately switches to a mode where it answers SMTP"
" traffic one byte at a time.  This technique, which is intended to waste as "
"much time as possible on the spammer's end, is called _tarpitting_.  The "
"specific implementation which uses one byte SMTP replies is often referred "
"to as _stuttering_."
msgstr ""
"当一个来自黑名单地址的 SMTP 连接被接收时，spamd 会呈现其横幅，并立即切换到一个以每个字节回答 SMTP "
"流量的模式。这种技术旨在尽可能地浪费垃圾邮件发送方的时间，被称为 \"tarpitting\"。使用每个字节 SMTP 回复的具体实现通常被称为 "
"\"stuttering\"。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:816
#, fuzzy
msgid ""
"This example demonstrates the basic procedure for setting up spamd with "
"automatically updated blocklists.  Refer to the man pages which are "
"installed with package:mail/spamd[] for more information."
msgstr "这个示例演示了使用自动更新的拦截列表设置 spamd 的基本过程。有关更多信息，请参阅安装包:mail/spamd[]中的 man 页面。"

#. type: Block title
#: documentation/content/en/books/handbook/firewalls/_index.adoc:819
#, fuzzy, no-wrap
msgid "Procedure: Configuring spamd"
msgstr ""
"过程：配置 spamd\n"
"\n"
"要配置 spamd，请按照以下步骤进行操作：\n"
"\n"
"1. 打开 spamd 配置文件（通常位于 /etc/spamassassin/spamd.conf）。\n"
"2. 修改配置文件中的参数以满足您的需求。以下是一些常见的配置参数：\n"
"   - `allowedips`：允许连接到 spamd 服务器的 IP 地址列表。\n"
"   - `port`：spamd 服务器监听的端口号。\n"
"   - `pidfile`：spamd 进程的 PID 文件路径。\n"
"   - `maxchildren`：接受的最大子进程数量。\n"
"   - `max-conn-per-child`：每个子进程的最大连接数。\n"
"   - `timeout`：连接超时时间。\n"
"3. 保存并关闭配置文件。\n"
"4. 启动或重启 spamd 服务。\n"
"5. 确认 spamd 服务已成功启动。\n"
"\n"
"现在，spamd 已经配置完成，并可以开始过滤垃圾邮件。您可以根据需要定期检查并调整 spamd 的配置。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:821
#, fuzzy
msgid ""
"Install the package:mail/spamd[] package or port. To use spamd's greylisting"
" features, man:fdescfs[5] must be mounted at [.filename]#/dev/fd#. Add the "
"following line to [.filename]#/etc/fstab#:"
msgstr ""
"安装 `package:mail/spamd[]` 包或端口。要使用 spamd 的 greylisting 功能，必须在 "
"[.filename]#/dev/fd# 下挂载 man:fdescfs[5]。将以下行添加到 [.filename]#/etc/fstab#："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:825
#, no-wrap
msgid " fdescfs /dev/fd fdescfs rw 0 0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:828
#, fuzzy
msgid "Then, mount the filesystem:"
msgstr "然后，挂载文件系统："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:832
#, no-wrap
msgid "#  mount fdescfs\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:835
#, fuzzy
msgid "Next, edit the PF ruleset to include:"
msgstr "接下来，编辑 PF 规则集以包含："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:844
#, no-wrap
msgid ""
"table <spamd> persist\n"
"table <spamd-white> persist\n"
"rdr pass on $ext_if inet proto tcp from <spamd> to \\\n"
"    { $ext_if, $localnet } port smtp -> 127.0.0.1 port 8025\n"
"rdr pass on $ext_if inet proto tcp from !<spamd-white> to \\\n"
"    { $ext_if, $localnet } port smtp -> 127.0.0.1 port 8025\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:848
#, fuzzy
msgid ""
"The two tables `<spamd>` and `<spamd-white>` are essential.  SMTP traffic "
"from an address listed in `<spamd>` but not in `<spamd-white>` is redirected"
" to the spamd daemon listening at port 8025."
msgstr ""
"两个表格 `<spamd>` 和 `<spamd-white>` 是必不可少的。地址列在 `<spamd>` 但未列在 `<spamd-white>` "
"中的 SMTP 流量将被重定向到监听端口 8025 的 spamd 守护程序。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:849
#, fuzzy
msgid ""
"The next step is to configure spamd in "
"[.filename]#/usr/local/etc/spamd.conf# and to add some [.filename]#rc.conf# "
"parameters."
msgstr "下一步是在`/usr/local/etc/spamd.conf`中配置`spamd`，并添加一些`rc.conf`参数。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:852
#, fuzzy
msgid ""
"The installation of package:mail/spamd[] includes a sample configuration "
"file ([.filename]#/usr/local/etc/spamd.conf.sample#) and a man page for "
"[.filename]#spamd.conf#.  Refer to these for additional configuration "
"options beyond those shown in this example."
msgstr ""
"包`mail/spamd`的安装包括一个示例配置文件（`/usr/local/etc/spamd.conf.sample`）和一个`spamd.conf`的手册页面。参考这些内容获取此示例之外的其他配置选项。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:854
#, fuzzy
msgid ""
"One of the first lines in the configuration file that does not begin with a "
"`+#+` comment sign contains the block which defines the `all` list, which "
"specifies the lists to use:"
msgstr "在配置文件中，第一行不以`+#+`注释符号开头的行包含了定义`all`列表的代码块，它指定了要使用的列表。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:859
#, no-wrap
msgid ""
"all:\\\n"
"    :traplist:allowlist:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:862
#, fuzzy
msgid ""
"This entry adds the desired blocklists, separated by colons (`:`).  To use "
"an allowlist to subtract addresses from a blocklist, add the name of the "
"allowlist _immediately_ after the name of that blocklist. For example: "
"`:blocklist:allowlist:`."
msgstr ""
"此条目通过冒号 (`:`) "
"分隔的方式添加所需的阻止列表。如果要使用一个白名单从阻止列表中剔除地址，请在该阻止列表的名称后面**立即**添加白名单的名称。例如：`:阻止列表:白名单:`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:864
#, fuzzy
msgid "This is followed by the specified blocklist's definition:"
msgstr "紧接着是指定的块列表的定义："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:872
#, no-wrap
msgid ""
"traplist:\\\n"
"    :black:\\\n"
"    :msg=\"SPAM. Your address %A has sent spam within the last 24 hours\":\\\n"
"    :method=http:\\\n"
"    :file=www.openbsd.org/spamd/traplist.gz\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:878
#, fuzzy
msgid ""
"where the first line is the name of the blocklist and the second line "
"specifies the list type.  The `msg` field contains the message to display to"
" blocklisted senders during the SMTP dialogue.  The `method` field specifies"
" how spamd-setup fetches the list data; supported methods are `http`, `ftp`,"
" from a `file` in a mounted file system, and via `exec` of an external "
"program.  Finally, the `file` field specifies the name of the file spamd "
"expects to receive."
msgstr ""
"第一行是屏蔽列表的名称，第二行指定了列表类型。`msg`字段包含了在SMTP对话期间显示给被屏蔽发件人的消息。`method`字段指定了spam采取的列表数据获取方式；支持的方法有`http`,"
" `ftp`,从挂载文件系统的`file`文件以及通过对外部程序进行`exec`操作。最后，`file`字段指定了spam期望接收的文件名称。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:880
#, fuzzy
msgid ""
"The definition of the specified allowlist is similar, but omits the `msg` "
"field since a message is not needed:"
msgstr "指定的白名单的定义类似，但省略了 `msg` 字段，因为不需要消息。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:887
#, no-wrap
msgid ""
"allowlist:\\\n"
"    :white:\\\n"
"    :method=file:\\\n"
"    :file=/var/mail/allowlist.txt\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:892
#, fuzzy, no-wrap
msgid "*Choose Data Sources with Care:* +\n"
msgstr "*谨慎选择数据源：*"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:895
#, fuzzy
msgid ""
"Using all the blocklists in the sample [.filename]#spamd.conf# will block "
"large blocks of the Internet.  Administrators need to edit the file to "
"create an optimal configuration which uses applicable data sources and, when"
" necessary, uses custom lists."
msgstr "使用样例中的所有屏蔽列表将会屏蔽大片的互联网。管理员需要编辑该文件创建一个最优的配置，使用适用的数据源，并在必要时使用自定义列表。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:899
#, fuzzy
msgid ""
"Next, add this entry to [.filename]#/etc/rc.conf#.  Additional flags are "
"described in the man page specified by the comment:"
msgstr "接下来，将此条目添加到 [.filename]#/etc/rc.conf# 文件中。附加的标志在由注释指定的 man 页面中有描述。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:903
#, no-wrap
msgid "spamd_flags=\"-v\" # use \"\" and see spamd-setup(8) for flags\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:907
#, fuzzy
msgid ""
"When finished, reload the ruleset, start spamd by typing `service obspamd "
"start`, and complete the configuration using `spamd-setup`.  Finally, create"
" a man:cron[8] job which calls `spamd-setup` to update the tables at "
"reasonable intervals."
msgstr ""
"完成后，重新加载规则集，通过输入 `service obspamd start` 启动 spamd，并使用 `spamd-setup` "
"完成配置。最后，创建一个 man:cron[8] 作业，在合理的时间间隔内调用 `spamd-setup` 更新表格。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:910
#, fuzzy
msgid ""
"On a typical gateway in front of a mail server, hosts will soon start "
"getting trapped within a few seconds to several minutes."
msgstr "在通常情况下，放置在邮件服务器前面的网关上，主机很快就会在几秒钟到几分钟内被捕获。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:914
#, fuzzy
msgid ""
"PF also supports _greylisting_, which temporarily rejects messages from "
"unknown hosts with _45n_ codes.  Messages from greylisted hosts which try "
"again within a reasonable time are let through.  Traffic from senders which "
"are set up to behave within the limits set by RFC 1123 and RFC 2821 are "
"immediately let through."
msgstr ""
"PF还支持\"greylisting\"（灰名单），它会暂时拒绝来自未知主机的带有\"45n\"代码的消息。在合理的时间内再次尝试连接的来自灰名单主机的消息将会通过。符合RFC"
" 1123和RFC 2821设置的发送者的流量将会立即通过。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:918
#, fuzzy
msgid ""
"More information about greylisting as a technique can be found at the "
"http://www.greylisting.org/[greylisting.org] web site.  The most amazing "
"thing about greylisting, apart from its simplicity, is that it still works."
"  Spammers and malware writers have been very slow to adapt to bypass this "
"technique."
msgstr ""
"有关作为一种技术的灰名单的更多信息可以在http://www.greylisting.org/[greylisting.org]网站找到。除了它的简单性之外，最令人惊讶的是，它仍然有效。垃圾邮件和恶意软件的编写者对绕过这种技术的适应非常缓慢。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:920
#, fuzzy
msgid "The basic procedure for configuring greylisting is as follows:"
msgstr "配置灰名单的基本步骤如下："

#. type: Block title
#: documentation/content/en/books/handbook/firewalls/_index.adoc:922
#, fuzzy, no-wrap
msgid "Procedure: Configuring Greylisting"
msgstr ""
"过程：配置灰名单\n"
"\n"
"步骤一：安装和配置灰名单程序\n"
"1. 安装灰名单程序（如Postgrey或milter-greylist）。\n"
"2. 配置灰名单程序，包括指定监听接口和端口。\n"
"\n"
"步骤二：设置邮件服务器\n"
"1. 配置邮件服务器，将灰名单程序设置为邮件服务的过滤组件。\n"
"2. 设置灰名单的超时时间，即多长时间内未收到客户端重试请求将被认为是临时拒绝。\n"
"\n"
"步骤三：监控和调整灰名单配置\n"
"1. 监控灰名单的运行日志，查看临时拒绝的邮件。\n"
"2. 根据需求调整灰名单配置，包括白名单、黑名单和超时时间等。\n"
"\n"
"步骤四：测试和验证\n"
"1. 发送测试邮件到自己的邮件服务器，并确认是否经过灰名单的处理。\n"
"2. 根据需要进行进一步的调整和测试。\n"
"\n"
"注意事项：\n"
"- 灰名单不适用于所有情况，建议在使用之前进行充分的评估和测试。\n"
"- 灰名单可以有效降低垃圾邮件和恶意软件的传播，但也可能会导致某些合法邮件被临时拒绝。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:924
#, fuzzy
msgid ""
"Make sure that man:fdescfs[5] is mounted as described in Step 1 of the "
"previous Procedure."
msgstr "确保 man:fdescfs[5] 挂载如前述步骤1所述。"

#. type: delimited block * 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:925
#, fuzzy
msgid ""
"To run spamd in greylisting mode, add this line to "
"[.filename]#/etc/rc.conf#:"
msgstr "要以灰名单模式运行spamd，将以下行添加到[/etc/rc.conf]文件中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:929
#, no-wrap
msgid "spamd_grey=\"YES\"  # use spamd greylisting if YES\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:932
#, fuzzy
msgid ""
"Refer to the spamd man page for descriptions of additional related "
"parameters."
msgstr "请参考 `spamd` 的手册页，了解其他相关参数的描述。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:933
#, fuzzy
msgid "To complete the greylisting setup:"
msgstr "完成灰名单设置的步骤如下："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:938
#, no-wrap
msgid ""
"#  service obspamd restart\n"
"#  service obspamlogd start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:942
#, fuzzy
msgid ""
"Behind the scenes, the spamdb database tool and the spamlogd whitelist "
"updater perform essential functions for the greylisting feature.  spamdb is "
"the administrator's main interface to managing the block, grey, and allow "
"lists via the contents of the [.filename]#/var/db/spamdb# database."
msgstr ""
"幕后，spamdb数据库工具和spamlogd白名单更新程序为灰名单功能执行必要的功能。spamdb是管理员通过[var/db/spamdb]数据库的内容来管理阻止、灰名单和允许名单的主要界面。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:944
#, fuzzy, no-wrap
msgid "Network Hygiene"
msgstr "网络卫生"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:947
#, fuzzy
msgid ""
"This section describes how `block-policy`, `scrub`, and `antispoof` can be "
"used to make the ruleset behave sanely."
msgstr "本节介绍了如何使用 `block-policy`、`scrub` 和 `antispoof` 来使规则集表现正常。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:951
#, fuzzy
msgid ""
"The `block-policy` is an option which can be set in the `options` part of "
"the ruleset, which precedes the redirection and filtering rules.  This "
"option determines which feedback, if any, PF sends to hosts that are blocked"
" by a rule.  The option has two possible values: `drop` drops blocked "
"packets with no feedback, and `return` returns a status code such as "
"`Connection refused`."
msgstr ""
"`block-policy` 是一个选项，可以在规则集的 `options` 部分设置，该部分位于重定向和过滤规则之前。这个选项决定了 PF "
"对被规则阻止的主机发送哪种反馈（如果有的话）。该选项有两个可能的值：`drop` 丢弃被规则阻止的数据包并不发送反馈，`return` 返回诸如 "
"`Connection refused` 的状态码。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:954
#, fuzzy
msgid ""
"If not set, the default policy is `drop`.  To change the `block-policy`, "
"specify the desired value:"
msgstr "如果未设置，则默认策略为`drop`。要更改`block-policy`，请指定所需的值："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:958
#, no-wrap
msgid "set block-policy return\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:964
#, fuzzy
msgid ""
"In PF, `scrub` is a keyword which enables network packet normalization.  "
"This process reassembles fragmented packets and drops TCP packets that have "
"invalid flag combinations.  Enabling `scrub` provides a measure of "
"protection against certain kinds of attacks based on incorrect handling of "
"packet fragments.  A number of options are available, but the simplest form "
"is suitable for most configurations:"
msgstr ""
"在PF中，`scrub`是一个关键字，它可以启用网络数据包归一化。该过程可以重新组装碎片分片，并且丢弃具有无效标志组合的TCP数据包。启用`scrub`可以提供一定程度的保护，防止基于对数据包碎片处理不正确的一些攻击。有许多选项可供选择，但最简单的形式适用于大多数配置："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:968
#, no-wrap
msgid "scrub in all\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:972
#, fuzzy
msgid ""
"Some services, such as NFS, require specific fragment handling options.  "
"Refer to "
"https://home.nuug.no/\\~peter/pf/en/scrub.html[https://home.nuug.no/~peter/pf/en/scrub.html]"
" for more information."
msgstr ""
"一些服务，例如NFS，需要特定的分片处理选项。有关更多信息，请参阅[https://home.nuug.no/~peter/pf/en/scrub.html](https://home.nuug.no/~peter/pf/en/scrub.html)。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:974
#, fuzzy
msgid ""
"This example reassembles fragments, clears the \"do not fragment\" bit, and "
"sets the maximum segment size to 1440 bytes:"
msgstr "这个例子重新组装片段，清除 \"do not fragment\" 位，并将最大分段大小设置为1440字节："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:978
#, no-wrap
msgid "scrub in all fragment reassemble no-df max-mss 1440\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:981
#, fuzzy
msgid ""
"The `antispoof` mechanism protects against activity from spoofed or forged "
"IP addresses, mainly by blocking packets appearing on interfaces and in "
"directions which are logically not possible."
msgstr "`antispoof` 机制通过阻止出现在接口和方向上的逻辑上不可能的数据包，主要是通过防止来自伪造或伪装的 IP 地址的活动来进行保护。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:983
#, fuzzy
msgid ""
"These rules weed out spoofed traffic coming in from the rest of the world as"
" well as any spoofed packets which originate in the local network:"
msgstr "这些规则可以排除来自世界其他地方的欺骗流量，以及源自本地网络的任何伪造数据包："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:988
#, no-wrap
msgid ""
"antispoof for $ext_if\n"
"antispoof for $int_if\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:991
#, fuzzy, no-wrap
msgid "Handling Non-Routable Addresses"
msgstr ""
"处理非可路由地址\n"
"\n"
"=== Problem Description\n"
"\n"
"Non-routable addresses, also known as private addresses, are IP addresses that are not meant to be routed over the internet. These addresses are reserved for use within private networks, such as home or office networks.\n"
"\n"
"When dealing with non-routable addresses, there are a few things to consider. First, these addresses are not unique on the internet, so it is possible for multiple private networks to use the same address ranges. This can cause conflicts when trying to communicate between different private networks.\n"
"\n"
"Additionally, non-routable addresses cannot be accessed directly from the internet. If you want to access a device with a non-routable address from outside the private network, you will need to use network address translation (NAT) to map the private address to a public, routable address.\n"
"\n"
"=== Solution\n"
"\n"
"To handle non-routable addresses, you can follow these steps:\n"
"\n"
"1. Use IP address ranges reserved for private use, such as:\n"
"\n"
"   - 10.0.0.0 to 10.255.255.255 (10.0.0.0/8)\n"
"   - 172.16.0.0 to 172.31.255.255 (172.16.0.0/12)\n"
"   - 192.168.0.0 to 192.168.255.255 (192.168.0.0/16)\n"
"\n"
"2. Ensure that each private network uses a unique address range to avoid conflicts.\n"
"\n"
"3. If you need to access a device with a non-routable address from outside the private network, set up network address translation (NAT) to map the private address to a public, routable address.\n"
"\n"
"By following these steps, you can effectively handle non-routable addresses in your network and ensure proper communication between different private networks."

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:996
#, fuzzy
msgid ""
"Even with a properly configured gateway to handle network address "
"translation, one may have to compensate for other people's "
"misconfigurations.  A common misconfiguration is to let traffic with non-"
"routable addresses out to the Internet.  Since traffic from non-routeable "
"addresses can play a part in several DoS attack techniques, consider "
"explicitly blocking traffic from non-routeable addresses from entering the "
"network through the external interface."
msgstr ""
"即使有一个正确配置的网关来处理网络地址转换，也可能需要补偿其他人的错误配置。一个常见的错误配置是允许非路由地址的流量流出到互联网。由于来自非路由地址的流量可以在几种拒绝服务攻击技术中起作用，建议通过外部接口明确阻止来自非路由地址的流量进入网络。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:999
#, fuzzy
msgid ""
"In this example, a macro containing non-routable addresses is defined, then "
"used in blocking rules.  Traffic to and from these addresses is quietly "
"dropped on the gateway's external interface."
msgstr "在这个例子中，定义了一个包含非路由地址的宏，并且在阻止规则中使用。这些地址之间的流量在网关的外部接口上被静默丢弃。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1005
#, no-wrap
msgid ""
"martians = \"{ 127.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12, \\\n"
"\t      10.0.0.0/8, 169.254.0.0/16, 192.0.2.0/24, \\\n"
"\t      0.0.0.0/8, 240.0.0.0/4 }\"\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1008
#, no-wrap
msgid ""
"block drop in quick on $ext_if from $martians to any\n"
"block drop out quick on $ext_if from any to $martians\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1010
#, fuzzy, no-wrap
msgid "Enabling ALTQ"
msgstr "启用ALTQ"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1014
#, fuzzy
msgid ""
"On FreeBSD, ALTQ can be used with PF to provide Quality of Service (QOS).  "
"Once ALTQ is enabled, queues can be defined in the ruleset which determine "
"the processing priority of outbound packets."
msgstr ""
"在FreeBSD上，可以使用ALTQ与PF一起提供服务质量（QOS）。启用ALTQ后，可以在规则集中定义队列，以确定出站数据包的处理优先级。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1016
#, fuzzy
msgid ""
"Before enabling ALTQ, refer to man:altq[4] to determine if the drivers for "
"the network cards installed on the system support it."
msgstr "在启用ALTQ之前，参考man:altq[4]，确定系统上安装的网络适配器驱动程序是否支持它。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1022
#, fuzzy
msgid ""
"ALTQ is not available as a loadable kernel module.  If the system's "
"interfaces support ALTQ, create a custom kernel using the instructions in "
"crossref:kernelconfig[kernelconfig,Configuring the FreeBSD Kernel].  The "
"following kernel options are available.  The first is needed to enable ALTQ."
"  At least one of the other options is necessary to specify the queueing "
"scheduler algorithm:"
msgstr ""
"ALTQ不可用作可加载的内核模块。如果系统的接口支持ALTQ，请按照crossref:kernelconfig[kernelconfig,配置FreeBSD内核]中的说明来创建自定义内核。以下是可用的内核选项。第一个选项用于启用ALTQ。其他选项中至少需要一个来指定队列调度算法："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1031
#, no-wrap
msgid ""
"options         ALTQ\n"
"options         ALTQ_CBQ        # Class Based Queuing (CBQ)\n"
"options         ALTQ_RED        # Random Early Detection (RED)\n"
"options         ALTQ_RIO        # RED In/Out\n"
"options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)\n"
"options         ALTQ_PRIQ       # Priority Queuing (PRIQ)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1034
#, fuzzy
msgid "The following scheduler algorithms are available:"
msgstr "以下调度算法可供选择："

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1035
#, fuzzy, no-wrap
msgid "CBQ"
msgstr ""
"CBQ指的是\"Class-Based "
"Queueing\"（基于类别的队列），它是一种用来管理网络流量的算法。CBQ通过将数据流分成不同的类别，并为每个类别分配优先级和带宽，来实现对网络流量的控制和调度。CBQ可以帮助网络管理员实现流量的优先级管理、带宽分配和拥塞控制等功能。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1037
#, fuzzy
msgid ""
"Class Based Queuing (CBQ) is used to divide a connection's bandwidth into "
"different classes or queues to prioritize traffic based on filter rules."
msgstr "基于类的排队（CBQ）用于将连接的带宽划分为不同的类别或队列，以根据过滤规则对流量进行优先级排序。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1038
#, fuzzy, no-wrap
msgid "RED"
msgstr "红色"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1041
#, fuzzy
msgid ""
"Random Early Detection (RED) is used to avoid network congestion by "
"measuring the length of the queue and comparing it to the minimum and "
"maximum thresholds for the queue.  When the queue is over the maximum, all "
"new packets are randomly dropped."
msgstr ""
"随机提前检测（RED）用于通过测量队列的长度并将其与队列的最小和最大阈值进行比较，以避免网络拥塞。当队列超过最大值时，所有新的数据包都会被随机丢弃。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1042
#, fuzzy, no-wrap
msgid "RIO"
msgstr ""
"RIO（Remote "
"Input/Output）是一种用于机器人和自动化系统的通信协议。它允许计算机通过网络与远程设备进行数据交换，包括输入和输出操作。RIO协议通常用于控制和监控各种设备，例如传感器、执行器和其他外部设备。RIO简化了远程设备之间的通信，在工业自动化和机器人控制等领域得到广泛应用。使用RIO协议，计算机可以实时控制、设置和获取远程设备的状态和数据，从而实现全面的远程控制。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1044
#, fuzzy
msgid ""
"In Random Early Detection In and Out (RIO) mode, RED maintains multiple "
"average queue lengths and multiple threshold values, one for each QOS level."
msgstr ""
"在随机提前检测（Random Early Detection，简称RED）的In and "
"Out（RIO）模式下，RED维护多个平均队列长度和多个阈值，每个QOS级别对应一个阈值。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1045
#, fuzzy, no-wrap
msgid "HFSC"
msgstr ""
"HFSC (Hierarchical Fair Service Curve) "
"是一种用于网络流量管理的调度算法，用于实现公平的带宽分配。它通过创建一个层次结构的服务曲线来控制和限制不同流量类别的带宽使用。HFSC "
"被广泛应用于计算机网络中，特别是在路由器和交换机中，用于提供基于服务质量的流量调度，并确保每个流量类别得到公平和合理的带宽分配。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1047
#, fuzzy
msgid ""
"Hierarchical Fair Service Curve Packet Scheduler (HFSC) is described in "
"http://www-2.cs.cmu.edu/\\~hzhang/HFSC/main.html[http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html]."
msgstr ""
"层次公平服务曲线分组调度器（HFSC）的详细介绍请参考[http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html]。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1048
#, fuzzy, no-wrap
msgid "PRIQ"
msgstr ""
"PRIQ是优先级队列的一种。PRIQ全称为Priority Queue，它是一种数据结构，用于存储带有优先级的元素。在PRIQ中，每个元素都分配了一个优先级，根据优先级对元素进行排序。优先级较高的元素会被优先处理。PRIQ通常使用堆（Heap）来实现，因为堆具有高效的插入和删除操作。\n"
"\n"
"在计算机科学中，PRIQ经常用于解决需要根据优先级排序处理元素的问题。例如，在操作系统的任务调度中，可以使用PRIQ来将具有高优先级的任务优先处理。此外，PRIQ还被广泛应用于图算法、网络路由等领域。\n"
"\n"
"需要注意的是，这里的PRIQ指的是Priority Queue，而不是其他可能的缩写。根据上下文可能会有不同的含义。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1050
#, fuzzy
msgid ""
"Priority Queuing (PRIQ) always passes traffic that is in a higher queue "
"first."
msgstr "优先队列（PRIQ）始终优先传输位于较高队列中的流量。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1052
#, fuzzy
msgid ""
"More information about the scheduling algorithms and example rulesets are "
"available at the "
"https://web.archive.org/web/20151109213426/http://www.openbsd.org/faq/pf/queueing.html[OpenBSD's"
" web archive]."
msgstr ""
"有关调度算法和示例规则集的更多信息，请访问OpenBSD的网络档案[1]。\n"
" \n"
"[1] https://web.archive.org/web/20151109213426/http://www.openbsd.org/faq/pf/queueing.html"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1054
#, fuzzy, no-wrap
msgid "IPFW"
msgstr ""
"IPFW是一个在BSD操作系统上常用的防火墙工具，它提供了一整套规则和过滤器，用于控制数据包进出系统的流量。它支持网络地址转换（NAT）、端口转发、连接跟踪等功能，并且可以通过配置文件进行灵活的设置。尽管在最新的BSD发行版中已经被其它防火墙软件取代，但IPFW仍然被一些老版本的BSD操作系统广泛使用。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1058
#, fuzzy
msgid ""
"IPFW is a stateful firewall written for FreeBSD which supports both IPv4 and"
" IPv6.  It is comprised of several components: the kernel firewall filter "
"rule processor and its integrated packet accounting facility, the logging "
"facility, NAT, the man:dummynet[4] traffic shaper, a forward facility, a "
"bridge facility, and an ipstealth facility."
msgstr ""
"IPFW 是为 FreeBSD 编写的有状态防火墙，支持 IPv4 和 "
"IPv6。它由几个组件组成：内核防火墙过滤规则处理器和集成的数据包计数功能，日志记录功能，NAT，man:dummynet[4] "
"流量整形器，转发功能，桥接功能和 ipstealth 功能。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1061
#, fuzzy
msgid ""
"FreeBSD provides a sample ruleset in [.filename]#/etc/rc.firewall# which "
"defines several firewall types for common scenarios to assist novice users "
"in generating an appropriate ruleset.  IPFW provides a powerful syntax which"
" advanced users can use to craft customized rulesets that meet the security "
"requirements of a given environment."
msgstr ""
"FreeBSD 在 [/etc/rc.firewall](此处省略号为asciidoc标签) "
"中提供了一个示例规则集，该规则集定义了几种常见场景下的防火墙类型，以帮助初学者生成适当的规则集。IPFW "
"提供了强大的语法，高级用户可以使用它来制定满足特定环境安全需求的自定义规则集。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1063
#, fuzzy
msgid ""
"This section describes how to enable IPFW, provides an overview of its rule "
"syntax, and demonstrates several rulesets for common configuration "
"scenarios."
msgstr "本节介绍了如何启用IPFW，提供了其规则语法的概述，并演示了几个常见配置场景的规则集。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1065
#, fuzzy, no-wrap
msgid "Enabling IPFW"
msgstr "启用IPFW"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1068
#, fuzzy
msgid ""
"IPFW is included in the basic FreeBSD install as a kernel loadable module, "
"meaning that a custom kernel is not needed in order to enable IPFW."
msgstr ""
"IPFW（Internet Protocol "
"Firewall）是基本的FreeBSD安装中的一个可加载内核模块，这意味着不需要定制内核即可启用IPFW。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1070
#, fuzzy
msgid ""
"For those users who wish to statically compile IPFW support into a custom "
"kernel, see <<firewalls-ipfw-kernelconfig>>."
msgstr "对于那些希望将IPFW支持静态编译到自定义内核的用户，请参考<<firewalls-ipfw-kernelconfig>>。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1072
#, fuzzy
msgid ""
"To configure the system to enable IPFW at boot time, add "
"`firewall_enable=\"YES\"` to [.filename]#/etc/rc.conf#:"
msgstr "要在启动时配置系统以启用IPFW，请将`firewall_enable=\"YES\"`添加到`/etc/rc.conf`文件中。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1076
#, no-wrap
msgid "# sysrc firewall_enable=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1079
#, fuzzy
msgid ""
"To use one of the default firewall types provided by FreeBSD, add another "
"line which specifies the type:"
msgstr "要使用FreeBSD提供的默认防火墙类型之一，添加另一行来指定类型："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1083
#, no-wrap
msgid "# sysrc firewall_type=\"open\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1086
#, fuzzy
msgid "The available types are:"
msgstr "可用的类型有："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1088
#, fuzzy
msgid "`open`: passes all traffic."
msgstr "`open`: 允许通过所有流量。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1089
#, fuzzy
msgid "`client`: protects only this machine."
msgstr "`client`：仅保护本机。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1090
#, fuzzy
msgid "`simple`: protects the whole network."
msgstr "`simple`: 保护整个网络。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1091
#, fuzzy
msgid ""
"`closed`: entirely disables IP traffic except for the loopback interface."
msgstr "`closed`：完全禁用 IP 通信，除了回环接口以外。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1092
#, fuzzy
msgid "`workstation`: protects only this machine using stateful rules."
msgstr "`workstation`: 使用有状态规则仅保护此机器。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1093
#, fuzzy
msgid "`UNKNOWN`: disables the loading of firewall rules."
msgstr "`UNKNOWN`：禁用防火墙规则的加载。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1094
#, fuzzy
msgid ""
"[.filename]#filename#: full path of the file containing the firewall "
"ruleset."
msgstr "[.filename]#filename#: 防火墙规则集文件的完整路径。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1096
#, fuzzy
msgid ""
"If `firewall_type` is set to either `client` or `simple`, modify the default"
" rules found in [.filename]#/etc/rc.firewall# to fit the configuration of "
"the system."
msgstr ""
"如果 `firewall_type` 被设置为 `client` 或者 `simple`，则修改位于 `/etc/rc.firewall` "
"的默认规则以适应系统的配置。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1098
#, fuzzy
msgid "Note that the `filename` type is used to load a custom ruleset."
msgstr "请注意，`filename` 类型用于加载自定义规则集。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1101
#, fuzzy
msgid ""
"An alternate way to load a custom ruleset is to set the `firewall_script` "
"variable to the absolute path of an _executable script_ that includes IPFW "
"commands.  The examples used in this section assume that the "
"`firewall_script` is set to [.filename]#/etc/ipfw.rules#:"
msgstr ""
"加载自定义规则集的另一种方法是将`firewall_script`变量设置为可执行脚本的绝对路径，该脚本包含IPFW命令。本节中使用的示例假设`firewall_script`设置为[.filename]#/etc/ipfw.rules#："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1105
#, no-wrap
msgid "# sysrc firewall_script=\"/etc/ipfw.rules\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1108
#, fuzzy
msgid "To enable logging through man:syslogd[8], include this line:"
msgstr "要通过`syslogd[8]`启用日志记录，请包含以下行："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1112
#, no-wrap
msgid "# sysrc firewall_logging=\"YES\"\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1120
#, fuzzy
msgid ""
"Only firewall rules with the `log` option will be logged.  The default rules"
" do not include this option and it must be manually added.  Therefore it is "
"advisable that the default ruleset is edited for logging.  In addition, log "
"rotation may be desired if the logs are stored in a separate file."
msgstr ""
"只有带有 `log` "
"选项的防火墙规则才会被记录。默认规则不包含此选项，需要手动添加。因此，建议编辑默认规则集以进行记录。此外，如果日志存储在单独的文件中，可能需要进行日志轮转。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1124
#, fuzzy
msgid ""
"There is no [.filename]#/etc/rc.conf# variable to set logging limits.  To "
"limit the number of times a rule is logged per connection attempt, specify "
"the number using this line in [.filename]#/etc/sysctl.conf#:"
msgstr ""
"没有 [.filename]#/etc/rc.conf# 变量来设置日志限制。要限制每次连接尝试记录规则的次数，请在 "
"[.filename]#/etc/sysctl.conf# 中使用以下行指定数字："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1128
#, no-wrap
msgid "# echo \"net.inet.ip.fw.verbose_limit=5\" >> /etc/sysctl.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1131
#, fuzzy
msgid ""
"To enable logging through a dedicated interface named `ipfw0`, add this line"
" to [.filename]#/etc/rc.conf# instead:"
msgstr "要通过名为`ipfw0`的专用接口启用日志记录，请将以下行添加到[/etc/rc.conf]#代替："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1135
#, no-wrap
msgid "# sysrc firewall_logif=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1138
#, fuzzy
msgid "Then use tcpdump to see what is being logged:"
msgstr "然后使用`tcpdump`命令查看记录的内容："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1142
#, no-wrap
msgid "# tcpdump -t -n -i ipfw0\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1148
#, fuzzy
msgid "There is no overhead due to logging unless tcpdump is attached."
msgstr "除非附加tcpdump，否则日志不会导致额外开销。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1152
#, fuzzy
msgid ""
"After saving the needed edits, start the firewall.  To enable logging limits"
" now, also set the `sysctl` value specified above:"
msgstr "保存所需的编辑后，启动防火墙。要立即启用日志记录限制，还需设置上述`sysctl`值。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1157
#, no-wrap
msgid ""
"# service ipfw start\n"
"# sysctl net.inet.ip.fw.verbose_limit=5\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1160
#, fuzzy, no-wrap
msgid "IPFW Rule Syntax"
msgstr "IPFW规则语法"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1168
#, fuzzy
msgid ""
"When a packet enters the IPFW firewall, it is compared against the first "
"rule in the ruleset and progresses one rule at a time, moving from top to "
"bottom in sequence.  When the packet matches the selection parameters of a "
"rule, the rule's action is executed and the search of the ruleset terminates"
" for that packet.  This is referred to as \"first match wins\".  If the "
"packet does not match any of the rules, it gets caught by the mandatory IPFW"
" default rule number 65535, which denies all packets and silently discards "
"them.  However, if the packet matches a rule that contains the `count`, "
"`skipto`, or `tee` keywords, the search continues.  Refer to man:ipfw[8] for"
" details on how these keywords affect rule processing."
msgstr ""
"当一个数据包进入IPFW防火墙时，它将与规则集中的第一条规则进行比对，并按顺序一条条地进行。当数据包匹配规则的选择参数时，将执行规则的操作，并终止该数据包的规则集搜索。这被称为“先中者胜”。如果数据包不匹配任何规则，则被强制性的IPFW默认规则号65535"
" 捕获，该规则拒绝所有数据包并将其静默丢弃。然而，如果数据包匹配包含 `count`, `skipto`, 或 `tee` "
"关键字的规则，则搜索会继续。有关这些关键字如何影响规则处理的详细信息，请参考 man:ipfw[8]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1174
#, fuzzy
msgid ""
"When creating an IPFW rule, keywords must be written in the following order."
"  Some keywords are mandatory while other keywords are optional.  The words "
"shown in uppercase represent a variable and the words shown in lowercase "
"must precede the variable that follows it.  The `+#+` symbol is used to mark"
" the start of a comment and may appear at the end of a rule or on its own "
"line.  Blank lines are ignored."
msgstr ""
"创建 IPFW "
"规则时，关键词必须按照以下顺序编写。某些关键词是强制性的，而其他关键词是可选的。大写字母表示变量，小写字母表示在其后面的变量之前必须出现。`+#+` "
"符号用于标记注释的开始，可以出现在规则的末尾或独立的行上。空行会被忽略。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1176
#, fuzzy
msgid ""
"`_CMD RULE_NUMBER set SET_NUMBER ACTION log LOG_AMOUNT PROTO from SRC "
"SRC_PORT to DST DST_PORT OPTIONS_`"
msgstr "`_CMD 规则编号 设置 设置编号 动作 日志记录数量 协议 从源地址 源端口 到目标地址 目标端口 选项_`"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1180
#, fuzzy
msgid ""
"This section provides an overview of these keywords and their options.  It "
"is not an exhaustive list of every possible option.  Refer to man:ipfw[8] "
"for a complete description of the rule syntax that can be used when creating"
" IPFW rules."
msgstr ""
"本节提供了这些关键字及其选项的概述。这不是关于每个可能选项的详尽列表。在创建IPFW规则时可使用的规则语法的完整描述，请参考man:ipfw[8]。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1181
#, fuzzy, no-wrap
msgid "CMD"
msgstr ""
"CMD是Windows操作系统中的命令行解释器，它可以用来执行各种系统命令和批处理脚本。通过CMD，用户可以与计算机交互，并执行一系列的命令来完成特定的任务。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1183
#, fuzzy
msgid "Every rule must start with `ipfw add`."
msgstr "每条规则都必须以 `ipfw add` 开头。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1184
#, fuzzy, no-wrap
msgid "RULE_NUMBER"
msgstr "RULE_NUMBER（规则编号）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1188
#, fuzzy
msgid ""
"Each rule is associated with a number from `1` to `65534`.  The number is "
"used to indicate the order of rule processing.  Multiple rules can have the "
"same number, in which case they are applied according to the order in which "
"they have been added."
msgstr ""
"每个规则与数字`1`到`65534`关联。该数字用于指示规则处理的顺序。多个规则可以具有相同的数字，这种情况下它们按照它们被添加的顺序应用。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1189
#, fuzzy, no-wrap
msgid "SET_NUMBER"
msgstr ""
"SET_NUMBER 指令是一个用于设置变量值的计算机指令。它用于给一个变量赋予一个特定的数值。在计算机编程中，SET_NUMBER "
"常常用于初始化变量，或者在程序执行过程中更新变量的值。这个指令通常包含两个参数：变量的标识符和所需赋予的数值。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1193
#, fuzzy
msgid ""
"Each rule is associated with a set number from `0` to `31`.  Sets can be "
"individually disabled or enabled, making it possible to quickly add or "
"delete a set of rules.  If a SET_NUMBER is not specified, the rule will be "
"added to set `0`."
msgstr ""
"每个规则与一个编号从`0`到`31`的集合相关联。可以单独禁用或启用集合，从而可以快速添加或删除一组规则。如果未指定SET_NUMBER，则规则将添加到集合`0`中。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1194
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1940
#, fuzzy, no-wrap
msgid "ACTION"
msgstr "动作"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1197
#, fuzzy
msgid ""
"A rule can be associated with one of the following actions.  The specified "
"action will be executed when the packet matches the selection criterion of "
"the rule."
msgstr "一个规则可以与以下动作之一关联起来。当数据包与规则的选择条件匹配时，将执行指定的动作。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1199
#, fuzzy
msgid ""
"`allow | accept | pass | permit`: these keywords are equivalent and allow "
"packets that match the rule."
msgstr "`allow | accept | pass | permit`: 这些关键字是等效的，允许匹配规则的数据包通过。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1204
#, fuzzy
msgid ""
"`check-state`: checks the packet against the dynamic state table.  If a "
"match is found, execute the action associated with the rule which generated "
"this dynamic rule, otherwise move to the next rule.  A `check-state` rule "
"does not have selection criterion.  If no `check-state` rule is present in "
"the ruleset, the dynamic rules table is checked at the first `keep-state` or"
" `limit` rule."
msgstr ""
"`check-state`：检查数据包与动态状态表的匹配情况。如果找到匹配项，则执行生成该动态规则的规则关联的操作，否则移至下一条规则。`check-"
"state`规则没有选择标准。如果规则集中没有`check-state`规则，则在第一个`keep-state`或`limit`规则处检查动态规则表。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1207
#, fuzzy
msgid ""
"`count`: updates counters for all packets that match the rule.  The search "
"continues with the next rule."
msgstr "`count`：对所有与规则匹配的数据包进行计数更新。搜索将继续执行下一条规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1209
#, fuzzy
msgid ""
"`deny | drop`: either word silently discards packets that match this rule."
msgstr "`deny | drop`：无论是`deny`（拒绝）还是`drop`（丢弃），都会静默地丢弃与此规则匹配的数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1212
#, fuzzy
msgid "Additional actions are available.  Refer to man:ipfw[8] for details."
msgstr "有其他可用的操作。参考 man:ipfw[8] 了解详细信息。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1213
#, fuzzy, no-wrap
msgid "LOG_AMOUNT"
msgstr "LOG_AMOUNT（日志数量）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1219
#, fuzzy
msgid ""
"When a packet matches a rule with the `log` keyword, a message will be "
"logged to man:syslogd[8] with a facility name of `SECURITY`.  Logging only "
"occurs if the number of packets logged for that particular rule does not "
"exceed a specified LOG_AMOUNT.  If no LOG_AMOUNT is specified, the limit is "
"taken from the value of `net.inet.ip.fw.verbose_limit`.  A value of zero "
"removes the logging limit.  Once the limit is reached, logging can be re-"
"enabled by clearing the logging counter or the packet counter for that rule,"
" using `ipfw resetlog`."
msgstr ""
"当一个数据包匹配到使用`log`关键字的规则时，将会记录一条消息到`man:syslogd[8]`，日志的设施名称为`SECURITY`。仅当特定规则的已记录数据包数量不超过指定的`LOG_AMOUNT`时，才会进行记录。如果未指定`LOG_AMOUNT`，则限制值来自于`net.inet.ip.fw.verbose_limit`的值。若值为零，则移除日志记录限制。一旦达到限制，可以通过清除该规则的记录计数器或数据包计数器来重新启用日志记录，使用命令`ipfw"
" resetlog`。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1224
#, fuzzy
msgid ""
"Logging is done after all other packet matching conditions have been met, "
"and before performing the final action on the packet.  The administrator "
"decides which rules to enable logging on."
msgstr "日志记录是在满足所有其他数据包匹配条件之后进行的，在对数据包执行最终操作之前。管理员决定在哪些规则上启用日志记录。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1226
#, fuzzy, no-wrap
msgid "PROTO"
msgstr ""
"PROTO是一个计算机网络协议，用于定义和管理数据的传输和通信规则。这个术语通常用于描述不同网络设备之间进行通信时所使用的协议。PROTO可以是一个特定的协议，例如TCP（传输控制协议）或UDP（用户数据报协议），也可以是一个更高级别的协议，如HTTP（超文本传输协议）或FTP（文件传输协议）。无论是哪种情况，PROTO都是计算机网络中非常重要的一个概念。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1228
#, fuzzy
msgid ""
"This optional value can be used to specify any protocol name or number found"
" in [.filename]#/etc/protocols#."
msgstr "这个可选值可以用来指定在[/etc/protocols]文件中找到的任何协议名称或编号。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1229
#, fuzzy, no-wrap
msgid "SRC"
msgstr ""
"SRC 是指源代码（Source "
"Code）的缩写。源代码是计算机程序的原始形式，由程序员使用特定的编程语言编写而成。编写的源代码通过编译（Compilation）或解释（Interpretation）等方式被转换为机器可以执行的形式，供计算机运行。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1234
#, fuzzy
msgid ""
"The `from` keyword must be followed by the source address or a keyword that "
"represents the source address.  An address can be represented by `any`, `me`"
" (any address configured on an interface on this system), `me6`, (any IPv6 "
"address configured on an interface on this system), or `table` followed by "
"the number of a lookup table which contains a list of addresses.  When "
"specifying an IP address, it can be optionally followed by its CIDR mask or "
"subnet mask.  For example, `1.2.3.4/25` or `1.2.3.4:255.255.255.128`."
msgstr ""
"`from`关键词后必须跟随源地址或代表源地址的关键词。地址可以用`any`、`me`（此系统上任意接口配置的地址）、`me6`（此系统上任意IPv6地址配置的接口）、或`table`加上包含地址列表的查找表编号来表示。当指定IP地址时，可以选择性地跟随CIDR掩码或子网掩码。例如，`1.2.3.4/25`或`1.2.3.4:255.255.255.128`。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1235
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2006
#, fuzzy, no-wrap
msgid "SRC_PORT"
msgstr "源端口"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1237
#, fuzzy
msgid ""
"An optional source port can be specified using the port number or name from "
"[.filename]#/etc/services#."
msgstr "可以使用端口号或者从`/etc/services`文件中的名称来指定一个可选的源端口。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1238
#, fuzzy, no-wrap
msgid "DST"
msgstr ""
"DST（Daylight Saving "
"Time）是指夏令时，它是一种时间调整制度，旨在充分利用日光时间。夏令时通常在夏季开始时将时间向前调整一小时，在冬季结束时将时间向后调整一小时。这样可以使得人们在白天能够更多地享受日光，并节约能源。夏令时的实施时间和方式因国家和地区而异。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1241
#, fuzzy
msgid ""
"The `to` keyword must be followed by the destination address or a keyword "
"that represents the destination address.  The same keywords and addresses "
"described in the SRC section can be used to describe the destination."
msgstr "`to`关键字后面必须跟着目标地址或代表目标地址的关键字。在SRC部分描述的相同关键字和地址可用于描述目标地址。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1242
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2019
#, fuzzy, no-wrap
msgid "DST_PORT"
msgstr "DST_PORT表示目标端口。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1244
#, fuzzy
msgid ""
"An optional destination port can be specified using the port number or name "
"from [.filename]#/etc/services#."
msgstr "可以使用端口号或者从 `.filename` 文件中的 `/etc/services` 中指定可选的目标端口。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1245
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1970
#, fuzzy, no-wrap
msgid "OPTIONS"
msgstr "选项"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1249
#, fuzzy
msgid ""
"Several keywords can follow the source and destination.  As the name "
"suggests, OPTIONS are optional.  Commonly used options include `in` or "
"`out`, which specify the direction of packet flow, `icmptypes` followed by "
"the type of ICMP message, and `keep-state`."
msgstr ""
"源地址和目的地址之后可以跟随几个关键字。顾名思义，选项是可选的。常用的选项包括`in`或`out`，用于指定数据包流动的方向，`icmptypes`后跟ICMP消息的类型，以及`keep-"
"state`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1251
#, fuzzy
msgid ""
"When a `keep-state` rule is matched, the firewall will create a dynamic rule"
" which matches bidirectional traffic between the source and destination "
"addresses and ports using the same protocol."
msgstr "当匹配到 `keep-state` 规则时，防火墙将创建一个动态规则，该规则在源地址和目标地址之间使用相同的协议，并匹配双向流量的端口。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1256
#, fuzzy
msgid ""
"The dynamic rules facility is vulnerable to resource depletion from a SYN-"
"flood attack which would open a huge number of dynamic rules.  To counter "
"this type of attack with IPFW, use `limit`.  This option limits the number "
"of simultaneous sessions by checking the open dynamic rules, counting the "
"number of times this rule and IP address combination occurred.  If this "
"count is greater than the value specified by `limit`, the packet is "
"discarded."
msgstr ""
"动态规则功能容易受到 SYN 洪水攻击的资源耗尽影响，因为这种攻击会打开大量的动态规则。为了抵御这种攻击，并使用 IPFW，使用 `limit` "
"命令。该选项通过检查已打开的动态规则来限制同时会话的数量，并计算该规则和 IP 地址组合发生的次数。如果此计数大于 `limit` "
"指定的值，则该数据包被丢弃。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1259
#, fuzzy
msgid ""
"Dozens of OPTIONS are available.  Refer to man:ipfw[8] for a description of "
"each available option."
msgstr "有几十种选项可供选择。请参考 man:ipfw[8] 获取每个可用选项的描述。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1260
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2047
#, fuzzy, no-wrap
msgid "Example Ruleset"
msgstr ""
"示例规则集\n"
"\n"
"[horizontal]\n"
"=== Rule 1: Avoid Repetition\n"
"\n"
"Avoid repeating the same code or information multiple times. Instead, use functions, loops, or variables to reuse code or data.\n"
"\n"
"=== Rule 2: Follow Naming Conventions\n"
"\n"
"Follow consistent and clear naming conventions for variables, functions, and files. Use descriptive names that accurately represent the purpose or content of the entity being named.\n"
"\n"
"=== Rule 3: Use Proper Indentation\n"
"\n"
"Use proper indentation to improve code readability. Indentation should be consistent and follow the chosen coding style guide.\n"
"\n"
"=== Rule 4: Handle Errors and Exceptions\n"
"\n"
"Always handle errors and exceptions appropriately. Use try-catch blocks or similar mechanisms to catch and handle exceptions, and provide informative error messages to aid in debugging.\n"
"\n"
"=== Rule 5: Comment Your Code\n"
"\n"
"Add comments to your code to explain its purpose, logic, and any important details. Comments should be clear, concise, and follow the specified commenting style.\n"
"\n"
"=== Rule 6: Adjust Code Formatting\n"
"\n"
"Adhere to the specified code formatting guidelines. This includes indentation, line length, spacing, and the placement of braces, brackets, and parentheses.\n"
"\n"
"=== Rule 7: Optimize Performance\n"
"\n"
"Optimize code to improve performance where necessary. This may involve optimizing algorithms, minimizing resource usage, or avoiding unnecessary operations.\n"
"\n"
"=== Rule 8: Test and Validate\n"
"\n"
"Thoroughly test and validate your code. Use unit tests, integration tests, and other testing techniques to ensure the code behaves as expected and handles various scenarios correctly.\n"
"\n"
"=== Rule 9: Secure Your Code\n"
"\n"
"Take steps to secure your code against potential vulnerabilities and attacks. Implement proper authentication, input validation, and data sanitization techniques to prevent security breaches.\n"
"\n"
"=== Rule 10: Document Your Code\n"
"\n"
"Document your code to provide comprehensive and meaningful documentation. Use proper documentation standards, such as Javadoc or Doxygen, to generate API documentation for your code."

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1265
#, fuzzy
msgid ""
"This section demonstrates how to create an example stateful firewall ruleset"
" script named [.filename]#/etc/ipfw.rules#.  In this example, all connection"
" rules use `in` or `out` to clarify the direction.  They also use `via` "
"_interface-name_ to specify the interface the packet is traveling over."
msgstr ""
"本节演示了如何创建一个名为 _/etc/ipfw.rules_ 的示例有状态防火墙规则脚本。在这个示例中，所有连接规则使用 `in` 或 `out` "
"来明确方向。它们还使用 `via` _interface-name_ 来指定数据包所经过的接口。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1269
#, fuzzy
msgid ""
"When first creating or testing a firewall ruleset, consider temporarily "
"setting this tunable:"
msgstr "当首次创建或测试防火墙规则集时，考虑临时设置此可调整项："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1273
#, no-wrap
msgid "net.inet.ip.fw.default_to_accept=\"1\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1276
#, fuzzy
msgid ""
"This sets the default policy of man:ipfw[8] to be more permissive than the "
"default `deny ip from any to any`, making it slightly more difficult to get "
"locked out of the system right after a reboot."
msgstr ""
"这将将 man:ipfw[8] 的默认策略设置为比默认的 `deny ip from any to any` 更宽松，使系统在重新启动后稍微更难被锁定。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1281
#, fuzzy
msgid ""
"The firewall script begins by indicating that it is a Bourne shell script "
"and flushes any existing rules.  It then creates the `cmd` variable so that "
"`ipfw add` does not have to be typed at the beginning of every rule.  It "
"also defines the `pif` variable which represents the name of the interface "
"that is attached to the Internet."
msgstr ""
"防火墙脚本首先指明它是一个Bourne shell脚本，并清除任何现有的规则。然后它创建 `cmd` 变量，这样在每条规则的开头不需要输入 `ipfw "
"add`。它还定义了 `pif` 变量，表示与互联网连接的接口的名称。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1287
#, no-wrap
msgid ""
"#!/bin/sh\n"
"# Flush out the list before we begin.\n"
"ipfw -q -f flush\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1291
#, no-wrap
msgid ""
"# Set rules command prefix\n"
"cmd=\"ipfw -q add\"\n"
"pif=\"dc0\"     # interface name of NIC attached to Internet\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1294
#, fuzzy
msgid ""
"The first two rules allow all traffic on the trusted internal interface and "
"on the loopback interface:"
msgstr "前两条规则允许所有经过受信任的内部接口和回环接口的流量通过："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1299
#, no-wrap
msgid ""
"# Change xl0 to LAN NIC interface name\n"
"$cmd 00005 allow all from any to any via xl0\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1302
#, no-wrap
msgid ""
"# No restrictions on Loopback Interface\n"
"$cmd 00010 allow all from any to any via lo0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1305
#, fuzzy
msgid ""
"The next rule allows the packet through if it matches an existing entry in "
"the dynamic rules table:"
msgstr "下一个规则允许通过的数据包是如果它与动态规则表中的现有条目匹配："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1309
#, no-wrap
msgid "$cmd 00101 check-state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1312
#, fuzzy
msgid ""
"The next set of rules defines which stateful connections internal systems "
"can create to hosts on the Internet:"
msgstr "下一组规则定义了内部系统可以向互联网上的主机创建哪些有状态连接："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1320
#, no-wrap
msgid ""
"# Allow access to public DNS\n"
"# Replace x.x.x.x with the IP address of a public DNS server\n"
"# and repeat for each DNS server in /etc/resolv.conf\n"
"$cmd 00110 allow tcp from any to x.x.x.x 53 out via $pif setup keep-state\n"
"$cmd 00111 allow udp from any to x.x.x.x 53 out via $pif keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1326
#, no-wrap
msgid ""
"# Allow access to ISP's DHCP server for cable/DSL configurations.\n"
"# Use the first rule and check log for IP address.\n"
"# Then, uncomment the second rule, input the IP address, and delete the first rule\n"
"$cmd 00120 allow log udp from any to any 67 out via $pif keep-state\n"
"#$cmd 00120 allow udp from any to x.x.x.x 67 out via $pif keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1330
#, no-wrap
msgid ""
"# Allow outbound HTTP and HTTPS connections\n"
"$cmd 00200 allow tcp from any to any 80 out via $pif setup keep-state\n"
"$cmd 00220 allow tcp from any to any 443 out via $pif setup keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1334
#, no-wrap
msgid ""
"# Allow outbound email connections\n"
"$cmd 00230 allow tcp from any to any 25 out via $pif setup keep-state\n"
"$cmd 00231 allow tcp from any to any 110 out via $pif setup keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1337
#, no-wrap
msgid ""
"# Allow outbound ping\n"
"$cmd 00250 allow icmp from any to any out via $pif keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1340
#, no-wrap
msgid ""
"# Allow outbound NTP\n"
"$cmd 00260 allow udp from any to any 123 out via $pif keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1343
#, no-wrap
msgid ""
"# Allow outbound SSH\n"
"$cmd 00280 allow tcp from any to any 22 out via $pif setup keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1346
#, no-wrap
msgid ""
"# deny and log all other outbound connections\n"
"$cmd 00299 deny log all from any to any out via $pif\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1351
#, fuzzy
msgid ""
"The next set of rules controls connections from Internet hosts to the "
"internal network.  It starts by denying packets typically associated with "
"attacks and then explicitly allows specific types of connections.  All the "
"authorized services that originate from the Internet use `limit` to prevent "
"flooding."
msgstr ""
"下一个规则集控制来自互联网主机到内部网络的连接。它首先禁止通常与攻击相关的数据包，然后显式允许特定类型的连接。所有源自互联网的授权服务均使用“limit”来防止过载攻击。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1364
#, no-wrap
msgid ""
"# Deny all inbound traffic from non-routable reserved address spaces\n"
"$cmd 00300 deny all from 192.168.0.0/16 to any in via $pif     #RFC 1918 private IP\n"
"$cmd 00301 deny all from 172.16.0.0/12 to any in via $pif      #RFC 1918 private IP\n"
"$cmd 00302 deny all from 10.0.0.0/8 to any in via $pif         #RFC 1918 private IP\n"
"$cmd 00303 deny all from 127.0.0.0/8 to any in via $pif        #loopback\n"
"$cmd 00304 deny all from 0.0.0.0/8 to any in via $pif          #loopback\n"
"$cmd 00305 deny all from 169.254.0.0/16 to any in via $pif     #DHCP auto-config\n"
"$cmd 00306 deny all from 192.0.2.0/24 to any in via $pif       #reserved for docs\n"
"$cmd 00307 deny all from 204.152.64.0/23 to any in via $pif    #Sun cluster interconnect\n"
"$cmd 00308 deny all from 224.0.0.0/3 to any in via $pif        #Class D & E multicast\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1367
#, no-wrap
msgid ""
"# Deny public pings\n"
"$cmd 00310 deny icmp from any to any in via $pif\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1370
#, no-wrap
msgid ""
"# Deny ident\n"
"$cmd 00315 deny tcp from any to any 113 in via $pif\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1376
#, no-wrap
msgid ""
"# Deny all Netbios services.\n"
"$cmd 00320 deny tcp from any to any 137 in via $pif\n"
"$cmd 00321 deny tcp from any to any 138 in via $pif\n"
"$cmd 00322 deny tcp from any to any 139 in via $pif\n"
"$cmd 00323 deny tcp from any to any 81 in via $pif\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1379
#, no-wrap
msgid ""
"# Deny fragments\n"
"$cmd 00330 deny all from any to any frag in via $pif\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1382
#, no-wrap
msgid ""
"# Deny ACK packets that did not match the dynamic rule table\n"
"$cmd 00332 deny tcp from any to any established in via $pif\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1386
#, no-wrap
msgid ""
"# Allow traffic from ISP's DHCP server.\n"
"# Replace x.x.x.x with the same IP address used in rule 00120.\n"
"#$cmd 00360 allow udp from any to x.x.x.x 67 in via $pif keep-state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1389
#, no-wrap
msgid ""
"# Allow HTTP connections to internal web server\n"
"$cmd 00400 allow tcp from any to me 80 in via $pif setup limit src-addr 2\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1392
#, no-wrap
msgid ""
"# Allow inbound SSH connections\n"
"$cmd 00410 allow tcp from any to me 22 in via $pif setup limit src-addr 2\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1395
#, no-wrap
msgid ""
"# Reject and log all other incoming connections\n"
"$cmd 00499 deny log all from any to any in via $pif\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1398
#, fuzzy
msgid ""
"The last rule logs all packets that do not match any of the rules in the "
"ruleset:"
msgstr "最后一条规则记录所有未匹配规则集中任何规则的数据包："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1403
#, no-wrap
msgid ""
"# Everything else is denied and logged\n"
"$cmd 00999 deny log all from any to any\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1406
#, fuzzy, no-wrap
msgid "In-kernel NAT"
msgstr "内核级NAT"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1411
#, fuzzy
msgid ""
"FreeBSD's IPFW firewall has two implementations of NAT: the userland "
"implementation man:natd[8], and the more recent in-kernel NAT "
"implementation.  Both work in conjunction with IPFW to provide network "
"address translation.  This can be used to provide an Internet Connection "
"Sharing solution so that several internal computers can connect to the "
"Internet using a single public IP address."
msgstr ""
"FreeBSD的IPFW防火墙有两种NAT的实现方式：用户空间实现 "
"man:natd[8]，以及更近期的内核级NAT实现方式。这两种方式都与IPFW一起工作，提供网络地址转换功能。这可以用于提供互联网连接共享解决方案，以便多台内部计算机能够使用单个公共IP地址连接到互联网上。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1415
#, fuzzy
msgid ""
"To do this, the FreeBSD machine connected to the Internet must act as a "
"gateway.  This system must have two NICs, where one is connected to the "
"Internet and the other is connected to the internal LAN.  Each machine "
"connected to the LAN should be assigned an IP address in the private network"
" space, as defined by https://www.ietf.org/rfc/rfc1918.txt[RFC 1918]."
msgstr ""
"要实现这一点，连接到互联网的FreeBSD机器必须充当网关。该系统必须具有两个网络接口卡（NIC），其中一个连接到互联网，另一个连接到内部局域网（LAN）。连接到LAN的每台设备应分配私有网络空间中的IP地址，如https://www.ietf.org/rfc/rfc1918.txt[RFC"
" 1918]所定义。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1418
#, fuzzy
msgid ""
"Some additional configuration is needed in order to enable the in-kernel NAT"
" facility of IPFW.  To enable in-kernel NAT support at boot time, the "
"following must be set in [.filename]#/etc/rc.conf#:"
msgstr ""
"为了启用IPFW内核中的NAT功能，需要进行一些额外的配置。要在引导时启用内核中的NAT支持，必须在/etc/rc.conf文件中设置以下内容："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1424
#, no-wrap
msgid ""
"gateway_enable=\"YES\"\n"
"firewall_enable=\"YES\"\n"
"firewall_nat_enable=\"YES\"\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1430
#, fuzzy
msgid ""
"When `firewall_nat_enable` is set but `firewall_enable` is not, it will have"
" no effect and do nothing.  This is because the in-kernel NAT implementation"
" is only compatible with IPFW."
msgstr ""
"当 `firewall_nat_enable` 被设置为 true, 但 `firewall_enable` "
"没有被设置时，它将无效并不会产生任何影响。这是因为内核中的网络地址转换（NAT）实现仅与 IPFW 兼容。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1437
#, fuzzy
msgid ""
"When the ruleset contains stateful rules, the positioning of the NAT rule is"
" critical and the `skipto` action is used.  The `skipto` action requires a "
"rule number so that it knows which rule to jump to.  The example below "
"builds upon the firewall ruleset shown in the previous section.  It adds "
"some additional entries and modifies some existing rules in order to "
"configure the firewall for in-kernel NAT.  It starts by adding some "
"additional variables which represent the rule number to skip to, the `keep-"
"state` option, and a list of TCP ports which will be used to reduce the "
"number of rules."
msgstr ""
"当规则集包含有状态的规则时，NAT规则的位置非常关键，这时我们可以使用`skipto`操作。`skipto`操作需要一个规则号，以便知道要跳转到哪个规则。下面的示例是基于前一节中显示的防火墙规则集构建的。它添加了一些额外的条目，并修改了一些现有的规则，以便配置内核级NAT防火墙。首先，添加一些额外的变量，这些变量表示要跳转到的规则号、`keep-"
"state`选项，以及用于减少规则数量的TCP端口列表。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1447
#, no-wrap
msgid ""
"#!/bin/sh\n"
"ipfw -q -f flush\n"
"cmd=\"ipfw -q add\"\n"
"skip=\"skipto 1000\"\n"
"pif=dc0\n"
"ks=\"keep-state\"\n"
"good_tcpo=\"22,25,37,53,80,443,110\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1452
#, fuzzy
msgid ""
"With in-kernel NAT it is necessary to disable TCP segmentation offloading "
"(TSO) due to the architecture of man:libalias[3], a library implemented as a"
" kernel module to provide the in-kernel NAT facility of IPFW.  TSO can be "
"disabled on a per network interface basis using man:ifconfig[8] or on a "
"system wide basis using man:sysctl[8].  To disable TSO system wide, the "
"following must be set it [.filename]#/etc/sysctl.conf#:"
msgstr ""
"使用内核内置的NAT功能时，由于内核模块man:libalias[3]的架构，需要禁用TCP分段卸载(TSO)。可以使用man:ifconfig[8]在每个网络接口上禁用TSO，也可以使用man:sysctl[8]在整个系统范围内禁用TSO。要在整个系统范围内禁用TSO，需要在文件#.filename#/etc/sysctl.conf#中进行以下设置："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1456
#, no-wrap
msgid "net.inet.tcp.tso=\"0\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1465
#, fuzzy
msgid ""
"A NAT instance will also be configured.  It is possible to have multiple NAT"
" instances each with their own configuration.  For this example only one NAT"
" instance is needed, NAT instance number 1.  The configuration can take a "
"few options such as: `if` which indicates the public interface, `same_ports`"
" which takes care that aliased ports and local port numbers are mapped the "
"same, `unreg_only` will result in only unregistered (private) address spaces"
" to be processed by the NAT instance, and `reset` which will help to keep a "
"functioning NAT instance even when the public IP address of the IPFW machine"
" changes.  For all possible options that can be passed to a single NAT "
"instance configuration consult man:ipfw[8].  When configuring a stateful "
"NATing firewall, it is necessary to allow translated packets to be "
"reinjected in the firewall for further processing.  This can be achieved by "
"disabling `one_pass` behavior at the start of the firewall script."
msgstr ""
"还将配置一个NAT实例。 可以有多个NAT实例，每个实例都有自己的配置。 在这个例子中只需要一个NAT实例，即NAT实例编号1。 配置可以有几个选项， "
"如“if”表示公共接口，“same_ports”则确保别名端口和本地端口号映射相同，“unreg_only”表示只处理未注册（私有）地址空间的NAT实例，“reset”将帮助在IPFW机器的公共IP地址更改时保持功能正常的NAT实例。"
" 有关可以传递给单个NAT实例配置的所有可选项，请参阅man命令：ipfw[8]。 "
"配置状态NAT防火墙时，有必要允许将翻译的数据包重新注入防火墙进行进一步处理。 可以通过在防火墙脚本开始时禁用“one_pass”行为来实现此目的。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1470
#, no-wrap
msgid ""
"ipfw disable one_pass\n"
"ipfw -q nat 1 config if $pif same_ports unreg_only reset\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1476
#, fuzzy
msgid ""
"The inbound NAT rule is inserted _after_ the two rules which allow all "
"traffic on the trusted and loopback interfaces and after the reassemble rule"
" but _before_ the `check-state` rule.  It is important that the rule number "
"selected for this NAT rule, in this example `100`, is higher than the first "
"three rules and lower than the `check-state` rule.  Furthermore, because of "
"the behavior of in-kernel NAT it is advised to place a reassemble rule just "
"before the first NAT rule and after the rules that allow traffic on trusted "
"interface.  Normally, IP fragmentation should not happen, but when dealing "
"with IPSEC/ESP/GRE tunneling traffic it might and the reassembling of "
"fragments is necessary before handing the complete packet over to the in-"
"kernel NAT facility."
msgstr ""
"入站NAT规则插入在允许可信和环回接口上的所有流量的两个规则之后，以及重组规则之后，但在\"check-"
"state\"规则之前。在此示例中，为该NAT规则选择的规则编号（例如100）应大于前三个规则，且小于\"check-"
"state\"规则。此外，由于内核NAT的行为，建议在第一个NAT规则之前和允许可信接口上的流量通过之后放置一个重组规则。通常情况下，不应该发生IP分片，但在处理IPSEC/ESP/GRE隧道流量时可能会发生，因此在将完整数据包交给内核NAT设备之前，需要对片段进行重新组装。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1480
#, fuzzy
msgid ""
"The reassemble rule was not needed with userland man:natd[8] because the "
"internal workings of the IPFW `divert` action already takes care of "
"reassembling packets before delivery to the socket as also stated in "
"man:ipfw[8]."
msgstr ""
"man:natd[8] 不需要 reassemble 规则，因为 IPFW 中的 \"divert\" "
"操作已经在将数据包传递到套接字之前负责重新组装数据包，这也在 man：ipfw[8] 中说明了。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1483
#, fuzzy
msgid ""
"The NAT instance and rule number used in this example does not match with "
"the default NAT instance and rule number created by "
"[.filename]#rc.firewall#.  [.filename]#rc.firewall# is a script that sets up"
" the default firewall rules present in FreeBSD."
msgstr ""
"在这个示例中使用的网络地址转换（NAT）实例和规则编号与由 [.filename]#rc.firewall# 创建的默认 NAT 实例和规则编号不匹配。"
" [.filename]#rc.firewall# 是一个设置在 FreeBSD 中存在的默认防火墙规则的脚本。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1493
#, no-wrap
msgid ""
"$cmd 005 allow all from any to any via xl0  # exclude LAN traffic\n"
"$cmd 010 allow all from any to any via lo0  # exclude loopback traffic\n"
"$cmd 099 reass all from any to any in       # reassemble inbound packets\n"
"$cmd 100 nat 1 ip from any to any in via $pif # NAT any inbound packets\n"
"# Allow the packet through if it has an existing entry in the dynamic rules table\n"
"$cmd 101 check-state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1497
#, fuzzy
msgid ""
"The outbound rules are modified to replace the `allow` action with the "
"`$skip` variable, indicating that rule processing will continue at rule "
"`1000`.  The seven `tcp` rules have been replaced by rule `125` as the "
"`$good_tcpo` variable contains the seven allowed outbound ports."
msgstr ""
"出站规则已被修改，将`allow`操作替换为`$skip`变量，表示规则处理将继续在规则`1000`处。七个`tcp`规则已被规则`125`替换，因为`$good_tcpo`变量包含了七个允许的出站端口。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1501
#, fuzzy
msgid ""
"Remember that IPFW's performance is largely determined by the number of "
"rules present in the ruleset."
msgstr "请记住，IPFW的性能在很大程度上取决于规则集中存在的规则数。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1510
#, no-wrap
msgid ""
"# Authorized outbound packets\n"
"$cmd 120 $skip udp from any to x.x.x.x 53 out via $pif $ks\n"
"$cmd 121 $skip udp from any to x.x.x.x 67 out via $pif $ks\n"
"$cmd 125 $skip tcp from any to any $good_tcpo out via $pif setup $ks\n"
"$cmd 130 $skip icmp from any to any out via $pif $ks\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1516
#, fuzzy
msgid ""
"The inbound rules remain the same, except for the very last rule which "
"removes the `via $pif` in order to catch both inbound and outbound rules.  "
"The NAT rule must follow this last outbound rule, must have a higher number "
"than that last rule, and the rule number must be referenced by the `skipto` "
"action.  In this ruleset, rule number `1000` handles passing all packets to "
"our configured instance for NAT processing.  The next rule allows any packet"
" which has undergone NAT processing to pass."
msgstr ""
"入站规则保持不变，除了最后一条规则，它移除了 `via "
"$pif`，以便捕获入站和出站规则。NAT规则必须跟随这个最后的出站规则，规则序号必须比最后一条规则的序号更高，并且规则序号必须被 `skipto` "
"操作所引用。在此规则集中，序号为 `1000` "
"的规则处理将所有数据包传递到我们配置的用于NAT处理的实例。下一个规则允许任何已经经过NAT处理的数据包通过。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1522
#, no-wrap
msgid ""
"$cmd 999 deny log all from any to any\n"
"$cmd 1000 nat 1 ip from any to any out via $pif # skipto location for outbound stateful rules\n"
"$cmd 1001 allow ip from any to any\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1525
#, fuzzy
msgid ""
"In this example, rules `100`, `101`, `125`, `1000`, and `1001` control the "
"address translation of the outbound and inbound packets so that the entries "
"in the dynamic state table always register the private LANIP address."
msgstr ""
"在这个例子中，规则 `100`，`101`，`125`，`1000` 和 `1001` "
"控制着出站和入站数据包的地址转换，以便动态状态表中的条目始终注册私有 LANIP 地址。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1537
#, fuzzy
msgid ""
"Consider an internal web browser which initializes a new outbound HTTP "
"session over port 80.  When the first outbound packet enters the firewall, "
"it does not match rule `100` because it is headed out rather than in.  It "
"passes rule `101` because this is the first packet and it has not been "
"posted to the dynamic state table yet.  The packet finally matches rule "
"`125` as it is outbound on an allowed port and has a source IP address from "
"the internal LAN.  On matching this rule, two actions take place.  First, "
"the `keep-state` action adds an entry to the dynamic state table and the "
"specified action, `skipto rule 1000`, is executed.  Next, the packet "
"undergoes NAT and is sent out to the Internet.  This packet makes its way to"
" the destination web server, where a response packet is generated and sent "
"back.  This new packet enters the top of the ruleset.  It matches rule `100`"
" and has its destination IP address mapped back to the original internal "
"address.  It then is processed by the `check-state` rule, is found in the "
"table as an existing session, and is released to the LAN."
msgstr ""
"考虑一个内部的网页浏览器，它在端口80上初始化一个新的出站HTTP会话。当第一个出站数据包进入防火墙时，它不匹配规则`100`，因为它是外出而不是进入。它通过规则`101`，因为这是第一个数据包，并且尚未被添加到动态状态表中。该数据包最终与规则`125`匹配，因为它是在允许的端口上出站，并具有来自内部局域网的源IP地址。匹配此规则后，执行两个操作。首先，`keep-"
"state`动作向动态状态表添加一个条目，并执行指定的动作`skipto rule "
"1000`。接下来，数据包经过NAT转换并发送到互联网。该数据包到达目标Web服务器，服务器生成并发送一个响应数据包。这个新数据包进入规则集的顶部。它匹配规则`100`，并将其目标IP地址映射回原始的内部地址。然后它被`check-"
"state`规则处理，作为一个现有的会话在表中找到，并释放到局域网。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1542
#, fuzzy
msgid ""
"On the inbound side, the ruleset has to deny bad packets and allow only "
"authorized services.  A packet which matches an inbound rule is posted to "
"the dynamic state table and the packet is released to the LAN.  The packet "
"generated as a response is recognized by the `check-state` rule as belonging"
" to an existing session.  It is then sent to rule `1000` to undergo NAT "
"before being released to the outbound interface."
msgstr ""
"在入站方面，规则集必须拒绝坏数据包并只允许授权的服务。符合入站规则的数据包将被发布到动态状态表中，并将数据包释放到局域网。作为响应生成的数据包将被`check-"
"state`规则识别为属于现有会话。然后，它将被发送到规则`1000`进行网络地址转换（NAT），然后释放到出站接口。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1550
#, fuzzy
msgid ""
"Transitioning from userland man:natd[8] to in-kernel NAT might appear "
"seamless at first but there is small catch.  When using the GENERIC kernel, "
"IPFW will load the [.filename]#libalias.ko# kernel module, when "
"`firewall_nat_enable` is enabled in [.filename]#/etc/rc.conf#.  The "
"[.filename]#libalias.ko# kernel module only provides basic NAT "
"functionality, whereas the userland implementation man:natd[8] has all NAT "
"functionality available in its userland library without any extra "
"configuration.  All functionality refers to the following kernel modules "
"that can additionally be loaded when needed besides the standard "
"[.filename]#libalias.ko# kernel module: [.filename]#alias_ftp.ko#, "
"[.filename]#alias_bbt.ko#, [.filename]#skinny.ko#, [.filename]#irc.ko#, "
"[.filename]#alias_pptp.ko# and [.filename]#alias_smedia.ko# using the "
"`kld_list` directive in [.filename]#/etc/rc.conf#.  If a custom kernel is "
"used, the full functionality of the userland library can be compiled in, in "
"the kernel, using the `options LIBALIAS`."
msgstr ""
"从用户空间的 man:natd[8] 迁移到内核级别的 NAT 可能一开始看起来是无缝的，但还有一个小问题。在使用 GENERIC 内核时，当 "
"[.filename]#/etc/rc.conf# 中启用 `firewall_nat_enable` 时，IPFW 将加载 "
"[.filename]#libalias.ko# 内核模块。但是 [.filename]#libalias.ko# 内核模块仅提供基本的 NAT "
"功能，而用户空间实现 man:natd[8] 在其用户空间库中提供了所有 NAT 功能，不需要任何额外配置。所有功能是指以下除了标准的 "
"[.filename]#libalias.ko# 内核模块之外，还可以根据需要加载的其他模块：[.filename]#alias_ftp.ko#, "
"[.filename]#alias_bbt.ko#, [.filename]#skinny.ko#, [.filename]#irc.ko#, "
"[.filename]#alias_pptp.ko# 和 [.filename]#alias_smedia.ko#，使用 "
"[.filename]#/etc/rc.conf# 中的 `kld_list` 指令。如果使用自定义内核，则可以使用 `options "
"LIBALIAS` 将用户空间库的完整功能编译到内核中。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1552
#, fuzzy, no-wrap
msgid "Port Redirection"
msgstr ""
"Port "
"Redirection（端口重定向）是一种网络通信的技术，它允许将接收到的数据流量从一个网络端口转发到另一个网络端口。通过端口重定向，可以将传入的网络请求导向到不同的目标端口，以实现网络流量的路由和转发。这种技术广泛应用于计算机网络的配置和网络服务的管理中，可以帮助管理员将特定端口上的流量重定向到不同的目标，以满足特定的需求和策略。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1558
#, fuzzy
msgid ""
"The drawback with NAT in general is that the LAN clients are not accessible "
"from the Internet.  Clients on the LAN can make outgoing connections to the "
"world but cannot receive incoming ones.  This presents a problem if trying "
"to run Internet services on one of the LAN client machines.  A simple way "
"around this is to redirect selected Internet ports on the NAT providing "
"machine to a LAN client."
msgstr ""
"NAT的一个缺点是LAN客户端无法从Internet访问。LAN上的客户端可以向外部建立连接，但无法接收内部连接。如果想要在LAN客户端机器上运行互联网服务，这就成了一个问题。一个简单的解决方法是将NAT提供设备上的特定互联网端口重定向到LAN客户端。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1561
#, fuzzy
msgid ""
"For example, an IRC server runs on client `A` and a web server runs on "
"client `B`.  For this to work properly, connections received on ports 6667 "
"(IRC) and 80 (HTTP) must be redirected to the respective machines."
msgstr ""
"例如，一个IRC服务器运行在客户端 `A` 上，一个web服务器运行在客户端 `B` "
"上。为了使其正常工作，收到的端口6667（IRC）和80（HTTP）的连接必须被重定向到相应的机器上。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1565
#, fuzzy
msgid ""
"With in-kernel NAT all configuration is done in the NAT instance "
"configuration.  For a full list of options that an in-kernel NAT instance "
"can use, consult man:ipfw[8].  The IPFW syntax follows the syntax of natd. "
"The syntax for `redirect_port` is as follows:"
msgstr ""
"使用内核级NAT时，所有的配置都是在NAT实例配置中完成的。对于内核级NAT实例可使用的所有选项的完整列表，请参阅man:ipfw[8]。IPFW语法遵循natd的语法。`redirect_port`的语法如下："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1571
#, no-wrap
msgid ""
"redirect_port proto targetIP:targetPORT[-targetPORT]\n"
"  [aliasIP:]aliasPORT[-aliasPORT]\n"
"  [remoteIP[:remotePORT[-remotePORT]]]\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1574
#, fuzzy
msgid "To configure the above example setup, the arguments should be:"
msgstr "要配置上述示例设置，参数应为："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1579
#, no-wrap
msgid ""
"redirect_port tcp 192.168.0.2:6667 6667\n"
"redirect_port tcp 192.168.0.3:80 80\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1582
#, fuzzy
msgid ""
"After adding these arguments to the configuration of NAT instance 1 in the "
"above ruleset, the TCP ports will be port forwarded to the LAN client "
"machines running the IRC and HTTP services."
msgstr "在上述规则集的NAT实例1的配置中添加这些参数后，TCP端口将被端口转发到运行IRC和HTTP服务的局域网客户端机器。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1588
#, no-wrap
msgid ""
"ipfw -q nat 1 config if $pif same_ports unreg_only reset \\\n"
"  redirect_port tcp 192.168.0.2:6667 6667 \\\n"
"  redirect_port tcp 192.168.0.3:80 80\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1592
#, fuzzy
msgid ""
"Port ranges over individual ports can be indicated with `redirect_port`.  "
"For example, _tcp 192.168.0.2:2000-3000 2000-3000_ would redirect all "
"connections received on ports 2000 to 3000 to ports 2000 to 3000 on client "
"`A`."
msgstr ""
"`redirect_port` 可以用于指示端口范围，而不仅仅是单个端口。例如，`_tcp 192.168.0.2:2000-3000 "
"2000-3000_` 将会把所有在端口2000到3000上收到的连接重定向到客户端 `A` 上的端口2000到3000。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1593
#, fuzzy, no-wrap
msgid "Address Redirection"
msgstr "地址重定向"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1599
#, fuzzy
msgid ""
"Address redirection is useful if more than one IP address is available.  "
"Each LAN client can be assigned its own external IP address by man:ipfw[8], "
"which will then rewrite outgoing packets from the LAN clients with the "
"proper external IP address and redirects all traffic incoming on that "
"particular IP address back to the specific LAN client.  This is also known "
"as static NAT.  For example, if IP addresses `128.1.1.1`, `128.1.1.2`, and "
"`128.1.1.3` are available, `128.1.1.1` can be used as the man:ipfw[8] "
"machine's external IP address, while `128.1.1.2` and `128.1.1.3` are "
"forwarded back to LAN clients `A` and `B`."
msgstr ""
"地址转发在多个IP地址可用时非常有用。每个局域网客户端可以通过man:ipfw[8]被分配自己的外部IP地址，然后man:ipfw[8]将重写来自局域网客户端的出站数据包以正确的外部IP地址，并将所有流入特定IP地址的流量重定向回相应的局域网客户端。这也被称为静态NAT。例如，如果可用的IP地址是`128.1.1.1`、`128.1.1.2`和`128.1.1.3`，则`128.1.1.1`可以用作man:ipfw[8]机器的外部IP地址，而`128.1.1.2`和`128.1.1.3`则被转发回局域网客户端`A`和`B`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1601
#, fuzzy
msgid ""
"The `redirect_addr` syntax is as below, where `localIP` is the internal IP "
"address of the LAN client, and `publicIP` the external IP address "
"corresponding to the LAN client."
msgstr ""
"`redirect_addr` 的语法如下所示，其中 `localIP` 是局域网客户端的内部 IP 地址，`publicIP` "
"则是对应于局域网客户端的外部 IP 地址。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1605
#, no-wrap
msgid "redirect_addr localIP publicIP\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1608
#, fuzzy
msgid "In the example, the arguments would read:"
msgstr "在这个例子中，参数将会读取："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1613
#, no-wrap
msgid ""
"redirect_addr 192.168.0.2 128.1.1.2\n"
"redirect_addr 192.168.0.3 128.1.1.3\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1617
#, fuzzy
msgid ""
"Like `redirect_port`, these arguments are placed in a NAT instance "
"configuration.  With address redirection, there is no need for port "
"redirection, as all data received on a particular IP address is redirected."
msgstr ""
"像`redirect_port`一样，这些参数都被放置在NAT实例的配置中。通过地址重定向，不需要进行端口重定向，因为所有接收到的特定IP地址的数据都会被重定向。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1620
#, fuzzy
msgid ""
"The external IP addresses on the man:ipfw[8] machine must be active and "
"aliased to the external interface.  Refer to man:rc.conf[5] for details."
msgstr "man:ipfw[8]机器上的外部IP地址必须处于活动状态，并且要别名到外部接口。详细信息请参考 man:rc.conf[5]。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1621
#, fuzzy, no-wrap
msgid "Userspace NAT"
msgstr "用户空间NAT（Network Address Translation）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1625
#, fuzzy
msgid ""
"Let us start with a statement: the userspace NAT implementation: "
"man:natd[8], has more overhead than in-kernel NAT.  For man:natd[8] to "
"translate packets, the packets have to be copied from the kernel to "
"userspace and back which brings in extra overhead that is not present with "
"in-kernel NAT."
msgstr ""
"让我们从一个陈述开始：用户空间的网络地址转换（NAT）实现 man:natd[8] 比内核中的 NAT 有更多的开销。为了让 man:natd[8] "
"转换数据包，数据包必须从内核复制到用户空间，然后再返回，这带来了额外的开销，而内核中的 NAT 则不存在这个问题。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1629
#, fuzzy
msgid ""
"To enable the userpace NAT daemon man:natd[8] at boot time, the following is"
" a minimum configuration in [.filename]#/etc/rc.conf#.  Where "
"`natd_interface` is set to the name of the NIC attached to the Internet.  "
"The man:rc[8] script of man:natd[8] will automatically check if a dynamic IP"
" address is used and configure itself to handle that."
msgstr ""
"为了在启动时启用用户空间的NAT守护进程`natd`[8]，下面是一个在`/etc/rc.conf`中的最小配置。其中，`natd_interface`被设置为连接到互联网的网络接口的名称。`natd`[8]的`rc`[8]脚本将自动检查是否使用了动态IP地址，并配置自身来处理它。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1635
#, no-wrap
msgid ""
"gateway_enable=\"YES\"\n"
"natd_enable=\"YES\"\n"
"natd_interface=\"rl0\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1640
#, fuzzy
msgid ""
"In general, the above ruleset as explained for in-kernel NAT can also be "
"used together with man:natd[8].  The exceptions are the configuration of the"
" in-kernel NAT instance `(ipfw -q nat 1 config ...)` which is not needed "
"together with reassemble rule 99 because its functionality is included in "
"the `divert` action.  Rule number 100 and 1000 will have to change sligthly "
"as shown below."
msgstr ""
"总的来说，上述规则集如同内核NAT中所解释的那样，也可以与man:natd[8]一起使用。唯一的例外是内核NAT实例的配置`(ipfw -q nat 1"
" config "
"...)`，与重组规则99一起使用时不需要，因为其功能已经包含在`divert`操作中。规则号码100和1000将需要稍作修改，如下所示。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1645
#, no-wrap
msgid ""
"$cmd 100 divert natd ip from any to any in via $pif\n"
"$cmd 1000 divert natd ip from any to any out via $pif\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1650
#, fuzzy
msgid ""
"To configure port or address redirection, a similar syntax as with in-kernel"
" NAT is used.  Although, now, instead of specifying the configuration in our"
" ruleset script like with in-kernel NAT, configuration of man:natd[8] is "
"best done in a configuration file.  To do this, an extra flag must be passed"
" via [.filename]#/etc/rc.conf# which specifies the path of the configuration"
" file."
msgstr ""
"要配置端口或地址重定向，使用的是类似于内核NAT的语法。但是，现在，与内核NAT不同的是，man:natd[8]的配置最好在一个配置文件中完成，而不是在规则脚本中指定配置。为了做到这点，必须通过[.filename]#/etc/rc.conf#传递一个额外的标志，指定配置文件的路径。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1654
#, no-wrap
msgid "natd_flags=\"-f /etc/natd.conf\"\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1661
#, fuzzy
msgid ""
"The specified file must contain a list of configuration options, one per "
"line.  For more information about the configuration file and possible "
"variables, consult man:natd[8].  Below are two example entries, one per "
"line:"
msgstr ""
"指定的文件必须包含一行一个的配置选项列表。有关配置文件和可能的变量的更多信息，请参阅 man:natd[8]。以下是两个示例条目，每行一个："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1666
#, no-wrap
msgid ""
"redirect_port tcp 192.168.0.2:6667 6667\n"
"redirect_addr 192.168.0.3 128.1.1.3\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1671
#, fuzzy, no-wrap
msgid "The IPFW Command"
msgstr "IPFW命令"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1676
#, fuzzy
msgid ""
"`ipfw` can be used to make manual, single rule additions or deletions to the"
" active firewall while it is running.  The problem with using this method is"
" that all the changes are lost when the system reboots.  It is recommended "
"to instead write all the rules in a file and to use that file to load the "
"rules at boot time and to replace the currently running firewall rules "
"whenever that file changes."
msgstr ""
"在运行过程中，可以使用 `ipfw` "
"对活动防火墙进行手动的单一规则添加或删除。使用这种方法的问题是，当系统重新启动时，所有的更改都会丢失。建议的做法是将所有的规则写入一个文件，并在启动时使用该文件加载规则，并在文件更改时替换当前运行的防火墙规则。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1680
#, fuzzy
msgid ""
"`ipfw` is a useful way to display the running firewall rules to the console "
"screen.  The IPFW accounting facility dynamically creates a counter for each"
" rule that counts each packet that matches the rule.  During the process of "
"testing a rule, listing the rule with its counter is one way to determine if"
" the rule is functioning as expected."
msgstr ""
"`ipfw` 是一种将运行中的防火墙规则显示到控制台屏幕上的有用方法。IPFW "
"账户设施会为每个规则动态创建一个计数器，用于计算与规则匹配的每个数据包。在测试规则的过程中，将规则与其计数器一起列出是确定规则是否按预期工作的一种方法。"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1682
#, fuzzy
msgid "To list all the running rules in sequence:"
msgstr "列出所有按顺序运行的规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1686
#, no-wrap
msgid "# ipfw list\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1689
#, fuzzy
msgid ""
"To list all the running rules with a time stamp of when the last time the "
"rule was matched:"
msgstr "列出所有正在运行的规则，并显示规则最后匹配时间的时间戳："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1693
#, no-wrap
msgid "# ipfw -t list\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1697
#, fuzzy
msgid ""
"The next example lists accounting information and the packet count for "
"matched rules along with the rules themselves.  The first column is the rule"
" number, followed by the number of matched packets and bytes, followed by "
"the rule itself."
msgstr "下面的示例列出了匹配规则的会计信息和数据包计数，以及规则本身。第一列是规则编号，之后是匹配的数据包数量和字节数，最后是规则本身。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1701
#, no-wrap
msgid "# ipfw -a list\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1704
#, fuzzy
msgid "To list dynamic rules in addition to static rules:"
msgstr "要列出动态规则以及静态规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1708
#, no-wrap
msgid "# ipfw -d list\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1711
#, fuzzy
msgid "To also show the expired dynamic rules:"
msgstr "为了显示已过期的动态规则:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1715
#, no-wrap
msgid "# ipfw -d -e list\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1718
#, fuzzy
msgid "To zero the counters:"
msgstr "将计数器归零："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1722
#, no-wrap
msgid "# ipfw zero\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1725
#, fuzzy
msgid "To zero the counters for just the rule with number _NUM_:"
msgstr "将编号为_NUM_的规则的计数器归零："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1729
#, no-wrap
msgid "# ipfw zero NUM\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1731
#, fuzzy, no-wrap
msgid "Logging Firewall Messages"
msgstr ""
"记录防火墙消息\n"
"\n"
"== Introduction\n"
"\n"
"A firewall is a network security device that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between an organization's internal network and the external network, such as the Internet. To provide effective network security, firewalls often generate log messages that record various events and activities.\n"
"\n"
"== Importance of Logging Firewall Messages\n"
"\n"
"Logging firewall messages is essential for monitoring and troubleshooting network security issues. By analyzing these log messages, administrators can:\n"
"- Identify and analyze potential security threats or vulnerabilities\n"
"- Detect any unauthorized access attempts or suspicious activities\n"
"- Investigate network incidents or breaches\n"
"- Monitor network traffic patterns and identify any abnormal behavior\n"
"- Ensure compliance with security policies and regulations\n"
"\n"
"== Common Firewall Log Messages\n"
"\n"
"Firewall log messages can provide valuable information about network traffic, security events, and system conditions. Some common types of firewall log messages include:\n"
"\n"
"1. Deny or Allow Messages\n"
"- \"Deny\" messages indicate that the firewall has blocked a specific network connection or traffic.\n"
"- \"Allow\" messages indicate that the firewall has permitted a specific network connection or traffic.\n"
"\n"
"2. Source and Destination IP Addresses\n"
"- Firewall log messages often include the source and destination IP addresses involved in a network connection.\n"
"\n"
"3. Port Numbers\n"
"- Log messages may include the port numbers associated with network connections, such as the source and destination ports.\n"
"\n"
"4. Protocol Information\n"
"- Firewall logs may provide information about the protocols used in network connections, such as TCP, UDP, or ICMP.\n"
"\n"
"5. Timestamps\n"
"- Log messages typically include timestamps to record when certain events occurred.\n"
"\n"
"== Conclusion\n"
"\n"
"Logging firewall messages is a critical aspect of network security management. By analyzing these log messages, organizations can proactively detect and respond to potential security threats, ensuring the overall integrity and confidentiality of their computer networks."

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1738
#, fuzzy
msgid ""
"Even with the logging facility enabled, IPFW will not generate any rule "
"logging on its own.  The firewall administrator decides which rules in the "
"ruleset will be logged, and adds the `log` keyword to those rules.  Normally"
" only deny rules are logged.  It is customary to duplicate the \"ipfw "
"default deny everything\" rule with the `log` keyword included as the last "
"rule in the ruleset.  This way, it is possible to see all the packets that "
"did not match any of the rules in the ruleset."
msgstr ""
"即使启用了日志功能，IPFW 也不会自动产生任何规则日志。防火墙管理员决定哪些规则会被记录，并在这些规则中添加 `log` "
"关键字。通常只有拒绝规则会被记录。惯例上，在规则集中将“ipfw 默认拒绝一切”的规则复制一份，并作为规则集中的最后一条规则添加 `log` "
"关键字。这样，就可以查看所有未匹配规则集中任何规则的数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1742
#, fuzzy
msgid ""
"Logging is a two edged sword.  If one is not careful, an over abundance of "
"log data or a DoS attack can fill the disk with log files.  Log messages are"
" not only written to syslogd, but also are displayed on the root console "
"screen and soon become annoying."
msgstr ""
"日志是一把双刃剑。如果不小心处理，过多的日志数据或者拒绝服务（DoS）攻击会导致磁盘被日志文件填满。日志消息不仅会被写入syslogd，还会显示在root控制台屏幕上，很快会变得非常烦人。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1747
#, fuzzy
msgid ""
"The `IPFIREWALL_VERBOSE_LIMIT=5` kernel option limits the number of "
"consecutive messages sent to man:syslogd[8], concerning the packet matching "
"of a given rule.  When this option is enabled in the kernel, the number of "
"consecutive messages concerning a particular rule is capped at the number "
"specified.  There is nothing to be gained from 200 identical log messages.  "
"With this option set to five, five consecutive messages concerning a "
"particular rule would be logged to syslogd and the remainder identical "
"consecutive messages would be counted and posted to syslogd with a phrase "
"like the following:"
msgstr ""
"`IPFIREWALL_VERBOSE_LIMIT=5`内核选项限制了发送给man:syslogd[8]的关于给定规则的数据包匹配的连续消息的数量。当在内核中启用此选项时，关于特定规则的连续消息的数量被限制为指定的数量。对于200条相同的日志消息，没有任何好处。将此选项设置为5后，将会在syslogd中记录5条关于特定规则的连续消息，而其余相同的连续消息将被计数并以以下的短语发布到syslogd中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1751
#, no-wrap
msgid "last message repeated 45 times\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1754
#, fuzzy
msgid ""
"All logged packets messages are written by default to "
"[.filename]#/var/log/security#, which is defined in "
"[.filename]#/etc/syslog.conf#."
msgstr ""
"所有登录的数据包消息默认写入到[.filename]#/var/log/security#，该路径在[.filename]#/etc/syslog.conf#中定义。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1756
#, fuzzy, no-wrap
msgid "Building a Rule Script"
msgstr ""
"构建规则脚本\n"
"\n"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1762
#, fuzzy
msgid ""
"Most experienced IPFW users create a file containing the rules and code them"
" in a manner compatible with running them as a script.  The major benefit of"
" doing this is the firewall rules can be refreshed in mass without the need "
"of rebooting the system to activate them.  This method is convenient in "
"testing new rules as the procedure can be executed as many times as needed."
"  Being a script, symbolic substitution can be used for frequently used "
"values to be substituted into multiple rules."
msgstr ""
"大多数经验丰富的IPFW用户会创建一个包含规则的文件，并以适合作为脚本运行的方式编写它们。这样做的主要好处是防火墙规则可以批量刷新，无需重新启动系统来激活它们。这种方法在测试新规则时非常方便，因为可以根据需要执行该过程多次。作为脚本，可以使用符号替换来将常用的值替换为多个规则中的值。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1767
#, fuzzy
msgid ""
"This example script is compatible with the syntax used by the man:sh[1], "
"man:csh[1], and man:tcsh[1] shells.  Symbolic substitution fields are "
"prefixed with a dollar sign ($).  Symbolic fields do not have the $ prefix."
"  The value to populate the symbolic field must be enclosed in double quotes"
" (\"\")."
msgstr ""
"该示例脚本适用于 man:sh[1]、man:csh[1] 和 man:tcsh[1] shell "
"使用的语法。符号替换字段以美元符号（$）作为前缀。符号字段没有$前缀。用于填充符号字段的值必须用双引号（\"\"）括起来。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1769
#, fuzzy
msgid "Start the rules file like this:"
msgstr "像这样开始规则文件："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1787
#, no-wrap
msgid ""
"############### start of example ipfw rules script #############\n"
"#\n"
"ipfw -q -f flush       # Delete all rules\n"
"# Set defaults\n"
"oif=\"tun0\"             # out interface\n"
"odns=\"192.0.2.11\"      # ISP's DNS server IP address\n"
"cmd=\"ipfw -q add \"     # build rule prefix\n"
"ks=\"keep-state\"        # just too lazy to key this each time\n"
"$cmd 00500 check-state\n"
"$cmd 00502 deny all from any to any frag\n"
"$cmd 00501 deny tcp from any to any established\n"
"$cmd 00600 allow tcp from any to any 80 out via $oif setup $ks\n"
"$cmd 00610 allow tcp from any to $odns 53 out via $oif setup $ks\n"
"$cmd 00611 allow udp from any to $odns 53 out via $oif $ks\n"
"################### End of example ipfw rules script ############\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1790
#, fuzzy
msgid ""
"The rules are not important as the focus of this example is how the symbolic"
" substitution fields are populated."
msgstr "规则并不重要，因为这个例子的重点是如何填充符号替代字段。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1792
#, fuzzy
msgid ""
"If the above example was in [.filename]#/etc/ipfw.rules#, the rules could be"
" reloaded by the following command:"
msgstr "如果上面的示例在 [.filename]#/etc/ipfw.rules# 中，可以通过以下命令重新加载规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1796
#, no-wrap
msgid "# sh /etc/ipfw.rules\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1799
#, fuzzy
msgid ""
"[.filename]#/etc/ipfw.rules# can be located anywhere and the file can have "
"any name."
msgstr "[.filename]#/etc/ipfw.rules# 可以位于任何位置，文件的名称可以是任意的。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1801
#, fuzzy
msgid ""
"The same thing could be accomplished by running these commands by hand:"
msgstr "同样的事情也可以通过手动运行这些命令来实现："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1811
#, no-wrap
msgid ""
"# ipfw -q -f flush\n"
"# ipfw -q add check-state\n"
"# ipfw -q add deny all from any to any frag\n"
"# ipfw -q add deny tcp from any to any established\n"
"# ipfw -q add allow tcp from any to any 80 out via tun0 setup keep-state\n"
"# ipfw -q add allow tcp from any to 192.0.2.11 53 out via tun0 setup keep-state\n"
"# ipfw -q add 00611 allow udp from any to 192.0.2.11 53 out via tun0 keep-state\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1814
#, fuzzy, no-wrap
msgid "IPFW Kernel Options"
msgstr "IPFW 内核选项"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1818
#, fuzzy
msgid ""
"In order to statically compile IPFW support into a custom kernel, refer to "
"the instructions in crossref:kernelconfig[kernelconfig,Configuring the "
"FreeBSD Kernel].  The following options are available for the custom kernel "
"configuration file:"
msgstr ""
"为了将IPFW支持静态编译到自定义内核中，请参考crossref:kernelconfig[kernelconfig,配置FreeBSD内核]中的指令。对于自定义内核配置文件，有以下选项可供选择："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1831
#, no-wrap
msgid ""
"options    IPFIREWALL\t\t\t# enables IPFW\n"
"options    IPFIREWALL_VERBOSE\t\t# enables logging for rules with log keyword to syslogd(8)\n"
"options    IPFIREWALL_VERBOSE_LIMIT=5\t# limits number of logged packets per-entry\n"
"options    IPFIREWALL_DEFAULT_TO_ACCEPT # sets default policy to pass what is not explicitly denied\n"
"options    IPFIREWALL_NAT\t\t# enables basic in-kernel NAT support\n"
"options    LIBALIAS\t\t\t# enables full in-kernel NAT support\n"
"options    IPFIREWALL_NAT64\t\t# enables in-kernel NAT64 support\n"
"options    IPFIREWALL_NPTV6\t\t# enables in-kernel IPv6 NPT support\n"
"options    IPFIREWALL_PMOD\t\t# enables protocols modification module support\n"
"options    IPDIVERT\t\t\t# enables NAT through natd(8)\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1836
#, fuzzy
msgid ""
"IPFW can be loaded as a kernel module: options above are built by default as"
" modules or can be set at runtime using tunables."
msgstr "IPFW 可以作为内核模块加载：上述选项默认情况下作为模块构建，或者可以在运行时使用可调节项进行设置。"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1839
#, fuzzy, no-wrap
msgid "IPFILTER (IPF)"
msgstr ""
"IPFILTER（也称为IPF）是一种在计算机网络上进行过滤和防火墙操作的软件。它可以根据特定规则对传入和传出的数据包进行处理，以实现网络安全和访问控制。IPFILTER是一个开源项目，被广泛地用于各种操作系统和网络设备中。它提供了一系列功能和选项，使管理员能够配置和管理网络的访问策略。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1842
#, fuzzy
msgid ""
"IPFILTER, also known as IPF, is a cross-platform, open source firewall which"
" has been ported to several operating systems, including FreeBSD, NetBSD, "
"OpenBSD, and Solaris(TM)."
msgstr ""
"IPFILTER，也称为IPF，是一个跨平台、开源的防火墙，已经移植到多个操作系统上，包括FreeBSD、NetBSD、OpenBSD和Solaris(TM)。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1845
#, fuzzy
msgid ""
"IPFILTER is a kernel-side firewall and NAT mechanism that can be controlled "
"and monitored by userland programs.  Firewall rules can be set or deleted "
"using ipf, NAT rules can be set or deleted using ipnat, run-time statistics "
"for the kernel parts of IPFILTER can be printed using ipfstat, and ipmon can"
" be used to log IPFILTER actions to the system log files."
msgstr ""
"IPFILTER 是一个位于内核的防火墙和网络地址转换（NAT）机制，可以由用户程序进行控制和监控。可以使用 ipf 设置或删除防火墙规则，使用 "
"ipnat 设置或删除 NAT 规则，使用 ipfstat 打印 IPFILTER 内核部分的运行时统计信息，并使用 ipmon 将 IPFILTER "
"的操作记录到系统日志文件中。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1848
#, fuzzy
msgid ""
"IPF was originally written using a rule processing logic of \"the last "
"matching rule wins\" and only used stateless rules.  Since then, IPF has "
"been enhanced to include the `quick` and `keep state` options."
msgstr ""
"IPF最初使用的是“最后匹配规则获胜”的规则处理逻辑，只使用无状态规则。此后，IPF已经增强，包括了`quick`和`keep state`选项。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1851
#, fuzzy
msgid ""
"The IPF FAQ is at "
"http://www.phildev.net/ipf/index.html[http://www.phildev.net/ipf/index.html]."
"  A searchable archive of the IPFilter mailing list is available at "
"http://marc.info/?l=ipfilter[http://marc.info/?l=ipfilter]."
msgstr ""
"IPFilter 常见问题解答位于 "
"http://www.phildev.net/ipf/index.html[http://www.phildev.net/ipf/index.html]。可以在"
" http://marc.info/?l=ipfilter[http://marc.info/?l=ipfilter] 上搜索 IPFilter "
"邮件列表的归档。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1854
#, fuzzy
msgid ""
"This section of the Handbook focuses on IPF as it pertains to FreeBSD.  It "
"provides examples of rules that contain the `quick` and `keep state` "
"options."
msgstr "本手册的这一部分重点介绍了与FreeBSD相关的IPF。它提供了包含`quick`和`keep state`选项的规则示例。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1855
#, fuzzy, no-wrap
msgid "Enabling IPF"
msgstr "启用IPF"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1858
#, fuzzy
msgid ""
"IPF is included in the basic FreeBSD install as a kernel loadable module, "
"meaning that a custom kernel is not needed in order to enable IPF."
msgstr "IPF被包含在基本的FreeBSD安装中作为一个可加载的内核模块，这意味着不需要定制内核就可以启用IPF。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1861
#, fuzzy
msgid ""
"For users who prefer to statically compile IPF support into a custom kernel,"
" refer to the instructions in crossref:kernelconfig[kernelconfig,Configuring"
" the FreeBSD Kernel].  The following kernel options are available:"
msgstr ""
"对于喜欢将IPF支持静态编译到自定义内核中的用户，请参考crossref:kernelconfig[Configuring the FreeBSD "
"Kernel]中的指示。以下内核选项可供选择："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1868
#, no-wrap
msgid ""
"options IPFILTER\n"
"options IPFILTER_LOG\n"
"options IPFILTER_LOOKUP\n"
"options IPFILTER_DEFAULT_BLOCK\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1871
#, fuzzy
msgid ""
"where `options IPFILTER` enables support for IPFILTER, `options "
"IPFILTER_LOG` enables IPF logging using the [.filename]#ipl# packet logging "
"pseudo-device for every rule that has the `log` keyword, `IPFILTER_LOOKUP` "
"enables IP pools in order to speed up IP lookups, and `options "
"IPFILTER_DEFAULT_BLOCK` changes the default behavior so that any packet not "
"matching a firewall `pass` rule gets blocked."
msgstr ""
"其中 `options IPFILTER` 启用了对 IPFILTER 的支持，`options IPFILTER_LOG` 启用了使用 "
"[.filename]#ipl# 伪设备进行 IPF 记录日志的功能，对于每个具有 `log` 关键字的规则，`IPFILTER_LOOKUP` 启用了"
" IP 池以加速 IP 查找，而 `options IPFILTER_DEFAULT_BLOCK` 更改了默认行为，使得不符合防火墙 `pass` "
"规则的任何数据包都被阻塞。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1875
#, fuzzy
msgid ""
"To configure the system to enable IPF at boot time, add the following "
"entries to [.filename]#/etc/rc.conf#.  These entries will also enable "
"logging and `default pass all`.  To change the default policy to `block all`"
" without compiling a custom kernel, remember to add a `block all` rule at "
"the end of the ruleset."
msgstr ""
"要在启动时配置系统以启用IPF，请将以下条目添加到 [.filename]#/etc/rc.conf#。这些条目还将启用日志记录和`default "
"pass all`。要将默认策略更改为`block all`而不编译自定义内核，请记住在规则集的末尾添加一个`block all`规则。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1886
#, no-wrap
msgid ""
"ipfilter_enable=\"YES\"             # Start ipf firewall\n"
"ipfilter_rules=\"/etc/ipf.rules\"   # loads rules definition text file\n"
"ipv6_ipfilter_rules=\"/etc/ipf6.rules\" # loads rules definition text file for IPv6\n"
"ipmon_enable=\"YES\"                # Start IP monitor log\n"
"ipmon_flags=\"-Ds\"                 # D = start as daemon\n"
"                                  # s = log to syslog\n"
"                                  # v = log tcp window, ack, seq\n"
"                                  # n = map IP & port to names\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1889
#, fuzzy
msgid "If NAT functionality is needed, also add these lines:"
msgstr "如果需要NAT功能，还需添加以下这些行："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1895
#, no-wrap
msgid ""
"gateway_enable=\"YES\"              # Enable as LAN gateway\n"
"ipnat_enable=\"YES\"                # Start ipnat function\n"
"ipnat_rules=\"/etc/ipnat.rules\"    # rules definition file for ipnat\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1898
#, fuzzy
msgid "Then, to start IPF now:"
msgstr "然后，现在要启动IPF："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1902
#, no-wrap
msgid "#  service ipfilter start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1906
#, fuzzy
msgid ""
"To load the firewall rules, specify the name of the ruleset file using "
"`ipf`.  The following command can be used to replace the currently running "
"firewall rules:"
msgstr "要加载防火墙规则，请使用 `ipf` 指定规则集文件的名称。以下命令可用于替换当前运行的防火墙规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1910
#, no-wrap
msgid "# ipf -Fa -f /etc/ipf.rules\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1913
#, fuzzy
msgid ""
"where `-Fa` flushes all the internal rules tables and `-f` specifies the "
"file containing the rules to load."
msgstr "其中，`-Fa` 会清除所有内部规则表，而 `-f` 则指定了包含规则的文件进行加载。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1916
#, fuzzy
msgid ""
"This provides the ability to make changes to a custom ruleset and update the"
" running firewall with a fresh copy of the rules without having to reboot "
"the system.  This method is convenient for testing new rules as the "
"procedure can be executed as many times as needed."
msgstr ""
"这提供了在不重启系统的情况下对自定义规则集进行更改，并使用最新的规则副本更新正在运行的防火墙的能力。这种方法方便测试新规则，因为可以按需执行该过程多次。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1918
#, fuzzy
msgid ""
"Refer to man:ipf[8] for details on the other flags available with this "
"command."
msgstr "详细了解此命令的其他标志，请参考man:ipf[8]。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1919
#, fuzzy, no-wrap
msgid "IPF Rule Syntax"
msgstr "IPF Rule Syntax（IPF 规则语法）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1925
#, fuzzy
msgid ""
"This section describes the IPF rule syntax used to create stateful rules.  "
"When creating rules, keep in mind that unless the `quick` keyword appears in"
" a rule, every rule is read in order, with the _last matching rule_ being "
"the one that is applied.  This means that even if the first rule to match a "
"packet is a `pass`, if there is a later matching rule that is a `block`, the"
" packet will be dropped.  Sample rulesets can be found in "
"[.filename]#/usr/share/examples/ipfilter#."
msgstr ""
"本节描述了用于创建有状态规则的 IPF 规则语法。在创建规则时，请记住，除非规则中出现 `quick` "
"关键字，否则每条规则都按顺序读取，并应用_最后一个匹配的规则_。这意味着，即使第一条匹配数据包的规则是 `pass`，如果后面还有匹配的 `block`"
" 规则，数据包将会被丢弃。示例规则集可在 [.filename]#/usr/share/examples/ipfilter# 找到。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1928
#, fuzzy
msgid ""
"When creating rules, a `+#+` character is used to mark the start of a "
"comment and may appear at the end of a rule, to explain that rule's "
"function, or on its own line.  Any blank lines are ignored."
msgstr ""
"创建规则时，使用 `+#+` 字符来标记注释的开始，并且可以出现在规则的末尾，来解释该规则的功能，或者出现在独立的一行上。任何空行都会被忽略。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1933
#, fuzzy
msgid ""
"The keywords which are used in rules must be written in a specific order, "
"from left to right.  Some keywords are mandatory while others are optional."
"  Some keywords have sub-options which may be keywords themselves and also "
"include more sub-options.  The keyword order is as follows, where the words "
"shown in uppercase represent a variable and the words shown in lowercase "
"must precede the variable that follows it:"
msgstr ""
"规则中使用的关键字必须按照特定的顺序从左到右进行编写。一些关键字是必需的，而其他一些关键字是可选的。一些关键字具有子选项，这些子选项可能是关键字本身，并且还包含更多的子选项。关键字的顺序如下所示，大写字母表示变量，小写字母表示必须在其后出现的变量的前面："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1935
#, fuzzy
msgid ""
"`_ACTION DIRECTION OPTIONS proto PROTO_TYPE from SRC_ADDR SRC_PORT to "
"DST_ADDR DST_PORT TCP_FLAG|ICMP_TYPE keep state STATE_`"
msgstr ""
"`_ACTION DIRECTION OPTIONS proto PROTO_TYPE from SRC_ADDR SRC_PORT to DST_ADDR DST_PORT TCP_FLAG|ICMP_TYPE keep state STATE_`\n"
"\n"
"`_ACTION_`, `_DIRECTION_`, `_OPTIONS_`, `proto`, `PROTO_TYPE`, `from`, `SRC_ADDR`, `SRC_PORT`, `to`, `DST_ADDR`, `DST_PORT`, `TCP_FLAG`, `ICMP_TYPE`, `keep`, `state`, `STATE_`"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1939
#, fuzzy
msgid ""
"This section describes each of these keywords and their options.  It is not "
"an exhaustive list of every possible option.  Refer to man:ipf[5] for a "
"complete description of the rule syntax that can be used when creating IPF "
"rules and examples for using each keyword."
msgstr ""
"本节描述了每个关键字以及它们的选项。这不是一个列举所有可能选项的详尽清单。有关创建IPF规则时可以使用的规则语法及使用每个关键字的示例的完整描述，请参阅man:ipf[5]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1944
#, fuzzy
msgid ""
"The action keyword indicates what to do with the packet if it matches that "
"rule.  Every rule _must_ have an action.  The following actions are "
"recognized:"
msgstr "action关键字 表示如果数据包与该规则匹配，要采取的操作。每个规则必须有一个操作。以下操作被识别："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1946
#, fuzzy
msgid "`block`: drops the packet."
msgstr "`block`：丢弃该数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1948
#, fuzzy
msgid "`pass`: allows the packet."
msgstr "`pass`：允许数据包通过。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1950
#, fuzzy
msgid "`log`: generates a log record."
msgstr "`log`：生成一条日志记录。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1952
#, fuzzy
msgid ""
"`count`: counts the number of packets and bytes which can provide an "
"indication of how often a rule is used."
msgstr "`count`: 统计数据包和字节数的数量，可以提供规则使用频率的指示。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1954
#, fuzzy
msgid "`auth`: queues the packet for further processing by another program."
msgstr "`auth`: 将数据包排队，以供其他程序进一步处理。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1956
#, fuzzy
msgid ""
"`call`: provides access to functions built into IPF that allow more complex "
"actions."
msgstr "`call`：提供对内置于 IPF 中的函数的访问，允许进行更复杂的操作。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1958
#, fuzzy
msgid ""
"`decapsulate`: removes any headers in order to process the contents of the "
"packet."
msgstr "`decapsulate`：移除任何头部以便处理数据包的内容。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1959
#, fuzzy, no-wrap
msgid "DIRECTION"
msgstr "方向"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1961
#, fuzzy
msgid ""
"Next, each rule must explicitly state the direction of traffic using one of "
"these keywords:"
msgstr "接下来，每条规则必须明确指定流量方向，使用以下关键字之一："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1963
#, fuzzy
msgid "`in`: the rule is applied against an inbound packet."
msgstr "`in`: 规则应用于传入的数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1965
#, fuzzy
msgid "`out`: the rule is applied against an outbound packet."
msgstr "`out`: 此规则适用于出站数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1967
#, fuzzy
msgid "`all`: the rule applies to either direction."
msgstr "`all`: 这个规则适用于两个方向。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1969
#, fuzzy
msgid ""
"If the system has multiple interfaces, the interface can be specified along "
"with the direction. An example would be `in on fxp0`."
msgstr "如果系统具有多个接口，可以指定接口以及方向。一个示例是 `in on fxp0`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1973
#, fuzzy
msgid ""
"Options are optional.  However, if multiple options are specified, they must"
" be used in the order shown here."
msgstr "选项是可选的。然而，如果指定了多个选项，则必须按照这里显示的顺序使用它们。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1975
#, fuzzy
msgid ""
"`log`: when performing the specified ACTION, the contents of the packet's "
"headers will be written to the man:ipl[4] packet log pseudo-device."
msgstr "`log`：执行指定的动作时，数据包的头部内容将被写入到`man:ipl[4]`数据包日志伪设备中。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1977
#, fuzzy
msgid ""
"`quick`: if a packet matches this rule, the ACTION specified by the rule "
"occurs and no further processing of any following rules will occur for this "
"packet."
msgstr "`quick`：如果一个数据包与这条规则匹配，则会执行规则指定的动作，并且对于这个数据包，不会再进行任何后续规则的处理。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1980
#, fuzzy
msgid ""
"`on`: must be followed by the interface name as displayed by "
"man:ifconfig[8].  The rule will only match if the packet is going through "
"the specified interface in the specified direction."
msgstr "`on`（在`man ifconfig[8]`中显示的接口名称）：该规则只有在数据包通过指定的接口以指定的方向传输时才会匹配。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1982
#, fuzzy
msgid ""
"When using the `log` keyword, the following qualifiers may be used in this "
"order:"
msgstr "在使用 `log` 关键字时，可以按照以下顺序使用以下限定符："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1984
#, fuzzy
msgid ""
"`body`: indicates that the first 128 bytes of the packet contents will be "
"logged after the headers."
msgstr "`body`：表示在标头之后，将会记录下前128字节的数据包内容。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1986
#, fuzzy
msgid ""
"`first`: if the `log` keyword is being used in conjunction with a `keep "
"state` option, this option is recommended so that only the triggering packet"
" is logged and not every packet which matches the stateful connection."
msgstr ""
"`first`: 如果 `log` 关键字与 `keep state` "
"选项一起使用，建议使用此选项，以便仅将触发的数据包记录下来，而不是匹配状态连接的每个数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1989
#, fuzzy
msgid ""
"Additional options are available to specify error return messages.  Refer to"
" man:ipf[5] for more details."
msgstr "可以使用额外的选项来指定错误返回消息。 更多细节请参考man:ipf[5]。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1990
#, fuzzy, no-wrap
msgid "PROTO_TYPE"
msgstr ""
"PROTO_TYPE\n"
"`PROTO_TYPE` 是一个计算机相关的术语，代表着原型类型。原型类型是指在软件开发中，用于验证概念或测试功能的初步版本。通常原型类型是一个简化的版本，包含基本的功能和界面，旨在帮助开发人员和用户了解系统的潜在功能和交互方式。原型类型是在软件开发过程中非常常见的一个阶段，它可以帮助团队快速迭代和调整设计，提高最终产品的质量和用户体验。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1996
#, fuzzy
msgid ""
"The protocol type is optional.  However, it is mandatory if the rule needs "
"to specify a SRC_PORT or a DST_PORT as it defines the type of protocol.  "
"When specifying the type of protocol, use the `proto` keyword followed by "
"either a protocol number or name from [.filename]#/etc/protocols#.  Example "
"protocol names include `tcp`, `udp`, or `icmp`.  If PROTO_TYPE is specified "
"but no SRC_PORT or DST_PORT is specified, all port numbers for that protocol"
" will match that rule."
msgstr ""
"协议类型是可选的。然而，如果规则需要指定SRC_PORT或DST_PORT，则该协议类型是必需的，因为它定义了协议的类型。在指定协议类型时，请使用`proto`关键字，后跟位于[.filename]#/etc/protocols#文件中的协议号或名称。示例协议名称包括`tcp`、`udp`或`icmp`。如果指定了PROTO_TYPE但没有指定SRC_PORT或DST_PORT，则该规则将与该协议的所有端口号匹配。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:1997
#, fuzzy, no-wrap
msgid "SRC_ADDR"
msgstr "SRC_ADDR 指的是源地址，用于标识一个数据包或消息的发送方的地址。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2001
#, fuzzy
msgid ""
"The `from` keyword is mandatory and is followed by a keyword which "
"represents the source of the packet.  The source can be a hostname, an IP "
"address followed by the CIDR mask, an address pool, or the keyword `all`.  "
"Refer to man:ipf[5] for examples."
msgstr ""
"`from` 关键字是必需的，并且后面跟着一个关键字，用于表示数据包的来源。来源可以是主机名、带有 CIDR 子网掩码的 IP 地址、地址池，或关键字 "
"`all`。可参考 man:ipf[5] 获取示例。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2005
#, fuzzy
msgid ""
"There is no way to match ranges of IP addresses which do not express "
"themselves easily using the dotted numeric form / mask-length notation.  The"
" package:net-mgmt/ipcalc[] package or port may be used to ease the "
"calculation of the CIDR mask.  Additional information is available at the "
"utility's web page: http://jodies.de/ipcalc[http://jodies.de/ipcalc]."
msgstr ""
"没有办法匹配那些无法使用点分十进制形式或掩码长度表示的 IP 地址范围。可以使用 package:net-mgmt/ipcalc 或 port 来简化 "
"CIDR "
"掩码的计算。该实用工具的网页上提供了更多的信息：http://jodies.de/ipcalc[http://jodies.de/ipcalc]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2010
#, fuzzy
msgid ""
"The port number of the source is optional.  However, if it is used, it "
"requires PROTO_TYPE to be first defined in the rule.  The port number must "
"also be preceded by the `proto` keyword."
msgstr "源的端口号是可选的。但是，如果使用了端口号，它需要在规则中首先定义 PROTO_TYPE。端口号还必须在`proto`关键字之前。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2012
#, fuzzy
msgid ""
"A number of different comparison operators are supported: `=` (equal to), "
"`!=` (not equal to), `<` (less than), `>` (greater than), `<=` (less than or"
" equal to), and `>=` (greater than or equal to)."
msgstr "支持多种不同的比较运算符：`=`（等于），`!=`（不等于），`<`（小于），`>`（大于），`<=`（小于等于）和`>=`（大于等于）。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2014
#, fuzzy
msgid ""
"To specify port ranges, place the two port numbers between `<>` (less than "
"and greater than ), `><` (greater than and less than ), or `:` (greater than"
" or equal to and less than or equal to)."
msgstr "要指定端口范围，请将两个端口数字放置在 `<>`（小于和大于）、`><`（大于和小于）或 `:`（大于或等于并且小于或等于）之间。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2015
#, fuzzy, no-wrap
msgid "DST_ADDR"
msgstr "DST_ADDR（目标地址）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2018
#, fuzzy
msgid ""
"The `to` keyword is mandatory and is followed by a keyword which represents "
"the destination of the packet.  Similar to SRC_ADDR, it can be a hostname, "
"an IP address followed by the CIDR mask, an address pool, or the keyword "
"`all`."
msgstr ""
"`to` 关键字是必须的，后面跟着一个关键字，代表数据包的目的地。 类似于 SRC_ADDR，它可以是主机名，后面跟着 CIDR 掩码的 IP "
"地址，地址池或关键字 `all`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2023
#, fuzzy
msgid ""
"Similar to SRC_PORT, the port number of the destination is optional.  "
"However, if it is used, it requires PROTO_TYPE to be first defined in the "
"rule.  The port number must also be preceded by the `proto` keyword."
msgstr ""
"与SRC_PORT类似，目的地的端口号是可选的。然而，如果使用了端口号，在规则中必须首先定义PROTO_TYPE。端口号还必须在`proto`关键字之前。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2024
#, fuzzy, no-wrap
msgid "TCP_FLAG|ICMP_TYPE"
msgstr "TCP_FLAG | ICMP_TYPE"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2027
#, fuzzy
msgid ""
"If `tcp` is specified as the PROTO_TYPE, flags can be specified as letters, "
"where each letter represents one of the possible TCP flags used to determine"
" the state of a connection.  Possible values are: `S` (SYN), `A` (ACK), `P` "
"(PSH), `F` (FIN), `U` (URG), `R` (RST), `C` (CWN), and `E` (ECN)."
msgstr ""
"如果`tcp`被指定为\"PROTO_TYPE\"，则可以使用字母指定标志，其中每个字母代表用于确定连接状态的可能的TCP标志之一。可能的值是：`S`（SYN），`A`（ACK），`P`（PSH），`F`（FIN），`U`（URG），`R`（RST），`C`（CWN）和`E`（ECN）。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2030
#, fuzzy
msgid ""
"If `icmp` is specified as the PROTO_TYPE, the ICMP type to match can be "
"specified.  Refer to man:ipf[5] for the allowable types."
msgstr "如果指定 `icmp` 作为 `PROTO_TYPE`，可以指定要匹配的 ICMP 类型。有关可允许的类型，请参阅 man:ipf[5]。"

#. type: Labeled list
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2031
#, fuzzy, no-wrap
msgid "STATE"
msgstr "状态"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2035
#, fuzzy
msgid ""
"If a `pass` rule contains `keep state`, IPF will add an entry to its dynamic"
" state table and allow subsequent packets that match the connection.  IPF "
"can track state for TCP, UDP, and ICMP sessions.  Any packet that IPF can be"
" certain is part of an active session, even if it is a different protocol, "
"will be allowed."
msgstr ""
"如果一个`pass`规则包含`keep "
"state`，IPF会将一个条目添加到其动态状态表并允许后续匹配该连接的数据包通过。IPF可以跟踪TCP、UDP和ICMP会话的状态。IPF可以确定属于活动会话的任何数据包（即使是不同的协议），都会被允许通过。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2042
#, fuzzy
msgid ""
"In IPF, packets destined to go out through the interface connected to the "
"public Internet are first checked against the dynamic state table.  If the "
"packet matches the next expected packet comprising an active session "
"conversation, it exits the firewall and the state of the session "
"conversation flow is updated in the dynamic state table.  Packets that do "
"not belong to an already active session are checked against the outbound "
"ruleset.  Packets coming in from the interface connected to the public "
"Internet are first checked against the dynamic state table.  If the packet "
"matches the next expected packet comprising an active session, it exits the "
"firewall and the state of the session conversation flow is updated in the "
"dynamic state table.  Packets that do not belong to an already active "
"session are checked against the inbound ruleset."
msgstr ""
"在IPF中，要通过与公共互联网连接的接口发送的数据包首先会与动态状态表进行匹配检查。如果数据包与活动会话对话组成的下一个预期数据包匹配，则该数据包将通过防火墙，并且会话对话流的状态将在动态状态表中更新。不属于已经活动会话的数据包则需要与出站规则集进行检查。从与公共互联网连接的接口进入的数据包首先会与动态状态表进行匹配检查。如果数据包与活动会话的下一个预期数据包匹配，则该数据包将通过防火墙，并且会话对话流的状态将在动态状态表中更新。不属于已经活动会话的数据包则需要与入站规则集进行检查。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2046
#, fuzzy
msgid ""
"Several keywords can be added after `keep state`.  If used, these keywords "
"set various options that control stateful filtering, such as setting "
"connection limits or connection age.  Refer to man:ipf[5] for the list of "
"available options and their descriptions."
msgstr ""
"在`keep state`之后可以添加几个关键词。如果使用这些关键词，可以设置各种控制有状态过滤的选项，如设置连接限制或连接时长。请参考 "
"man:ipf[5] 查看可用选项和它们的说明。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2050
#, fuzzy
msgid ""
"This section demonstrates how to create an example ruleset which only allows"
" services matching `pass` rules and blocks all others."
msgstr "本节演示如何创建一个示例规则集，该规则集仅允许匹配“pass”规则的服务，并阻止所有其他服务。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2053
#, fuzzy
msgid ""
"FreeBSD uses the loopback interface ([.filename]#lo0#) and the IP address "
"`127.0.0.1` for internal communication.  The firewall ruleset must contain "
"rules to allow free movement of these internally used packets:"
msgstr ""
"FreeBSD使用环回接口（`lo0`）和IP地址 `127.0.0.1` 来进行内部通信。防火墙规则集必须包含允许这些内部使用的数据包自由移动的规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2059
#, no-wrap
msgid ""
"# no restrictions on loopback interface\n"
"pass in quick on lo0 all\n"
"pass out quick on lo0 all\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2064
#, fuzzy
msgid ""
"The public interface connected to the Internet is used to authorize and "
"control access of all outbound and inbound connections.  If one or more "
"interfaces are cabled to private networks, those internal interfaces may "
"require rules to allow packets originating from the LAN to flow between the "
"internal networks or to the interface attached to the Internet.  The ruleset"
" should be organized into three major sections: any trusted internal "
"interfaces, outbound connections through the public interface, and inbound "
"connections through the public interface."
msgstr ""
"与互联网连接的公共接口用于授权和控制所有出站和入站连接的访问。如果有一个或多个接口与私有网络连接，那些内部接口可能需要规则来允许源自局域网的数据包在内部网络之间或连接到互联网的接口之间流动。规则集应组织为三个主要部分：任何受信任的内部接口、通过公共接口的出站连接以及通过公共接口的入站连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2066
#, fuzzy
msgid ""
"These two rules allow all traffic to pass through a trusted LAN interface "
"named [.filename]#xl0#:"
msgstr "这两个规则允许所有流量通过一个名为 [.filename]#xl0# 的可信局域网接口进行传输："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2072
#, no-wrap
msgid ""
"# no restrictions on inside LAN interface for private network\n"
"pass out quick on xl0 all\n"
"pass in quick on xl0 all\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2075
#, fuzzy
msgid ""
"The rules for the public interface's outbound and inbound sections should "
"have the most frequently matched rules placed before less commonly matched "
"rules, with the last rule in the section blocking and logging all packets "
"for that interface and direction."
msgstr ""
"公共接口的出站和入站部分的规则应将最常匹配的规则放置在较不常匹配的规则之前，而该部分的最后一条规则应该是阻止并记录该接口和方向的所有数据包的规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2079
#, fuzzy
msgid ""
"This set of rules defines the outbound section of the public interface named"
" [.filename]#dc0#.  These rules keep state and identify the specific "
"services that internal systems are authorized for public Internet access.  "
"All the rules use `quick` and specify the appropriate port numbers and, "
"where applicable, destination addresses."
msgstr ""
"这组规则定义了公共接口的出站部分，名为 `dc0`。这些规则会保持状态，并确定内部系统被授权用于公共互联网访问的特定服务。所有规则都使用了 "
"`quick`，并指定了适当的端口号，以及在适用的情况下，目标地址。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2085
#, no-wrap
msgid ""
"# interface facing Internet (outbound)\n"
"# Matches session start requests originating from or behind the\n"
"# firewall, destined for the Internet.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2091
#, no-wrap
msgid ""
"# Allow outbound access to public DNS servers.\n"
"# Replace x.x.x.x with address listed in /etc/resolv.conf.\n"
"# Repeat for each DNS server.\n"
"pass out quick on dc0 proto tcp from any to x.x.x.x port = 53 flags S keep state\n"
"pass out quick on dc0 proto udp from any to x.x.x.x port = 53 keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2098
#, no-wrap
msgid ""
"# Allow access to ISP's specified DHCP server for cable or DSL networks.\n"
"# Use the first rule, then check log for the IP address of DHCP server.\n"
"# Then, uncomment the second rule, replace z.z.z.z with the IP address,\n"
"# and comment out the first rule\n"
"pass out log quick on dc0 proto udp from any to any port = 67 keep state\n"
"#pass out quick on dc0 proto udp from any to z.z.z.z port = 67 keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2102
#, no-wrap
msgid ""
"# Allow HTTP and HTTPS\n"
"pass out quick on dc0 proto tcp from any to any port = 80 flags S keep state\n"
"pass out quick on dc0 proto tcp from any to any port = 443 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2106
#, no-wrap
msgid ""
"# Allow email\n"
"pass out quick on dc0 proto tcp from any to any port = 110 flags S keep state\n"
"pass out quick on dc0 proto tcp from any to any port = 25 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2109
#, no-wrap
msgid ""
"# Allow NTP\n"
"pass out quick on dc0 proto tcp from any to any port = 37 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2112
#, no-wrap
msgid ""
"# Allow FTP\n"
"pass out quick on dc0 proto tcp from any to any port = 21 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2115
#, no-wrap
msgid ""
"# Allow SSH\n"
"pass out quick on dc0 proto tcp from any to any port = 22 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2118
#, no-wrap
msgid ""
"# Allow ping\n"
"pass out quick on dc0 proto icmp from any to any icmp-type 8 keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2121
#, no-wrap
msgid ""
"# Block and log everything else\n"
"block out log first quick on dc0 all\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2125
#, fuzzy
msgid ""
"This example of the rules in the inbound section of the public interface "
"blocks all undesirable packets first.  This reduces the number of packets "
"that are logged by the last rule."
msgstr "这个例子中，公共接口入站部分的规则首先阻止所有不需要的数据包。这样可以减少最后一条规则记录的数据包数量。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2139
#, no-wrap
msgid ""
"# interface facing Internet (inbound)\n"
"# Block all inbound traffic from non-routable or reserved address spaces\n"
"block in quick on dc0 from 192.168.0.0/16 to any    #RFC 1918 private IP\n"
"block in quick on dc0 from 172.16.0.0/12 to any     #RFC 1918 private IP\n"
"block in quick on dc0 from 10.0.0.0/8 to any        #RFC 1918 private IP\n"
"block in quick on dc0 from 127.0.0.0/8 to any       #loopback\n"
"block in quick on dc0 from 0.0.0.0/8 to any         #loopback\n"
"block in quick on dc0 from 169.254.0.0/16 to any    #DHCP auto-config\n"
"block in quick on dc0 from 192.0.2.0/24 to any      #reserved for docs\n"
"block in quick on dc0 from 204.152.64.0/23 to any   #Sun cluster interconnect\n"
"block in quick on dc0 from 224.0.0.0/3 to any       #Class D & E multicast\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2143
#, no-wrap
msgid ""
"# Block fragments and too short tcp packets\n"
"block in quick on dc0 all with frags\n"
"block in quick on dc0 proto tcp all with short\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2147
#, no-wrap
msgid ""
"# block source routed packets\n"
"block in quick on dc0 all with opt lsrr\n"
"block in quick on dc0 all with opt ssrr\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2150
#, no-wrap
msgid ""
"# Block OS fingerprint attempts and log first occurrence\n"
"block in log first quick on dc0 proto tcp from any to any flags FUP\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2153
#, no-wrap
msgid ""
"# Block anything with special options\n"
"block in quick on dc0 all with ipopts\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2157
#, no-wrap
msgid ""
"# Block public pings and ident\n"
"block in quick on dc0 proto icmp all icmp-type 8\n"
"block in quick on dc0 proto tcp from any to any port = 113\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2163
#, no-wrap
msgid ""
"# Block incoming Netbios services\n"
"block in log first quick on dc0 proto tcp/udp from any to any port = 137\n"
"block in log first quick on dc0 proto tcp/udp from any to any port = 138\n"
"block in log first quick on dc0 proto tcp/udp from any to any port = 139\n"
"block in log first quick on dc0 proto tcp/udp from any to any port = 81\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2167
#, fuzzy
msgid ""
"Any time there are logged messages on a rule with the `log first` option, "
"run `ipfstat -hio` to evaluate how many times the rule has been matched.  A "
"large number of matches may indicate that the system is under attack."
msgstr ""
"每当具有“log first”选项的规则上有日志消息时，运行`ipfstat -hio`来评估匹配该规则的次数。大量的匹配可能表明系统受到攻击。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2170
#, fuzzy
msgid ""
"The rest of the rules in the inbound section define which connections are "
"allowed to be initiated from the Internet.  The last rule denies all "
"connections which were not explicitly allowed by previous rules in this "
"section."
msgstr "入站部分的其余规则定义了从互联网发起的连接是允许的。最后一条规则拒绝所有之前规则中未明确允许的连接。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2176
#, no-wrap
msgid ""
"# Allow traffic in from ISP's DHCP server. Replace z.z.z.z with\n"
"# the same IP address used in the outbound section.\n"
"pass in quick on dc0 proto udp from z.z.z.z to any port = 68 keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2179
#, no-wrap
msgid ""
"# Allow public connections to specified internal web server\n"
"pass in quick on dc0 proto tcp from any to x.x.x.x port = 80 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2182
#, no-wrap
msgid ""
"# Block and log only first occurrence of all remaining traffic.\n"
"block in log first quick on dc0 all\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2184
#, fuzzy, no-wrap
msgid "Configuring NAT"
msgstr "配置网络地址转换（NAT）"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2187
#, fuzzy
msgid ""
"To enable NAT, add these statements to [.filename]#/etc/rc.conf# and specify"
" the name of the file containing the NAT rules:"
msgstr "要启用NAT，请将以下语句添加到`/etc/rc.conf`文件，并指定包含NAT规则的文件的名称："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2193
#, no-wrap
msgid ""
"gateway_enable=\"YES\"\n"
"ipnat_enable=\"YES\"\n"
"ipnat_rules=\"/etc/ipnat.rules\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2198
#, fuzzy
msgid ""
"NAT rules are flexible and can accomplish many different things to fit the "
"needs of both commercial and home users.  The rule syntax presented here has"
" been simplified to demonstrate common usage.  For a complete rule syntax "
"description, refer to man:ipnat[5]."
msgstr ""
"NAT规则非常灵活，可以满足商业和家庭用户的各种需求。这里介绍的规则语法已经简化，以示常见用法。完整的规则语法说明请参考man:ipnat[5]。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2200
#, fuzzy
msgid ""
"The basic syntax for a NAT rule is as follows, where `map` starts the rule "
"and _IF_ should be replaced with the name of the external interface:"
msgstr "NAT规则的基本语法如下，其中`map`开始规则，将_IF_替换为外部接口的名称："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2204
#, no-wrap
msgid "map IF LAN_IP_RANGE -> PUBLIC_ADDRESS\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2209
#, fuzzy
msgid ""
"The _LAN_IP_RANGE_ is the range of IP addresses used by internal clients.  "
"Usually, it is a private address range such as `192.168.1.0/24`.  The "
"_PUBLIC_ADDRESS_ can either be the static external IP address or the keyword"
" `0/32` which represents the IP address assigned to _IF_."
msgstr ""
"_LAN_IP_RANGE_是内部客户端使用的IP地址范围。通常，它是一个私有地址范围，例如`192.168.1.0/24`。_PUBLIC_ADDRESS_可以是静态外部IP地址，也可以是表示分配给_IF_的IP地址的关键字`0/32`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2216
#, fuzzy
msgid ""
"In IPF, when a packet arrives at the firewall from the LAN with a public "
"destination, it first passes through the outbound rules of the firewall "
"ruleset.  Then, the packet is passed to the NAT ruleset which is read from "
"the top down, where the first matching rule wins.  IPF tests each NAT rule "
"against the packet's interface name and source IP address.  When a packet's "
"interface name matches a NAT rule, the packet's source IP address in the "
"private LAN is checked to see if it falls within the IP address range "
"specified in _LAN_IP_RANGE_.  On a match, the packet has its source IP "
"address rewritten with the public IP address specified by _PUBLIC_ADDRESS_."
"  IPF posts an entry in its internal NAT table so that when the packet "
"returns from the Internet, it can be mapped back to its original private IP "
"address before being passed to the firewall rules for further processing."
msgstr ""
"在IPF中，当一个数据包从局域网带有公共目的地到达防火墙时，它首先经过防火墙规则集的出站规则。然后，数据包被传递到从上到下读取的NAT规则集，第一个匹配的规则获胜。IPF会对每个NAT规则进行测试，检查数据包的接口名称和源IP地址是否匹配。当数据包的接口名称与NAT规则匹配时，将检查私有局域网中数据包的源IP地址是否在_LAN_IP_RANGE_中指定的IP地址范围内。如果匹配成功，数据包的源IP地址将使用_PUBLIC_ADDRESS_指定的公共IP地址进行重写。IPF在其内部NAT表中发布一个条目，这样当数据包从互联网返回时，可以将其映射回原始的私有IP地址，然后传递给防火墙规则进行进一步处理。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2219
#, fuzzy
msgid ""
"For networks that have large numbers of internal systems or multiple "
"subnets, the process of funneling every private IP address into a single "
"public IP address becomes a resource problem.  Two methods are available to "
"relieve this issue."
msgstr "对于具有大量内部系统或多个子网的网络来说，将每个私有IP地址集中到一个公共IP地址中的过程会成为一个资源问题。有两种方法可解决这个问题。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2222
#, fuzzy
msgid ""
"The first method is to assign a range of ports to use as source ports.  By "
"adding the `portmap` keyword, NAT can be directed to only use source ports "
"in the specified range:"
msgstr "第一种方法是分配一系列端口作为源端口使用。通过添加`portmap`关键字，可以指示NAT仅使用指定范围内的源端口："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2226
#, no-wrap
msgid "map dc0 192.168.1.0/24 -> 0/32 portmap tcp/udp 20000:60000\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2229
#, fuzzy
msgid ""
"Alternately, use the `auto` keyword which tells NAT to determine the ports "
"that are available for use:"
msgstr "或者，使用 `auto` 关键字，该关键字告诉NAT确定可供使用的端口。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2233
#, no-wrap
msgid "map dc0 192.168.1.0/24 -> 0/32 portmap tcp/udp auto\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2238
#, fuzzy
msgid ""
"The second method is to use a pool of public addresses.  This is useful when"
" there are too many LAN addresses to fit into a single public address and a "
"block of public IP addresses is available.  These public addresses can be "
"used as a pool from which NAT selects an IP address as a packet's address is"
" mapped on its way out."
msgstr ""
"第二种方法是使用一个公共地址池。当局域网地址太多而无法适应一个单独的公共地址，并且有一块公共IP地址可用时，这种方法是有用的。这些公共地址可以作为一个池，NAT可以从中选择一个IP地址，作为一个数据包在发送时映射到该地址上。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2241
#, fuzzy
msgid ""
"The range of public IP addresses can be specified using a netmask or CIDR "
"notation.  These two rules are equivalent:"
msgstr "公共 IP 地址的范围可以使用网络掩码或 CIDR 表示法来指定。以下两条规则是等效的："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2246
#, no-wrap
msgid ""
"map dc0 192.168.1.0/24 -> 204.134.75.0/255.255.255.0\n"
"map dc0 192.168.1.0/24 -> 204.134.75.0/24\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2251
#, fuzzy
msgid ""
"A common practice is to have a publically accessible web server or mail "
"server segregated to an internal network segment.  The traffic from these "
"servers still has to undergo NAT, but port redirection is needed to direct "
"inbound traffic to the correct server.  For example, to map a web server "
"using the internal address `10.0.10.25` to its public IP address of "
"`20.20.20.5`, use this rule:"
msgstr ""
"常见做法是将可公开访问的 Web "
"服务器或邮件服务器隔离在内部网络段中。这些服务器的流量仍然需要经过网络地址转换（NAT），但需要使用端口重定向来将入站流量引导到正确的服务器。例如，要将使用内部地址"
" `10.0.10.25` 的 Web 服务器映射到其公共 IP 地址 `20.20.20.5`，请使用以下规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2255
#, no-wrap
msgid "rdr dc0 20.20.20.5/32 port 80 -> 10.0.10.25 port 80\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2258
#, fuzzy
msgid ""
"If it is the only web server, this rule would also work as it redirects all "
"external HTTP requests to `10.0.10.25`:"
msgstr "如果它是唯一的网络服务器，这个规则也可以工作，它将所有外部HTTP请求重定向到`10.0.10.25`："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2262
#, no-wrap
msgid "rdr dc0 0.0.0.0/0 port 80 -> 10.0.10.25 port 80\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2267
#, fuzzy
msgid ""
"IPF has a built in FTP proxy which can be used with NAT.  It monitors all "
"outbound traffic for active or passive FTP connection requests and "
"dynamically creates temporary filter rules containing the port number used "
"by the FTP data channel.  This eliminates the need to open large ranges of "
"high order ports for FTP connections."
msgstr ""
"IPF内置了一个可以与NAT一起使用的FTP代理。它监控所有的出站流量，并动态创建临时过滤规则，包含FTP数据通道使用的端口号。这样就不需要打开大量的高阶端口范围来进行FTP连接。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2270
#, fuzzy
msgid ""
"In this example, the first rule calls the proxy for outbound FTP traffic "
"from the internal LAN.  The second rule passes the FTP traffic from the "
"firewall to the Internet, and the third rule handles all non-FTP traffic "
"from the internal LAN:"
msgstr ""
"在这个例子中，第一条规则调用代理来处理从内部局域网发出的FTP流量。第二条规则将防火墙的FTP流量传递到互联网，第三条规则处理来自内部局域网的所有非FTP流量。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2276
#, no-wrap
msgid ""
"map dc0 10.0.10.0/29 -> 0/32 proxy port 21 ftp/tcp\n"
"map dc0 0.0.0.0/0 -> 0/32 proxy port 21 ftp/tcp\n"
"map dc0 10.0.10.0/29 -> 0/32\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2280
#, fuzzy
msgid ""
"The FTP `map` rules go before the NAT rule so that when a packet matches an "
"FTP rule, the FTP proxy creates temporary filter rules to let the FTP "
"session packets pass and undergo NAT.  All LAN packets that are not FTP will"
" not match the FTP rules but will undergo NAT if they match the third rule."
msgstr ""
"FTP的`map`规则在NAT规则之前，这样当一个数据包匹配到FTP规则时，FTP代理会创建临时过滤规则，允许FTP会话的数据包通过并进行NAT处理。所有不是FTP的局域网数据包如果匹配第三个规则，将会进行NAT处理。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2283
#, fuzzy
msgid ""
"Without the FTP proxy, the following firewall rules would instead be needed."
"  Note that without the proxy, all ports above `1024` need to be allowed:"
msgstr "如果没有FTP代理，下述的防火墙规则将需要被使用。请注意，如果没有代理，所有大于 `1024` 的端口都需要被允许通行："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2289
#, no-wrap
msgid ""
"# Allow out LAN PC client FTP to public Internet\n"
"# Active and passive modes\n"
"pass out quick on rl0 proto tcp from any to any port = 21 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2292
#, no-wrap
msgid ""
"# Allow out passive mode data channel high order port numbers\n"
"pass out quick on rl0 proto tcp from any to any port > 1024 flags S keep state\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2295
#, no-wrap
msgid ""
"# Active mode let data channel in from FTP server\n"
"pass in quick on rl0 proto tcp from any to any port = 20 flags S keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2299
#, fuzzy
msgid ""
"Whenever the file containing the NAT rules is edited, run `ipnat` with `-CF`"
" to delete the current NAT rules and flush the contents of the dynamic "
"translation table.  Include `-f` and specify the name of the NAT ruleset to "
"load:"
msgstr ""
"每当编辑包含NAT规则的文件时，使用`ipnat "
"-CF`命令来删除当前的NAT规则并清空动态转换表的内容。同时，使用`-f`参数并指定NAT规则集的名称来加载规则集。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2303
#, no-wrap
msgid "# ipnat -CF -f /etc/ipnat.rules\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2306
#, fuzzy
msgid "To display the NAT statistics:"
msgstr "显示网络地址转换（NAT）统计信息的方法如下："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2310
#, no-wrap
msgid "# ipnat -s\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2313
#, fuzzy
msgid "To list the NAT table's current mappings:"
msgstr "要列出 NAT 表的当前映射："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2317
#, no-wrap
msgid "# ipnat -l\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2320
#, fuzzy
msgid ""
"To turn verbose mode on and display information relating to rule processing "
"and active rules and table entries:"
msgstr "要打开详细模式并显示与规则处理和活动规则和表项相关的信息："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2324
#, no-wrap
msgid "# ipnat -v\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2326
#, fuzzy, no-wrap
msgid "Viewing IPF Statistics"
msgstr ""
"查看 IPF 统计信息\n"
"\n"
"IPF（Internet Protocol Filtering）是一种基于网络协议的过滤机制，用于保护网络免受恶意攻击。在计算机网络中，可以通过查看 IPF 统计信息来了解网络的流量情况和过滤规则的效果。\n"
"\n"
"要查看 IPF 统计信息，可以执行以下步骤：\n"
"\n"
"1. 打开命令行界面。\n"
"2. 输入 `ipfstat` 命令并按下回车键。\n"
"3. 系统将显示 IPF 相关的统计信息，包括已过滤的数据包数量、阻止的连接数量等。\n"
"\n"
"通过查看 IPF 统计信息，管理员可以得知网络上的流量情况，判断网络是否受到攻击，以及调整过滤规则以提高网络的安全性。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2330
#, fuzzy
msgid ""
"IPF includes man:ipfstat[8] which can be used to retrieve and display "
"statistics which are gathered as packets match rules as they go through the "
"firewall.  Statistics are accumulated since the firewall was last started or"
" since the last time they were reset to zero using `ipf -Z`."
msgstr ""
"IPF 包含 man:ipfstat[8]，可用于检索和显示在防火墙通过规则时匹配的数据包所收集的统计信息。统计信息从上次启动防火墙或最后一次使用 "
"`ipf -Z` 将其重置为零开始累积。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2332
#, fuzzy
msgid "The default `ipfstat` output looks like this:"
msgstr "默认的 `ipfstat` 输出如下所示："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2352
#, no-wrap
msgid ""
"input packets: blocked 99286 passed 1255609 nomatch 14686 counted 0\n"
" output packets: blocked 4200 passed 1284345 nomatch 14687 counted 0\n"
" input packets logged: blocked 99286 passed 0\n"
" output packets logged: blocked 0 passed 0\n"
" packets logged: input 0 output 0\n"
" log failures: input 3898 output 0\n"
" fragment state(in): kept 0 lost 0\n"
" fragment state(out): kept 0 lost 0\n"
" packet state(in): kept 169364 lost 0\n"
" packet state(out): kept 431395 lost 0\n"
" ICMP replies: 0 TCP RSTs sent: 0\n"
" Result cache hits(in): 1215208 (out): 1098963\n"
" IN Pullups succeeded: 2 failed: 0\n"
" OUT Pullups succeeded: 0 failed: 0\n"
" Fastroute successes: 0 failures: 0\n"
" TCP cksum fails(in): 0 (out): 0\n"
" Packet log flags set: (0)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2358
#, fuzzy
msgid ""
"Several options are available.  When supplied with either `-i` for inbound "
"or `-o` for outbound, the command will retrieve and display the appropriate "
"list of filter rules currently installed and in use by the kernel.  To also "
"see the rule numbers, include `-n`.  For example, `ipfstat -on` displays the"
" outbound rules table with rule numbers:"
msgstr ""
"有几个选项可供选择。当使用 `-i` 表示入站规则或 `-o` "
"表示出站规则时，该命令将检索并显示内核当前安装和使用的适当的过滤器规则列表。如果要同时查看规则编号，请包括 `-n`。例如，`ipfstat -on` "
"将显示带有规则编号的出站规则表："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2364
#, no-wrap
msgid ""
"@1 pass out on xl0 from any to any\n"
"@2 block out on dc0 from any to any\n"
"@3 pass out quick on dc0 proto tcp/udp from any to any keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2368
#, fuzzy
msgid ""
"Include `-h` to prefix each rule with a count of how many times the rule was"
" matched.  For example, `ipfstat -oh` displays the outbound internal rules "
"table, prefixing each rule with its usage count:"
msgstr ""
"在每条规则的前面加上一个规则匹配次数计数的`-h`选项。 例如，`ipfstat -oh`会显示出站内规则表，并在每条规则前面加上匹配次数计数："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2374
#, no-wrap
msgid ""
"2451423 pass out on xl0 from any to any\n"
"354727 block out on dc0 from any to any\n"
"430918 pass out quick on dc0 proto tcp/udp from any to any keep state\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2380
#, fuzzy
msgid ""
"To display the state table in a format similar to man:top[1], use `ipfstat "
"-t`.  When the firewall is under attack, this option provides the ability to"
" identify and see the attacking packets.  The optional sub-flags give the "
"ability to select the destination or source IP, port, or protocol to be "
"monitored in real time.  Refer to man:ipfstat[8] for details."
msgstr ""
"要以类似于 man:top[1] 的格式显示状态表格，请使用 `ipfstat -t` "
"命令。当防火墙遭受攻击时，该选项能够识别并查看攻击数据包。可选的子标志（sub-flags）可以选择实时监控的目标或源 IP、端口或协议。详情请参考 "
"man:ipfstat[8]。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2381
#, fuzzy, no-wrap
msgid "IPF Logging"
msgstr "IPF日志记录"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2385
#, fuzzy
msgid ""
"IPF provides `ipmon`, which can be used to write the firewall's logging "
"information in a human readable format.  It requires that `options "
"IPFILTER_LOG` be first added to a custom kernel using the instructions in "
"crossref:kernelconfig[kernelconfig,Configuring the FreeBSD Kernel]."
msgstr ""
"IPF提供了`ipmon`，可以用来以人类可读的格式写入防火墙的日志信息。使用它需要在自定义内核中首先添加`options "
"IPFILTER_LOG`，具体步骤请参考crossref:kernelconfig[kernelconfig,配置FreeBSD内核]中的说明。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2388
#, fuzzy
msgid ""
"This command is typically run in daemon mode in order to provide a "
"continuous system log file so that logging of past events may be reviewed.  "
"Since FreeBSD has a built in man:syslogd[8] facility to automatically rotate"
" system logs, the default [.filename]#rc.conf# `ipmon_flags` statement uses "
"`-Ds`:"
msgstr ""
"通常，此命令以守护进程模式运行，以提供连续的系统日志文件，以便可以回顾过去事件的日志记录。由于FreeBSD内置了 `man:syslogd[8]` "
"设施以自动轮转系统日志，因此默认的 `.filename`#rc.conf# `ipmon_flags` 声明使用了 `-Ds`。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2395
#, no-wrap
msgid ""
"ipmon_flags=\"-Ds\" # D = start as daemon\n"
"                  # s = log to syslog\n"
"                  # v = log tcp window, ack, seq\n"
"                  # n = map IP & port to names\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2399
#, fuzzy
msgid ""
"Logging provides the ability to review, after the fact, information such as "
"which packets were dropped, what addresses they came from, and where they "
"were going.  This information is useful in tracking down attackers."
msgstr "日志记录提供了事后审查的能力，例如丢弃了哪些数据包，它们来自哪些地址，以及它们的目的地是什么。这些信息有助于追踪攻击者。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2404
#, fuzzy
msgid ""
"Once the logging facility is enabled in [.filename]#rc.conf# and started "
"with `service ipmon start`, IPF will only log the rules which contain the "
"`log` keyword.  The firewall administrator decides which rules in the "
"ruleset should be logged and normally only deny rules are logged.  It is "
"customary to include the `log` keyword in the last rule in the ruleset.  "
"This makes it possible to see all the packets that did not match any of the "
"rules in the ruleset."
msgstr ""
"一旦在 [.filename]#rc.conf# 中启用了日志记录功能，并使用 `service ipmon start` 启动后，IPF将只记录包含 "
"`log` 关键字的规则。防火墙管理员决定在规则集中应该记录哪些规则，通常只记录拒绝规则。习惯上在规则集中的最后一个规则中包含 `log` "
"关键字。这样可以查看所有未与规则集中任何规则匹配的数据包。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2407
#, fuzzy
msgid ""
"By default, `ipmon -Ds` mode uses `local0` as the logging facility.  The "
"following logging levels can be used to further segregate the logged data:"
msgstr "默认情况下，`ipmon -Ds` 模式使用 `local0` 作为日志设施。可以使用以下日志级别进一步划分记录的数据："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2414
#, no-wrap
msgid ""
"LOG_INFO - packets logged using the \"log\" keyword as the action rather than pass or block.\n"
"LOG_NOTICE - packets logged which are also passed\n"
"LOG_WARNING - packets logged which are also blocked\n"
"LOG_ERR - packets which have been logged and which can be considered short due to an incomplete header\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2417
#, fuzzy
msgid ""
"In order to setup IPF to log all data to [.filename]#/var/log/ipfilter.log#,"
" first create the empty file:"
msgstr ""
"为了将IPF配置为将所有数据记录到 `/var/log/ipfilter.log`，首先创建一个空文件：`/var/log/ipfilter.log`。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2421
#, no-wrap
msgid "# touch /var/log/ipfilter.log\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2424
#, fuzzy
msgid ""
"Then, to write all logged messages to the specified file, add the following "
"statement to [.filename]#/etc/syslog.conf#:"
msgstr "然后，要将所有已记录的消息写入指定的文件，请在 [.filename]#/etc/syslog.conf# 添加以下语句："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2428
#, no-wrap
msgid "local0.* /var/log/ipfilter.log\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2431
#, fuzzy
msgid ""
"To activate the changes and instruct man:syslogd[8] to read the modified "
"[.filename]#/etc/syslog.conf#, run `service syslogd reload`."
msgstr ""
"要激活更改并指示 man:syslogd[8] 读取已修改的 [.filename]#/etc/syslog.conf#，运行`service "
"syslogd reload`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2433
#, fuzzy
msgid ""
"Do not forget to edit [.filename]#/etc/newsyslog.conf# to rotate the new log"
" file."
msgstr "不要忘记编辑[.filename]#/etc/newsyslog.conf#以便轮转新的日志文件。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2436
#, fuzzy
msgid ""
"Messages generated by `ipmon` consist of data fields separated by white "
"space.  Fields common to all messages are:"
msgstr "`ipmon`生成的消息由以空格分隔的数据字段组成。所有消息共有的字段如下："

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2438
#, fuzzy
msgid "The date of packet receipt."
msgstr "数据包接收日期。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2439
#, fuzzy
msgid ""
"The time of packet receipt. This is in the form HH:MM:SS.F, for hours, "
"minutes, seconds, and fractions of a second."
msgstr "接收数据包的时间。时间格式为HH:MM:SS.F，表示小时、分钟、秒和秒的小数部分。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2440
#, fuzzy
msgid "The name of the interface that processed the packet."
msgstr "处理数据包的接口的名称。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2441
#, fuzzy
msgid "The group and rule number of the rule in the format `@0:17`."
msgstr "规则的组别和编号格式为`@0:17`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2442
#, fuzzy
msgid ""
"The action: `p` for passed, `b` for blocked, `S` for a short packet, `n` did"
" not match any rules, and `L` for a log rule."
msgstr "动作: `p` 表示通过，`b` 表示阻止，`S` 表示短包，`n` 表示未匹配任何规则，`L` 表示日志规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2443
#, fuzzy
msgid ""
"The addresses written as three fields: the source address and port separated"
" by a comma, the -> symbol, and the destination address and port. For "
"example: `209.53.17.22,80 -> 198.73.220.17,1722`."
msgstr ""
"这些地址写作三个字段: 源地址和端口由逗号分隔，接着是 -> 符号，然后是目标地址和端口。例如: `209.53.17.22,80 -> "
"198.73.220.17,1722`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2444
#, fuzzy
msgid "`PR` followed by the protocol name or number: for example, `PR tcp`."
msgstr "`PR` 后跟协议名称或编号：例如，`PR tcp`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2445
#, fuzzy
msgid ""
"`len` followed by the header length and total length of the packet: for "
"example, `len 20 40`."
msgstr "`len`后面跟着的是数据包的头部长度和总长度：例如，`len 20 40`。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2448
#, fuzzy
msgid ""
"If the packet is a TCP packet, there will be an additional field starting "
"with a hyphen followed by letters corresponding to any flags that were set."
"  Refer to man:ipf[5] for a list of letters and their flags."
msgstr ""
"如果数据包是TCP数据包，那么还会有一个以连字符开头的附加字段，后面跟着对应于设置的任何标志的字母。请参考 man:ipf[5] "
"了解字母及其标志的列表。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2451
#, fuzzy
msgid ""
"If the packet is an ICMP packet, there will be two fields at the end: the "
"first always being \"icmp\" and the next being the ICMP message and sub-"
"message type, separated by a slash.  For example: `icmp 3/3` for a port "
"unreachable message."
msgstr ""
"如果数据包是一个 ICMP 数据包，末尾会有两个字段：第一个字段始终是 \"icmp\"，然后是 ICMP "
"消息和子消息类型，用斜杠分隔。例如：对于一个端口不可达的消息，会是 `icmp 3/3`。"

#. type: Title ==
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2453
#, fuzzy, no-wrap
msgid "Blacklistd"
msgstr ""
"Blacklistd 是一个计算机安全工具，它用于管理黑名单。通过黑名单，用户可以限制特定的网络连接或者阻止某些 IP "
"地址或域名的访问。Blacklistd 可以帮助保护计算机免受恶意行为或攻击的影响。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2460
#, fuzzy
msgid ""
"Blacklistd is a daemon listening to sockets awaiting to receive "
"notifications from other daemons about connection attempts that failed or "
"were successful.  It is most widely used in blocking too many connection "
"attempts on open ports.  A prime example is SSH running on the internet "
"getting a lot of requests from bots or scripts trying to guess passwords and"
" gain access.  Using blacklistd, the daemon can notify the firewall to "
"create a filter rule to block excessive connection attempts from a single "
"source after a number of tries. Blacklistd was first developed on NetBSD and"
" appeared there in version 7.  FreeBSD 11 imported blacklistd from NetBSD."
msgstr ""
"Blacklistd是一个守护进程，监听套接字接收来自其他守护进程的关于连接尝试失败或成功的通知。它在阻止对开放端口的过多连接尝试中应用最广泛。一个典型的例子是在Internet上运行的SSH收到大量来自机器人或脚本的请求，试图猜测密码并获取访问权限。使用blacklistd，该守护进程可以通知防火墙在多次尝试后从单个源地址阻止过多的连接尝试，并创建过滤规则。"
" Blacklistd最早是在NetBSD上开发的，并在版本7中首次出现。FreeBSD 11从NetBSD导入了blacklistd。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2465
#, fuzzy
msgid ""
"This chapter describes how to set up blacklistd, configure it, and provides "
"examples on how to use it.  Readers should be familiar with basic firewall "
"concepts like rules.  For details, refer to the firewall chapter.  PF is "
"used in the examples, but other firewalls available on FreeBSD should be "
"able to work with blacklistd, too."
msgstr ""
"本章介绍了如何设置 "
"blacklistd，配置它，并提供了如何使用它的示例。读者应该熟悉基本的防火墙概念，如规则。有关详细信息，请参考防火墙章节。示例中使用了 PF，但在 "
"FreeBSD 上可用的其他防火墙也应该能够与 blacklistd 一起工作。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2466
#, fuzzy, no-wrap
msgid "Enabling Blacklistd"
msgstr "启用 Blacklistd"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2472
#, fuzzy
msgid ""
"The main configuration for blacklistd is stored in man:blacklistd.conf[5].  "
"Various command line options are also available to change blacklistd's run-"
"time behavior.  Persistent configuration across reboots should be stored in "
"[.filename]#/etc/blacklistd.conf#.  To enable the daemon during system boot,"
" add a `blacklistd_enable` line to [.filename]#/etc/rc.conf# like this:"
msgstr ""
"黑名单守护进程的主要配置存储在 man:blacklistd.conf[5] "
"中。还有各种命令行选项可用于更改黑名单守护进程的运行时行为。应将持久配置存储在 [.filename]#/etc/blacklistd.conf# "
"中，以便在重启后仍然有效。要在系统启动时启用守护进程，请在 [.filename]#/etc/rc.conf# 中添加一行 "
"`blacklistd_enable`，例如："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2476
#, no-wrap
msgid "# sysrc blacklistd_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2479
#, fuzzy
msgid "To start the service manually, run this command:"
msgstr "要手动启动服务，请运行以下命令："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2483
#, no-wrap
msgid "# service blacklistd start\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2485
#, fuzzy, no-wrap
msgid "Creating a Blacklistd Ruleset"
msgstr "创建一个 Blacklistd 规则集"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2490
#, fuzzy
msgid ""
"Rules for blacklistd are configured in man:blacklistd.conf[5] with one entry"
" per line.  Each rule contains a tuple separated by spaces or tabs.  Rules "
"either belong to a `local` or a `remote`, which applies to the machine where"
" blacklistd is running or an outside source, respectively."
msgstr ""
"黑名单管理程序 blacklistd 的规则配置在 man:blacklistd.conf[5] "
"中，每行配置一条规则。每条规则由用空格或制表符分隔的元组组成。规则可以属于 `local`（本地）或 `remote`（远程），分别适用于运行 "
"blacklistd 的机器或外部来源。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2491
#, fuzzy, no-wrap
msgid "Local Rules"
msgstr "局部规定"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2494
#, fuzzy
msgid "An example blacklistd.conf entry for a local rule looks like this:"
msgstr "一个本地规则的黑名单配置文件(blacklistd.conf)的示例条目如下所示："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2499
#, no-wrap
msgid ""
"[local]\n"
"ssh             stream  *       *               *       3       24h\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2503
#, fuzzy
msgid ""
"All rules that follow the `[local]` section are treated as local rules "
"(which is the default), applying to the local machine.  When a `[remote]` "
"section is encountered, all rules that follow it are handled as remote "
"machine rules."
msgstr ""
"所有跟随`[local]`部分的规则都被视为本地规则（默认情况下），适用于本地计算机。当遇到`[remote]`部分时，所有跟随它的规则将被视为远程计算机规则。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2511
#, fuzzy
msgid ""
"Seven fields separated by either tabs or spaces define a rule.  The first "
"four fields identify the traffic that should be blocklisted.  The three "
"fields that follow define backlistd's behavior.  Wildcards are denoted as "
"asterisks (`*`), matching anything in this field.  The first field defines "
"the location.  In local rules, these are the network ports.  The syntax for "
"the location field is as follows:"
msgstr ""
"一个规则由七个用制表符或空格分隔的字段组成。前四个字段用于标识应被列入黑名单的流量。后面的三个字段定义了黑名单应采取的行为。通配符被表示为星号（`*`），表示该字段中的任何内容。第一个字段定义了位置。在本地规则中，这些是网络端口。位置字段的语法如下:"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2515
#, no-wrap
msgid "[address|interface][/mask][:port]\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2519
#, fuzzy
msgid ""
"Addresses can be specified as IPv4 in numeric format or IPv6 in square "
"brackets.  An interface name like `_em0_` can also be used."
msgstr "地址可以用数字格式的IPv4或方括号中的IPv6来指定。也可以使用类似 `_em0_`的接口名称。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2523
#, fuzzy
msgid ""
"The socket type is defined by the second field.  TCP sockets are of type "
"`stream`, whereas UDP is denoted as `dgram`.  The example above uses TCP, "
"since SSH is using that protocol."
msgstr ""
"套接字类型由第二个字段定义。TCP套接字的类型是`stream`，而UDP则表示为`dgram`。上面的示例使用了TCP，因为SSH正在使用该协议。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2527
#, fuzzy
msgid ""
"A protocol can be used in the third field of a blacklistd rule.  The "
"following protocols can be used: `tcp`, `udp`, `tcp6`, `udp6`, or numeric.  "
"A wildcard, like in the example, is typically used to match all protocols "
"unless there is a reason to distinguish traffic by a certain protocol."
msgstr ""
"协议可以在blacklistd规则的第三个字段中使用。可以使用以下协议：`tcp`、`udp`、`tcp6`、`udp6`或数字。通常使用通配符（如示例中）可用于匹配所有协议，除非有特定协议区分流量的原因。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2530
#, fuzzy
msgid ""
"In the fourth field, the effective user or owner of the daemon process that "
"is reporting the event is defined.  The username or UID can be used here, as"
" well as a wildcard (see example rule above)."
msgstr "在第四字段中，定义了报告事件的守护进程的有效用户或拥有者。可以在此处使用用户名或UID，以及通配符（参见上面的示例规则）。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2533
#, fuzzy
msgid ""
"The packet filter rule name is declared by the fifth field, which starts the"
" behavior part of the rule.  By default, blacklistd puts all blocks under a "
"pf anchor called `blacklistd` in [.filename]#pf.conf# like this:"
msgstr ""
"包过滤规则的名称由第五个字段声明，这个字段开启规则的行为部分。默认情况下，blacklistd 将所有阻止操作放在一个名为`blacklistd`的 "
"pf 锚中，就像这样放在 [.filename]#pf.conf# 文件中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2539
#, no-wrap
msgid ""
"anchor \"blacklistd/*\" in on $ext_if\n"
"block in\n"
"pass out\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2545
#, fuzzy
msgid ""
"For separate blocklists, an anchor name can be used in this field.  In other"
" cases, the wildcard will suffice.  When a name starts with a hyphen (`-`) "
"it means that an anchor with the default rule name prepended should be used."
"  A modified example from the above using the hyphen would look like this:"
msgstr ""
"对于独立的块列表，可以在此字段中使用锚点名称。在其他情况下，通配符就足够了。当名称以连字符（`-`）开头时，表示应使用带有默认规则名称前缀的锚点。使用连字符的修改示例如下："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2549
#, no-wrap
msgid "ssh             stream  *       *               -ssh       3       24h\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2552
#, fuzzy
msgid ""
"With such a rule, any new blocklist rules are added to an anchor called "
"`blacklistd-ssh`."
msgstr "有了这样的规则，任何新的屏蔽列表规则都会添加到一个名为`blacklistd-ssh`的锚点上。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2556
#, fuzzy
msgid ""
"To block whole subnets for a single rule violation, a `/` in the rule name "
"can be used.  This causes the remaining portion of the name to be "
"interpreted as the mask to be applied to the address specified in the rule."
"  For example, this rule would block every address adjoining `/24`."
msgstr ""
"为了对于单个规则违规屏蔽整个子网，可以在规则名称中使用 `/`。这会导致名称的剩余部分被解释为要应用于规则中指定的地址的掩码。例如，这个规则将屏蔽与 "
"`/24` 相邻的所有地址。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2560
#, no-wrap
msgid "22              stream  tcp       *               */24    3       24h\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2566
#, fuzzy
msgid ""
"It is important to specify the proper protocol here.  IPv4 and IPv6 treat "
"/24 differently, that is the reason why `*` cannot be used in the third "
"field for this rule."
msgstr "在这里，明确指定适当的协议非常重要。IPv4和IPv6对待/24的方式不同，这就是为什么在这个规则的第三个字段中不能使用 `*` 的原因。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2569
#, fuzzy
msgid ""
"This rule defines that if any one host in that network is misbehaving, "
"everything else on that network will be blocked, too."
msgstr "这条规则定义了如果该网络中的任何一台主机表现不端，那么该网络上的其他所有内容也将被阻止。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2573
#, fuzzy
msgid ""
"The sixth field, called `nfail`, sets the number of login failures required "
"to blocklist the remote IP in question.  When a wildcard is used at this "
"position, it means that blocks will never happen.  In the example rule "
"above, a limit of three is defined meaning that after three attempts to log "
"into SSH on one connection, the IP is blocked."
msgstr ""
"第六个字段称为 `nfail`，它设置了必须发生的登录失败次数，以在被检查的远程 IP "
"被列入封锁名单。当在该位置使用通配符时，表示封锁将永远不会发生。在上面的示例规则中，定义了限制为三次，意味着在一次连接中尝试登录 SSH 三次后，该 "
"IP 将被封锁。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2576
#, fuzzy
msgid ""
"The last field in a blacklistd rule definition specifies how long a host is "
"blocklisted.  The default unit is seconds, but suffixes like `m`, `h`, and "
"`d` can also be specified for minutes, hours, and days, respectively."
msgstr "黑名单规则定义中的最后一个字段指定了主机被阻止的时间。默认的单位是秒，但也可以指定`m`、`h`和`d`分别表示分钟、小时和天。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2580
#, fuzzy
msgid ""
"The example rule in its entirety means that after three times authenticating"
" to SSH will result in a new PF block rule for that host.  Rule matches are "
"performed by first checking local rules one after another, from most "
"specific to least specific.  When a match occurs, the `remote` rules are "
"applied and the name, `nfail`, and disable fields are changed by the "
"`remote` rule that matched."
msgstr ""
"完整的示例规则意味着在 SSH 进行三次身份验证后，将为该主机创建一个新的 PF "
"阻止规则。规则匹配是通过首先逐个检查本地规则来进行的，从最具体到最不具体。当匹配发生时，将应用“远程”规则，并且匹配的“远程”规则将更改名称、`nfail`"
" 和禁用字段。"

#. type: Title ====
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2581
#, fuzzy, no-wrap
msgid "Remote Rules"
msgstr "远程规则"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2587
#, fuzzy
msgid ""
"Remote rules are used to specify how blacklistd changes its behavior "
"depending on the remote host currently being evaluated.  Each field in a "
"remote rule is the same as in a local rule.  The only difference is in the "
"way blacklistd is using them.  To explain it, this example rule is used:"
msgstr ""
"远程规则用于指定 blacklistd 根据当前正在评估的远程主机来改变其行为的方式。远程规则中的每个字段与本地规则中的字段相同，唯一的区别在于 "
"blacklistd 使用它们的方式。为了解释这一点，我们使用下面的示例规则："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2592
#, no-wrap
msgid ""
"[remote]\n"
"203.0.113.128/25 *      *       *               =/25    =       48h\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2597
#, fuzzy
msgid ""
"The address field can be an IP address (either v4 or v6), a port or both.  "
"This allows setting special rules for a specific remote address range like "
"in this example.  The fields for socket type, protocol and owner are "
"identically interpreted as in the local rule."
msgstr ""
"地址字段可以是 IP 地址（IPv4 或 "
"IPv6），端口或两者兼有。这允许对特定的远程地址范围设置特殊规则，就像这个例子中一样。套接字类型、协议和所有者字段的解释与本地规则完全相同。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2603
#, fuzzy
msgid ""
"The name fields is different though: the equal sign (`=`) in a remote rule "
"tells blacklistd to use the value from the matching local rule.  It means "
"that the firewall rule entry is taken and the `/25` prefix (a netmask of "
"`255.255.255.128`) is added.  When a connection from that address range is "
"blocklisted, the entire subnet is affected.  A PF anchor name can also be "
"used here, in which case blacklistd will add rules for this address block to"
" the anchor of that name.  The default table is used when a wildcard is "
"specified."
msgstr ""
"名称字段不同：远程规则中的等号（`=`）告诉 blacklistd 使用匹配的本地规则的值。它意味着防火墙规则条目被采用，加上 `/25` "
"前缀（`255.255.255.128` 的子网掩码）。当来自该地址范围的连接被列入黑名单，整个子网都会受到影响。在这里也可以使用 PF 锚点名称，这样"
" blacklistd 将为该地址块添加到相应名称的锚点的规则。在指定通配符时使用默认表格。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2607
#, fuzzy
msgid ""
"A custom number of failures in the `nfail` column can be defined for an "
"address.  This is useful for exceptions to a specific rule, to maybe allow "
"someone a less strict application of rules or a bit more leniency in login "
"tries.  Blocking is disabled when an asterisk is used in this sixth field."
msgstr ""
"可以为地址定义`nfail`列中的自定义失败次数。这对于特定规则的异常情况非常有用，可以允许某人在应用规则时更宽松一些或在登录尝试方面更宽容一些。当在该第六个字段中使用星号时，阻止功能将被禁用。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2609
#, fuzzy
msgid ""
"Remote rules allow a stricter enforcement of limits on attempts to log in "
"compared to attempts coming from a local network like an office."
msgstr "远程规则可对登录尝试的限制施加更严格的执行，相比于来自办公室等本地网络的尝试。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2610
#, fuzzy, no-wrap
msgid "Blacklistd Client Configuration"
msgstr ""
"黑名单客户端配置\n"
"\n"
"asciidoc 标签:\n"
"\n"
"- `Blacklistd`：黑名单服务\n"
"- `Client Configuration`：客户端配置"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2615
#, fuzzy
msgid ""
"There are a few software packages in FreeBSD that can utilize blacklistd's "
"functionality.  The two most prominent ones are man:ftpd[8] and man:sshd[8] "
"to block excessive connection attempts.  To activate blacklistd in the SSH "
"daemon, add the following line to [.filename]#/etc/ssh/sshd_config#:"
msgstr ""
"在FreeBSD中有几个软件包可以利用blacklistd的功能。其中两个最突出的是man:ftpd[8]和man:sshd[8]，可以用来阻止过多的连接尝试。要在SSH守护程序中激活blacklistd，将以下行添加到[.filename]#/etc/ssh/sshd_config#文件中："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2619
#, no-wrap
msgid "UseBlacklist yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2622
#, fuzzy
msgid "Restart sshd afterwards to make these changes take effect."
msgstr "在此之后重新启动sshd以使这些更改生效。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2624
#, fuzzy
msgid ""
"Blacklisting for man:ftpd[8] is enabled using `-B`, either in "
"[.filename]#/etc/inetd.conf# or as a flag in [.filename]#/etc/rc.conf# like "
"this:"
msgstr ""
"禁用 man:ftpd[8] 的黑名单功能可以使用 `-B`，可以在 [.filename]#/etc/inetd.conf# 中或者作为 "
"[.filename]#/etc/rc.conf# 的一个标志来启用。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2628
#, no-wrap
msgid "ftpd_flags=\"-B\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2631
#, fuzzy
msgid "That is all that is needed to make these programs talk to blacklistd."
msgstr "这是使这些程序与blacklistd进行通信所需的全部内容。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2632
#, fuzzy, no-wrap
msgid "Blacklistd Management"
msgstr "Blacklistd 管理"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2637
#, fuzzy
msgid ""
"Blacklistd provides the user with a management utility called "
"man:blacklistctl[8].  It displays blocked addresses and networks that are "
"blocklisted by the rules defined in man:blacklistd.conf[5].  To see the list"
" of currently blocked hosts, use `dump` combined with `-b` like this."
msgstr ""
"Blacklistd为用户提供一个管理工具，名为man:blacklistctl[8]。它显示被man:blacklistd.conf[5]中定义规则所屏蔽的地址和网络。要查看当前被阻止的主机列表，可以使用`dump`命令结合`-b`选项，如下所示。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2643
#, no-wrap
msgid ""
"# blacklistctl dump -b\n"
"      address/ma:port id      nfail   last access\n"
"213.0.123.128/25:22   OK      6/3     2019/06/08 14:30:19\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2649
#, fuzzy
msgid ""
"This example shows that there were 6 out of three permitted attempts on port"
" 22 coming from the address range `213.0.123.128/25`.  There are more "
"attempts listed than are allowed because SSH allows a client to try multiple"
" logins on a single TCP connection.  A connection that is currently going on"
" is not stopped by blacklistd.  The last connection attempt is listed in the"
" `last access` column of the output."
msgstr ""
"这个例子表明，来自地址范围`213.0.123.128/25`的端口22上有6次尝试，其中只有三次是允许的。列出的尝试次数比允许的要多，因为SSH允许客户端在单个TCP连接上尝试多次登录。正在进行中的连接不会被blacklistd停止。输出的“last"
" access”列显示了最后一次连接尝试的时间。"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2651
#, fuzzy
msgid ""
"To see the remaining time that this host will be on the blocklist, add `-r` "
"to the previous command."
msgstr "要查看此主机在黑名单上保留的剩余时间，请在上一个命令中添加`-r`选项。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2657
#, no-wrap
msgid ""
"# blacklistctl dump -br\n"
"      address/ma:port id      nfail   remaining time\n"
"213.0.123.128/25:22   OK      6/3     36s\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2660
#, fuzzy
msgid ""
"In this example, there are 36s seconds left until this host will not be "
"blocked any more."
msgstr "在这个例子中，距离这个主机不再被阻止还有36秒。"

#. type: Title ===
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2661
#, fuzzy, no-wrap
msgid "Removing Hosts from the Block List"
msgstr "从阻止列表中移除主机"

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2672
#, fuzzy
msgid ""
"Sometimes it is necessary to remove a host from the block list before the "
"remaining time expires.  Unfortunately, there is no functionality in "
"blacklistd to do that.  However, it is possible to remove the address from "
"the PF table using pfctl.  For each blocked port, there is a child anchor "
"inside the blacklistd anchor defined in [.filename]#/etc/pf.conf#.  For "
"example, if there is a child anchor for blocking port 22 it is called "
"`blacklistd/22`.  There is a table inside that child anchor that contains "
"the blocked addresses.  This table is called port followed by the port "
"number.  In this example, it would be called `port22`.  With that "
"information at hand, it is now possible to use man:pfctl[8] to display all "
"addresses listed like this:"
msgstr ""
"有时候需要在剩余时间到期之前将主机从封锁列表中移除。不幸的是，blacklistd 中没有相应的功能可以实现这一点。然而，可以使用 pfctl "
"命令将地址从 PF 表中移除。对于每个被封锁的端口，blacklistd 锚点中都定义了一个子锚点。例如，如果有一个用于封锁端口 22 "
"的子锚点，它被称为 `blacklistd/22`。在子锚点内有一个包含被封锁地址的表。该表的名称是 "
"`port`，后面跟着端口号。在这个例子中，表的名称将是 `port22`。有了这些信息，现在可以使用 man:pfctl[8] "
"命令将列出所有以这种方式命名的地址。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2679
#, no-wrap
msgid ""
"# pfctl -a blacklistd/22 -t port22 -T show\n"
"...\n"
"213.0.123.128/25\n"
"...\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2682
#, fuzzy
msgid ""
"After identifying the address to be unblocked from the list, the following "
"command removes it from the list:"
msgstr "在从列表中确定要解除阻止的地址之后，以下命令将其从列表中移除："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2686
#, no-wrap
msgid "# pfctl -a blacklistd/22 -t port22 -T delete 213.0.123.128/25\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/firewalls/_index.adoc:2690
#, fuzzy
msgid ""
"The address is now removed from PF, but will still show up in the "
"blacklistctl list, since it does not know about any changes made in PF.  The"
" entry in blacklistd's database will eventually expire and be removed from "
"its output.  The entry will be added again if the host is matching one of "
"the block rules in blacklistd again."
msgstr ""
"地址已从PF中移除，但仍会显示在blacklistctl列表中，因为它不知道PF中的任何更改。 "
"blacklistd数据库中的条目最终将过期并从输出中删除。如果主机再次与blacklistd中的阻止规则匹配，该条目将再次被添加。"
