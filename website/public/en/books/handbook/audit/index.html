<!DOCTYPE html>
<html class="theme-light" lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="FreeBSD security event auditing supports reliable, fine-grained, and configurable logging of a variety of security-relevant system events, including logins, configuration changes, and file and network access"/>
  <meta name="keywords" content="audit, terms, configuration, guide, audit trails"/>
  <meta name="copyright" content="1995-2023 The FreeBSD Foundation" />
  <link rel="canonical" href="http://127.0.0.1:5500/en/books/handbook/audit/" />

  <title>Chapter 19. Security Event Auditing |  FreeBSD Documentation Portal</title>

  <meta name="theme-color" content="#790000">
  <meta name="color-scheme" content="system light dark high-contrast">

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles/main.min.css">
    <link rel="stylesheet" href="/css/font-awesome-min.css">
    <script defer src="/js/theme-chooser.min.js"></script>
    <script defer src="/js/copy-clipboard.min.js"></script>
    <script defer src="/js/search.min.js"></script>

  
  
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:domain" content="docs.FreeBSD.org"/>
    <meta name="twitter:site" content="@freebsd"/>
    <meta name="twitter:url" content="https://twitter.com/freebsd"/>
    <meta property="og:title" content="Chapter 19. Security Event Auditing" />
    <meta property="og:description" content="FreeBSD security event auditing supports reliable, fine-grained, and configurable logging of a variety of security-relevant system events, including logins, configuration changes, and file and network access" />
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="http://127.0.0.1:5500favicon.ico"/>
    <meta property="og:image:alt" content="FreeBSD Logo">
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="http://127.0.0.1:5500/en/books/handbook/audit/" />
    <meta property="og:site_name" content="FreeBSD Documentation Portal" />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Article",
        "url": "http:\/\/127.0.0.1:5500\/en\/books\/handbook\/audit\/",
        "name": "FreeBSD Documentation Portal",
        "headline": "FreeBSD Documentation Portal",
        "description": "FreeBSD Documentation Portal"
      }
    </script>
    

  
</head>


  <body>
    <header>
  <div class="header-container">
    <div class="logo-menu-bars-container">
      <a href="http://127.0.0.1:5500" class="logo">
        <img src="/images/FreeBSD-monochromatic.svg" width="160" height="50" alt="FreeBSD logo" />
      </a>
      <label class="menu-bars" for="menu-bars">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </div>
    <input id="menu-bars" type="checkbox" />
    
    <div class="search-donate-container">
      
      
    </div>
  </div>
</header>

    
<input type="checkbox" class="hidden toggle" id="menu-control">
<main class="main-wrapper-book">
  <a id="top"></a>
  
  <aside class="book-menu">
    <div class="book-menu-content">
      <input id="search-book" type="text" placeholder="Search" aria-label="Search" maxlength="128" />
      <nav id="MenuContents">
        
  <ul>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ada319c45e780947f82b569049480cc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-8ada319c45e780947f82b569049480cc"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/preface/">
              Preface
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-audience">Intended Audience</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-changes-from4">Fourth Edition</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-changes-from3">Third Edition</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-changes-from2">Second Edition (2004)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-changes">First Edition (2001)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-overview">Organization of This Book</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-conv">Conventions used in this book</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/preface/#preface-acknowledgements">Acknowledgments</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-32a83d18a326852a8d9ae2582360bbc8" class="toggle"  />
          <label  for="chapter-32a83d18a326852a8d9ae2582360bbc8"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/parti/">
              Part I. Getting Started
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a4909db05d872d16d5be86a57cbc2dc7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a4909db05d872d16d5be86a57cbc2dc7"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/introduction/">
              Chapter 1. Introduction
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/introduction/#introduction-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/introduction/#nutshell">2. Welcome to FreeBSD!</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/introduction/#history">3. About the FreeBSD Project</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3c2455cadf89eadd3f6e77461085d5e9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3c2455cadf89eadd3f6e77461085d5e9"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/">
              Chapter 2. Installing FreeBSD
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-hardware">2. Minimum Hardware Requirements</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-pre">3. Pre-Installation Tasks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-start">4. Starting the Installation</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#using-bsdinstall">5. Using bsdinstall</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-partitioning">6. Allocating Disk Space</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-fetching-distribution">7. Fetching Distribution Files</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-post">8. Network Interfaces, Accounts, Time Zone, Services and Hardening</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#bsdinstall-install-trouble">9. Troubleshooting</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bsdinstall/#using-live-cd">10. Using the Live CD</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-709481b75d22ad36960f7ac166b3306c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-709481b75d22ad36960f7ac166b3306c"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/basics/">
              Chapter 3. FreeBSD Basics
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#basics-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#consoles">2. Virtual Consoles and Terminals</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#users-synopsis">3. Users and Basic Account Management</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#permissions">4. Permissions</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#dirstructure">5. Directory Structure</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#disk-organization">6. Disk Organization</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#mount-unmount">7. Mounting and Unmounting File Systems</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#basics-processes">8. Processes and Daemons</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#shells">9. Shells</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#editors">10. Text Editors</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#basics-devices">11. Devices and Device Nodes</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/basics/#basics-more-information">12. Manual Pages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-58c050d31a1fbecd859248dacefeb567" class="toggle"  />
          <label  class="icon cursor"  for="chapter-58c050d31a1fbecd859248dacefeb567"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/ports/">
              Chapter 4. Installing Applications: Packages and Ports
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-overview">2. Overview of Software Installation</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-finding-applications">3. Finding Software</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#pkgng-intro">4. Using pkg for Binary Package Management</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-using">5. Using the Ports Collection</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-poudriere">6. Building Packages with poudriere</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-nextsteps">7. Post-Installation Considerations</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ports/#ports-broken">8. Dealing with Broken Ports</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e5a000ce7f50680a180e2c1b83c121bc" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e5a000ce7f50680a180e2c1b83c121bc"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/x11/">
              Chapter 5. The X Window System
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/x11/#x11-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/x11/#x-install">2. Installing Xorg</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/x11/#x-graphic-card-drivers">3. Graphic card drivers</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/x11/#x-config">4. Xorg Configuration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/x11/#x-fonts">5. Using Fonts in Xorg</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-235af08fb87fd7a58003348706d2111d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-235af08fb87fd7a58003348706d2111d"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/wayland/">
              Chapter 6. Wayland
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-synopsis">1. Wayland Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-wayfire">2. The Wayfire Compositor</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-hikari">3. The Hikari Compositor</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-sway">4. The Sway Compositor</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-xwayland">5. Using Xwayland</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-remotedesktop">6. Remote Desktop Using VNC</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-ly">7. Wayland Login Manager</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wayland/#wayland-utilities">8. Useful Utilities</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4de18483dde20bf9ed0024176afd09da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4de18483dde20bf9ed0024176afd09da"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/network/">
              Chapter 7. Network
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#network-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#config-network-setup">2. Setting up the Network</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#config-network-connection">3. Wired Networks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#network-wireless">4. Wireless Networks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#hostname">5. Hostname</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#dns">6. DNS</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network/#troubleshooting">7. Troubleshooting</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-5eb30759c3a2873e716dc31d7760054c" class="toggle"  />
          <label  for="chapter-5eb30759c3a2873e716dc31d7760054c"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/partii/">
              Part II. Common Tasks
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-c96504f017c56f4bc7f71548cccf5382" class="toggle"  />
          <label  class="icon cursor"  for="chapter-c96504f017c56f4bc7f71548cccf5382"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/desktop/">
              Chapter 8. Desktop Environments
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-environments">2. Desktop Environments</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-browsers">3. Browsers</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-development">4. Development tools</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-productivity">5. Desktop office productivity</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-viewers">6. Document Viewers</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/desktop/#desktop-finance">7. Finance</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-e1898af36aaacc168e13b673d25b908f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-e1898af36aaacc168e13b673d25b908f"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/multimedia/">
              Chapter 9. Multimedia
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#multimedia-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#sound-setup">2. Setting Up the Sound Card</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#audio-ports">3. Audio players</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#video-ports">4. Video players</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#conferencing-meetings">5. Conferencing and Meetings</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/multimedia/#scanners">6. Image Scanners</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6926664836e63c5cae4b2fa60855f91d" class="toggle"  />
          <label  class="icon cursor"  for="chapter-6926664836e63c5cae4b2fa60855f91d"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/">
              Chapter 10. Configuring the FreeBSD Kernel
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-custom-kernel">2. Why Build a Custom Kernel?</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-devices">3. Finding the System Hardware</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-config">4. The Configuration File</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-building">5. Building and Installing a Custom Kernel</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/kernelconfig/#kernelconfig-trouble">6. If Something Goes Wrong</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-19d36bd70a320268f0ea1f66e4f3e224" class="toggle"  />
          <label  class="icon cursor"  for="chapter-19d36bd70a320268f0ea1f66e4f3e224"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/printing/">
              Chapter 11. Printing
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-quick-start">1. Quick Start</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-connections">2. Printer Connections</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-pdls">3. Common Page Description Languages</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-direct">4. Direct Printing</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-lpd">5. LPD (Line Printer Daemon)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/printing/#printing-other">6. Other Printing Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79" class="toggle"  />
          <label  class="icon cursor"  for="chapter-a07f539e6c18f2db4da5dbb2b5bb1e79"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/linuxemu/">
              Chapter 12. Linux Binary Compatibility
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/linuxemu/#linuxemu-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/linuxemu/#linuxemu-lbc-install">2. Configuring Linux Binary Compatibility</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/linuxemu/#linux-userlands">3. Linux userlands</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/linuxemu/#linuxemu-advanced">4. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-af234c193ce95c480af0ff5ec3f32f5c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-af234c193ce95c480af0ff5ec3f32f5c"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/wine/">
              Chapter 13. WINE
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#wine-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#wine-overview-concepts">2. WINE Overview & Concepts</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#installing-wine-on-freebsd">3. Installing WINE on FreeBSD</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#running-first-wine-program">4. Running a First WINE Program on FreeBSD</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#configuring-wine-installation">5. Configuring WINE Installation</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#wine-management-guis">6. WINE Management GUIs</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#wine-in-multi-user-os-installations">7. WINE in Multi-User FreeBSD Installations</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/wine/#wine-on-os-faq">8. WINE on FreeBSD FAQ</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-51416fdea9d5a1dfa1c2718cd825213a" class="toggle"  />
          <label  for="chapter-51416fdea9d5a1dfa1c2718cd825213a"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/partiii/">
              Part III. System Administration
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-532d0380ba66d66e033765a0b6930ee7" class="toggle"  />
          <label  class="icon cursor"  for="chapter-532d0380ba66d66e033765a0b6930ee7"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/config/">
              Chapter 14. Configuration, Services, Logging and Power Management
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#config-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#configtuning-configfiles">2. Configuration Files</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#configtuning-rcd">3. Managing Services in FreeBSD</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#cron-periodic">4. Cron and Periodic</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#configtuning-syslog">5. Configuring System Logging</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#acpi-overview">6. Power and Resource Management</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/config/#adding-swap-space">7. Adding Swap Space</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-d05f41680fb7e3d68b354ae03de368b1" class="toggle"  />
          <label  class="icon cursor"  for="chapter-d05f41680fb7e3d68b354ae03de368b1"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/boot/">
              Chapter 15. The FreeBSD Booting Process
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/boot/#boot-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/boot/#boot-introduction">2. FreeBSD Boot Process</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/boot/#device-hints">3. Device Hints</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/boot/#boot-shutdown">4. Shutdown Sequence</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-513e8e407c57354df334059688e9b60a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-513e8e407c57354df334059688e9b60a"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/security/">
              Chapter 16. Security
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-intro">2. Introduction</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#sec-accounts">3. Securing Accounts</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-ids">4. Intrusion Detection System (IDS)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-secure-levels">5. Secure levels</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-file-flags">6. File flags</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#openssh">7. OpenSSH</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#openssl">8. OpenSSL</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#kerberos5">9. Kerberos</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#tcpwrappers">10. TCP Wrappers</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#fs-acl">11. Access Control Lists</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#capsicum">12. Capsicum</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-accounting">13. Process Accounting</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-resourcelimits">14. Resource Limits</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-pkg">15. Monitoring Third Party Security Issues</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/security/#security-advisories">16. FreeBSD Security Advisories</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0f7d2858504c83a029928c048d394e2a" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0f7d2858504c83a029928c048d394e2a"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/jails/">
              Chapter 17. Jails and Containers
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jails-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jail-types">2. Jail Types</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#host-configuration">3. Host Configuration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#classic-jail">4. Classic Jail (Thick Jail)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#thin-jail">5. Thin Jails</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jail-management">6. Jail Management</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jail-upgrading">7. Jail Upgrading</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jail-resource-limits">8. Jail Resource Limits</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/jails/#jail-managers-and-containers">9. Jail Managers and Containers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-15be125ce5997f51c5499e3a0dee6c2c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-15be125ce5997f51c5499e3a0dee6c2c"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/mac/">
              Chapter 18. Mandatory Access Control
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-inline-glossary">2. Key Terms</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-understandlabel">3. Understanding MAC Labels</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-planning">4. Planning the Security Configuration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-policies">5. Available MAC Policies</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-userlocked">6. User Lock Down</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-implementing">7. Nagios in a MAC Jail</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mac/#mac-troubleshoot">8. Troubleshooting the MAC Framework</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3f7e8d763b17c7d0c44c60505cf0feea" class="toggle"  checked  />
          <label  class="icon cursor"  for="chapter-3f7e8d763b17c7d0c44c60505cf0feea"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/audit/">
              Chapter 19. Security Event Auditing
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/audit/#audit-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/audit/#audit-inline-glossary">2. Key Terms</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/audit/#audit-config">3. Audit Configuration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/audit/#audit-administration">4. Working with Audit Trails</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7bb1cb2287cd08a3672cc878e604f0d0" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7bb1cb2287cd08a3672cc878e604f0d0"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/disks/">
              Chapter 20. Storage
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-adding">2. Adding Disks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-growing">3. Resizing and Growing Disks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#usb-disks">4. USB Storage Devices</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#creating-cds">5. Creating and Using CD Media</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#creating-dvds">6. Creating and Using DVD Media</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#floppies">7. Creating and Using Floppy Disks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#using-ntfs">8. Using NTFS Disks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#backup-basics">9. Backup Basics</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-virtual">10. Memory Disks</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#snapshots">11. File System Snapshots</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#quotas">12. Disk Quotas</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-encrypting">13. Encrypting Disk Partitions</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#swap-encrypting">14. Encrypting Swap</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/disks/#disks-hast">15. Highly Available Storage (HAST)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-dec5fc4f0100e5030db0fb188d8d4b2f" class="toggle"  />
          <label  class="icon cursor"  for="chapter-dec5fc4f0100e5030db0fb188d8d4b2f"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/geom/">
              Chapter 21. GEOM: Modular Disk Transformation Framework
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-striping">2. RAID0 - Striping</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-mirror">3. RAID1 - Mirroring</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-raid3">4. RAID3 - Byte-level Striping with Dedicated Parity</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-graid">5. Software RAID Devices</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-ggate">6. GEOM Gate Network</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-glabel">7. Labeling Disk Devices</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/geom/#geom-gjournal">8. UFS Journaling Through GEOM</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f1657a05627dd16bad31d4c7f675604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f1657a05627dd16bad31d4c7f675604"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/zfs/">
              Chapter 22. The Z File System (ZFS)
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-differences">1. What Makes ZFS Different</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-quickstart">2. Quick Start Guide</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-zpool">3. <code>zpool</code> Administration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-zfs">4. <code>zfs</code> Administration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-zfs-allow">5. Delegated Administration</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-advanced">6. Advanced Topics</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-links">7. Further Resources</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/zfs/#zfs-term">8. ZFS Features and Terminology</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-4c6bf6828e601b79edb2813329ac6604" class="toggle"  />
          <label  class="icon cursor"  for="chapter-4c6bf6828e601b79edb2813329ac6604"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/filesystems/">
              Chapter 23. Other File Systems
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/filesystems/#filesystems-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/filesystems/#filesystems-linux">2. Linux® File Systems</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-ae23289d4b6415f3f878893f9d3ef9b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-ae23289d4b6415f3f878893f9d3ef9b8"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/virtualization/">
              Chapter 24. Virtualization
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-guest-parallelsdesktop">2. FreeBSD as a Guest on Parallels Desktop for macOS®</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-guest-vmware">3. FreeBSD as a Guest on VMware Fusion for macOS®</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-guest-virtualbox">4. FreeBSD as a Guest on VirtualBox™</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-host-virtualbox">5. FreeBSD as a Host with VirtualBox™</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-host-bhyve">6. FreeBSD as a Host with bhyve</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/virtualization/#virtualization-host-xen">7. FreeBSD as a Xen™-Host</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-b279d2b738963a45a059268d2fae00d5" class="toggle"  />
          <label  class="icon cursor"  for="chapter-b279d2b738963a45a059268d2fae00d5"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/l10n/">
              Chapter 25. Localization - i18n/L10n Usage and Setup
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/l10n/#l10n-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/l10n/#using-localization">2. Using Localization</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/l10n/#l10n-compiling">3. Finding i18n Applications</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/l10n/#lang-setup">4. Locale Configuration for Specific Languages</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9e3f99bd76c861ab2e9a5f31ac421842" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9e3f99bd76c861ab2e9a5f31ac421842"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/">
              Chapter 26. Updating and Upgrading FreeBSD
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#updating-upgrading-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate">2. FreeBSD Update</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#updating-bootcode">3. Updating Bootcode</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#updating-upgrading-documentation">4. Updating the Documentation Set</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#current-stable">5. Tracking a Development Branch</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#makeworld">6. Updating FreeBSD from Source</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#small-lan">7. Tracking for Multiple Machines</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/cutting-edge/#building-on-non-freebsd-hosts">8. Building on non-FreeBSD Hosts</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-3ba999091575eb04ae88235cd0fb1afa" class="toggle"  />
          <label  class="icon cursor"  for="chapter-3ba999091575eb04ae88235cd0fb1afa"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/dtrace/">
              Chapter 27. DTrace
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/dtrace/#dtrace-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/dtrace/#dtrace-implementation">2. Implementation Differences</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/dtrace/#dtrace-enable">3. Enabling DTrace Support</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/dtrace/#dtrace-using">4. Using DTrace</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bdb217202a0a3eef4571dd1fcd50863c" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bdb217202a0a3eef4571dd1fcd50863c"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/usb-device-mode/">
              Chapter 28. USB Device Mode / USB OTG
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/usb-device-mode/#usb-device-mode-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/usb-device-mode/#usb-device-mode-terminals">2. USB Virtual Serial Ports</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/usb-device-mode/#usb-device-mode-network">3. USB Device Mode Network Interfaces</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/usb-device-mode/#usb-device-mode-storage">4. USB Virtual Storage Device</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-6d4439926bb106ac084ecc88cfd3cfa4" class="toggle"  />
          <label  for="chapter-6d4439926bb106ac084ecc88cfd3cfa4"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/partiv/">
              Part IV. Network Communication
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-05a353fcb61d8e035f7c43e14725766e" class="toggle"  />
          <label  class="icon cursor"  for="chapter-05a353fcb61d8e035f7c43e14725766e"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/">
              Chapter 29. Serial Communications
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#serial-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#serial">2. Serial Terminology and Hardware</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#term">3. Terminals</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#dialup">4. Dial-in Service</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#dialout">5. Dial-out Service</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/serialcomms/#serialconsole-setup">6. Setting Up the Serial Console</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8" class="toggle"  />
          <label  class="icon cursor"  for="chapter-7f0cbcbf6701b86eba3bbd6fc829f1b8"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/">
              Chapter 30. PPP
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/#userppp">2. Configuring PPP</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/#ppp-troubleshoot">3. Troubleshooting PPP Connections</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/#pppoe">4. Using PPP over Ethernet (PPPoE)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/ppp-and-slip/#pppoa">5. Using PPP over ATM (PPPoA)</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9d023b545804f197d195dd9412749943" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9d023b545804f197d195dd9412749943"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/mail/">
              Chapter 31. Electronic Mail
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#mail-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#mail-using">2. Mail Components</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#dragonFly-mail-agent">3. DragonFly Mail Agent (DMA)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#sendmail">4. Sendmail</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#mail-changingmta">5. Changing the Mail Transfer Agent</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#mail-agents">6. Mail User Agents</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mail/#mail-advanced">7. Advanced Topics</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-42b19e05d30c4135c74b9878818747a9" class="toggle"  />
          <label  class="icon cursor"  for="chapter-42b19e05d30c4135c74b9878818747a9"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/network-servers/">
              Chapter 32. Network Servers
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-servers-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-inetd">2. The inetd Super-Server</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-nfs">3. Network File System (NFS)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-nis">4. Network Information System (NIS)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-ldap">5. Lightweight Directory Access Protocol (LDAP)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-dhcp">6. Dynamic Host Configuration Protocol (DHCP)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-dns">7. Domain Name System (DNS)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-apache">8. Apache HTTP Server</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-ftp">9. File Transfer Protocol (FTP)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-samba">10. File and Print Services for Microsoft® Windows® Clients (Samba)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-ntp">11. Clock Synchronization with NTP</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/network-servers/#network-iscsi">12. iSCSI Initiator and Target Configuration</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9554a5177d00d0e87ada408809a1fc67" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9554a5177d00d0e87ada408809a1fc67"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/firewalls/">
              Chapter 33. Firewalls
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-intro">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-concepts">2. Firewall Concepts</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-pf">3. PF</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-ipfw">4. IPFW</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-ipf">5. IPFILTER (IPF)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/firewalls/#firewalls-blacklistd">6. Blacklistd</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-9903a1d844ed803a436595e93ec33572" class="toggle"  />
          <label  class="icon cursor"  for="chapter-9903a1d844ed803a436595e93ec33572"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/">
              Chapter 34. Advanced Networking
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#advanced-networking-synopsis">1. Synopsis</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-routing">2. Gateways and Routes</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#configtuning-virtual-hosts">3. Virtual Hosts</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-advanced-wireless">4. Wireless Advanced Authentication</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#wireless-ad-hoc-mode">5. Wireless Ad-hoc Mode</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-usb-tethering">6. USB Tethering</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-bluetooth">7. Bluetooth</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-bridging">8. Bridging</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-aggregation">9. Link Aggregation and Failover</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-diskless">10. Diskless Operation with PXE</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#carp">11. Common Address Redundancy Protocol (CARP)</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/advanced-networking/#network-vlan">12. VLANs</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-8ca29f99c249993ee9234cb4632af7a5" class="toggle"  />
          <label  for="chapter-8ca29f99c249993ee9234cb4632af7a5"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/partv/">
              Part V. Appendices
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-0229d553ebf23ffeb945be6f32836221" class="toggle"  />
          <label  class="icon cursor"  for="chapter-0229d553ebf23ffeb945be6f32836221"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/mirrors/">
              Appendix A. Obtaining FreeBSD
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mirrors/#mirrors">1. Mirrors</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mirrors/#git">2. Using Git</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mirrors/#svn">3. Using Subversion</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/mirrors/#mirrors-cdrom">4. CD and DVD Sets</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-743c99fa278b8138914ff018e40c9231" class="toggle"  />
          <label  class="icon cursor"  for="chapter-743c99fa278b8138914ff018e40c9231"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/bibliography/">
              Appendix B. Bibliography
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bibliography/#bibliography-freebsd">1. FreeBSD Bibliography</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bibliography/#bibliography-security">2. Security Reference</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bibliography/#bibliography-history">3. UNIX® History</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/bibliography/#bibliography-journals">4. Periodicals, Journals, and Magazines</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-de7eade4b8b64f298c0cbac44c2278da" class="toggle"  />
          <label  class="icon cursor"  for="chapter-de7eade4b8b64f298c0cbac44c2278da"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/eresources/">
              Appendix C. Resources on the Internet
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/eresources/#eresources-www">1. Websites</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/eresources/#eresources-mail">2. Mailing Lists</a></li>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/eresources/#eresources-news">3. Usenet Newsgroups</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26" class="toggle"  />
          <label  class="icon cursor"  for="chapter-bfb0d4e71c3c1a18a8b75e03f4b48e26"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/pgpkeys/">
              Appendix D. OpenPGP Keys
            </a>
            
            
  <ul>
    <li><a href="http://127.0.0.1:5500/en/books/handbook/pgpkeys/#pgpkeys-officers">1. Officers</a></li>
  </ul>

          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-2a8deedf14429128049622ec007c9d3f" class="toggle"  />
          <label  for="chapter-2a8deedf14429128049622ec007c9d3f"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/glossary/">
              FreeBSD Glossary
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-110dbb242491bf200e51e76db171f670" class="toggle"  />
          <label  for="chapter-110dbb242491bf200e51e76db171f670"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/colophon/">
              Colophon
            </a>
            
            
          

        
      </li>
    
      <li>
        

          
          
          

          <input type="checkbox" id="chapter-caffbcba74982e4b26b9263ac0232bc3" class="toggle"  />
          <label  for="chapter-caffbcba74982e4b26b9263ac0232bc3"><a role="button"></a></label>

          
            
            <a href="http://127.0.0.1:5500/en/books/handbook/introduction/">
              
            </a>
            
            
          

        
      </li>
    
      <li>
        
      </li>
    
  </ul>


      </nav>
    </div>
  </aside>
  
  <div class="book">
    
    <div class="book-menu-mobile">
      <label for="menu-control">
        <span class="menu-control-button">
          <i class="fa fa-list" aria-hidden="true" title="Book menu"></i>
          Book menu
        </span>
      </label>
    </div>
    
    <h1 class="title">Chapter 19. Security Event Auditing</h1>
    
    
    
    
    <div class="toc-mobile">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#audit-synopsis">1. Synopsis</a></li>
    <li><a href="#audit-inline-glossary">2. Key Terms</a></li>
    <li><a href="#audit-config">3. Audit Configuration</a></li>
    <li><a href="#audit-administration">4. Working with Audit Trails</a></li>
  </ul>
</nav>
    </div>
    
      
      
    
    <div class="book-content">
      <div id="preamble">
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="audit-synopsis">1. Synopsis<a class="anchor" href="#audit-synopsis"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The FreeBSD operating system includes support for security event auditing.
Event auditing supports reliable, fine-grained, and configurable logging of a variety of security-relevant system events, including logins, configuration changes, and file and network access.
These log records can be invaluable for live system monitoring, intrusion detection, and postmortem analysis.
FreeBSD implements Sun™&#39;s published Basic Security Module (BSM) Application Programming Interface (API) and file format, and is interoperable with the Solaris™ and Mac OS® X audit implementations.</p>
</div>
<div class="paragraph">
<p>This chapter focuses on the installation and configuration of event auditing.
It explains audit policies and provides an example audit configuration.</p>
</div>
<div class="paragraph">
<p>After reading this chapter, you will know:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What event auditing is and how it works.</p>
</li>
<li>
<p>How to configure event auditing on FreeBSD for users and processes.</p>
</li>
<li>
<p>How to review the audit trail using the audit reduction and review tools.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before reading this chapter, you should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand UNIX® and FreeBSD basics (crossref:basics[basics,FreeBSD Basics]).</p>
</li>
<li>
<p>Be familiar with the basics of kernel configuration/compilation (crossref:kernelconfig[kernelconfig,Configuring the FreeBSD Kernel]).</p>
</li>
<li>
<p>Have some familiarity with security and how it pertains to FreeBSD (crossref:security[security,Security]).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The audit facility has some known limitations.
Not all security-relevant system events are auditable and some login mechanisms, such as Xorg-based display managers and third-party daemons, do not properly configure auditing for user login sessions.</p>
</div>
<div class="paragraph">
<p>The security event auditing facility is able to generate very detailed logs of system activity.
On a busy system, trail file data can be very large when configured for high detail, exceeding gigabytes a week in some configurations.
Administrators should take into account the disk space requirements associated with high volume audit configurations.
For example, it may be desirable to dedicate a file system to <span class="filename">/var/audit</span> so that other file systems are not affected if the audit file system becomes full.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="audit-inline-glossary">2. Key Terms<a class="anchor" href="#audit-inline-glossary"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following terms are related to security event auditing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>event</em>: an auditable event is any event that can be logged using the audit subsystem. Examples of security-relevant events include the creation of a file, the building of a network connection, or a user logging in. Events are either &#34;attributable&#34;, meaning that they can be traced to an authenticated user, or &#34;non-attributable&#34;. Examples of non-attributable events are any events that occur before authentication in the login process, such as bad password attempts.</p>
</li>
<li>
<p><em>class</em>: a named set of related events which are used in selection expressions. Commonly used classes of events include &#34;file creation&#34; (fc), &#34;exec&#34; (ex), and &#34;login_logout&#34; (lo).</p>
</li>
<li>
<p><em>record</em>: an audit log entry describing a security event. Records contain a record event type, information on the subject (user) performing the action, date and time information, information on any objects or arguments, and a success or failure condition.</p>
</li>
<li>
<p><em>trail</em>: a log file consisting of a series of audit records describing security events. Trails are in roughly chronological order with respect to the time events completed. Only authorized processes are allowed to commit records to the audit trail.</p>
</li>
<li>
<p><em>selection expression</em>: a string containing a list of prefixes and audit event class names used to match events.</p>
</li>
<li>
<p><em>preselection</em>: the process by which the system identifies which events are of interest to the administrator. The preselection configuration uses a series of selection expressions to identify which classes of events to audit for which users, as well as global settings that apply to both authenticated and unauthenticated processes.</p>
</li>
<li>
<p><em>reduction</em>: the process by which records from existing audit trails are selected for preservation, printing, or analysis. Likewise, the process by which undesired audit records are removed from the audit trail. Using reduction, administrators can implement policies for the preservation of audit data. For example, detailed audit trails might be kept for one month, but after that, trails might be reduced in order to preserve only login information for archival purposes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="audit-config">3. Audit Configuration<a class="anchor" href="#audit-config"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>User space support for event auditing is installed as part of the base FreeBSD operating system.
Kernel support is available in the <span class="filename">GENERIC</span> kernel by default, and man:auditd[8] can be enabled by adding the following line to <span class="filename">/etc/rc.conf</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>auditd_enable=&#34;YES&#34;</pre>
</div>
</div>
<div class="paragraph">
<p>Then, start the audit daemon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># service auditd start</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Users who prefer to compile a custom kernel must include the following line in their custom kernel configuration file:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>options	AUDIT</pre>
</div>
</div>
<div class="sect2">
<h3 id="_event_selection_expressions">3.1. Event Selection Expressions<a class="anchor" href="#_event_selection_expressions"></a></h3>
<div class="paragraph">
<p>Selection expressions are used in a number of places in the audit configuration to determine which events should be audited.
Expressions contain a list of event classes to match.
Selection expressions are evaluated from left to right, and two expressions are combined by appending one onto the other.</p>
</div>
<div class="paragraph">
<p><a href="#event-selection">Default Audit Event Classes</a> summarizes the default audit event classes:</p>
</div>
<table id="event-selection" class="tableblock frame-none grid-all stretch">
<caption class="title">Table 1. Default Audit Event Classes</caption>
<colgroup>
<col style="width: 33.3333%;"/>
<col style="width: 33.3333%;"/>
<col style="width: 33.3334%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match all event classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">authentication and authorization</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">administrative</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Administrative actions performed on the system as a whole.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">application</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application defined action.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file close</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit calls to the <code>close</code> system call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">exec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit program execution. Auditing of command line arguments and environmental variables is controlled via man:audit_control[5] using the <code>argv</code> and <code>envv</code> parameters to the <code>policy</code> setting.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file attribute access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit the access of object attributes such as man:stat[1] and man:pathconf[2].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events where a file is created as a result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events where file deletion occurs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file attribute modify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events where file attribute modification occurs, such as by man:chown[8], man:chflags[1], and man:flock[2].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events in which data is read or files are opened for reading.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fw</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">file write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events in which data is written or files are written or modified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">io</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ioctl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit use of the <code>ioctl</code> system call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit various forms of Inter-Process Communication, including POSIX pipes and System V IPC operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">login_logout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit man:login[1] and man:logout[1] events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">na</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">non attributable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit non-attributable events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Match no audit events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">network</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit events related to network actions such as man:connect[2] and man:accept[2].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">other</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit miscellaneous events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit process operations such as man:exec[3] and man:exit[3].</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These audit event classes may be customized by modifying the <span class="filename">audit_class</span> and <span class="filename">audit_event</span> configuration files.</p>
</div>
<div class="paragraph">
<p>Each audit event class may be combined with a prefix indicating whether successful/failed operations are matched, and whether the entry is adding or removing matching for the class and type.
<a href="#event-prefixes">Prefixes for Audit Event Classes</a> summarizes the available prefixes:</p>
</div>
<table id="event-prefixes" class="tableblock frame-none grid-all stretch">
<caption class="title">Table 2. Prefixes for Audit Event Classes</caption>
<colgroup>
<col style="width: 50%;"/>
<col style="width: 50%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit successful events in this class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit failed events in this class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">^</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit neither successful nor failed events in this class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">^+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not audit successful events in this class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">^-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not audit failed events in this class.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If no prefix is present, both successful and failed instances of the event will be audited.</p>
</div>
<div class="paragraph">
<p>The following example selection string selects both successful and failed login/logout events, but only successful execution events:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>lo,+ex</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_files">3.2. Configuration Files<a class="anchor" href="#_configuration_files"></a></h3>
<div class="paragraph">
<p>The following configuration files for security event auditing are found in <span class="filename">/etc/security</span>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="filename">audit_class</span>: contains the definitions of the audit classes.</p>
</li>
<li>
<p><span class="filename">audit_control</span>: controls aspects of the audit subsystem, such as default audit classes, minimum disk space to leave on the audit log volume, and maximum audit trail size.</p>
</li>
<li>
<p><span class="filename">audit_event</span>: textual names and descriptions of system audit events and a list of which classes each event is in.</p>
</li>
<li>
<p><span class="filename">audit_user</span>: user-specific audit requirements to be combined with the global defaults at login.</p>
</li>
<li>
<p><span class="filename">audit_warn</span>: a customizable shell script used by man:auditd[8] to generate warning messages in exceptional situations, such as when space for audit records is running low or when the audit trail file has been rotated.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Audit configuration files should be edited and maintained carefully, as errors in configuration may result in improper logging of events.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>In most cases, administrators will only need to modify <span class="filename">audit_control</span> and <span class="filename">audit_user</span>.
The first file controls system-wide audit properties and policies and the second file may be used to fine-tune auditing by user.</p>
</div>
<div class="sect3">
<h4 id="audit-auditcontrol">3.2.1. The <span class="filename">audit_control</span> File<a class="anchor" href="#audit-auditcontrol"></a></h4>
<div class="paragraph">
<p>A number of defaults for the audit subsystem are specified in <span class="filename">audit_control</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>dir:/var/audit
dist:off
flags:lo,aa
minfree:5
naflags:lo,aa
policy:cnt,argv
filesz:2M
expire-after:10M</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>dir</code> entry is used to set one or more directories where audit logs will be stored.
If more than one directory entry appears, they will be used in order as they fill.
It is common to configure audit so that audit logs are stored on a dedicated file system, in order to prevent interference between the audit subsystem and other subsystems if the file system fills.</p>
</div>
<div class="paragraph">
<p>If the <code>dist</code> field is set to <code>on</code> or <code>yes</code>, hard links will be created to all trail files in <span class="filename">/var/audit/dist</span>.</p>
</div>
<div class="paragraph">
<p>The <code>flags</code> field sets the system-wide default preselection mask for attributable events.
In the example above, successful and failed login/logout events as well as authentication and authorization are audited for all users.</p>
</div>
<div class="paragraph">
<p>The <code>minfree</code> entry defines the minimum percentage of free space for the file system where the audit trail is stored.</p>
</div>
<div class="paragraph">
<p>The <code>naflags</code> entry specifies audit classes to be audited for non-attributed events, such as the login/logout process and authentication and authorization.</p>
</div>
<div class="paragraph">
<p>The <code>policy</code> entry specifies a comma-separated list of policy flags controlling various aspects of audit behavior.
The <code>cnt</code> indicates that the system should continue running despite an auditing failure (this flag is highly recommended).
The other flag, <code>argv</code>, causes command line arguments to the man:execve[2] system call to be audited as part of command execution.</p>
</div>
<div class="paragraph">
<p>The <code>filesz</code> entry specifies the maximum size for an audit trail before automatically terminating and rotating the trail file.
A value of <code>0</code> disables automatic log rotation.
If the requested file size is below the minimum of 512k, it will be ignored and a log message will be generated.</p>
</div>
<div class="paragraph">
<p>The <code>expire-after</code> field specifies when audit log files will expire and be removed.</p>
</div>
</div>
<div class="sect3">
<h4 id="audit-audituser">3.2.2. The <span class="filename">audit_user</span> File<a class="anchor" href="#audit-audituser"></a></h4>
<div class="paragraph">
<p>The administrator can specify further audit requirements for specific users in <span class="filename">audit_user</span>.
Each line configures auditing for a user via two fields: the <code>alwaysaudit</code> field specifies a set of events that should always be audited for the user, and the <code>neveraudit</code> field specifies a set of events that should never be audited for the user.</p>
</div>
<div class="paragraph">
<p>The following example entries audit login/logout events and successful command execution for <code>root</code> and file creation and successful command execution for <code>www</code>.
If used with the default <span class="filename">audit_control</span>, the <code>lo</code> entry for <code>root</code> is redundant, and login/logout events will also be audited for <code>www</code>.</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>root:lo,+ex:no
www:fc,+ex:no</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="audit-administration">4. Working with Audit Trails<a class="anchor" href="#audit-administration"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since audit trails are stored in the BSM binary format, several built-in tools are available to modify or convert these trails to text.
To convert trail files to a simple text format, use <code>praudit</code>.
To reduce the audit trail file for analysis, archiving, or printing purposes, use <code>auditreduce</code>.
This utility supports a variety of selection parameters, including event type, event class, user, date or time of the event, and the file path or object acted on.</p>
</div>
<div class="paragraph">
<p>For example, to dump the entire contents of a specified audit log in plain text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># praudit /var/audit/AUDITFILE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <em>AUDITFILE</em> is the audit log to dump.</p>
</div>
<div class="paragraph">
<p>Audit trails consist of a series of audit records made up of tokens, which <code>praudit</code> prints sequentially, one per line.
Each token is of a specific type, such as <code>header</code> (an audit record header) or <code>path</code> (a file path from a name lookup).
The following is an example of an <code>execve</code> event:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>header,133,10,execve(2),0,Mon Sep 25 15:58:03 2006, + 384 msec
exec arg,finger,doug
path,/usr/bin/finger
attribute,555,root,wheel,90,24918,104944
subject,robert,root,wheel,root,wheel,38439,38032,42086,128.232.9.100
return,success,0
trailer,133</pre>
</div>
</div>
<div class="paragraph">
<p>This audit represents a successful <code>execve</code> call, in which the command <code>finger doug</code> has been run.
The <code>exec arg</code> token contains the processed command line presented by the shell to the kernel.
The <code>path</code> token holds the path to the executable as looked up by the kernel.
The <code>attribute</code> token describes the binary and includes the file mode.
The <code>subject</code> token stores the audit user ID, effective user ID and group ID, real user ID and group ID, process ID, session ID, port ID, and login address.
Notice that the audit user ID and real user ID differ as the user <code>robert</code> switched to the <code>root</code> account before running this command, but it is audited using the original authenticated user.
The <code>return</code> token indicates the successful execution and the <code>trailer</code> concludes the record.</p>
</div>
<div class="paragraph">
<p>XML output format is also supported and can be selected by including <code>-x</code>.</p>
</div>
<div class="paragraph">
<p>Since audit logs may be very large, a subset of records can be selected using <code>auditreduce</code>.
This example selects all audit records produced for the user <code>trhodes</code> stored in <span class="filename">AUDITFILE</span>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># auditreduce -u trhodes /var/audit/AUDITFILE | praudit</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Members of the <code>audit</code> group have permission to read audit trails in <span class="filename">/var/audit</span>.
By default, this group is empty, so only the <code>root</code> user can read audit trails.
Users may be added to the <code>audit</code> group in order to delegate audit review rights.
As the ability to track audit log contents provides significant insight into the behavior of users and processes, it is recommended that the delegation of audit review rights be performed with caution.</p>
</div>
<div class="sect2">
<h3 id="_live_monitoring_using_audit_pipes">4.1. Live Monitoring Using Audit Pipes<a class="anchor" href="#_live_monitoring_using_audit_pipes"></a></h3>
<div class="paragraph">
<p>Audit pipes are cloning pseudo-devices which allow applications to tap the live audit record stream.
This is primarily of interest to authors of intrusion detection and system monitoring applications.
However, the audit pipe device is a convenient way for the administrator to allow live monitoring without running into problems with audit trail file ownership or log rotation interrupting the event stream.
To track the live audit event stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># praudit /dev/auditpipe</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, audit pipe device nodes are accessible only to the <code>root</code> user.
To make them accessible to the members of the <code>audit</code> group, add a <code>devfs</code> rule to <span class="filename">/etc/devfs.rules</span>:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>add path &#39;auditpipe*&#39; mode 0440 group audit</pre>
</div>
</div>
<div class="paragraph">
<p>See man:devfs.rules[5] for more information on configuring the devfs file system.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is easy to produce audit event feedback cycles, in which the viewing of each audit event results in the generation of more audit events.
For example, if all network I/O is audited, and <code>praudit</code> is run from an SSH session, a continuous stream of audit events will be generated at a high rate, as each event being printed will generate another event.
For this reason, it is advisable to run <code>praudit</code> on an audit pipe device from sessions without fine-grained I/O auditing.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_rotating_and_compressing_audit_trail_files">4.2. Rotating and Compressing Audit Trail Files<a class="anchor" href="#_rotating_and_compressing_audit_trail_files"></a></h3>
<div class="paragraph">
<p>Audit trails are written to by the kernel and managed by the audit daemon, man:auditd[8].
Administrators should not attempt to use man:newsyslog.conf[5] or other tools to directly rotate audit logs.
Instead, <code>audit</code> should be used to shut down auditing, reconfigure the audit system, and perform log rotation.
The following command causes the audit daemon to create a new audit log and signal the kernel to switch to using the new log.
The old log will be terminated and renamed, at which point it may then be manipulated by the administrator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># audit -n</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If man:auditd[8] is not currently running, this command will fail and an error message will be produced.</p>
</div>
<div class="paragraph">
<p>Adding the following line to <span class="filename">/etc/crontab</span> will schedule this rotation every twelve hours:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>0     */12       *       *       *       root    /usr/sbin/audit -n</pre>
</div>
</div>
<div class="paragraph">
<p>The change will take effect once <span class="filename">/etc/crontab</span> is saved.</p>
</div>
<div class="paragraph">
<p>Automatic rotation of the audit trail file based on file size is possible using <code>filesz</code> in <span class="filename">audit_control</span> as described in <a href="#audit-auditcontrol">The <span class="filename">audit_control</span> File</a>.</p>
</div>
<div class="paragraph">
<p>As audit trail files can become very large, it is often desirable to compress or otherwise archive trails once they have been closed by the audit daemon.
The <span class="filename">audit_warn</span> script can be used to perform customized operations for a variety of audit-related events, including the clean termination of audit trails when they are rotated.
For example, the following may be added to <span class="filename">/etc/security/audit_warn</span> to compress audit trails on close:</p>
</div>
<div class="literalblock programlisting">
<div class="content">
<pre>#
# Compress audit trail files on close.
#
if [ &#34;$1&#34; = closefile ]; then
        gzip -9 $2
fi</pre>
</div>
</div>
<div class="paragraph">
<p>Other archiving activities might include copying trail files to a centralized server, deleting old trail files, or reducing the audit trail to remove unneeded records.
This script will be run only when audit trail files are cleanly terminated.
It will not be run on trails left unterminated following an improper shutdown.</p>
</div>
</div>
</div>
</div>

    </div>
    
    <div class="buttons">
      
      <div class="prev">
        <i class="fa fa-angle-left" aria-hidden="true" title="Prev"></i>
        <div class="container">
          
            <a href=http://127.0.0.1:5500/en/books/handbook/mac class="direction">Prev</a>
          
        </div>
      </div>
      
      <div class="home">
        <i class="fa fa-home" aria-hidden="true" title="Home"></i>
        <div class="container">
          
            <a href="../" class="direction">Home</a>
          
        </div>
      </div>
      
      <div class="next">
        <div class="container">
          
            <a href=http://127.0.0.1:5500/en/books/handbook/disks  class="direction">Next</a>
          
        </div>
        <i class="fa fa-angle-right" aria-hidden="true" title="Next"></i>
      </div>
      
    </div>
    <label class="hidden book-menu-overlay" for="menu-control"></label>
  </div>
  <aside class="toc">
    <div class="toc-content">
      <h3>Table of Contents</h3>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#audit-synopsis">1. Synopsis</a></li>
    <li><a href="#audit-inline-glossary">2. Key Terms</a></li>
    <li><a href="#audit-config">3. Audit Configuration</a></li>
    <li><a href="#audit-administration">4. Working with Audit Trails</a></li>
  </ul>
</nav>
      <hr />
      
    </div>
  </aside>
  <a class="to-top" href="#top">
    <i class="fa fa-arrow-circle-up" aria-hidden="true"></i>
  </a>
</main>

    <footer>
  <div class="footer-container">
    <section class="logo-column">
          <img src="/images/FreeBSD-colors.svg" width="160" height="50" alt="FreeBSD logo" />
        <div class="options-container">
          
            <div class="language-container">
              <a id="languages" href="http://127.0.0.1:5500/en/languages">
                
                <img src="/images/language.png" class="language-image" alt="Choose language">
                <span>English</span>
              </a>
            </div>
          
          <div class="theme-container">
            <select id="theme-chooser">
	      <option value="theme-system">System</option>
              <option value="theme-light">Light</option>
              <option value="theme-dark">Dark</option>
              <option value="theme-high-contrast">High contrast</option>
            </select>
          </div>
        </div>
      </section>
      
      <section class="copyright-column">
        <p>&copy; 1994-2023 The FreeBSD Project. All rights reserved</p>
        <span>Made with <span class="heart">♥</span> by the FreeBSD Community</span>
      </section>
  </div>
</footer>

  </body>
</html>
